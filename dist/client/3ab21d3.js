(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{392:function(t,e,n){"use strict";n(12),n(13),n(17),n(18);var o=n(2),r=(n(5),n(51),n(58),n(32),n(11),n(28),n(54),n(371),n(49),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(50),n(10),n(260),n(1)),h=n(78),l=n(0);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d=["sm","md","lg","xl"],m=["start","end","center"];function y(t,e){return d.reduce((function(n,o){return n[t+Object(l.t)(o)]=e(),n}),{})}var v=function(t){return[].concat(m,["baseline","stretch"]).includes(t)},x=y("align",(function(){return{type:String,default:null,validator:v}})),w=function(t){return[].concat(m,["space-between","space-around"]).includes(t)},k=y("justify",(function(){return{type:String,default:null,validator:w}})),M=function(t){return[].concat(m,["space-between","space-around","stretch"]).includes(t)},S=y("alignContent",(function(){return{type:String,default:null,validator:M}})),P={align:Object.keys(x),justify:Object.keys(k),alignContent:Object.keys(S)},N={align:"align",justify:"justify",alignContent:"align-content"};function C(t,e,n){var o=N[t];if(null!=n){if(e){var r=e.replace(t,"");o+="-".concat(r)}return(o+="-".concat(n)).toLowerCase()}}var T=new Map;e.a=r.a.extend({name:"v-row",functional:!0,props:f(f(f({tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:v}},x),{},{justify:{type:String,default:null,validator:w}},k),{},{alignContent:{type:String,default:null,validator:M}},S),render:function(t,e){var n=e.props,data=e.data,r=e.children,l="";for(var c in n)l+=String(n[c]);var f=T.get(l);if(!f){var d,m;for(m in f=[],P)P[m].forEach((function(t){var e=n[t],o=C(m,t,e);o&&f.push(o)}));f.push((d={"no-gutters":n.noGutters,"row--dense":n.dense},Object(o.a)(d,"align-".concat(n.align),n.align),Object(o.a)(d,"justify-".concat(n.justify),n.justify),Object(o.a)(d,"align-content-".concat(n.alignContent),n.alignContent),d)),T.set(l,f)}return t(n.tag,Object(h.a)(data,{staticClass:"row",class:f}),r)}})},393:function(t,e,n){"use strict";n(12),n(13),n(17),n(18);var o=n(2),r=(n(5),n(23),n(11),n(28),n(54),n(371),n(49),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(50),n(51),n(10),n(59),n(260),n(1)),h=n(78),l=n(0);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var d=["sm","md","lg","xl"],m=d.reduce((function(t,e){return t[e]={type:[Boolean,String,Number],default:!1},t}),{}),y=d.reduce((function(t,e){return t["offset"+Object(l.t)(e)]={type:[String,Number],default:null},t}),{}),v=d.reduce((function(t,e){return t["order"+Object(l.t)(e)]={type:[String,Number],default:null},t}),{}),x={col:Object.keys(m),offset:Object.keys(y),order:Object.keys(v)};function w(t,e,n){var o=t;if(null!=n&&!1!==n){if(e){var r=e.replace(t,"");o+="-".concat(r)}return"col"!==t||""!==n&&!0!==n?(o+="-".concat(n)).toLowerCase():o.toLowerCase()}}var k=new Map;e.a=r.a.extend({name:"v-col",functional:!0,props:f(f(f(f({cols:{type:[Boolean,String,Number],default:!1}},m),{},{offset:{type:[String,Number],default:null}},y),{},{order:{type:[String,Number],default:null}},v),{},{alignSelf:{type:String,default:null,validator:function(t){return["auto","start","end","center","baseline","stretch"].includes(t)}},tag:{type:String,default:"div"}}),render:function(t,e){var n=e.props,data=e.data,r=e.children,l=(e.parent,"");for(var c in n)l+=String(n[c]);var f=k.get(l);if(!f){var d,m;for(m in f=[],x)x[m].forEach((function(t){var e=n[t],o=w(m,t,e);o&&f.push(o)}));var y=f.some((function(t){return t.startsWith("col-")}));f.push((d={col:!y||!n.cols},Object(o.a)(d,"col-".concat(n.cols),n.cols),Object(o.a)(d,"offset-".concat(n.offset),n.offset),Object(o.a)(d,"order-".concat(n.order),n.order),Object(o.a)(d,"align-self-".concat(n.alignSelf),n.alignSelf),d)),k.set(l,f)}return t(n.tag,Object(h.a)(data,{class:f}),r)}})},440:function(t,e,n){"use strict";(function(t,o){n.d(e,"l",(function(){return h})),n.d(e,"o",(function(){return l})),n.d(e,"g",(function(){return c})),n.d(e,"p",(function(){return f})),n.d(e,"h",(function(){return d})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return v})),n.d(e,"b",(function(){return x})),n.d(e,"e",(function(){return w})),n.d(e,"j",(function(){return k})),n.d(e,"m",(function(){return M})),n.d(e,"n",(function(){return S})),n.d(e,"q",(function(){return P})),n.d(e,"k",(function(){return N})),n.d(e,"i",(function(){return C})),n.d(e,"f",(function(){return T})),n.d(e,"r",(function(){return L})),function(){var e;function n(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function r(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:n(a)}}function h(a){for(var b,t=[];!(b=a.next()).done;)t.push(b.value);return t}var l,c="function"==typeof Object.create?Object.create:function(a){function b(){}return b.prototype=a,new b};if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var f;t:{var d={};try{d.__proto__={a:!0},f=d.a;break t}catch(t){}f=!1}l=f?function(a,b){if(a.__proto__=b,a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var m=l;function y(a,b){if(a.prototype=c(b.prototype),a.prototype.constructor=a,m)m(a,b);else for(var t in b)if("prototype"!=t)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,t);e&&Object.defineProperty(a,t,e)}else a[t]=b[t];a.QA=b.prototype}var v=void 0!==t&&null!=t?t:self,x="function"==typeof Object.assign?Object.assign:function(a,b){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n])}return a},w="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,t){a!=Array.prototype&&a!=Object.prototype&&(a[b]=t.value)};function k(a,b){if(b){var t=v;a=a.split(".");for(var e=0;e<a.length-1;e++){var n=a[e];n in t||(t[n]={}),t=t[n]}(b=b(e=t[a=a[a.length-1]]))!=e&&null!=b&&w(t,a,{writable:!0,value:b})}}k("Object.assign",(function(a){return a||x})),k("Array.prototype.fill",(function(a){return a||function(a,t,e){var b=this.length||0;for(0>t&&(t=Math.max(0,b+t)),(null==e||e>b)&&(e=b),0>(e=Number(e))&&(e=Math.max(0,b+e)),t=Number(t||0);t<e;t++)this[t]=a;return this}}));var M="object"==typeof globalThis&&globalThis||"object"==typeof t&&t.global===t&&t||"object"==typeof self&&self.self===self&&self||{};function S(){}function P(a,b){var t=-1;return function(){var e=this,n=arguments;-1!==t&&M.clearTimeout(t),t=N((function(){t=-1,a.apply(e,n)}),b)}}function N(a,b){return M.setTimeout(a,b)}function C(a){return M.document.createElement(a)}function T(a){throw Error(a)}function L(a,b){a="The object is frozen, so its properties cannot be set: "+a.toString(),void 0!==b&&(a+="  to value: "+b),T(a)}function A(a,b,t,e){t=null===t?"*":"string"==typeof t?t:"function"==typeof t&&"string"==typeof t.className?t.className:"",void 0!==e&&(t+="."+e),T(t+" is not in the range "+b+": "+a)}function j(a){M.console&&M.console.log(a)}function F(a){return"object"==typeof a&&null!==a}function O(a){return Array.isArray(a)||M.NodeList&&a instanceof M.NodeList||M.HTMLCollection&&a instanceof M.HTMLCollection}function B(a){return Array.prototype.slice.call(a)}function D(a,b,t){Array.isArray(a)?b>=a.length?a.push(t):a.splice(b,0,t):T("Cannot insert an object into an HTMLCollection or NodeList: "+t+" at "+b)}function I(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):T("Cannot remove an object from an HTMLCollection or NodeList at "+b)}function z(){var a=H.pop();return void 0===a?[]:a}function R(a){a.length=0,H.push(a)}function E(a){if("function"==typeof a){if(a.className)return a.className;if(a.name)return a.name;var b=a.toString();if(""!==(b=b.substring(9,b.indexOf("(")).trim()))return a._className=b}else if(F(a)&&a.constructor)return E(a.constructor);return typeof a}function V(a){var b=a;return F(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID))),void 0===b?"undefined":null===b?"null":b.toString()}function Y(a,b){if(a.hasOwnProperty(b))return!0;for(a=Object.getPrototypeOf(a);a&&a!==Function;){if(a.hasOwnProperty(b))return!0;var t=a.CA;if(t&&t[b])return!0;a=Object.getPrototypeOf(a)}return!1}function G(a,b,t){Object.defineProperty(Li.prototype,a,{get:b,set:t})}function X(a){for(var b=[],t=0;256>t;t++)b["0123456789abcdef".charAt(t>>4)+"0123456789abcdef".charAt(15&t)]=String.fromCharCode(t);a.length%2&&(a="0"+a),t=[];for(var e=0,n=0;n<a.length;n+=2)t[e++]=b[a.substr(n,2)];for(a=""===(a=t.join(""))?"0":a,b=[],t=0;256>t;t++)b[t]=t;for(t=e=0;256>t;t++)e=(e+b[t]+119)%256,n=b[t],b[t]=b[e],b[e]=n;e=t=0;for(var o="",g=0;g<a.length;g++)e=(e+b[t=(t+1)%256])%256,n=b[t],b[t]=b[e],b[e]=n,o+=String.fromCharCode(a.charCodeAt(g)^b[(b[t]+b[e])%256]);return o}void 0===M.requestAnimationFrame&&(void 0===M.setImmediate?M.requestAnimationFrame=function(a){M.setTimeout(a,0)}:M.requestAnimationFrame=M.setImmediate);var U=void 0!==M.navigator&&0<M.navigator.userAgent.indexOf("Trident/7"),K=void 0!==M.navigator&&void 0!==M.navigator.platform&&null!==M.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i),H=[];function W(a,b,t){ht(this),this.j=a,this.xa=b,this.o=t}function J(a,b){return null==b||""===b?null:a[b]}function Z(){this.ew=[]}function _(){}Object.freeze([]),S.className="Util",S.Dx="32ab5ff3b26f42dc0ed90f21472913b5",S.adym="gojs.net",S.vfo="28e645fdb267",S.className="Util",W.prototype.toString=function(){return"EnumValue."+this.xa},v.Object.defineProperties(W.prototype,{classType:{get:function(){return this.j}},name:{get:function(){return this.xa}},value:{get:function(){return this.o}}}),W.className="EnumValue",Z.prototype.toString=function(){return this.ew.join("")},Z.prototype.add=function(a){""!==a&&this.ew.push(a)},Z.className="StringBuilder",_.className="PropertyCollection";var $={EA:!1,JA:!1,GA:!1,IA:!1,NA:!1,LA:!1,nx:!1,FA:null,trace:function(a){M.console&&M.console.log(a)},HA:function(a,b,t,e){a.strokeStyle="red",a.fillStyle="red",a.font="8px sans-serif",a.beginPath(),a.moveTo(-10,0),a.lineTo(10,0),a.moveTo(0,-10),a.lineTo(0,10),a.stroke(),a.setTransform(1,0,0,1,0,0),a.scale(t,t),a.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),a.lineWidth=2,a.beginPath(),a.moveTo(e.left,e.top+20),a.lineTo(e.left,e.top),a.lineTo(e.left+20,e.top),a.moveTo(e.right,e.bottom-20),a.lineTo(e.right,e.bottom),a.lineTo(e.right-20,e.bottom),a.stroke(),a.fillText("DB: "+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.width)+", "+Math.round(e.height),e.left,e.top-5)},DA:function(a){var t,b={};for(t in a){if(b.x=t,"licenseKey"!==b.x){var e=a[b.x];if(void 0!==e.prototype){b.Yl=Object.getOwnPropertyNames(e.prototype);for(var n={Sj:0};n.Sj<b.Yl.length;(n={Sj:n.Sj}).Sj++){var o=Object.getOwnPropertyDescriptor(e.prototype,b.Yl[n.Sj]);void 0!==o.get&&void 0===o.set&&Object.defineProperty(e.prototype,b.Yl[n.Sj],{set:function(a,b){return function(){throw Error("Property "+a.Yl[b.Sj]+" of "+a.x+" is read-only.")}}(b,n)})}}}b={Yl:b.Yl,x:b.x}}}};function Q(){}Q.prototype.reset=function(){},Q.prototype.next=function(){return!1},Q.prototype.Ad=function(){return!1},Q.prototype.first=function(){return null},Q.prototype.any=function(){return!1},Q.prototype.all=function(){return!0},Q.prototype.each=function(){return this},Q.prototype.map=function(){return this},Q.prototype.filter=function(){return this},Q.prototype.de=function(){},Q.prototype.toString=function(){return"EmptyIterator"},v.Object.defineProperties(Q.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 0}}}),Q.prototype.first=Q.prototype.first,Q.prototype.hasNext=Q.prototype.Ad,Q.prototype.next=Q.prototype.next,Q.prototype.reset=Q.prototype.reset;var tt;function et(a){this.key=-1,this.value=a}function it(a){this.Cb=a,this.qf=null,a.Sa=null,this.qa=a.Ja,this.Za=-1}function nt(a){this.Cb=a,a.Hg=null,this.qa=a.Ja,this.Za=a.s.length}function ot(a){ht(this),this._isFrozen=!1,this.s=[],this.Ja=0,this.Hg=this.Sa=null,"string"==typeof a&&T("Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."),void 0!==a&&this.addAll(a)}function st(a){this.eg=a,a.Sa=null,this.qa=a.Ja,this.sa=null}function at(a){ht(this),this._isFrozen=!1,this.Ub={},this.Tb=0,this.Sa=null,this.Ja=0,this.kf=this.ea=null,"string"==typeof a&&T("Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."),void 0!==a&&this.addAll(a)}function ht(a){a.__gohashid=yt++}function lt(a){var b=a.__gohashid;return void 0===b&&(b=yt++,a.__gohashid=b),b}function ut(a){return a.__gohashid}Q.className="EmptyIterator",tt=new Q,et.prototype.reset=function(){this.key=-1},et.prototype.next=function(){return-1===this.key&&(this.key=0,!0)},et.prototype.Ad=function(){return this.next()},et.prototype.first=function(){return this.key=0,this.value},et.prototype.any=function(a){return this.key=-1,a(this.value)},et.prototype.all=function(a){return this.key=-1,a(this.value)},et.prototype.each=function(a){return this.key=-1,a(this.value),this},et.prototype.map=function(a){return new et(a(this.value))},et.prototype.filter=function(a){return a(this.value)?new et(this.value):tt},et.prototype.de=function(){this.value=null},et.prototype.toString=function(){return"SingletonIterator("+this.value+")"},v.Object.defineProperties(et.prototype,{iterator:{get:function(){return this}},count:{get:function(){return 1}}}),et.prototype.first=et.prototype.first,et.prototype.hasNext=et.prototype.Ad,et.prototype.next=et.prototype.next,et.prototype.reset=et.prototype.reset,et.className="SingletonIterator",it.prototype.reset=function(){var a=this.Cb;a.Sa=null,this.qa=a.Ja,this.Za=-1},it.prototype.next=function(){var a=this.Cb;if(a.Ja!==this.qa&&0>this.key)return!1;var b=(a=a.s).length,t=++this.Za,e=this.qf;if(null!==e)for(;t<b;){var n=a[t];if(e(n))return this.key=this.Za=t,this.value=n,!0;t++}else{if(t<b)return this.key=t,this.value=a[t],!0;this.de()}return!1},it.prototype.Ad=function(){return this.next()},it.prototype.first=function(){var a=this.Cb;this.qa=a.Ja,this.Za=0;var b=(a=a.s).length,t=this.qf;if(null!==t){for(var e=0;e<b;){var n=a[e];if(t(n))return this.key=this.Za=e,this.value=n;e++}return null}return 0<b?(a=a[0],this.key=0,this.value=a):null},it.prototype.any=function(a){var b=this.Cb;b.Sa=null,this.Za=-1;for(var t=(b=b.s).length,e=this.qf,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&a(o))return!0}return!1},it.prototype.all=function(a){var b=this.Cb;b.Sa=null,this.Za=-1;for(var t=(b=b.s).length,e=this.qf,n=0;n<t;n++){var o=b[n];if((null===e||e(o))&&!a(o))return!1}return!0},it.prototype.each=function(a){var b=this.Cb;b.Sa=null,this.Za=-1;for(var t=(b=b.s).length,e=this.qf,n=0;n<t;n++){var o=b[n];(null===e||e(o))&&a(o)}return this},it.prototype.map=function(a){var b=this.Cb;b.Sa=null,this.Za=-1;for(var t=[],e=(b=b.s).length,n=this.qf,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&t.push(a(g))}return(a=new ot).s=t,a.yb(),a.iterator},it.prototype.filter=function(a){var b=this.Cb;b.Sa=null,this.Za=-1;for(var t=[],e=(b=b.s).length,n=this.qf,o=0;o<e;o++){var g=b[o];(null===n||n(g))&&a(g)&&t.push(g)}return(a=new ot).s=t,a.yb(),a.iterator},it.prototype.de=function(){this.key=-1,this.value=null,this.qa=-1,this.qf=null,this.Cb.Sa=this},it.prototype.toString=function(){return"ListIterator@"+this.Za+"/"+this.Cb.count},v.Object.defineProperties(it.prototype,{iterator:{get:function(){return this}},predicate:{get:function(){return this.qf},set:function(a){this.qf=a}},count:{get:function(){var a=this.qf;if(null!==a){for(var b=0,t=this.Cb.s,e=t.length,n=0;n<e;n++)a(t[n])&&b++;return b}return this.Cb.s.length}}}),it.prototype.first=it.prototype.first,it.prototype.hasNext=it.prototype.Ad,it.prototype.next=it.prototype.next,it.prototype.reset=it.prototype.reset,it.className="ListIterator",nt.prototype.reset=function(){var a=this.Cb;a.Hg=null,this.qa=a.Ja,this.Za=a.s.length},nt.prototype.next=function(){var a=this.Cb;if(a.Ja!==this.qa&&0>this.key)return!1;var b=--this.Za;return 0<=b?(this.key=b,this.value=a.s[b],!0):(this.de(),!1)},nt.prototype.Ad=function(){return this.next()},nt.prototype.first=function(){var a=this.Cb;this.qa=a.Ja;var b=a.s;return this.Za=a=b.length-1,0<=a?(b=b[a],this.key=a,this.value=b):null},nt.prototype.any=function(a){var b=this.Cb;b.Hg=null;var t=(b=b.s).length;for(this.Za=t,--t;0<=t;t--)if(a(b[t]))return!0;return!1},nt.prototype.all=function(a){var b=this.Cb;b.Hg=null;var t=(b=b.s).length;for(this.Za=t,--t;0<=t;t--)if(!a(b[t]))return!1;return!0},nt.prototype.each=function(a){var b=this.Cb;b.Hg=null;var t=(b=b.s).length;for(this.Za=t,--t;0<=t;t--)a(b[t]);return this},nt.prototype.map=function(a){var b=this.Cb;b.Hg=null;var t=[],e=(b=b.s).length;for(this.Za=e,--e;0<=e;e--)t.push(a(b[e]));return(a=new ot).s=t,a.yb(),a.iterator},nt.prototype.filter=function(a){var b=this.Cb;b.Hg=null;var t=[],e=(b=b.s).length;for(this.Za=e,--e;0<=e;e--){var n=b[e];a(n)&&t.push(n)}return(a=new ot).s=t,a.yb(),a.iterator},nt.prototype.de=function(){this.key=-1,this.value=null,this.qa=-1,this.Cb.Hg=this},nt.prototype.toString=function(){return"ListIteratorBackwards("+this.Za+"/"+this.Cb.count+")"},v.Object.defineProperties(nt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.Cb.s.length}}}),nt.prototype.first=nt.prototype.first,nt.prototype.hasNext=nt.prototype.Ad,nt.prototype.next=nt.prototype.next,nt.prototype.reset=nt.prototype.reset,nt.className="ListIteratorBackwards",(e=ot.prototype).yb=function(){var a=this.Ja;999999999<++a&&(a=0),this.Ja=a},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return this._isFrozen=!1,this},e.toString=function(){return"List()#"+ut(this)},e.add=function(a){return null===a||(this._isFrozen&&L(this,a),this.s.push(a),this.yb()),this},e.push=function(a){this.add(a)},e.addAll=function(a){if(null===a)return this;this._isFrozen&&L(this);var b=this.s;if(O(a))for(var t=a.length,e=0;e<t;e++)b.push(a[e]);else for(a=a.iterator;a.next();)b.push(a.value);return this.yb(),this},e.clear=function(){this._isFrozen&&L(this),this.s.length=0,this.yb()},e.contains=function(a){return null!==a&&-1!==this.s.indexOf(a)},e.has=function(a){return this.contains(a)},e.indexOf=function(a){return null===a?-1:this.s.indexOf(a)},e.M=function(a){var b=this.s;return(0>a||a>=b.length)&&A(a,"0 <= i < length",ot,"elt:i"),b[a]},e.get=function(a){return this.M(a)},e.cd=function(a,b){var t=this.s;(0>a||a>=t.length)&&A(a,"0 <= i < length",ot,"setElt:i"),this._isFrozen&&L(this,a),t[a]=b},e.set=function(a,b){this.cd(a,b)},e.first=function(){var a=this.s;return 0===a.length?null:a[0]},e.kc=function(){var a=this.s,b=a.length;return 0<b?a[b-1]:null},e.pop=function(){this._isFrozen&&L(this);var a=this.s;return 0<a.length?a.pop():null},ot.prototype.any=function(a){for(var b=this.s,t=b.length,e=0;e<t;e++)if(a(b[e]))return!0;return!1},ot.prototype.all=function(a){for(var b=this.s,t=b.length,e=0;e<t;e++)if(!a(b[e]))return!1;return!0},ot.prototype.each=function(a){for(var b=this.s,t=b.length,e=0;e<t;e++)a(b[e]);return this},ot.prototype.map=function(a){for(var b=new ot,t=[],e=this.s,n=e.length,o=0;o<n;o++)t.push(a(e[o]));return b.s=t,b.yb(),b},ot.prototype.filter=function(a){for(var b=new ot,t=[],e=this.s,n=e.length,o=0;o<n;o++){var g=e[o];a(g)&&t.push(g)}return b.s=t,b.yb(),b},(e=ot.prototype).Hb=function(a,b){0>a&&A(a,">= 0",ot,"insertAt:i"),this._isFrozen&&L(this,a);var t=this.s;a>=t.length?t.push(b):t.splice(a,0,b),this.yb()},e.remove=function(a){if(null===a)return!1;this._isFrozen&&L(this,a);var b=this.s;return-1!==(a=b.indexOf(a))&&(a===b.length-1?b.pop():b.splice(a,1),this.yb(),!0)},e.delete=function(a){return this.remove(a)},e.mb=function(a){var b=this.s;(0>a||a>=b.length)&&A(a,"0 <= i < length",ot,"removeAt:i"),this._isFrozen&&L(this,a),a===b.length-1?b.pop():b.splice(a,1),this.yb()},e.removeRange=function(a,b){var t=this.s,e=t.length;if(0>a)a=0;else if(a>=e)return this;if(0>b)return this;if(b>=e&&(b=e-1),a>b)return this;this._isFrozen&&L(this);for(var n=a,o=b+1;o<e;)t[n++]=t[o++];return t.length=e-(b-a+1),this.yb(),this},ot.prototype.copy=function(){var a=new ot,b=this.s;return 0<b.length&&(a.s=Array.prototype.slice.call(b)),a},(e=ot.prototype).Fa=function(){for(var a=this.s,b=this.count,t=Array(b),e=0;e<b;e++)t[e]=a[e];return t},e.Iv=function(){for(var a=new at,b=this.s,t=this.count,e=0;e<t;e++)a.add(b[e]);return a},e.sort=function(a){return this._isFrozen&&L(this),this.s.sort(a),this.yb(),this},e.zi=function(a,b,t){var e=this.s,n=e.length;void 0===b&&(b=0),void 0===t&&(t=n),this._isFrozen&&L(this);var o=t-b;if(1>=o)return this;if((0>b||b>=n-1)&&A(b,"0 <= from < length",ot,"sortRange:from"),2===o)return 0<a(t=e[b],n=e[b+1])&&(e[b]=n,e[b+1]=t,this.yb()),this;if(0===b)if(t>=n)e.sort(a);else for((b=e.slice(0,t)).sort(a),a=0;a<t;a++)e[a]=b[a];else if(t>=n)for((t=e.slice(b)).sort(a),a=b;a<n;a++)e[a]=t[a-b];else for((n=e.slice(b,t)).sort(a),a=b;a<t;a++)e[a]=n[a-b];return this.yb(),this},e.reverse=function(){return this._isFrozen&&L(this),this.s.reverse(),this.yb(),this},v.Object.defineProperties(ot.prototype,{_dataArray:{get:function(){return this.s}},count:{get:function(){return this.s.length}},size:{get:function(){return this.s.length}},length:{get:function(){return this.s.length}},iterator:{get:function(){if(0>=this.s.length)return tt;var a=this.Sa;return null!==a?(a.reset(),a):new it(this)}},iteratorBackwards:{get:function(){if(0>=this.s.length)return tt;var a=this.Hg;return null!==a?(a.reset(),a):new nt(this)}}}),ot.prototype.reverse=ot.prototype.reverse,ot.prototype.sortRange=ot.prototype.zi,ot.prototype.sort=ot.prototype.sort,ot.prototype.toSet=ot.prototype.Iv,ot.prototype.toArray=ot.prototype.Fa,ot.prototype.removeRange=ot.prototype.removeRange,ot.prototype.removeAt=ot.prototype.mb,ot.prototype.delete=ot.prototype.delete,ot.prototype.remove=ot.prototype.remove,ot.prototype.insertAt=ot.prototype.Hb,ot.prototype.pop=ot.prototype.pop,ot.prototype.last=ot.prototype.kc,ot.prototype.first=ot.prototype.first,ot.prototype.set=ot.prototype.set,ot.prototype.setElt=ot.prototype.cd,ot.prototype.get=ot.prototype.get,ot.prototype.elt=ot.prototype.M,ot.prototype.indexOf=ot.prototype.indexOf,ot.prototype.has=ot.prototype.has,ot.prototype.contains=ot.prototype.contains,ot.prototype.clear=ot.prototype.clear,ot.prototype.addAll=ot.prototype.addAll,ot.prototype.push=ot.prototype.push,ot.prototype.add=ot.prototype.add,ot.prototype.thaw=ot.prototype.ka,ot.prototype.freeze=ot.prototype.freeze,ot.className="List",st.prototype.reset=function(){var a=this.eg;a.Sa=null,this.qa=a.Ja,this.sa=null},st.prototype.next=function(){var a=this.eg;if(a.Ja!==this.qa&&null===this.key)return!1;var b=this.sa;return null!==(b=null===b?a.ea:b.va)?(this.sa=b,this.value=b.value,this.key=b.key,!0):(this.de(),!1)},st.prototype.Ad=function(){return this.next()},st.prototype.first=function(){var a=this.eg;if(this.qa=a.Ja,null!==(a=a.ea)){this.sa=a;var b=a.value;return this.key=a.key,this.value=b}return null},st.prototype.any=function(a){var b=this.eg;for(this.sa=b.Sa=null,b=b.ea;null!==b;){if(a(b.value))return!0;b=b.va}return!1},st.prototype.all=function(a){var b=this.eg;for(this.sa=b.Sa=null,b=b.ea;null!==b;){if(!a(b.value))return!1;b=b.va}return!0},st.prototype.each=function(a){var b=this.eg;for(this.sa=b.Sa=null,b=b.ea;null!==b;)a(b.value),b=b.va;return this},st.prototype.map=function(a){var b=this.eg;b.Sa=null;var t=new ot;for(b=b.ea;null!==b;)t.add(a(b.value)),b=b.va;return t.iterator},st.prototype.filter=function(a){var b=this.eg;b.Sa=null;var t=new ot;for(b=b.ea;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.va}return t.iterator},st.prototype.de=function(){this.value=this.key=null,this.qa=-1,this.eg.Sa=this},st.prototype.toString=function(){return null!==this.sa?"SetIterator@"+this.sa.value:"SetIterator"},v.Object.defineProperties(st.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.eg.Tb}}}),st.prototype.first=st.prototype.first,st.prototype.hasNext=st.prototype.Ad,st.prototype.next=st.prototype.next,st.prototype.reset=st.prototype.reset,st.className="SetIterator",(e=at.prototype).yb=function(){var a=this.Ja;999999999<++a&&(a=0),this.Ja=a},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return this._isFrozen=!1,this},e.toString=function(){return"Set()#"+ut(this)},e.add=function(a){if(null===a)return this;this._isFrozen&&L(this,a);var b=a;return F(a)&&(b=lt(a)),void 0===this.Ub[b]&&(this.Tb++,a=new wt(a,a),this.Ub[b]=a,null===(b=this.kf)?this.ea=a:(a.kl=b,b.va=a),this.kf=a,this.yb()),this},e.addAll=function(a){if(null===a)return this;if(this._isFrozen&&L(this),O(a))for(var b=a.length,t=0;t<b;t++)this.add(a[t]);else for(a=a.iterator;a.next();)this.add(a.value);return this},e.contains=function(a){if(null===a)return!1;var b=a;return(!F(a)||void 0!==(b=ut(a)))&&void 0!==this.Ub[b]},e.has=function(a){return this.contains(a)},e.Sy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(!this.contains(a.value))return!1;return!0},e.Ty=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(this.contains(a.value))return!0;return!1},e.first=function(){var a=this.ea;return null===a?null:a.value},at.prototype.any=function(a){for(var b=this.ea;null!==b;){if(a(b.value))return!0;b=b.va}return!1},at.prototype.all=function(a){for(var b=this.ea;null!==b;){if(!a(b.value))return!1;b=b.va}return!0},at.prototype.each=function(a){for(var b=this.ea;null!==b;)a(b.value),b=b.va;return this},at.prototype.map=function(a){for(var b=new at,t=this.ea;null!==t;)b.add(a(t.value)),t=t.va;return b},at.prototype.filter=function(a){for(var b=new at,t=this.ea;null!==t;){var e=t.value;a(e)&&b.add(e),t=t.va}return b},(e=at.prototype).remove=function(a){if(null===a)return!1;this._isFrozen&&L(this,a);var b=a;if(F(a)&&void 0===(b=ut(a)))return!1;if(void 0===(a=this.Ub[b]))return!1;var t=a.va,e=a.kl;return null!==t&&(t.kl=e),null!==e&&(e.va=t),this.ea===a&&(this.ea=t),this.kf===a&&(this.kf=e),delete this.Ub[b],this.Tb--,this.yb(),!0},e.delete=function(a){return this.remove(a)},e.gp=function(a){if(null===a)return this;if(this._isFrozen&&L(this),O(a))for(var b=a.length,t=0;t<b;t++)this.remove(a[t]);else for(a=a.iterator;a.next();)this.remove(a.value);return this},e.pA=function(a){if(null===a||0===this.count)return this;this._isFrozen&&L(this);var b=new at;b.addAll(a),a=[];for(var t=this.iterator;t.next();){var e=t.value;b.contains(e)||a.push(e)}return this.gp(a),this},e.clear=function(){this._isFrozen&&L(this),this.Ub={},this.Tb=0,null!==this.Sa&&this.Sa.reset(),this.kf=this.ea=null,this.yb()},at.prototype.copy=function(){var t,a=new at,b=this.Ub;for(t in b)a.add(b[t].value);return a},at.prototype.Fa=function(){var t,a=Array(this.Tb),b=this.Ub,e=0;for(t in b)a[e]=b[t].value,e++;return a},at.prototype.Hv=function(){var t,a=new ot,b=this.Ub;for(t in b)a.add(b[t].value);return a},v.Object.defineProperties(at.prototype,{count:{get:function(){return this.Tb}},size:{get:function(){return this.Tb}},iterator:{get:function(){if(0>=this.Tb)return tt;var a=this.Sa;return null!==a?(a.reset(),a):new st(this)}}}),at.prototype.toList=at.prototype.Hv,at.prototype.toArray=at.prototype.Fa,at.prototype.clear=at.prototype.clear,at.prototype.retainAll=at.prototype.pA,at.prototype.removeAll=at.prototype.gp,at.prototype.delete=at.prototype.delete,at.prototype.remove=at.prototype.remove,at.prototype.first=at.prototype.first,at.prototype.containsAny=at.prototype.Ty,at.prototype.containsAll=at.prototype.Sy,at.prototype.has=at.prototype.has,at.prototype.contains=at.prototype.contains,at.prototype.addAll=at.prototype.addAll,at.prototype.add=at.prototype.add,at.prototype.thaw=at.prototype.ka,at.prototype.freeze=at.prototype.freeze;var ct,ft,pt,gt,mt,yt=1;function vt(a){this.ma=a,this.qa=a.Ja,this.sa=null}function xt(a){at.call(this),ht(this),this._isFrozen=!0,this.ma=a}function bt(a){this.ma=a,a.jf=null,this.qa=a.Ja,this.sa=null}function wt(a,b){this.key=a,this.value=b,this.kl=this.va=null}function kt(a){this.ma=a,a.Sa=null,this.qa=a.Ja,this.sa=null}function Mt(a){ht(this),this._isFrozen=!1,this.Ub={},this.Tb=0,this.jf=this.Sa=null,this.Ja=0,this.kf=this.ea=null,"string"==typeof a&&T("Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."),void 0!==a&&this.addAll(a)}function St(a,b){void 0===a?this.y=this.x=0:"number"==typeof a&&"number"==typeof b?(this.x=a,this.y=b):T("Invalid arguments to Point constructor: "+a+", "+b),this._isFrozen=!1}function Pt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new St(t,n)}return new St}function Nt(a){return a.x.toString()+" "+a.y.toString()}function Ct(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var t=180*Math.atan(Math.abs(b/a))/Math.PI;return 0>a?t=0>b?t+180:180-t:0>b&&(t=360-t),t}function Tt(a,b){return b.Cd(a),a}function Lt(a,b,t,e,n,o){var g=n-t,r=o-e,h=g*g+r*r,l=-(t-=a)*g-(e-=b)*r;return 0>=l||l>=h?(g=n-a,r=o-b,Math.min(t*t+e*e,g*g+r*r)):(a=g*e-r*t)*a/h}function At(a,b,t,e){return(a=t-a)*a+(b=e-b)*b}function jt(a,b,t,e){return b=e-b,0===(a=t-a)?0<b?90:0>b?270:0:0===b?0<a?0:180:isNaN(a)||isNaN(b)?0:(e=180*Math.atan(Math.abs(b/a))/Math.PI,0>a?e=0>b?e+180:180-e:0>b&&(e=360-e),e)}at.className="Set",at.uniqueHash=ht,at.hashIdUnique=lt,at.hashId=ut,vt.prototype.reset=function(){this.qa=this.ma.Ja,this.sa=null},vt.prototype.next=function(){var a=this.ma;if(a.Ja!==this.qa&&null===this.key)return!1;var b=this.sa;return null!==(b=null===b?a.ea:b.va)?(this.sa=b,this.value=this.key=a=b.key,!0):(this.de(),!1)},vt.prototype.Ad=function(){return this.next()},vt.prototype.first=function(){var a=this.ma;return this.qa=a.Ja,null!==(a=a.ea)?(this.sa=a,this.value=this.key=a=a.key):null},vt.prototype.any=function(a){var b=this.ma;for(this.sa=null,b=b.ea;null!==b;){if(a(b.key))return!0;b=b.va}return!1},vt.prototype.all=function(a){var b=this.ma;for(this.sa=null,b=b.ea;null!==b;){if(!a(b.key))return!1;b=b.va}return!0},vt.prototype.each=function(a){var b=this.ma;for(this.sa=null,b=b.ea;null!==b;)a(b.key),b=b.va;return this},vt.prototype.map=function(a){var b=this.ma;this.sa=null;var t=new ot;for(b=b.ea;null!==b;)t.add(a(b.key)),b=b.va;return t.iterator},vt.prototype.filter=function(a){var b=this.ma;this.sa=null;var t=new ot;for(b=b.ea;null!==b;){var e=b.key;a(e)&&t.add(e),b=b.va}return t.iterator},vt.prototype.de=function(){this.value=this.key=null,this.qa=-1},vt.prototype.toString=function(){return null!==this.sa?"MapKeySetIterator@"+this.sa.value:"MapKeySetIterator"},v.Object.defineProperties(vt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ma.Tb}}}),vt.prototype.first=vt.prototype.first,vt.prototype.hasNext=vt.prototype.Ad,vt.prototype.next=vt.prototype.next,vt.prototype.reset=vt.prototype.reset,vt.className="MapKeySetIterator",y(xt,at),(e=xt.prototype).freeze=function(){return this},e.ka=function(){return this},e.toString=function(){return"MapKeySet("+this.ma.toString()+")"},e.add=function(){T("This Set is read-only: "+this.toString())},e.contains=function(a){return this.ma.contains(a)},e.has=function(a){return this.contains(a)},e.remove=function(){T("This Set is read-only: "+this.toString())},e.delete=function(a){return this.remove(a)},e.clear=function(){T("This Set is read-only: "+this.toString())},e.first=function(){var a=this.ma.ea;return null!==a?a.key:null},xt.prototype.any=function(a){for(var b=this.ma.ea;null!==b;){if(a(b.key))return!0;b=b.va}return!1},xt.prototype.all=function(a){for(var b=this.ma.ea;null!==b;){if(!a(b.key))return!1;b=b.va}return!0},xt.prototype.each=function(a){for(var b=this.ma.ea;null!==b;)a(b.key),b=b.va;return this},xt.prototype.map=function(a){for(var b=new at,t=this.ma.ea;null!==t;)b.add(a(t.key)),t=t.va;return b},xt.prototype.filter=function(a){for(var b=new at,t=this.ma.ea;null!==t;){var e=t.key;a(e)&&b.add(e),t=t.va}return b},xt.prototype.copy=function(){return new xt(this.ma)},xt.prototype.Iv=function(){var t,a=new at,b=this.ma.Ub;for(t in b)a.add(b[t].key);return a},xt.prototype.Fa=function(){var t,a=this.ma.Ub,b=Array(this.ma.Tb),e=0;for(t in a)b[e]=a[t].key,e++;return b},xt.prototype.Hv=function(){var t,a=new ot,b=this.ma.Ub;for(t in b)a.add(b[t].key);return a},v.Object.defineProperties(xt.prototype,{count:{get:function(){return this.ma.Tb}},size:{get:function(){return this.ma.Tb}},iterator:{get:function(){return 0>=this.ma.Tb?tt:new vt(this.ma)}}}),xt.prototype.toList=xt.prototype.Hv,xt.prototype.toArray=xt.prototype.Fa,xt.prototype.toSet=xt.prototype.Iv,xt.prototype.first=xt.prototype.first,xt.prototype.clear=xt.prototype.clear,xt.prototype.delete=xt.prototype.delete,xt.prototype.remove=xt.prototype.remove,xt.prototype.has=xt.prototype.has,xt.prototype.contains=xt.prototype.contains,xt.prototype.add=xt.prototype.add,xt.prototype.thaw=xt.prototype.ka,xt.prototype.freeze=xt.prototype.freeze,xt.className="MapKeySet",bt.prototype.reset=function(){var a=this.ma;a.jf=null,this.qa=a.Ja,this.sa=null},bt.prototype.next=function(){var a=this.ma;if(a.Ja!==this.qa&&null===this.key)return!1;var b=this.sa;return null!==(b=null===b?a.ea:b.va)?(this.sa=b,this.value=b.value,this.key=b.key,!0):(this.de(),!1)},bt.prototype.Ad=function(){return this.next()},bt.prototype.first=function(){var a=this.ma;if(this.qa=a.Ja,null!==(a=a.ea)){this.sa=a;var b=a.value;return this.key=a.key,this.value=b}return null},bt.prototype.any=function(a){var b=this.ma;for(this.sa=b.jf=null,b=b.ea;null!==b;){if(a(b.value))return!0;b=b.va}return!1},bt.prototype.all=function(a){var b=this.ma;for(this.sa=b.jf=null,b=b.ea;null!==b;){if(!a(b.value))return!1;b=b.va}return!0},bt.prototype.each=function(a){var b=this.ma;for(this.sa=b.jf=null,b=b.ea;null!==b;)a(b.value),b=b.va;return this},bt.prototype.map=function(a){var b=this.ma;this.sa=b.jf=null;var t=new ot;for(b=b.ea;null!==b;)t.add(a(b.value)),b=b.va;return t.iterator},bt.prototype.filter=function(a){var b=this.ma;this.sa=b.jf=null;var t=new ot;for(b=b.ea;null!==b;){var e=b.value;a(e)&&t.add(e),b=b.va}return t.iterator},bt.prototype.de=function(){this.value=this.key=null,this.qa=-1,this.ma.jf=this},bt.prototype.toString=function(){return null!==this.sa?"MapValueSetIterator@"+this.sa.value:"MapValueSetIterator"},v.Object.defineProperties(bt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ma.Tb}}}),bt.prototype.first=bt.prototype.first,bt.prototype.hasNext=bt.prototype.Ad,bt.prototype.next=bt.prototype.next,bt.prototype.reset=bt.prototype.reset,bt.className="MapValueSetIterator",wt.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"},wt.className="KeyValuePair",kt.prototype.reset=function(){var a=this.ma;a.Sa=null,this.qa=a.Ja,this.sa=null},kt.prototype.next=function(){var a=this.ma;if(a.Ja!==this.qa&&null===this.key)return!1;var b=this.sa;return null!==(b=null===b?a.ea:b.va)?(this.sa=b,this.key=b.key,this.value=b.value,!0):(this.de(),!1)},kt.prototype.Ad=function(){return this.next()},kt.prototype.first=function(){var a=this.ma;return this.qa=a.Ja,null!==(a=a.ea)?(this.sa=a,this.key=a.key,this.value=a.value,a):null},kt.prototype.any=function(a){var b=this.ma;for(this.sa=b.Sa=null,b=b.ea;null!==b;){if(a(b))return!0;b=b.va}return!1},kt.prototype.all=function(a){var b=this.ma;for(this.sa=b.Sa=null,b=b.ea;null!==b;){if(!a(b))return!1;b=b.va}return!0},kt.prototype.each=function(a){var b=this.ma;for(this.sa=b.Sa=null,b=b.ea;null!==b;)a(b),b=b.va;return this},kt.prototype.map=function(a){var b=this.ma;this.sa=b.Sa=null;var t=new ot;for(b=b.ea;null!==b;)t.add(a(b)),b=b.va;return t.iterator},kt.prototype.filter=function(a){var b=this.ma;this.sa=b.Sa=null;var t=new ot;for(b=b.ea;null!==b;)a(b)&&t.add(b),b=b.va;return t.iterator},kt.prototype.de=function(){this.value=this.key=null,this.qa=-1,this.ma.Sa=this},kt.prototype.toString=function(){return null!==this.sa?"MapIterator@"+this.sa:"MapIterator"},v.Object.defineProperties(kt.prototype,{iterator:{get:function(){return this}},count:{get:function(){return this.ma.Tb}}}),kt.prototype.first=kt.prototype.first,kt.prototype.hasNext=kt.prototype.Ad,kt.prototype.next=kt.prototype.next,kt.prototype.reset=kt.prototype.reset,kt.className="MapIterator",(e=Mt.prototype).yb=function(){var a=this.Ja;999999999<++a&&(a=0),this.Ja=a},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return this._isFrozen=!1,this},e.toString=function(){return"Map()#"+ut(this)},e.add=function(a,b){this._isFrozen&&L(this,a);var t=a;F(a)&&(t=lt(a));var e=this.Ub[t];return void 0===e?(this.Tb++,a=new wt(a,b),this.Ub[t]=a,null===(t=this.kf)?this.ea=a:(a.kl=t,t.va=a),this.kf=a,this.yb()):e.value=b,this},e.set=function(a,b){return this.add(a,b)},e.addAll=function(a){if(null===a)return this;if(O(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];this.add(e.key,e.value)}else if(a instanceof Mt)for(a=a.iterator;a.next();)this.add(a.key,a.value);else for(a=a.iterator;a.next();)b=a.value,this.add(b.key,b.value);return this},e.first=function(){return this.ea},Mt.prototype.any=function(a){for(var b=this.ea;null!==b;){if(a(b))return!0;b=b.va}return!1},Mt.prototype.all=function(a){for(var b=this.ea;null!==b;){if(!a(b))return!1;b=b.va}return!0},Mt.prototype.each=function(a){for(var b=this.ea;null!==b;)a(b),b=b.va;return this},Mt.prototype.map=function(a){for(var b=new Mt,t=this.ea;null!==t;)b.add(t.key,a(t)),t=t.va;return b},Mt.prototype.filter=function(a){for(var b=new Mt,t=this.ea;null!==t;)a(t)&&b.add(t.key,t.value),t=t.va;return b},(e=Mt.prototype).contains=function(a){var b=a;return(!F(a)||void 0!==(b=ut(a)))&&void 0!==this.Ub[b]},e.has=function(a){return this.contains(a)},e.I=function(a){var b=a;return F(a)&&void 0===(b=ut(a))||void 0===(a=this.Ub[b])?null:a.value},e.get=function(a){return this.I(a)},e.remove=function(a){if(null===a)return!1;this._isFrozen&&L(this,a);var b=a;if(F(a)&&void 0===(b=ut(a)))return!1;if(void 0===(a=this.Ub[b]))return!1;var t=a.va,e=a.kl;return null!==t&&(t.kl=e),null!==e&&(e.va=t),this.ea===a&&(this.ea=t),this.kf===a&&(this.kf=e),delete this.Ub[b],this.Tb--,this.yb(),!0},e.delete=function(a){return this.remove(a)},e.clear=function(){this._isFrozen&&L(this),this.Ub={},this.Tb=0,null!==this.Sa&&this.Sa.reset(),null!==this.jf&&this.jf.reset(),this.kf=this.ea=null,this.yb()},Mt.prototype.copy=function(){var t,a=new Mt,b=this.Ub;for(t in b){var e=b[t];a.add(e.key,e.value)}return a},Mt.prototype.Fa=function(){var t,a=this.Ub,b=Array(this.Tb),e=0;for(t in a){var n=a[t];b[e]=new wt(n.key,n.value),e++}return b},Mt.prototype.Lf=function(){return new xt(this)},v.Object.defineProperties(Mt.prototype,{count:{get:function(){return this.Tb}},size:{get:function(){return this.Tb}},iterator:{get:function(){if(0>=this.count)return tt;var a=this.Sa;return null!==a?(a.reset(),a):new kt(this)}},iteratorKeys:{get:function(){return 0>=this.count?tt:new vt(this)}},iteratorValues:{get:function(){if(0>=this.count)return tt;var a=this.jf;return null!==a?(a.reset(),a):new bt(this)}}}),Mt.prototype.toKeySet=Mt.prototype.Lf,Mt.prototype.toArray=Mt.prototype.Fa,Mt.prototype.clear=Mt.prototype.clear,Mt.prototype.delete=Mt.prototype.delete,Mt.prototype.remove=Mt.prototype.remove,Mt.prototype.get=Mt.prototype.get,Mt.prototype.getValue=Mt.prototype.I,Mt.prototype.has=Mt.prototype.has,Mt.prototype.contains=Mt.prototype.contains,Mt.prototype.first=Mt.prototype.first,Mt.prototype.addAll=Mt.prototype.addAll,Mt.prototype.set=Mt.prototype.set,Mt.prototype.add=Mt.prototype.add,Mt.prototype.thaw=Mt.prototype.ka,Mt.prototype.freeze=Mt.prototype.freeze,Mt.className="Map",St.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this},St.prototype.h=function(a,b){return this.x=a,this.y=b,this},St.prototype.sg=function(a,b){return this.x=a,this.y=b,this},St.prototype.set=function(a){return this.x=a.x,this.y=a.y,this},St.prototype.copy=function(){var a=new St;return a.x=this.x,a.y=this.y,a},(e=St.prototype).ja=function(){return this._isFrozen=!0,Object.freeze(this),this},e.J=function(){return this._isFrozen||Object.isFrozen(this)?this:this.copy().freeze()},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this},e.toString=function(){return"Point("+this.x+","+this.y+")"},e.D=function(a){return a instanceof St&&(this.x===a.x&&this.y===a.y)},e.hi=function(a,b){return this.x===a&&this.y===b},e.Xa=function(a){return $e.B(this.x,a.x)&&$e.B(this.y,a.y)},e.add=function(a){return this.x+=a.x,this.y+=a.y,this},e.re=function(a){return this.x-=a.x,this.y-=a.y,this},e.offset=function(a,b){return this.x+=a,this.y+=b,this},St.prototype.rotate=function(a){if(0===a)return this;var b=this.x,t=this.y;if(0===b&&0===t)return this;if(360<=a?a-=360:0>a&&(a+=360),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));return this.x=a*b-e*t,this.y=e*b+a*t,this},(e=St.prototype).scale=function(a,b){return this.x*=a,this.y*=b,this},e.Bf=function(a){var b=a.x-this.x;return b*b+(a=a.y-this.y)*a},e.zd=function(a,b){return(a-=this.x)*a+(b-=this.y)*b},e.normalize=function(){var a=this.x,b=this.y,t=Math.sqrt(a*a+b*b);return 0<t&&(this.x=a/t,this.y=b/t),this},e.ab=function(a){return Ct(a.x-this.x,a.y-this.y)},e.direction=function(a,b){return Ct(a-this.x,b-this.y)},e.Ry=function(a,b){return $e.El(a.x,a.y,b.x,b.y,this.x,this.y)},e.fA=function(a,b,t,e){return $e.qh(a,b,t,e,this.x,this.y,this),this},e.gA=function(a,b){return $e.qh(a.x,a.y,b.x,b.y,this.x,this.y,this),this},e.uA=function(a,b,t,e){return $e.Mo(this.x,this.y,a,b,t,e,this),this},e.vA=function(a,b){return $e.Mo(this.x,this.y,a.x,a.y,b.width,b.height,this),this},e.xi=function(a,b){return this.x=a.x+b.x*a.width+b.offsetX,this.y=a.y+b.y*a.height+b.offsetY,this},e.yi=function(a,b,t,e,n){return this.x=a+n.x*t+n.offsetX,this.y=b+n.y*e+n.offsetY,this},e.transform=function(a){return a.Ga(this),this},e.w=function(){return isFinite(this.x)&&isFinite(this.y)},St.alloc=function(){var a=Et.pop();return void 0===a?new St:a},St.allocAt=function(a,b){var t=Et.pop();return void 0===t?new St(a,b):(t.x=a,t.y=b,t)},St.free=function(a){Et.push(a)},St.prototype.isReal=St.prototype.w,St.prototype.setSpot=St.prototype.yi,St.prototype.setRectSpot=St.prototype.xi,St.prototype.snapToGridPoint=St.prototype.vA,St.prototype.snapToGrid=St.prototype.uA,St.prototype.projectOntoLineSegmentPoint=St.prototype.gA,St.prototype.projectOntoLineSegment=St.prototype.fA,St.intersectingLineSegments=function(a,b,t,e,n,o,g,r){return $e.Ql(a,b,t,e,n,o,g,r)},St.prototype.compareWithLineSegmentPoint=St.prototype.Ry,St.compareWithLineSegment=function(a,b,t,e,n,o){return $e.El(a,b,t,e,n,o)},St.prototype.direction=St.prototype.direction,St.prototype.directionPoint=St.prototype.ab,St.prototype.normalize=St.prototype.normalize,St.prototype.distanceSquared=St.prototype.zd,St.prototype.distanceSquaredPoint=St.prototype.Bf,St.prototype.scale=St.prototype.scale,St.prototype.rotate=St.prototype.rotate,St.prototype.offset=St.prototype.offset,St.prototype.subtract=St.prototype.re,St.prototype.add=St.prototype.add,St.prototype.equalsApprox=St.prototype.Xa,St.prototype.equalTo=St.prototype.hi,St.prototype.equals=St.prototype.D,St.prototype.set=St.prototype.set,St.prototype.setTo=St.prototype.sg;var Ft,Ot,Bt,Dt,It,zt,Rt,Et=[];function Vt(a,b){void 0===a?this.height=this.width=0:"number"==typeof a&&(0<=a||isNaN(a))&&"number"==typeof b&&(0<=b||isNaN(b))?(this.width=a,this.height=b):T("Invalid arguments to Size constructor: "+a+", "+b),this._isFrozen=!1}function Yt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;return(e=a[b++])&&(n=parseFloat(e)),new Vt(t,n)}return new Vt}function Gt(a){return a.width.toString()+" "+a.height.toString()}St.className="Point",St.parse=Pt,St.stringify=Nt,St.distanceLineSegmentSquared=Lt,St.distanceSquared=At,St.direction=jt,St.Origin=ct=new St(0,0).ja(),St.InfiniteTopLeft=ft=new St(-1/0,-1/0).ja(),St.InfiniteBottomRight=pt=new St(1/0,1/0).ja(),St.SixPoint=gt=new St(6,6).ja(),St.NoPoint=mt=new St(NaN,NaN).ja(),St.parse=Pt,St.stringify=Nt,St.distanceLineSegmentSquared=Lt,St.distanceSquared=At,St.direction=jt,Vt.prototype.assign=function(a){return this.width=a.width,this.height=a.height,this},Vt.prototype.h=function(a,b){return this.width=a,this.height=b,this},Vt.prototype.sg=function(a,b){return this.width=a,this.height=b,this},Vt.prototype.set=function(a){return this.width=a.width,this.height=a.height,this},Vt.prototype.copy=function(){var a=new Vt;return a.width=this.width,a.height=this.height,a},(e=Vt.prototype).ja=function(){return this._isFrozen=!0,Object.freeze(this),this},e.J=function(){return this._isFrozen||Object.isFrozen(this)?this:this.copy().freeze()},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this},e.toString=function(){return"Size("+this.width+","+this.height+")"},e.D=function(a){return a instanceof Vt&&(this.width===a.width&&this.height===a.height)},e.hi=function(a,b){return this.width===a&&this.height===b},e.Xa=function(a){return $e.B(this.width,a.width)&&$e.B(this.height,a.height)},e.Bc=function(a,b){return a=this.width+a,this.width=0<=a?a:0,b=this.height+b,this.height=0<=b?b:0,this},e.w=function(){return isFinite(this.width)&&isFinite(this.height)},Vt.alloc=function(){var a=Xt.pop();return void 0===a?new Vt:a},Vt.free=function(a){Xt.push(a)},Vt.prototype.isReal=Vt.prototype.w,Vt.prototype.inflate=Vt.prototype.Bc,Vt.prototype.equalsApprox=Vt.prototype.Xa,Vt.prototype.equalTo=Vt.prototype.hi,Vt.prototype.equals=Vt.prototype.D,Vt.prototype.set=Vt.prototype.set,Vt.prototype.setTo=Vt.prototype.sg;var Xt=[];function Ut(a,b,t,e){void 0===a?this.height=this.width=this.y=this.x=0:"number"==typeof a&&"number"==typeof b&&"number"==typeof t&&(0<=t||isNaN(t))&&"number"==typeof e&&(0<=e||isNaN(e))?(this.x=a,this.y=b,this.width=t,this.height=e):a instanceof St?(t=a.x,a=a.y,b instanceof St?(e=b.x,b=b.y,this.x=Math.min(t,e),this.y=Math.min(a,b),this.width=Math.abs(t-e),this.height=Math.abs(a-b)):b instanceof Vt?(this.x=t,this.y=a,this.width=b.width,this.height=b.height):T("Incorrect second argument supplied to Rect constructor "+b)):T("Invalid arguments to Rect constructor: "+a+", "+b+", "+t+", "+e),this._isFrozen=!1}function qt(a,b,t){a.width=b,a.height=t}function Kt(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];e&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;(e=a[b++])&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;(e=a[b++])&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),new Ut(t,n,o,g)}return new Ut}function Ht(a){return a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString()}function Wt(a,b){return $e.$(a.x,b.x)&&$e.$(a.y,b.y)&&$e.$(a.width,b.width)&&$e.$(a.height,b.height)}function Jt(a,b,t,e,n){var o=a.width;return t+n<=-o?(a.x+=o/2,a.width=0):(a.x-=n,a.width+=t+n),b+e<=-(t=a.height)?(a.y+=t/2,a.height=0):(a.y-=b,a.height+=b+e),a}function Zt(a,b,t,e,n){var o=Math.max(a.x,b),g=Math.max(a.y,t);return b=Math.min(a.x+a.width,b+e),t=Math.min(a.y+a.height,t+n),a.x=o,a.y=g,a.width=Math.max(0,b-o),a.height=Math.max(0,t-g),a}function _t(a,b){var t=a.width,e=a.x,n=b.x-10;return!(e>b.width+10+10+n||n>t+e)&&(t=a.height,a=a.y,e=b.y-10,!(a>b.height+10+10+e||e>t+a))}function $t(a,b,t,e,n){var o=Math.min(a.x,b),g=Math.min(a.y,t);return b=Math.max(a.x+a.width,b+e),t=Math.max(a.y+a.height,t+n),a.x=o,a.y=g,a.width=b-o,a.height=t-g,a}function Qt(a,b,t,e,n,o,g,r){return void 0===g&&(g=0),void 0===r&&(r=0),a<=n&&n+g<=a+t&&b<=o&&o+r<=b+e}function te(a,b,t,e,n,o,g,r){return!(a>g+n||n>t+a)&&!(b>r+o||o>e+b)}Vt.className="Size",Vt.parse=Yt,Vt.stringify=Gt,Vt.ZeroSize=Ft=new Vt(0,0).ja(),Vt.OneSize=Ot=new Vt(1,1).ja(),Vt.SixSize=Bt=new Vt(6,6).ja(),Vt.EightSize=Dt=new Vt(8,8).ja(),Vt.TenSize=It=new Vt(10,10).ja(),Vt.InfiniteSize=zt=new Vt(1/0,1/0).ja(),Vt.NoSize=Rt=new Vt(NaN,NaN).ja(),Vt.parse=Yt,Vt.stringify=Gt,(e=Ut.prototype).assign=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},e.h=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},e.sg=function(a,b,t,e){return this.x=a,this.y=b,this.width=t,this.height=e,this},e.set=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},e.dd=function(a){return this.x=a.x,this.y=a.y,this},e.tA=function(a){return this.width=a.width,this.height=a.height,this},Ut.prototype.copy=function(){var a=new Ut;return a.x=this.x,a.y=this.y,a.width=this.width,a.height=this.height,a},(e=Ut.prototype).ja=function(){return this._isFrozen=!0,Object.freeze(this),this},e.J=function(){return this._isFrozen||Object.isFrozen(this)?this:this.copy().freeze()},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this},e.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"},e.D=function(a){return a instanceof Ut&&(this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height)},e.hi=function(a,b,t,e){return this.x===a&&this.y===b&&this.width===t&&this.height===e},e.Xa=function(a){return $e.B(this.x,a.x)&&$e.B(this.y,a.y)&&$e.B(this.width,a.width)&&$e.B(this.height,a.height)},e.ca=function(a){return this.x<=a.x&&this.x+this.width>=a.x&&this.y<=a.y&&this.y+this.height>=a.y},e.Re=function(a){return this.x<=a.x&&a.x+a.width<=this.x+this.width&&this.y<=a.y&&a.y+a.height<=this.y+this.height},e.contains=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.x<=a&&a+t<=this.x+this.width&&this.y<=b&&b+e<=this.y+this.height},e.offset=function(a,b){return this.x+=a,this.y+=b,this},e.Bc=function(a,b){return Jt(this,b,a,b,a)},e.Bo=function(a){return Jt(this,a.top,a.right,a.bottom,a.left)},e.Fv=function(a){return Jt(this,-a.top,-a.right,-a.bottom,-a.left)},e.Hz=function(a,b,t,e){return Jt(this,a,b,t,e)},e.Ex=function(a){return Zt(this,a.x,a.y,a.width,a.height)},e.Uu=function(a,b,t,e){return Zt(this,a,b,t,e)},e.Yc=function(a){return this.Vu(a.x,a.y,a.width,a.height)},e.Vu=function(a,b,t,e){var n=this.width,o=this.x;return!(1/0!==n&&1/0!==t&&(n+=o,t+=a,isNaN(t)||isNaN(n)||o>t||a>n))&&(a=this.height,t=this.y,!(1/0!==a&&1/0!==e&&(a+=t,e+=b,isNaN(e)||isNaN(a)||t>e||b>a)))},e.Ye=function(a){return $t(this,a.x,a.y,0,0)},e.ed=function(a){return $t(this,a.x,a.y,a.width,a.height)},e.Kv=function(a,b,t,e){return void 0===t&&(t=0),void 0===e&&(e=0),$t(this,a,b,t,e)},e.yi=function(a,b,t){return this.x=a-t.offsetX-t.x*this.width,this.y=b-t.offsetY-t.y*this.height,this},e.w=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.Mz=function(){return 0===this.width&&0===this.height},Ut.alloc=function(){var a=ne.pop();return void 0===a?new Ut:a},Ut.allocAt=function(a,b,t,e){var n=ne.pop();return void 0===n?new Ut(a,b,t,e):n.h(a,b,t,e)},Ut.free=function(a){ne.push(a)},v.Object.defineProperties(Ut.prototype,{left:{get:function(){return this.x},set:function(a){this.x=a}},top:{get:function(){return this.y},set:function(a){this.y=a}},right:{get:function(){return this.x+this.width},set:function(a){this.x+=a-(this.x+this.width)}},bottom:{get:function(){return this.y+this.height},set:function(a){this.y+=a-(this.y+this.height)}},position:{get:function(){return new St(this.x,this.y)},set:function(a){this.x=a.x,this.y=a.y}},size:{get:function(){return new Vt(this.width,this.height)},set:function(a){this.width=a.width,this.height=a.height}},center:{get:function(){return new St(this.x+this.width/2,this.y+this.height/2)},set:function(a){this.x=a.x-this.width/2,this.y=a.y-this.height/2}},centerX:{get:function(){return this.x+this.width/2},set:function(a){this.x=a-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(a){this.y=a-this.height/2}}}),Ut.prototype.isEmpty=Ut.prototype.Mz,Ut.prototype.isReal=Ut.prototype.w,Ut.intersectsLineSegment=function(a,b,t,e,n,o,g,r){return $e.Fx(a,b,t,e,n,o,g,r)},Ut.prototype.setSpot=Ut.prototype.yi,Ut.prototype.union=Ut.prototype.Kv,Ut.prototype.unionRect=Ut.prototype.ed,Ut.prototype.unionPoint=Ut.prototype.Ye,Ut.prototype.intersects=Ut.prototype.Vu,Ut.prototype.intersectsRect=Ut.prototype.Yc,Ut.prototype.intersect=Ut.prototype.Uu,Ut.prototype.intersectRect=Ut.prototype.Ex,Ut.prototype.grow=Ut.prototype.Hz,Ut.prototype.subtractMargin=Ut.prototype.Fv,Ut.prototype.addMargin=Ut.prototype.Bo,Ut.prototype.inflate=Ut.prototype.Bc,Ut.prototype.offset=Ut.prototype.offset,Ut.prototype.contains=Ut.prototype.contains,Ut.prototype.containsRect=Ut.prototype.Re,Ut.prototype.containsPoint=Ut.prototype.ca,Ut.prototype.equalsApprox=Ut.prototype.Xa,Ut.prototype.equalTo=Ut.prototype.hi,Ut.prototype.equals=Ut.prototype.D,Ut.prototype.setSize=Ut.prototype.tA,Ut.prototype.setPoint=Ut.prototype.dd,Ut.prototype.set=Ut.prototype.set,Ut.prototype.setTo=Ut.prototype.sg;var ee,ie=null,ne=[];function oe(a,b,t,e){void 0===a?this.left=this.bottom=this.right=this.top=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===t?(this.top=a,this.right=b,this.bottom=a,this.left=b):void 0!==e?(this.top=a,this.right=b,this.bottom=t,this.left=e):T("Invalid arguments to Margin constructor: "+a+", "+b+", "+t+", "+e),this._isFrozen=!1}function re(a){if("string"==typeof a){a=a.split(" ");for(var b=0,t=NaN;""===a[b];)b++;var e=a[b++];if(e&&(t=parseFloat(e)),isNaN(t))return new oe;for(var n=NaN;""===a[b];)b++;if((e=a[b++])&&(n=parseFloat(e)),isNaN(n))return new oe(t);for(var o=NaN;""===a[b];)b++;if((e=a[b++])&&(o=parseFloat(e)),isNaN(o))return new oe(t,n);for(var g=NaN;""===a[b];)b++;return(e=a[b++])&&(g=parseFloat(e)),isNaN(g)?new oe(t,n):new oe(t,n,o,g)}return new oe}function se(a){return a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString()}Ut.className="Rect",Ut.parse=Kt,Ut.stringify=Ht,Ut.contains=Qt,Ut.intersects=te,Ut.ZeroRect=ee=new Ut(0,0,0,0).ja(),Ut.NoRect=ie=new Ut(NaN,NaN,NaN,NaN).ja(),Ut.parse=Kt,Ut.stringify=Ht,Ut.contains=Qt,Ut.intersects=te,oe.prototype.assign=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},oe.prototype.sg=function(a,b,t,e){return this.top=a,this.right=b,this.bottom=t,this.left=e,this},oe.prototype.set=function(a){return this.top=a.top,this.right=a.right,this.bottom=a.bottom,this.left=a.left,this},oe.prototype.copy=function(){var a=new oe;return a.top=this.top,a.right=this.right,a.bottom=this.bottom,a.left=this.left,a},(e=oe.prototype).ja=function(){return this._isFrozen=!0,Object.freeze(this),this},e.J=function(){return this._isFrozen||Object.isFrozen(this)?this:this.copy().freeze()},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this},e.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"},e.D=function(a){return a instanceof oe&&(this.top===a.top&&this.right===a.right&&this.bottom===a.bottom&&this.left===a.left)},e.hi=function(a,b,t,e){return this.top===a&&this.right===b&&this.bottom===t&&this.left===e},e.Xa=function(a){return $e.B(this.top,a.top)&&$e.B(this.right,a.right)&&$e.B(this.bottom,a.bottom)&&$e.B(this.left,a.left)},e.w=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)},oe.alloc=function(){var a=Ue.pop();return void 0===a?new oe:a},oe.free=function(a){Ue.push(a)},oe.prototype.isReal=oe.prototype.w,oe.prototype.equalsApprox=oe.prototype.Xa,oe.prototype.equalTo=oe.prototype.hi,oe.prototype.equals=oe.prototype.D,oe.prototype.set=oe.prototype.set,oe.prototype.setTo=oe.prototype.sg;var ae,he,le,ue,ce,fe,de,pe,ge,me,ye,ve,xe,be,we,ke,Me,Se,Pe,Ne,Ce,Te,Le,Ae,je,Fe,Oe,Be,De,Ie,ze,Re,Ee,Ve,dd,Ye,Ge=null,Xe=null,Ue=[];function qe(a,b,t,e){void 0===a?this.offsetY=this.offsetX=this.y=this.x=0:(void 0===b&&(b=0),void 0===t&&(t=0),void 0===e&&(e=0),this.x=a,this.y=b,this.offsetX=t,this.offsetY=e),this._isFrozen=!1}function Ke(a,b){return a.x=NaN,a.y=NaN,a.offsetX=b,a}function He(a){if("string"==typeof a){if("None"===(a=a.trim()))return ae;if("TopLeft"===a)return he;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return le;if("TopRight"===a)return ue;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return ce;if("Center"===a)return fe;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return de;if("BottomLeft"===a)return pe;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return ge;if("BottomRight"===a)return me;if("TopSide"===a)return ye;if("LeftSide"===a)return ve;if("RightSide"===a)return xe;if("BottomSide"===a)return be;if("TopBottomSides"===a)return we;if("LeftRightSides"===a)return ke;if("TopLeftSides"===a)return Me;if("TopRightSides"===a)return Se;if("BottomLeftSides"===a)return Pe;if("BottomRightSides"===a)return Ne;if("NotTopSide"===a)return Ce;if("NotLeftSide"===a)return Te;if("NotRightSide"===a)return Le;if("NotBottomSide"===a)return Ae;if("AllSides"===a)return je;if("Default"===a)return Fe;a=a.split(" ");for(var b=0,t=0;""===a[b];)b++;var e=a[b++];void 0!==e&&0<e.length&&(t=parseFloat(e));for(var n=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(n=parseFloat(e));for(var o=0;""===a[b];)b++;void 0!==(e=a[b++])&&0<e.length&&(o=parseFloat(e));for(var g=0;""===a[b];)b++;return void 0!==(e=a[b++])&&0<e.length&&(g=parseFloat(e)),new qe(t,n,o,g)}return new qe}function We(a){return a.sb()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString()}oe.className="Margin",oe.parse=re,oe.stringify=se,oe.ZeroMargin=Ge=new oe(0,0,0,0).ja(),oe.TwoMargin=Xe=new oe(2,2,2,2).ja(),oe.parse=re,oe.stringify=se,qe.prototype.assign=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},qe.prototype.sg=function(a,b,t,e){return this.x=a,this.y=b,this.offsetX=t,this.offsetY=e,this},qe.prototype.set=function(a){return this.x=a.x,this.y=a.y,this.offsetX=a.offsetX,this.offsetY=a.offsetY,this},qe.prototype.copy=function(){var a=new qe;return a.x=this.x,a.y=this.y,a.offsetX=this.offsetX,a.offsetY=this.offsetY,a},(e=qe.prototype).ja=function(){return this._isFrozen=!0,Object.freeze(this),this},e.J=function(){return this._isFrozen||Object.isFrozen(this)?this:this.copy().freeze()},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this},e.toString=function(){return this.sb()?0===this.offsetX&&0===this.offsetY?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.D(ae)?"None":this.D(he)?"TopLeft":this.D(le)?"Top":this.D(ue)?"TopRight":this.D(ce)?"Left":this.D(fe)?"Center":this.D(de)?"Right":this.D(pe)?"BottomLeft":this.D(ge)?"Bottom":this.D(me)?"BottomRight":this.D(ye)?"TopSide":this.D(ve)?"LeftSide":this.D(xe)?"RightSide":this.D(be)?"BottomSide":this.D(we)?"TopBottomSides":this.D(ke)?"LeftRightSides":this.D(Me)?"TopLeftSides":this.D(Se)?"TopRightSides":this.D(Pe)?"BottomLeftSides":this.D(Ne)?"BottomRightSides":this.D(Ce)?"NotTopSide":this.D(Te)?"NotLeftSide":this.D(Le)?"NotRightSide":this.D(Ae)?"NotBottomSide":this.D(je)?"AllSides":this.D(Fe)?"Default":"None"},e.D=function(a){return a instanceof qe&&((this.x===a.x||isNaN(this.x)&&isNaN(a.x))&&(this.y===a.y||isNaN(this.y)&&isNaN(a.y))&&this.offsetX===a.offsetX&&this.offsetY===a.offsetY)},e.gv=function(){return new qe(.5-(this.x-.5),.5-(this.y-.5),-this.offsetX,-this.offsetY)},e.Hf=function(a){if(!this.$c())return!1;if(!a.$c())if(a.D(Oe))a=ve;else if(a.D(Be))a=xe;else if(a.D(De))a=ye;else{if(!a.D(Ie))return!1;a=be}return a=a.offsetY,(this.offsetY&a)===a},e.sb=function(){return!isNaN(this.x)&&!isNaN(this.y)},e.Mc=function(){return isNaN(this.x)||isNaN(this.y)},e.$c=function(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY},e.xs=function(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY},e.Yb=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY},qe.alloc=function(){var a=Je.pop();return void 0===a?new qe:a},qe.free=function(a){Je.push(a)},qe.prototype.isDefault=qe.prototype.Yb,qe.prototype.isNone=qe.prototype.xs,qe.prototype.isSide=qe.prototype.$c,qe.prototype.isNoSpot=qe.prototype.Mc,qe.prototype.isSpot=qe.prototype.sb,qe.prototype.includesSide=qe.prototype.Hf,qe.prototype.opposite=qe.prototype.gv,qe.prototype.equals=qe.prototype.D,qe.prototype.set=qe.prototype.set,qe.prototype.setTo=qe.prototype.sg;var Je=[];function Ze(){this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0}qe.className="Spot",qe.parse=He,qe.stringify=We,qe.None=ae=Ke(new qe(0,0,0,0),0).ja(),qe.Default=Fe=Ke(new qe(0,0,-1,0),-1).ja(),qe.TopLeft=he=new qe(0,0,0,0).ja(),qe.TopCenter=le=new qe(.5,0,0,0).ja(),qe.TopRight=ue=new qe(1,0,0,0).ja(),qe.LeftCenter=ce=new qe(0,.5,0,0).ja(),qe.Center=fe=new qe(.5,.5,0,0).ja(),qe.RightCenter=de=new qe(1,.5,0,0).ja(),qe.BottomLeft=pe=new qe(0,1,0,0).ja(),qe.BottomCenter=ge=new qe(.5,1,0,0).ja(),qe.BottomRight=me=new qe(1,1,0,0).ja(),qe.MiddleTop=ze=le,qe.MiddleLeft=Re=ce,qe.MiddleRight=Ee=de,qe.MiddleBottom=Ve=ge,qe.Top=De=le,qe.Left=Oe=ce,qe.Right=Be=de,qe.Bottom=Ie=ge,qe.TopSide=ye=Ke(new qe(0,0,1,1),1).ja(),qe.LeftSide=ve=Ke(new qe(0,0,1,2),1).ja(),qe.RightSide=xe=Ke(new qe(0,0,1,4),1).ja(),qe.BottomSide=be=Ke(new qe(0,0,1,8),1).ja(),qe.TopBottomSides=we=Ke(new qe(0,0,1,9),1).ja(),qe.LeftRightSides=ke=Ke(new qe(0,0,1,6),1).ja(),qe.TopLeftSides=Me=Ke(new qe(0,0,1,3),1).ja(),qe.TopRightSides=Se=Ke(new qe(0,0,1,5),1).ja(),qe.BottomLeftSides=Pe=Ke(new qe(0,0,1,10),1).ja(),qe.BottomRightSides=Ne=Ke(new qe(0,0,1,12),1).ja(),qe.NotTopSide=Ce=Ke(new qe(0,0,1,14),1).ja(),qe.NotLeftSide=Te=Ke(new qe(0,0,1,13),1).ja(),qe.NotRightSide=Le=Ke(new qe(0,0,1,11),1).ja(),qe.NotBottomSide=Ae=Ke(new qe(0,0,1,7),1).ja(),qe.AllSides=je=Ke(new qe(0,0,1,15),1).ja(),dd=new qe(.156,.156).ja(),Ye=new qe(.844,.844).ja(),qe.parse=He,qe.stringify=We,Ze.prototype.set=function(a){return this.m11=a.m11,this.m12=a.m12,this.m21=a.m21,this.m22=a.m22,this.dx=a.dx,this.dy=a.dy,this},Ze.prototype.setTransform=function(a,b,t,e,n,o){return this.m11=a,this.m12=b,this.m21=t,this.m22=e,this.dx=n,this.dy=o,this},Ze.prototype.copy=function(){var a=new Ze;return a.m11=this.m11,a.m12=this.m12,a.m21=this.m21,a.m22=this.m22,a.dx=this.dx,a.dy=this.dy,a},Ze.prototype.toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"},Ze.prototype.D=function(a){return this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy},Ze.prototype.vs=function(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22},Ze.prototype.reset=function(){return this.m11=1,this.m21=this.m12=0,this.m22=1,this.dy=this.dx=0,this},Ze.prototype.multiply=function(a){var b=this.m11*a.m11+this.m21*a.m12,t=this.m12*a.m11+this.m22*a.m12,e=this.m11*a.m21+this.m21*a.m22,n=this.m12*a.m21+this.m22*a.m22;return this.dx=this.m11*a.dx+this.m21*a.dy+this.dx,this.dy=this.m12*a.dx+this.m22*a.dy+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},Ze.prototype.bv=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),t=a.m22*b,e=-a.m12*b,n=-a.m21*b,o=a.m11*b,g=b*(a.m21*a.dy-a.m22*a.dx);return a=b*(a.m12*a.dx-a.m11*a.dy),b=this.m11*t+this.m21*e,t=this.m12*t+this.m22*e,e=this.m11*n+this.m21*o,n=this.m12*n+this.m22*o,this.dx=this.m11*g+this.m21*a+this.dx,this.dy=this.m12*g+this.m22*a+this.dy,this.m11=b,this.m12=t,this.m21=e,this.m22=n,this},Ze.prototype.Uj=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,t=-this.m21*a,e=this.m11*a,n=a*(this.m21*this.dy-this.m22*this.dx),o=a*(this.m12*this.dx-this.m11*this.dy);return this.m11=this.m22*a,this.m12=b,this.m21=t,this.m22=e,this.dx=n,this.dy=o,this},Ze.prototype.rotate=function(a,b,t){if(360<=a?a-=360:0>a&&(a+=360),0===a)return this;if(this.translate(b,t),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));var n=this.m12*a+this.m22*e,o=this.m11*-e+this.m21*a,g=this.m12*-e+this.m22*a;return this.m11=this.m11*a+this.m21*e,this.m12=n,this.m21=o,this.m22=g,this.translate(-b,-t),this},(e=Ze.prototype).translate=function(a,b){return this.dx+=this.m11*a+this.m21*b,this.dy+=this.m12*a+this.m22*b,this},e.scale=function(a,b){return void 0===b&&(b=a),this.m11*=a,this.m12*=a,this.m21*=b,this.m22*=b,this},e.Ga=function(a){var b=a.x,t=a.y;return a.h(b*this.m11+t*this.m21+this.dx,b*this.m12+t*this.m22+this.dy)},e.Cd=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),t=a.x,e=a.y;return a.h(t*this.m22*b+e*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx),t*-this.m12*b+e*this.m11*b+b*(this.m12*this.dx-this.m11*this.dy))},e.Eu=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),t=1.25*a.x,e=1.2*a.y;return a.h(t*this.m22*b+e*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx),t*-this.m12*b+e*this.m11*b+b*(this.m12*this.dx-this.m11*this.dy))},e.op=function(a){var b=a.x,t=a.y,e=b+a.width,n=t+a.height,o=this.m11,g=this.m12,r=this.m21,h=this.m22,l=this.dx,c=this.dy,f=b*o+t*r+l,p=b*g+t*h+c,q=e*o+t*r+l,d=e*g+t*h+c;return t=b*o+n*r+l,b=b*g+n*h+c,o=e*o+n*r+l,e=e*g+n*h+c,n=Math.min(f,q),f=Math.max(f,q),q=Math.min(p,d),p=Math.max(p,d),n=Math.min(n,t),f=Math.max(f,t),q=Math.min(q,b),p=Math.max(p,b),n=Math.min(n,o),f=Math.max(f,o),q=Math.min(q,e),p=Math.max(p,e),a.h(n,q,f-n,p-q),a},Ze.alloc=function(){var a=_e.pop();return void 0===a?new Ze:a},Ze.free=function(a){_e.push(a)},Ze.prototype.transformRect=Ze.prototype.op,Ze.prototype.transformPoint=Ze.prototype.Ga,Ze.prototype.scale=Ze.prototype.scale,Ze.prototype.translate=Ze.prototype.translate,Ze.prototype.rotate=Ze.prototype.rotate,Ze.prototype.invert=Ze.prototype.Uj,Ze.prototype.multiplyInverted=Ze.prototype.bv,Ze.prototype.multiply=Ze.prototype.multiply,Ze.prototype.reset=Ze.prototype.reset,Ze.prototype.isIdentity=Ze.prototype.vs,Ze.prototype.equals=Ze.prototype.D,Ze.prototype.setTransform=Ze.prototype.setTransform,Ze.prototype.set=Ze.prototype.set;var _e=[];Ze.className="Transform",Ze.xF="54a702f3e53909c447824c6706603faf4c";var $e={AA:"7da71ca0ad381e90",wg:(Math.sqrt(2)-1)/3*4,Uv:null,sqrt:function(a){if(0>=a)return 0;var b=$e.Uv;if(null===b){b=[];for(var t=0;2e3>=t;t++)b[t]=Math.sqrt(t);$e.Uv=b}return 1>a?2e3>=(t=1/a)?1/b[0|t]:Math.sqrt(a):2e3>=a?b[0|a]:Math.sqrt(a)},B:function(a,b){return.5>(a-=b)&&-.5<a},$:function(a,b){return 5e-8>(a-=b)&&-5e-8<a},Zb:function(a,b,t,e,n,o,g){if(0>=n&&(n=1e-6),a<t)var r=a,h=t;else r=t,h=a;if(b<e)var l=b,c=e;else l=e,c=b;if(a===t)return l<=g&&g<=c&&a-n<=o&&o<=a+n;if(b===e)return r<=o&&o<=h&&b-n<=g&&g<=b+n;if(h+=n,(r-=n)<=o&&o<=h&&(c+=n,(l-=n)<=g&&g<=c))if(h-r>c-l){if(!(a-t>n||t-a>n))return!0;if((o=(e-b)/(t-a)*(o-a)+b)-n<=g&&g<=o+n)return!0}else{if(!(b-e>n||e-b>n))return!0;if((g=(t-a)/(e-b)*(g-b)+a)-n<=o&&o<=g+n)return!0}return!1},bs:function(a,b,t,e,n,o,g,r,h,l,c,f){if($e.Zb(a,b,g,r,f,t,e)&&$e.Zb(a,b,g,r,f,n,o))return $e.Zb(a,b,g,r,f,l,c);var p=(a+t)/2,q=(b+e)/2,d=(t+n)/2,u=(e+o)/2,m=((e=(p+d)/2)+(d=(d+(n=(n+g)/2))/2))/2,y=((t=(q+u)/2)+(u=(u+(o=(o+r)/2))/2))/2;return $e.bs(a,b,p,q,e,t,m,y,h,l,c,f)||$e.bs(m,y,d,u,n,o,g,r,h,l,c,f)},ax:function(a,b,t,e,n,o,g,r,h){var l=(t+n)/2,c=(e+o)/2;return h.h((((a+t)/2+l)/2+(l+(n+g)/2)/2)/2,(((b+e)/2+c)/2+(c+(o+r)/2)/2)/2),h},My:function(a,b,t,e,n,o,g,r){var h=(t+n)/2,l=(e+o)/2;return jt(((a+t)/2+h)/2,((b+e)/2+l)/2,(h+(n+g)/2)/2,(l+(o+r)/2)/2)},Cl:function(a,b,t,e,n,o,g,r,h,l){if($e.Zb(a,b,g,r,h,t,e)&&$e.Zb(a,b,g,r,h,n,o))$t(l,a,b,0,0),$t(l,g,r,0,0);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,q=(e+o)/2,d=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+q)/2)+(q=(q+(o=(o+r)/2))/2))/2;$e.Cl(a,b,c,f,e,t,d,u,h,l),$e.Cl(d,u,p,q,n,o,g,r,h,l)}return l},Qe:function(a,b,t,e,n,o,g,r,h,l){if($e.Zb(a,b,g,r,h,t,e)&&$e.Zb(a,b,g,r,h,n,o))0===l.length&&(l.push(a),l.push(b)),l.push(g),l.push(r);else{var c=(a+t)/2,f=(b+e)/2,p=(t+n)/2,q=(e+o)/2,d=((e=(c+p)/2)+(p=(p+(n=(n+g)/2))/2))/2,u=((t=(f+q)/2)+(q=(q+(o=(o+r)/2))/2))/2;$e.Qe(a,b,c,f,e,t,d,u,h,l),$e.Qe(d,u,p,q,n,o,g,r,h,l)}return l},jv:function(a,b,t,e,n,o,g,r,h,l){if($e.Zb(a,b,n,o,l,t,e))return $e.Zb(a,b,n,o,l,r,h);var c=(a+t)/2,f=(b+e)/2,p=(c+(t=(t+n)/2))/2,q=(f+(e=(e+o)/2))/2;return $e.jv(a,b,c,f,p,q,g,r,h,l)||$e.jv(p,q,t,e,n,o,g,r,h,l)},OA:function(a,b,t,e,n,o,g){return g.h(((a+t)/2+(t+n)/2)/2,((b+e)/2+(e+o)/2)/2),g},iv:function(a,b,t,e,n,o,g,r){if($e.Zb(a,b,n,o,g,t,e))$t(r,a,b,0,0),$t(r,n,o,0,0);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;$e.iv(a,b,h,l,c,f,g,r),$e.iv(c,f,t,e,n,o,g,r)}return r},cp:function(a,b,t,e,n,o,g,r){if($e.Zb(a,b,n,o,g,t,e))0===r.length&&(r.push(a),r.push(b)),r.push(n),r.push(o);else{var h=(a+t)/2,l=(b+e)/2,c=(h+(t=(t+n)/2))/2,f=(l+(e=(e+o)/2))/2;$e.cp(a,b,h,l,c,f,g,r),$e.cp(c,f,t,e,n,o,g,r)}return r},Do:function(a,b,t,e,n,o,g,r,h,l,c,f,p,q){if($e.Zb(a,b,g,r,p,t,e)&&$e.Zb(a,b,g,r,p,n,o))return!!$e.Ql(a,b,g,r,h,l,c,f)&&(0!=(p=(a-g)*(l-f)-(b-r)*(h-c))&&(q.h(((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/p,((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/p),!0));var d=(a+t)/2,u=(b+e)/2,m=(t+n)/2,y=(e+o)/2,v=((e=(d+m)/2)+(m=(m+(n=(n+g)/2))/2))/2,x=((t=(u+y)/2)+(y=(y+(o=(o+r)/2))/2))/2,w=1/0,k=!1,M=0,S=0;return $e.Do(a,b,d,u,e,t,v,x,h,l,c,f,p,q)&&((a=(q.x-h)*(q.x-h)+(q.y-l)*(q.y-l))<w&&(w=a,k=!0,M=q.x,S=q.y)),$e.Do(v,x,m,y,n,o,g,r,h,l,c,f,p,q)&&(q.x-h)*(q.x-h)+(q.y-l)*(q.y-l)<w&&(k=!0,M=q.x,S=q.y),k&&(q.x=M,q.y=S),k},Eo:function(a,b,t,e,n,o,g,r,h,l,c,f,p){var q=0;if($e.Zb(a,b,g,r,p,t,e)&&$e.Zb(a,b,g,r,p,n,o)){if(0===(p=(a-g)*(l-f)-(b-r)*(h-c)))return q;var d=((a*r-b*g)*(h-c)-(a-g)*(h*f-l*c))/p,u=((a*r-b*g)*(l-f)-(b-r)*(h*f-l*c))/p;if(d>=c)return q;if((h>c?h-c:c-h)<(l>f?l-f:f-l)){if(b<r?(h=b,a=r):(h=r,a=b),u<h||u>a)return q}else if(a<g?(h=a,a=g):h=g,d<h||d>a)return q;0<p?q++:0>p&&q--}else{u=(b+e)/2;var m=(t+n)/2,y=(e+o)/2,v=((e=((d=(a+t)/2)+m)/2)+(m=(m+(n=(n+g)/2))/2))/2,x=((t=(u+y)/2)+(y=(y+(o=(o+r)/2))/2))/2;q+=$e.Eo(a,b,d,u,e,t,v,x,h,l,c,f,p),q+=$e.Eo(v,x,m,y,n,o,g,r,h,l,c,f,p)}return q},qh:function(a,b,t,e,n,o,g){return $e.$(a,t)?(b<e?(t=b,b=e):t=e,o<t?(g.h(a,t),!1):o>b?(g.h(a,b),!1):(g.h(a,o),!0)):$e.$(b,e)?(a<t?(e=a,a=t):e=t,n<e?(g.h(e,b),!1):n>a?(g.h(a,b),!1):(g.h(n,b),!0)):-5e-6>(n=((a-n)*(a-t)+(b-o)*(b-e))/((t-a)*(t-a)+(e-b)*(e-b)))?(g.h(a,b),!1):1.000005<n?(g.h(t,e),!1):(g.h(a+n*(t-a),b+n*(e-b)),!0)},Ve:function(a,b,t,e,n,o,g,r,h){return $e.B(a,t)&&$e.B(b,e)?(h.h(a,b),!1):$e.$(n,g)?$e.$(a,t)?($e.qh(a,b,t,e,n,o,h),!1):$e.qh(a,b,t,e,n,(e-b)/(t-a)*(n-a)+b,h):(r=(r-o)/(g-n),$e.$(a,t)?(t=r*(a-n)+o,b<e?(n=b,b=e):n=e,t<n?(h.h(a,n),!1):t>b?(h.h(a,b),!1):(h.h(a,t),!0)):(g=(e-b)/(t-a),$e.$(r,g)?($e.qh(a,b,t,e,n,o,h),!1):(n=(g*a-r*n+o-b)/(g-r),$e.$(g,0)?(a<t?(e=a,a=t):e=t,n<e?(h.h(e,b),!1):n>a?(h.h(a,b),!1):(h.h(n,b),!0)):$e.qh(a,b,t,e,n,g*(n-a)+b,h))))},MA:function(a,b,t,e,n){return $e.Ve(t.x,t.y,e.x,e.y,a.x,a.y,b.x,b.y,n)},KA:function(a,b,t,e,n,o,g,r,h,l){function c(t,e){var n=(t-a)*(t-a)+(e-b)*(e-b);n<f&&(f=n,h.h(t,e))}var f=1/0;c(h.x,h.y);var p=0,q=0,d=0,u=0;if(n<g?(p=n,q=g):(p=g,q=n),o<r?(d=n,u=g):(d=g,u=n),p=(q-p)/2+l,l=(u-d)/2+l,n=(n+g)/2,o=(o+r)/2,0===p||0===l)return h;if(.5>(t>a?t-a:a-t)){if(0>(p=1-(t-n)*(t-n)/(p*p)))return h;e=-l*(p=Math.sqrt(p))+o,c(t,l*p+o),c(t,e)}else{if(0>(p=(r=2*(t=(e-b)/(t-a))*(b-t*a)/(l*l)-2*t*o/(l*l)-2*n/(p*p))*r-4*(e=1/(p*p)+t*t/(l*l))*(2*t*a*o/(l*l)-2*b*o/(l*l)+o*o/(l*l)+n*n/(p*p)-1+(b-t*a)*(b-t*a)/(l*l))))return h;c(l=(-r+(p=Math.sqrt(p)))/(2*e),t*l-t*a+b),c(p=(-r-p)/(2*e),t*p-t*a+b)}return h},Ff:function(a,b,t,e,n,o,g,r,h){var l=1e21,c=a,f=b;if($e.Ve(a,b,a,e,n,o,g,r,h)){var p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o);p<l&&(l=p,c=h.x,f=h.y)}return $e.Ve(t,b,t,e,n,o,g,r,h)&&((p=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=p,c=h.x,f=h.y)),$e.Ve(a,b,t,b,n,o,g,r,h)&&((b=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=b,c=h.x,f=h.y)),$e.Ve(a,e,t,e,n,o,g,r,h)&&((a=(h.x-n)*(h.x-n)+(h.y-o)*(h.y-o))<l&&(l=a,c=h.x,f=h.y)),h.h(c,f),1e21>l},ts:function(a,b,t){return $e.Fx(a.x,a.y,a.width,a.height,b.x,b.y,t.x,t.y)},Fx:function(a,b,t,e,n,o,g,r){var h=a+t,l=b+e;return n===g?(o<r?(g=o,o=r):g=r,a<=n&&n<=h&&g<=l&&o>=b):o===r?(n<g?(r=n,n=g):r=g,b<=o&&o<=l&&r<=h&&n>=a):!!(Qt(a,b,t,e,n,o)||Qt(a,b,t,e,g,r)||$e.Ql(a,b,h,b,n,o,g,r)||$e.Ql(h,b,h,l,n,o,g,r)||$e.Ql(h,l,a,l,n,o,g,r)||$e.Ql(a,l,a,b,n,o,g,r))},Ql:function(a,b,t,e,n,o,g,r){return a===t&&b===e&&n===g&&o===r?a===n&&b===o:0>=$e.El(a,b,t,e,n,o)*$e.El(a,b,t,e,g,r)&&0>=$e.El(n,o,g,r,a,b)*$e.El(n,o,g,r,t,e)},El:function(a,b,t,e,n,o){return t-=a,0===(o=(a=n-a)*(e-=b)-(b=o-b)*t)&&(0<(o=a*t+b*e)&&(0>(o=(a-t)*t+(b-e)*e)&&(o=0))),o},ap:function(a){return 0>a&&(a+=360),360<=a&&(a-=360),a},jx:function(a,b,t,e,n,o){var g=Math.PI;o||(e*=g/180,n*=g/180);var r=e>n?-1:1;o=[];var h=g/2,l=e;if(1e-5>(e=Math.min(2*g,Math.abs(n-e))))return h=l+r*Math.min(e,h),r=a+t*Math.cos(l),l=b+t*Math.sin(l),a+=t*Math.cos(h),b+=t*Math.sin(h),t=(r+a)/2,h=(l+b)/2,o.push([r,l,t,h,t,h,a,b]),o;for(;1e-5<e;)n=l+r*Math.min(e,h),o.push($e.Vy(t,l,n,a,b)),e-=Math.abs(n-l),l=n;return o},Vy:function(a,b,t,e,n){var o=(t-b)/2,g=a*Math.cos(o),r=a*Math.sin(o),h=-r,l=g*g+h*h,c=l+g*g+h*r;return r=g-(l=4/3*(Math.sqrt(2*l*c)-c)/(g*r-h*g))*h,h=-(g=h+l*g),l=o+b,o=Math.cos(l),l=Math.sin(l),[e+a*Math.cos(b),n+a*Math.sin(b),e+r*o-g*l,n+r*l+g*o,e+r*o-h*l,n+r*l+h*o,e+a*Math.cos(t),n+a*Math.sin(t)]},Mo:function(a,b,t,e,n,o,g){var r=t=Math.floor((a-t)/n)*n+t;return t+n-a<n/2&&(r=t+n),a=e=Math.floor((b-e)/o)*o+e,e+o-b<o/2&&(a=e+o),g.h(r,a),g},vx:function(a,b){var t,e=Math.max(a,b);a=Math.min(a,b);do{b=e%a,e=t=a,a=b}while(0<b);return t},$y:function(a,b,t,e){var n=0>t,o=0>e;if(a<b)var g=1,r=0;else g=0,r=1;var h=0===g?a:b,l=0===g?t:e;return(0===g?n:o)&&(l=-l),t=0===(g=r)?t:e,(0===g?n:o)&&(t=-t),$e.az(h,0===g?a:b,l,t,0,0)},az:function(a,b,t,e,n,o){if(0<e)if(0<t){n=a*a,a*=t;var g=b*e,r=-(o=b*b)+g,h=-o+Math.sqrt(a*a+g*g);b=r;for(var l=0;9999999999>l&&((b=.5*(r+h))!==r&&b!==h);++l){var c=a/(b+n),f=g/(b+o);if(0<(c=c*c+f*f-1))r=b;else{if(!(0>c))break;h=b}}t=n*t/(b+n)-t,e=o*e/(b+o)-e,t=Math.sqrt(t*t+e*e)}else t=Math.abs(e-b);else(o=a*t)<(e=a*a-b*b)?(e=o/e,o=b*Math.sqrt(Math.abs(1-e*e)),t=a*e-t,t=Math.sqrt(t*t+o*o)):t=Math.abs(t-a);return t},Ze:new _,tm:new _,Mf:new _,Nf:0,um:100};function Qe(a){ht(this),this.l=2,void 0===a&&(a=Qe.o),this.na=a,this.Ec=this.Dc=this.pd=this.od=0,a===Qe.o?this.ee=new ot:(null===Qe.V&&(Qe.V=(new ot).freeze()),this.ee=Qe.V),this.$p=this.ee.Ja,this.Hp=(new Ut).freeze(),this.xm=this.sk=null,this.ym=NaN,this.fg=he,this.gg=me,this.Qk=this.Rk=NaN,this.Uf=Ms}function ti(a,b){return a.type===Qe.j&&b.type===Qe.o&&!!(1===b.figures.count&&(b=b.figures.M(0),1===b.segments.count&&$e.B(a.startX,b.startX)&&$e.B(a.startY,b.startY)&&(b=b.segments.M(0),b.type===di&&$e.B(a.endX,b.endX)&&$e.B(a.endY,b.endY))))}function ei(a,b,t){switch(a.type){case Qe.j:case Qe.u:case Qe.F:t?b.h(a.od,a.pd,0,0):$t(b,a.od,a.pd,0,0),$t(b,a.Dc,a.Ec,0,0);break;case Qe.o:var e=a.figures;a=e.s,e=e.length;for(var n=0;n<e;n++){var o=a[n];t&&0===n?b.h(o.startX,o.startY,0,0):$t(b,o.startX,o.startY,0,0);for(var g=o.segments.s,r=g.length,h=o.startX,l=o.startY,c=0;c<r;c++){var f=g[c];switch(f.type){case di:case fi:$t(b,h=f.endX,l=f.endY,0,0);break;case pi:$e.Cl(h,l,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case gi:$e.iv(h,l,f.point1X,f.point1Y,f.endX,f.endY,.5,b),h=f.endX,l=f.endY;break;case mi:case yi:var p=f.type===mi?ui(f,o):ci(f,o,h,l),q=p.length;if(0===q){$t(b,h=f.type===mi?f.centerX:f.endX,l=f.type===mi?f.centerY:f.endY,0,0);break}f=null;for(var d=0;d<q;d++)f=p[d],$e.Cl(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.5,b);null!==f&&(h=f[6],l=f[7]);break;default:T("Unknown Segment type: "+f.type)}}}break;default:T("Unknown Geometry type: "+a.type)}}function ii(a,b,t,e,n){var o=b.x;b=b.y;for(var r,h,l,c,g=a.bounds.x-20,f=0,p=a.figures.s,q=p.length,d=0;d<q;d++){var u=p[d],m=!u.isEvenOdd;if(u.isFilled){if(e&&u.ca(o,b,t))return!0;for(var y=u.segments,v=r=u.startX,x=h=u.startY,w=y.s,k=0;k<=y.length;k++){var M=void 0;if(k!==y.length){var S=(M=w[k]).type;a=M.endX,c=M.endY}else S=di,a=v,c=x;switch(S){case fi:if(v=ni(o,b,g,b,r,h,v,x),isNaN(v))return!0;f+=v,v=a,x=c;break;case di:if(r=ni(o,b,g,b,r,h,a,c),isNaN(r))return!0;f+=r;break;case pi:f+=l=$e.Eo(r,h,M.point1X,M.point1Y,M.point2X,M.point2Y,a,c,g,b,o,b,.5);break;case gi:f+=l=$e.Eo(r,h,(r+2*M.point1X)/3,(h+2*M.point1Y)/3,(2*M.point1X+a)/3,(2*M.point1Y+c)/3,a,c,g,b,o,b,.5);break;case mi:case yi:var P=(S=M.type===mi?ui(M,u):ci(M,u,r,h)).length;if(0===P){if(r=ni(o,b,g,b,r,h,M.type===mi?M.centerX:M.endX,M.type===mi?M.centerY:M.endY),isNaN(r))return!0;f+=r;break}M=null;for(var N=0;N<P;N++){if(M=S[N],0===N){if(l=ni(o,b,g,b,r,h,M[0],M[1]),isNaN(l))return!0;f+=l}f+=l=$e.Eo(M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],g,b,o,b,.5)}null!==M&&(a=M[6],c=M[7]);break;default:T("Unknown Segment type: "+M.type)}r=a,h=c}if(m){if(0!==f)return!0}else if(0!=f%2)return!0;f=0}else if(u.ca(o,b,n?t:t+2))return!0}return!1}function ni(a,b,t,e,n,o,g,r){if($e.Zb(n,o,g,r,.05,a,b))return NaN;var h=(a-t)*(o-r);if(0===h)return 0;var l=((a*e-b*t)*(n-g)-(a-t)*(n*r-o*g))/h;if(b=(a*e-b*t)*(o-r)/h,l>=a)return 0;if((n>g?n-g:g-n)<(o>r?o-r:r-o)){if(o<r){if(b<o||b>r)return 0}else if(b<r||b>o)return 0}else if(n<g){if(l<n||l>g)return 0}else if(l<g||l>n)return 0;return 0<h?1:-1}function oi(a,b,t,e){for(var n=(a=a.figures.s).length,o=0;o<n;o++)if(a[o].ca(b,t,e))return!0;return!1}function ri(a){if(null===a.sk){var b=a.sk=[],t=a.xm=[],e=[],n=[];if(a.type===Qe.j)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.endY),b.push(e),n.push(Math.sqrt((a.startX-a.endX)*(a.startX-a.endX)+(a.startY-a.endY)*(a.startY-a.endY))),t.push(n);else if(a.type===Qe.u)e.push(a.startX),e.push(a.startY),e.push(a.endX),e.push(a.startY),e.push(a.endX),e.push(a.endY),e.push(a.startX),e.push(a.endY),e.push(a.startX),e.push(a.startY),b.push(e),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),n.push(Math.abs(a.startX-a.endX)),n.push(Math.abs(a.startY-a.endY)),t.push(n);else if(a.type===Qe.F){var o=new ai;o.startX=a.endX,o.startY=(a.startY+a.endY)/2;var g=new hi(mi);if(g.startAngle=0,g.sweepAngle=360,g.centerX=(a.startX+a.endX)/2,g.centerY=(a.startY+a.endY)/2,g.radiusX=Math.abs(a.startX-a.endX)/2,g.radiusY=Math.abs(a.startY-a.endY)/2,o.add(g),0===(n=(a=ui(g,o)).length))e.push(g.centerX),e.push(g.centerY);else{g=o.startX,o=o.startY;for(var r=0;r<n;r++){var h=a[r];$e.Qe(g,o,h[2],h[3],h[4],h[5],h[6],h[7],.5,e),g=h[6],o=h[7]}}b.push(e),t.push(si(e))}else for(a=a.figures.iterator;a.next();){n=a.value,(e=[]).push(n.startX),e.push(n.startY),r=g=n.startX,h=o=n.startY;for(var l=n.segments.s,c=l.length,f=0;f<c;f++){var p=l[f];switch(p.type){case fi:4<=e.length&&(b.push(e),t.push(si(e))),(e=[]).push(p.endX),e.push(p.endY),r=g=p.endX,h=o=p.endY;break;case di:e.push(p.endX),e.push(p.endY),g=p.endX,o=p.endY;break;case pi:$e.Qe(g,o,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case gi:$e.cp(g,o,p.point1X,p.point1Y,p.endX,p.endY,.5,e),g=p.endX,o=p.endY;break;case mi:var q=ui(p,n),d=q.length;if(0===d){e.push(p.centerX),e.push(p.centerY),g=p.centerX,o=p.centerY;break}for(var u=0;u<d;u++){var m=q[u];$e.Qe(g,o,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),g=m[6],o=m[7]}break;case yi:if(d=(q=ci(p,n,g,o)).length,u=p.endX,m=p.endY,0===d){e.push(u),e.push(m),g=u,o=m;break}for(u=0;u<d;u++)m=q[u],$e.Qe(g,o,m[2],m[3],m[4],m[5],m[6],m[7],.5,e),g=m[6],o=m[7];break;default:T("Segment not of valid type: "+p.type)}p.isClosed&&(e.push(r),e.push(h))}4<=e.length&&(b.push(e),t.push(si(e)))}}}function si(a){for(var b=[],t=0,e=0,n=a.length,o=0;o<n;o+=2){var g=a[o],r=a[o+1];0!==o&&b.push(Math.sqrt(At(t,e,g,r))),t=g,e=r}return b}function ai(a,b,t,e,n){ht(this),void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!1),this.l=2|(t?4:0)|(e?8:0)|(n?16:0),this.od=void 0!==a?a:0,this.pd=void 0!==b?b:0,this.ol=new ot,this.rr=this.ol.Ja,this.fw=null}function hi(a,b,t,e,n,o,g,r){ht(this),void 0===a&&(a=di),this.na=a,this.l=2,this.Dc=void 0!==b?b:0,this.Ec=void 0!==t?t:0,void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===g&&(g=0),a===yi?(0>(a=o%360)&&(a+=360),this.Ne=a,this.Vh=0,this.Wh=Math.max(e,0),this.Pg=Math.max(n,0),"boolean"==typeof g?g&&(this.isLargeArc=!0):"number"==typeof g&&g&&(this.isLargeArc=!0),r&&(this.isClockwiseArc=!0)):(this.Ne=e,this.Vh=n,a===mi&&(o=Math.max(o,0)),this.Wh=o,"number"==typeof g?(a===mi&&(g=Math.max(g,0)),this.Pg=g):this.Pg=0),this.ae=null}function ui(a,b){if(null!==a.ae&&!1===b._isInvalidBounds)return a.ae;var t=a.radiusX,e=a.radiusY;if(void 0===e&&(e=t),0===t||0===e)return a.ae=[],a.ae;b=a.Ne;var n=a.Vh,o=$e.jx(0,0,t<e?t:e,a.startAngle,a.startAngle+a.sweepAngle,!1);if(t!==e){var g=Ze.alloc();g.reset(),t<e?g.scale(1,e/t):g.scale(t/e,1),Qe.Ha(o,g),Ze.free(g)}for(t=o.length,e=0;e<t;e++)(g=o[e])[0]+=b,g[1]+=n,g[2]+=b,g[3]+=n,g[4]+=b,g[5]+=n,g[6]+=b,g[7]+=n;return a.ae=o,a.ae}function ci(a,b,t,e){function n(a,b,t,e){return(a*e<b*t?-1:1)*Math.acos((a*t+b*e)/(Math.sqrt(a*a+b*b)*Math.sqrt(t*t+e*e)))}if(null!==a.ae&&!1===b._isInvalidBounds)return a.ae;if(0===a.radiusX||0===a.radiusY)return a.ae=[],a.ae;b=a.Wh;var o=a.Pg;0===b&&(b=1e-4),0===o&&(o=1e-4);var g=Math.PI/180*a.Ne,r=a.isLargeArc,h=a.isClockwiseArc,l=a.Dc,c=a.Ec,f=Math.cos(g),p=Math.sin(g),q=f*(t-l)/2+p*(e-c)/2,d=q*q/(b*b)+(g=-p*(t-l)/2+f*(e-c)/2)*g/(o*o);return 1<d&&(b*=Math.sqrt(d),o*=Math.sqrt(d)),d=(r===h?-1:1)*Math.sqrt((b*b*o*o-b*b*g*g-o*o*q*q)/(b*b*g*g+o*o*q*q)),isNaN(d)&&(d=0),r=d*b*g/o,d=d*-o*q/b,isNaN(r)&&(r=0),isNaN(d)&&(d=0),t=(t+l)/2+f*r-p*d,e=(e+c)/2+p*r+f*d,c=n(1,0,(q-r)/b,(g-d)/o),g=n(f=(q-r)/b,l=(g-d)/o,q=(-q-r)/b,r=(-g-d)/o),-1>=(q=(f*q+l*r)/(Math.sqrt(f*f+l*l)*Math.sqrt(q*q+r*r)))?g=Math.PI:1<=q&&(g=0),!h&&0<g&&(g-=2*Math.PI),h&&0>g&&(g+=2*Math.PI),h=b>o?1:b/o,q=b>o?o/b:1,b=$e.jx(0,0,b>o?b:o,c,c+g,!0),(o=Ze.alloc()).reset(),o.translate(t,e),o.rotate(a.Ne,0,0),o.scale(h,q),Qe.Ha(b,o),Ze.free(o),a.ae=b,a.ae}$e.za=$e.AA,Qe.prototype.copy=function(){var a=new Qe;if(a.l=-2&this.l,a.na=this.na,a.od=this.od,a.pd=this.pd,a.Dc=this.Dc,a.Ec=this.Ec,this.na===Qe.o){for(var b=this.ee.s,t=a.ee,e=0;e<b.length;e++)t.add(b[e].copy());a.ee=t}else a.ee=this.ee;return a.$p=this.$p,a.Hp.assign(this.Hp),a.sk=this.sk,a.xm=this.xm,a.ym=this.ym,a.fg=this.fg.J(),a.gg=this.gg.J(),a.Rk=this.Rk,a.Qk=this.Qk,a.Uf=this.Uf,a},Qe.prototype.ja=function(){return this.freeze(),Object.freeze(this),this},Qe.prototype.freeze=function(){if(this._isFrozen=!0,this.type!==Qe.o)return this;var a=this.figures;a.freeze();for(var b=(a=a.s).length,t=0;t<b;t++)a[t].freeze();return this},Qe.prototype.ka=function(){if(Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,this.type!==Qe.o)return this;var a=this.figures;a.ka();for(var b=(a=a.s).length,t=0;t<b;t++)a[t].ka();return this},Qe.prototype.Xa=function(a){if(!(a instanceof Qe))return!1;if(this.type!==a.type)return this.type===Qe.j&&a.type===Qe.o?ti(this,a):a.type===Qe.j&&this.type===Qe.o&&ti(a,this);if(this.type===Qe.o){var b=this.figures.s;a=a.figures.s;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Xa(a[e]))return!1;return!0}return $e.B(this.startX,a.startX)&&$e.B(this.startY,a.startY)&&$e.B(this.endX,a.endX)&&$e.B(this.endY,a.endY)},Qe.ia=function(a){return a.toString()},Qe.prototype.qb=function(a){a.classType===Qe&&(this.type=a)},Qe.prototype.toString=function(a){switch(void 0===a&&(a=-1),this.type){case Qe.j:return 0>a?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a)+"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);case Qe.u:var b=new Ut(this.startX,this.startY,0,0);return b.Kv(this.endX,this.endY,0,0),0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case Qe.F:if((b=new Ut(this.startX,this.startY,0,0)).Kv(this.endX,this.endY,0,0),0>a)return"M"+(a=b.left.toString()+" "+(b.y+b.height/2).toString())+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+b.right.toString()+" "+(b.y+b.height/2).toString()+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+a;var t=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+t+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a)+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+t;case Qe.o:b="";for(var e=(t=this.figures.s).length,n=0;n<e;n++){var o=t[n];0<n&&(b+=" x "),o.isFilled&&(b+="F "),b+=o.toString(a)}return b;default:return this.type.toString()}},Qe.nb=function(a){for(var b=(a=a.split(/[Xx]/)).length,t="",e=0;e<b;e++){var n=a[e];t=null!==n.match(/[Ff]/)?0===e?t+n:t+"X"+(" "===n[0]?"":" ")+n:t+(0===e?"":"X ")+"F"+(" "===n[0]?"":" ")+n}return t},Qe.parse=function(a,b){function t(){return u>=w-1||null!==l[u+1].match(k)}function e(){return u++,l[u]}function n(a){var b=parseFloat(e()),t=parseFloat(e());m===m.toLowerCase()&&(b=x.x+b,t=x.y+t),a.h(b,t)}function o(){return n(x),x}function g(){return n(v),v}function r(){var a=y.toLowerCase();return"c"!==a&&"s"!==a&&"q"!==a&&"t"!==a?x:new St(2*x.x-v.x,2*x.y-v.y)}void 0===b&&(b=!1);var h=/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,l=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(/,/gm," ")).replace(h,"$1 $2")).replace(h,"$1 $2")).replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^s])/gm,"$1 $2")).replace(/([^s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(a=0;a<l.length;a++){var c=l[a];if(null!==c.match(/(\.[0-9]*)(\.)/gm)){h=z();for(var f="",p=!1,q=0;q<c.length;q++){var d=c[q];"."!==d||p?"."===d?(h.push(f),f="."):f+=d:(p=!0,f+=d)}for(h.push(f),l.splice(a,1),c=0;c<h.length;c++)l.splice(a+c,0,h[c]);a+=h.length-1,R(h)}}var u=-1,m="",y="";h=new St(0,0);var v=new St(0,0),x=new St(0,0),w=l.length;a=Ou(null),p=f=c=!1,q=!0,d=null;for(var k=/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/;!(u>=w-1);)if(y=m,""!==(m=e()))switch(m.toUpperCase()){case"X":q=!0,f=c=!1;break;case"M":for(d=o(),null===a.nc||!0===q?(Tu(a,d.x,d.y,c,!f,p),q=!1):a.moveTo(d.x,d.y),h.assign(x);!t();)d=o(),a.lineTo(d.x,d.y);break;case"L":for(;!t();)d=o(),a.lineTo(d.x,d.y);break;case"H":for(;!t();)x=new St((m===m.toLowerCase()?x.x:0)+parseFloat(e()),x.y),a.lineTo(x.x,x.y);break;case"V":for(;!t();)x=new St(x.x,(m===m.toLowerCase()?x.y:0)+parseFloat(e())),a.lineTo(x.x,x.y);break;case"C":for(;!t();){n(d=new St);var M=g(),S=o();Au(a,d.x,d.y,M.x,M.y,S.x,S.y)}break;case"S":for(;!t();)d=r(),M=g(),S=o(),Au(a,d.x,d.y,M.x,M.y,S.x,S.y);break;case"Q":for(;!t();)d=g(),M=o(),ju(a,d.x,d.y,M.x,M.y);break;case"T":for(;!t();)v=d=r(),M=o(),ju(a,d.x,d.y,M.x,M.y);break;case"B":for(;!t();){d=parseFloat(e()),M=parseFloat(e()),S=parseFloat(e());var P=parseFloat(e()),N=parseFloat(e()),C=N,T=!1;t()||(C=parseFloat(e()),t()||(T=0!==parseFloat(e()))),m===m.toLowerCase()&&(S+=x.x,P+=x.y),a.arcTo(d,M,S,P,N,C,T)}break;case"A":for(;!t();)d=Math.abs(parseFloat(e())),M=Math.abs(parseFloat(e())),S=parseFloat(e()),N=P=!1,T=C=0,1===(C=e()).length?(P=!!parseFloat(C),N=!!parseFloat(e()),C=parseFloat(e())):2===C.length?(P=!!parseFloat(C[0]),N=!!parseFloat(C[1]),C=parseFloat(e())):(P=!!parseFloat(C[0]),N=!!parseFloat(C[1]),C=parseFloat(C.slice(2))),T=parseFloat(e()),m===m.toLowerCase()&&(C=x.x+C,T=x.y+T),x.h(C,T),Fu(a,d,M,S,P,N,C,T);break;case"Z":Lu(a),x.assign(h);break;case"F":for(d="",M=1;l[u+M];)if("0"===l[u+M])p=!0,M++;else if(null!==l[u+M].match(/[Uu]/))M++;else{if(null!==l[u+M].match(k)){d=l[u+M];break}M++}d.match(/[Mm]/)?c=!0:0<a.nc.segments.length&&(a.nc.isFilled=!0);break;case"U":for(d="",M=1;l[u+M];)if(null!==l[u+M].match(/[Ff]/))M++;else{if(null!==l[u+M].match(k)){d=l[u+M];break}M++}d.match(/[Mm]/)?f=!0:a.nc.isShadowed=!1}if(h=a.ns,Bu=a,b)for(b=h.figures.iterator;b.next();)b.value.isFilled=!0;return h},Qe.Ha=function(a,b){for(var t=a.length,e=St.alloc(),n=0;n<t;n++){var o=a[n];e.x=o[0],e.y=o[1],b.Ga(e),o[0]=e.x,o[1]=e.y,e.x=o[2],e.y=o[3],b.Ga(e),o[2]=e.x,o[3]=e.y,e.x=o[4],e.y=o[5],b.Ga(e),o[4]=e.x,o[5]=e.y,e.x=o[6],e.y=o[7],b.Ga(e),o[6]=e.x,o[7]=e.y}St.free(e)},Qe.prototype.Zu=function(){if(this._isInvalidBounds)return!0;if(this.type===Qe.o){if(this.$p!==this.figures.Ja)return!0;for(var a=this.figures.s,b=a.length,t=0;t<b;t++)if(a[t].Zu())return!0}return!1},Qe.prototype.computeBounds=function(){if(this._isInvalidBounds=!1,this.xm=this.sk=null,this.ym=NaN,this.type===Qe.o){this.$p=this.figures.Ja;for(var a=this.figures.s,b=a.length,t=0;t<b;t++){var e=a[t];e._isInvalidBounds=!1;var n=e.segments;e.rr=n.Ja,n=(e=n.s).length;for(var o=0;o<n;o++){var g=e[o];g._isInvalidBounds=!1,g.ae=null}}}(a=this.Hp).ka(),isNaN(this.Rk)||isNaN(this.Qk)?a.h(0,0,0,0):a.h(0,0,this.Rk,this.Qk),ei(this,a,!1),$t(a,0,0,0,0),a.freeze()},Qe.prototype.ix=function(){var a=new Ut;return ei(this,a,!0),a},Qe.prototype.normalize=function(){this._isFrozen&&L(this);var a=this.ix();return this.offset(-a.x,-a.y),new St(-a.x,-a.y)},Qe.prototype.offset=function(a,b){return this._isFrozen&&L(this),this.transform(1,0,0,1,a,b),this},Qe.prototype.scale=function(a,b){return this._isFrozen&&L(this),this.transform(a,0,0,b,0,0),this},Qe.prototype.rotate=function(a,b,t){this._isFrozen&&L(this),void 0===b&&(b=0),void 0===t&&(t=0);var e=Ze.alloc();return e.reset(),e.rotate(a,b,t),this.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),Ze.free(e),this},(e=Qe.prototype).transform=function(a,b,t,e,n,o){switch(this.type){case Qe.j:case Qe.u:case Qe.F:var g=this.od,r=this.pd;this.od=g*a+r*t+n,this.pd=g*b+r*e+o,g=this.Dc,r=this.Ec,this.Dc=g*a+r*t+n,this.Ec=g*b+r*e+o;break;case Qe.o:for(var h=this.figures.s,l=h.length,c=0;c<l;c++){var f=h[c];g=f.startX,r=f.startY,f.startX=g*a+r*t+n,f.startY=g*b+r*e+o;for(var p=(f=f.segments.s).length,q=0;q<p;q++){var d=f[q];switch(d.type){case di:case fi:g=d.endX,r=d.endY,d.endX=g*a+r*t+n,d.endY=g*b+r*e+o;break;case pi:g=d.point1X,r=d.point1Y,d.point1X=g*a+r*t+n,d.point1Y=g*b+r*e+o,g=d.point2X,r=d.point2Y,d.point2X=g*a+r*t+n,d.point2Y=g*b+r*e+o,g=d.endX,r=d.endY,d.endX=g*a+r*t+n,d.endY=g*b+r*e+o;break;case gi:g=d.point1X,r=d.point1Y,d.point1X=g*a+r*t+n,d.point1Y=g*b+r*e+o,g=d.endX,r=d.endY,d.endX=g*a+r*t+n,d.endY=g*b+r*e+o;break;case mi:g=d.centerX,r=d.centerY,d.centerX=g*a+r*t+n,d.centerY=g*b+r*e+o,0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),d.startAngle+=g),0>a&&(d.startAngle=180-d.startAngle,d.sweepAngle=-d.sweepAngle),0>e&&(d.startAngle=-d.startAngle,d.sweepAngle=-d.sweepAngle),d.radiusX*=Math.sqrt(a*a+t*t),void 0!==d.radiusY&&(d.radiusY*=Math.sqrt(b*b+e*e));break;case yi:if(g=d.endX,r=d.endY,d.endX=g*a+r*t+n,d.endY=g*b+r*e+o,0===d.radiusX||0===d.radiusY)break;0!==b&&(0>(g=180*Math.atan2(b,a)/Math.PI)&&(g+=360),d.xAxisRotation+=g),0>a&&(d.xAxisRotation=180-d.xAxisRotation,d.isClockwiseArc=!d.isClockwiseArc),0>e&&(d.xAxisRotation=-d.xAxisRotation,d.isClockwiseArc=!d.isClockwiseArc),d.radiusX*=Math.sqrt(a*a+t*t),d.radiusY*=Math.sqrt(b*b+e*e);break;default:T("Unknown Segment type: "+d.type)}}}}return this._isInvalidBounds=!0,this},e.ca=function(a,b){void 0===b&&(b=0);var t=this.od,e=this.pd,n=this.Dc,o=this.Ec;switch(this.type){case Qe.j:return $e.Zb(t,e,n,o,b,a.x,a.y);case Qe.u:var g=Ut.allocAt(Math.min(t,n)-b,Math.min(e,o)-b,Math.abs(n-t)+2*b,Math.abs(o-e)+2*b);return a=g.ca(a),Ut.free(g),a;case Qe.F:g=Math.min(t,n)-b;var r=Math.min(e,o)-b;return t=(Math.abs(n-t)+2*b)/2,b=(Math.abs(o-e)+2*b)/2,0>=t||0>=b?!1:1>=(g=a.x-(g+t))*g/(t*t)+(r=a.y-(r+b))*r/(b*b);case Qe.o:return ii(this,a,b,!0,!1);default:return!1}},e.Pu=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=new St),this.type===Qe.j)return b.h(this.startX+a*(this.endX-this.startX),this.startY+a*(this.endY-this.startY)),b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,r=(t=t[r])[2*a],n=t[2*a+1],b.h(r+(t[2*a+2]-r)*e,n+(t[2*a+3]-n)*e),b;g+=c}}return b},e.wx=function(a){if(0>a?a=0:1<a&&(a=1),this.type===Qe.j)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;for(var b=this.flattenedSegments,t=this.flattenedLengths,e=b.length,n=this.flattenedTotalLength*a,o=0,g=0;g<e;g++){var r=t[g],h=r.length;for(a=0;a<h;a++){var l=r[a];if(o+l>=n)return b=(n=b[g])[2*a],t=n[2*a+1],e=n[2*a+2],a=n[2*a+3],1>Math.abs(e-b)&&1>Math.abs(a-t)?0:1>Math.abs(e-b)?0<=a-t?90:270:1>Math.abs(a-t)?0<=e-b?0:180:180*Math.atan2(a-t,e-b)/Math.PI;o+=l}}return NaN},e.Qu=function(a,b){if(0>a?a=0:1<a&&(a=1),void 0===b&&(b=[]),b.length=3,this.type===Qe.j)return b[0]=this.startX+a*(this.endX-this.startX),b[1]=this.startY+a*(this.endY-this.startY),b[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,b;for(var t=this.flattenedSegments,e=this.flattenedLengths,n=t.length,o=this.flattenedTotalLength*a,g=0,r=0;r<n;r++){var h=e[r],l=h.length;for(a=0;a<l;a++){var c=h[a];if(g+c>=o)return e=o-g,e=0===c?0:e/c,t=(c=t[r])[2*a],r=c[2*a+1],n=c[2*a+2],a=c[2*a+3],b[0]=t+(n-t)*e,b[1]=r+(a-r)*e,b[2]=1>Math.abs(n-t)&&1>Math.abs(a-r)?0:1>Math.abs(n-t)?0<=a-r?90:270:1>Math.abs(a-r)?0<=n-t?0:180:180*Math.atan2(a-r,n-t)/Math.PI,b;g+=c}}return b},e.xx=function(a){if(this.type===Qe.j){var b=this.startX,t=this.startY,e=this.endX,n=this.endY;if(b!==e||t!==n){var o=a.x;if(a=a.y,b===e){if(t<n){var g=t;e=n}else g=n,e=t;return a<=g?g===t?0:1:a>=e?e===t?0:1:Math.abs(a-t)/(e-g)}if(t===n)return b<e?g=b:(g=e,e=b),o<=g?g===b?0:1:o>=e?e===b?0:1:Math.abs(o-b)/(e-g);g=(e-b)*(e-b)+(n-t)*(n-t);var r=St.alloc();return $e.qh(b,t,e,n,o,a,r),a=r.x,o=r.y,St.free(r),Math.sqrt(((a-b)*(a-b)+(o-t)*(o-t))/g)}}else{if(this.type!==Qe.u){b=this.flattenedSegments,t=this.flattenedLengths,o=this.flattenedTotalLength,e=St.alloc(),n=1/0,r=g=0,y=b.length;for(var h=v=0,l=0;l<y;l++)for(var p=b[l],q=t[l],c=p.length,u=0;u<c;u+=2){var f=p[u],d=p[u+1];if(0!==u){$e.qh(v,h,f,d,a.x,a.y,e);var m=(e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y);m<n&&(n=m,g=r,g+=Math.sqrt((e.x-v)*(e.x-v)+(e.y-h)*(e.y-h))),r+=q[(u-2)/2]}v=f,h=d}return St.free(e),0>(a=g/o)?0:1<a?1:a}g=this.startX,r=this.startY;var y=this.endX;if(n=this.endY,g!==y||r!==n){o=2*(b=y-g)+2*(t=n-r),e=a.x,a=a.y,e=Math.min(Math.max(e,g),y),a=Math.min(Math.max(a,r),n),g=Math.abs(e-g),y=Math.abs(e-y),r=Math.abs(a-r),n=Math.abs(a-n);var v=Math.min(g,y,r,n);if(v===r)return e/o;if(v===y)return(b+a)/o;if(v===n)return(2*b+t-e)/o;if(v===g)return(2*b+2*t-a)/o}}return 0},e.add=function(a){return this.ee.add(a),this},e.om=function(a,b,t,e,n,o,g,r){return this._isFrozen&&L(this),this.fg=new qe(a,b,n,o).freeze(),this.gg=new qe(t,e,g,r).freeze(),this},v.Object.defineProperties(Qe.prototype,{_isFrozen:{get:function(){return 0!=(1&this.l)},set:function(a){this.l=a?1|this.l:-2&this.l}},_isInvalidBounds:{get:function(){return 0!=(2&this.l)},set:function(a){this.l=a?2|this.l:-3&this.l}},flattenedSegments:{get:function(){return ri(this),this.sk}},flattenedLengths:{get:function(){return ri(this),this.xm}},flattenedTotalLength:{get:function(){var a=this.ym;if(isNaN(a)){if(this.type===Qe.j){a=Math.abs(this.endX-this.startX);var b=Math.abs(this.endY-this.startY);a=Math.sqrt(a*a+b*b)}else if(this.type===Qe.u)a=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY);else for(var t=(b=this.flattenedLengths).length,e=a=0;e<t;e++)for(var n=b[e],o=n.length,g=0;g<o;g++)a+=n[g];this.ym=a}return a}},type:{get:function(){return this.na},set:function(a){this.na!==a&&(this._isFrozen&&L(this,a),this.na=a,a===Qe.o?this.ee=new ot:(null===Qe.V&&(Qe.V=(new ot).freeze()),this.ee=Qe.V),this._isInvalidBounds=!0)}},startX:{get:function(){return this.od},set:function(a){this.od!==a&&(this._isFrozen&&L(this,a),this.od=a,this._isInvalidBounds=!0)}},startY:{get:function(){return this.pd},set:function(a){this.pd!==a&&(this._isFrozen&&L(this,a),this.pd=a,this._isInvalidBounds=!0)}},endX:{get:function(){return this.Dc},set:function(a){this.Dc!==a&&(this._isFrozen&&L(this,a),this.Dc=a,this._isInvalidBounds=!0)}},endY:{get:function(){return this.Ec},set:function(a){this.Ec!==a&&(this._isFrozen&&L(this,a),this.Ec=a,this._isInvalidBounds=!0)}},figures:{get:function(){return this.ee},set:function(a){this.ee!==a&&(this._isFrozen&&L(this,a),this.ee=a,this._isInvalidBounds=!0)}},spot1:{get:function(){return this.fg},set:function(a){this._isFrozen&&L(this,a),this.fg=a.J()}},spot2:{get:function(){return this.gg},set:function(a){this._isFrozen&&L(this,a),this.gg=a.J()}},defaultStretch:{get:function(){return this.Uf},set:function(a){this._isFrozen&&L(this,a),this.Uf=a}},bounds:{get:function(){return this.Zu()&&this.computeBounds(),this.Hp}}}),Qe.prototype.setSpots=Qe.prototype.om,Qe.prototype.add=Qe.prototype.add,Qe.prototype.getFractionForPoint=Qe.prototype.xx,Qe.prototype.getPointAndAngleAlongPath=Qe.prototype.Qu,Qe.prototype.getAngleAlongPath=Qe.prototype.wx,Qe.prototype.getPointAlongPath=Qe.prototype.Pu,Qe.prototype.containsPoint=Qe.prototype.ca,Qe.prototype.transform=Qe.prototype.transform,Qe.prototype.rotate=Qe.prototype.rotate,Qe.prototype.scale=Qe.prototype.scale,Qe.prototype.offset=Qe.prototype.offset,Qe.prototype.normalize=Qe.prototype.normalize,Qe.prototype.computeBoundsWithoutOrigin=Qe.prototype.ix,Qe.prototype.equalsApprox=Qe.prototype.Xa,Qe.className="Geometry",Qe.j=new W(Qe,"Line",0),Qe.u=new W(Qe,"Rectangle",1),Qe.F=new W(Qe,"Ellipse",2),Qe.o=new W(Qe,"Path",3),Qe.V=null,Qe.hb="UuBbMmZzLlHhVvCcSsQqTtAaFfXx",Qe.className="Geometry",Qe.stringify=Qe.ia,Qe.fillPath=Qe.nb,Qe.parse=Qe.parse,Qe.Line=Qe.j,Qe.Rectangle=Qe.u,Qe.Ellipse=Qe.F,Qe.Path=Qe.o,ai.prototype.copy=function(){var a=new ai;a.l=-2&this.l,a.od=this.od,a.pd=this.pd;for(var b=this.ol.s,t=b.length,e=a.ol,n=0;n<t;n++){var o=b[n].copy();e.add(o)}return a.rr=this.rr,a.fw=this.fw,a},(e=ai.prototype).Xa=function(a){if(!(a instanceof ai&&$e.B(this.startX,a.startX)&&$e.B(this.startY,a.startY)))return!1;var b=this.segments.s;a=a.segments.s;var t=b.length;if(t!==a.length)return!1;for(var e=0;e<t;e++)if(!b[e].Xa(a[e]))return!1;return!0},e.toString=function(a){void 0===a&&(a=-1);for(var b=0>a?"M"+this.startX.toString()+" "+this.startY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a),t=this.segments.s,e=t.length,n=0;n<e;n++)b+=" "+t[n].toString(a);return b},e.freeze=function(){this._isFrozen=!0;var a=this.segments;a.freeze();var b=a.s;a=a.length;for(var t=0;t<a;t++)b[t].freeze();return this},e.ka=function(){this._isFrozen=!1;var a=this.segments;a.ka();for(var b=(a=a.s).length,t=0;t<b;t++)a[t].ka();return this},e.Zu=function(){if(this._isInvalidBounds)return!0;var a=this.segments;if(this.rr!==a.Ja)return!0;for(var b=(a=a.s).length,t=0;t<b;t++)if(a[t]._isInvalidBounds)return!0;return!1},e.add=function(a){return this.ol.add(a),this},e.ca=function(a,b,t){for(var e=this.startX,n=this.startY,o=e,g=n,r=this.segments.s,h=r.length,l=0;l<h;l++){var c=r[l];switch(c.type){case fi:o=c.endX,g=c.endY,e=c.endX,n=c.endY;break;case di:if($e.Zb(e,n,c.endX,c.endY,t,a,b))return!0;e=c.endX,n=c.endY;break;case pi:if($e.bs(e,n,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case gi:if($e.jv(e,n,c.point1X,c.point1Y,c.endX,c.endY,.5,a,b,t))return!0;e=c.endX,n=c.endY;break;case mi:case yi:var f=c.type===mi?ui(c,this):ci(c,this,e,n),p=f.length,q=c.type===mi?c.centerX:c.endX,d=c.type===mi?c.centerY:c.endY;if(0===p){if($e.Zb(e,n,q,d,t,a,b))return!0;e=q,n=d;break}for(q=null,d=0;d<p;d++)if(q=f[d],0===d&&$e.Zb(e,n,q[0],q[1],t,a,b)||$e.bs(q[0],q[1],q[2],q[3],q[4],q[5],q[6],q[7],.5,a,b,t))return!0;null!==q&&(e=q[6],n=q[7]);break;default:T("Unknown Segment type: "+c.type)}if(c.isClosed&&(e!==o||n!==g)&&$e.Zb(e,n,o,g,t,a,b))return!0}return!1},v.Object.defineProperties(ai.prototype,{_isFrozen:{get:function(){return 0!=(1&this.l)},set:function(a){this.l=a?1|this.l:-2&this.l}},_isInvalidBounds:{get:function(){return 0!=(2&this.l)},set:function(a){this.l=a?2|this.l:-3&this.l}},isFilled:{get:function(){return 0!=(4&this.l)},set:function(a){this._isFrozen&&L(this,a),this.l=a?4|this.l:-5&this.l}},isShadowed:{get:function(){return 0!=(8&this.l)},set:function(a){this._isFrozen&&L(this,a),this.l=a?8|this.l:-9&this.l}},isEvenOdd:{get:function(){return 0!=(16&this.l)},set:function(a){this._isFrozen&&L(this,a),this.l=a?16|this.l:-17&this.l}},startX:{get:function(){return this.od},set:function(a){this._isFrozen&&L(this,a),this.od=a,this._isInvalidBounds=!0}},startY:{get:function(){return this.pd},set:function(a){this._isFrozen&&L(this,a),this.pd=a,this._isInvalidBounds=!0}},segments:{get:function(){return this.ol},set:function(a){this._isFrozen&&L(this,a),this.ol=a,this._isInvalidBounds=!0}}}),ai.prototype.add=ai.prototype.add,ai.prototype.equalsApprox=ai.prototype.Xa,ai.className="PathFigure",hi.prototype.copy=function(){var a=new hi;return a.na=this.na,a.l=-2&this.l,a.Dc=this.Dc,a.Ec=this.Ec,a.Ne=this.Ne,a.Vh=this.Vh,a.Wh=this.Wh,a.Pg=this.Pg,a},(e=hi.prototype).Xa=function(a){if(!(a instanceof hi)||this.type!==a.type||this.isClosed!==a.isClosed)return!1;switch(this.type){case fi:case di:return $e.B(this.endX,a.endX)&&$e.B(this.endY,a.endY);case pi:return $e.B(this.endX,a.endX)&&$e.B(this.endY,a.endY)&&$e.B(this.point1X,a.point1X)&&$e.B(this.point1Y,a.point1Y)&&$e.B(this.point2X,a.point2X)&&$e.B(this.point2Y,a.point2Y);case gi:return $e.B(this.endX,a.endX)&&$e.B(this.endY,a.endY)&&$e.B(this.point1X,a.point1X)&&$e.B(this.point1Y,a.point1Y);case mi:return $e.B(this.startAngle,a.startAngle)&&$e.B(this.sweepAngle,a.sweepAngle)&&$e.B(this.centerX,a.centerX)&&$e.B(this.centerY,a.centerY)&&$e.B(this.radiusX,a.radiusX)&&$e.B(this.radiusY,a.radiusY);case yi:return this.isClockwiseArc===a.isClockwiseArc&&this.isLargeArc===a.isLargeArc&&$e.B(this.xAxisRotation,a.xAxisRotation)&&$e.B(this.endX,a.endX)&&$e.B(this.endY,a.endY)&&$e.B(this.radiusX,a.radiusX)&&$e.B(this.radiusY,a.radiusY);default:return!1}},e.qb=function(a){a.classType===hi&&(this.type=a)},e.toString=function(a){switch(void 0===a&&(a=-1),this.type){case fi:a=0>a?"M"+this.endX.toString()+" "+this.endY.toString():"M"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case di:a=0>a?"L"+this.endX.toString()+" "+this.endY.toString():"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case pi:a=0>a?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.point2X.toFixed(a)+" "+this.point2Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case gi:a=0>a?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case mi:a=0>a?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+this.startAngle.toFixed(a)+" "+this.sweepAngle.toFixed(a)+" "+this.centerX.toFixed(a)+" "+this.centerY.toFixed(a)+" "+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a);break;case yi:a=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+" "+this.xAxisRotation.toFixed(a)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;default:a=this.type.toString()}return a+(this.isClosed?"z":"")},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return this._isFrozen=!1,this},e.close=function(){return this.isClosed=!0,this},v.Object.defineProperties(hi.prototype,{_isFrozen:{get:function(){return 0!=(1&this.l)},set:function(a){this.l=a?1|this.l:-2&this.l}},_isInvalidBounds:{get:function(){return 0!=(2&this.l)},set:function(a){this.l=a?2|this.l:-3&this.l}},isClosed:{get:function(){return 0!=(8&this.l)},set:function(a){this.isClosed!==a&&(this.l=a?8|this.l:-9&this.l,this._isInvalidBounds=!0)}},type:{get:function(){return this.na},set:function(a){this._isFrozen&&L(this,a),this.na=a,this._isInvalidBounds=!0}},endX:{get:function(){return this.Dc},set:function(a){this._isFrozen&&L(this,a),this.Dc=a,this._isInvalidBounds=!0}},endY:{get:function(){return this.Ec},set:function(a){this._isFrozen&&L(this,a),this.Ec=a,this._isInvalidBounds=!0}},point1X:{get:function(){return this.Ne},set:function(a){this._isFrozen&&L(this,a),this.Ne=a,this._isInvalidBounds=!0}},point1Y:{get:function(){return this.Vh},set:function(a){this._isFrozen&&L(this,a),this.Vh=a,this._isInvalidBounds=!0}},point2X:{get:function(){return this.Wh},set:function(a){this._isFrozen&&L(this,a),this.Wh=a,this._isInvalidBounds=!0}},point2Y:{get:function(){return this.Pg},set:function(a){this._isFrozen&&L(this,a),this.Pg=a,this._isInvalidBounds=!0}},centerX:{get:function(){return this.Ne},set:function(a){this._isFrozen&&L(this,a),this.Ne=a,this._isInvalidBounds=!0}},centerY:{get:function(){return this.Vh},set:function(a){this._isFrozen&&L(this,a),this.Vh=a,this._isInvalidBounds=!0}},radiusX:{get:function(){return this.Wh},set:function(a){0>a&&A(a,">= zero",hi,"radiusX"),this._isFrozen&&L(this,a),this.Wh=a,this._isInvalidBounds=!0}},radiusY:{get:function(){return this.Pg},set:function(a){0>a&&A(a,">= zero",hi,"radiusY"),this._isFrozen&&L(this,a),this.Pg=a,this._isInvalidBounds=!0}},startAngle:{get:function(){return this.Dc},set:function(a){this._isFrozen&&L(this,a),0>(a%=360)&&(a+=360),this.Dc=a,this._isInvalidBounds=!0}},sweepAngle:{get:function(){return this.Ec},set:function(a){this._isFrozen&&L(this,a),360<a&&(a=360),-360>a&&(a=-360),this.Ec=a,this._isInvalidBounds=!0}},isClockwiseArc:{get:function(){return 0!=(4&this.l)},set:function(a){this._isFrozen&&L(this,a),this.l=a?4|this.l:-5&this.l,this._isInvalidBounds=!0}},isLargeArc:{get:function(){return 0!=(16&this.l)},set:function(a){this._isFrozen&&L(this,a),this.l=a?16|this.l:-17&this.l,this._isInvalidBounds=!0}},xAxisRotation:{get:function(){return this.Ne},set:function(a){this._isFrozen&&L(this,a),0>(a%=360)&&(a+=360),this.Ne=a,this._isInvalidBounds=!0}}}),hi.prototype.equalsApprox=hi.prototype.Xa;var fi=new W(hi,"Move",0),di=new W(hi,"Line",1),pi=new W(hi,"Bezier",2),gi=new W(hi,"QuadraticBezier",3),mi=new W(hi,"Arc",4),yi=new W(hi,"SvgArc",4);function vi(){this.H=null,this.wu=new St(0,0).freeze(),this.lt=new St(0,0).freeze(),this.Ap=this.Qq=0,this.Bp=1,this.wq="",this.Vr=this.Sp=!1,this.Qp=this.Dp=0,this.xg=this.mq=this.sq=!1,this.Yp=null,this.Qr=0,this.xd=this.Mr=null}function xi(){this.H=null,this.xa="",this.$q=this.Kr=null}function bi(){this.Em=ki,this.rf=this.Pq="",this.Kn=this.Ln=this.Qn=this.Rn=this.Pn=this.H=this.dc=null}hi.className="PathSegment",hi.Move=fi,hi.Line=di,hi.Bezier=pi,hi.QuadraticBezier=gi,hi.Arc=mi,hi.SvgArc=yi,vi.prototype.copy=function(){var a=new vi;return this.clone(a)},vi.prototype.clone=function(a){return a.H=this.H,a.wu.assign(this.viewPoint),a.lt.assign(this.documentPoint),a.Qq=this.Qq,a.Ap=this.Ap,a.Bp=this.Bp,a.wq=this.wq,a.Sp=this.Sp,a.Vr=this.Vr,a.Dp=this.Dp,a.Qp=this.Qp,a.sq=this.sq,a.mq=this.mq,a.xg=this.xg,a.Yp=this.Yp,a.Qr=this.Qr,a.Mr=this.Mr,a.xd=this.xd,a},vi.prototype.toString=function(){var a="^";return 0!==this.modifiers&&(a+="M:"+this.modifiers),0!==this.button&&(a+="B:"+this.button),""!==this.key&&(a+="K:"+this.key),0!==this.clickCount&&(a+="C:"+this.clickCount),0!==this.delta&&(a+="D:"+this.delta),this.handled&&(a+="h"),this.bubbles&&(a+="b"),null!==this.documentPoint&&(a+="@"+this.documentPoint.toString()),a},vi.prototype.Ro=function(a,b){var t=this.diagram;return null===t||sr(t,a,b),b},vi.prototype.Bz=function(a,b){var t=this.diagram;return null===t||(sr(t,a,b),b.assign(t.Os(b))),b},v.Object.defineProperties(vi.prototype,{diagram:{get:function(){return this.H},set:function(a){this.H=a}},viewPoint:{get:function(){return this.wu},set:function(a){this.wu.assign(a)}},documentPoint:{get:function(){return this.lt},set:function(a){this.lt.assign(a)}},modifiers:{get:function(){return this.Qq},set:function(a){this.Qq=a}},button:{get:function(){return this.Ap},set:function(a){if(this.Ap=a,null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}}},buttons:{get:function(){return this.Bp},set:function(a){this.Bp=a}},key:{get:function(){return this.wq},set:function(a){this.wq=a}},down:{get:function(){return this.Sp},set:function(a){this.Sp=a}},up:{get:function(){return this.Vr},set:function(a){this.Vr=a}},clickCount:{get:function(){return this.Dp},set:function(a){this.Dp=a}},delta:{get:function(){return this.Qp},set:function(a){this.Qp=a}},isMultiTouch:{get:function(){return this.sq},set:function(a){this.sq=a}},handled:{get:function(){return this.mq},set:function(a){this.mq=a}},bubbles:{get:function(){return this.xg},set:function(a){this.xg=a}},event:{get:function(){return this.Yp},set:function(a){this.Yp=a}},isTouchEvent:{get:function(){var a=this.event;return null!==a&&("touch"===a.pointerType||"pen"===a.pointerType)}},timestamp:{get:function(){return this.Qr},set:function(a){this.Qr=a}},targetDiagram:{get:function(){return this.Mr},set:function(a){this.Mr=a}},targetObject:{get:function(){return this.xd},set:function(a){this.xd=a}},control:{get:function(){return 0!=(1&this.modifiers)},set:function(a){this.modifiers=a?1|this.modifiers:-2&this.modifiers}},shift:{get:function(){return 0!=(4&this.modifiers)},set:function(a){this.modifiers=a?4|this.modifiers:-5&this.modifiers}},alt:{get:function(){return 0!=(2&this.modifiers)},set:function(a){this.modifiers=a?2|this.modifiers:-3&this.modifiers}},meta:{get:function(){return 0!=(8&this.modifiers)},set:function(a){this.modifiers=a?8|this.modifiers:-9&this.modifiers}},left:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(1&this.buttons):0===this.button},set:function(a){this.buttons=a?1|this.buttons:-2&this.buttons}},right:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(2&this.buttons):2===this.button},set:function(a){this.buttons=a?2|this.buttons:-3&this.buttons}},middle:{get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!=(4&this.buttons):1===this.button},set:function(a){this.buttons=a?4|this.buttons:-5&this.buttons}}}),vi.prototype.getMultiTouchDocumentPoint=vi.prototype.Bz,vi.prototype.getMultiTouchViewPoint=vi.prototype.Ro,vi.className="InputEvent",xi.prototype.copy=function(){var a=new xi;return a.H=this.H,a.xa=this.xa,a.Kr=this.Kr,a.$q=this.$q,a},xi.prototype.toString=function(){var a="*"+this.name;return null!==this.subject&&(a+=":"+this.subject.toString()),null!==this.parameter&&(a+="("+this.parameter.toString()+")"),a},v.Object.defineProperties(xi.prototype,{diagram:{get:function(){return this.H},set:function(a){this.H=a}},name:{get:function(){return this.xa},set:function(a){this.xa=a}},subject:{get:function(){return this.Kr},set:function(a){this.Kr=a}},parameter:{get:function(){return this.$q},set:function(a){this.$q=a}}}),xi.className="DiagramEvent",bi.prototype.clear=function(){this.Kn=this.Ln=this.Qn=this.Rn=this.Pn=this.H=this.dc=null},bi.prototype.copy=function(){var a=new bi;a.Em=this.Em,a.Pq=this.Pq,a.rf=this.rf,a.dc=this.dc,a.H=this.H,a.Pn=this.Pn;var b=this.Rn;return a.Rn=F(b)&&"function"==typeof b.J?b.J():b,b=this.Qn,a.Qn=F(b)&&"function"==typeof b.J?b.J():b,b=this.Ln,a.Ln=F(b)&&"function"==typeof b.J?b.J():b,b=this.Kn,a.Kn=F(b)&&"function"==typeof b.J?b.J():b,a},bi.prototype.qb=function(a){a.classType===bi&&(this.change=a)},bi.prototype.toString=function(){var a="";return a=this.change===wi?a+"* ":this.change===ki?a+(null!==this.model?"!m":"!d"):a+(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(a+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(a+=" "+this.modelChange),a+=": ",this.change===wi?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=V(this.object)),null!==this.oldValue&&(a+="  old: "+V(this.oldValue)),null!==this.oldParam&&(a+=" "+this.oldParam),null!==this.newValue&&(a+="  new: "+V(this.newValue)),null!==this.newParam&&(a+=" "+this.newParam)),a},bi.prototype.I=function(a){return a?this.oldValue:this.newValue},bi.prototype.Dz=function(a){return a?this.oldParam:this.newParam},bi.prototype.canUndo=function(){return null!==this.model||null!==this.diagram},bi.prototype.undo=function(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.changeState(this,!0))},bi.prototype.canRedo=function(){return null!==this.model||null!==this.diagram},bi.prototype.redo=function(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.changeState(this,!1))},v.Object.defineProperties(bi.prototype,{model:{get:function(){return this.dc},set:function(a){this.dc=a}},diagram:{get:function(){return this.H},set:function(a){this.H=a}},change:{get:function(){return this.Em},set:function(a){this.Em=a}},modelChange:{get:function(){return this.Pq},set:function(a){this.Pq=a}},propertyName:{get:function(){return this.rf},set:function(a){this.rf=a}},isTransactionFinished:{get:function(){return this.Em===wi&&("CommittedTransaction"===this.rf||"FinishedUndo"===this.rf||"FinishedRedo"===this.rf)}},object:{get:function(){return this.Pn},set:function(a){this.Pn=a}},oldValue:{get:function(){return this.Rn},set:function(a){this.Rn=a}},oldParam:{get:function(){return this.Qn},set:function(a){this.Qn=a}},newValue:{get:function(){return this.Ln},set:function(a){this.Ln=a}},newParam:{get:function(){return this.Kn},set:function(a){this.Kn=a}}}),bi.prototype.redo=bi.prototype.redo,bi.prototype.canRedo=bi.prototype.canRedo,bi.prototype.undo=bi.prototype.undo,bi.prototype.canUndo=bi.prototype.canUndo,bi.prototype.getParam=bi.prototype.Dz,bi.prototype.getValue=bi.prototype.I,bi.prototype.clear=bi.prototype.clear;var wi=new W(bi,"Transaction",-1),ki=new W(bi,"Property",0),Mi=new W(bi,"Insert",1),Si=new W(bi,"Remove",2);function Pi(){this.o=(new ot).freeze(),this.xa="",this.j=!1}function Ni(){this.Ot=new at,this.Jd=!1,this.u=(new ot).freeze(),this.Ce=-1,this.o=999,this.Fe=!1,this.Mp=null,this.bi=0,this.j=!1,this.Ie=(new ot).freeze(),this.gl=new ot,this.st=!0,this.Ct=this.qq=this.Ft=this.Et=!1}function Ci(a,b,t){if(a.isUndoingRedoing)return!1;a.checksTransactionLevel&&1>a.transactionLevel&&j("Ending transaction without having started a transaction: "+t);var e=1===a.transactionLevel,n=a.currentTransaction;e&&b&&(a.isInternalTransaction||a.Pb("CommittingTransaction",t,n));var o=0;if(0<a.transactionLevel&&(a.bi--,a.isEnabled)){var g=a.Ie.count;0<g&&(""===t&&(t=a.Ie.M(0)),a.Ie.ka(),a.Ie.mb(g-1),a.Ie.freeze()),0<(g=a.gl.count)&&(o=a.gl.M(g-1),a.gl.mb(g-1))}if(e){if(b)a.qq=!1,null===n&&""!==t&&(n=a.currentTransaction),a.isEnabled&&null!==n&&(n.isComplete||(n.isComplete=!0,n.name=t),a.lx(),(b=a.history).ka(),0<=(e=a.maxHistoryLength)&&(0===e?b.clear():b.count>=e&&(null!==(o=b.M(0))&&o.clear(),b.mb(0),a.Ce--)),0===e||0!==b.count&&b.get(b.count-1)===n||(b.add(n),a.Ce++),b.freeze()),a.isInternalTransaction||a.Pb("CommittedTransaction",t,n);else{a.Fe=!0;try{a.isEnabled&&null!==n&&(n.isComplete=!0,n.undo())}finally{a.isInternalTransaction||a.Pb("RolledBackTransaction",t,n),a.Fe=!1}null!==n&&n.clear()}return a.Mp=null,a.isPendingClear&&a.clear(),a.isPendingClear=!1,a.isPendingUnmodified=!1,!0}if(a.isEnabled&&!b&&null!==n){for(a=o,n=(t=n.changes).count-1;n>=a;n--)null!==(b=t.M(n))&&b.undo(),t.ka(),t.mb(n);t.freeze()}return!1}function Ti(){ht(this),this.H=Lo,this.xa="",this.Jd=!0,this.nb=!1,this.vm=null,this.yy=new vi,this.Yr=-1}function Li(){Ti.call(this),this.name="ToolManager",this.hb=new ot,this.ob=new ot,this.Ib=new ot,this.F=this.V=850,this.o=new Vt(2,2).ja(),this.Ha=5e3,this.ia=Fi,this.u=Di,this.Lp=this.j=null,this.zj=-1}function Ai(a,b){a.standardMouseOver(),a.isBeyondDragSize()&&a.standardWaitAfter(a.isActive?a.holdDelay:a.hoverDelay,b.lastInput)}bi.className="ChangedEvent",bi.Transaction=wi,bi.Property=ki,bi.Insert=Mi,bi.Remove=Si,Pi.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==a&&0<a){a=this.changes.count;for(var t=0;t<a;t++){var e=this.changes.M(t);null!==e&&(b+="\n  "+e.toString())}}return b},Pi.prototype.clear=function(){var a=this.changes;a.ka();for(var b=a.count-1;0<=b;b--){var t=a.M(b);null!==t&&t.clear()}a.clear(),a.freeze()},Pi.prototype.canUndo=function(){return this.isComplete},Pi.prototype.undo=function(){if(this.canUndo())for(var a=this.changes.count-1;0<=a;a--){var b=this.changes.M(a);null!==b&&b.undo()}},Pi.prototype.canRedo=function(){return this.isComplete},Pi.prototype.redo=function(){if(this.canRedo())for(var a=this.changes.count,b=0;b<a;b++){var t=this.changes.M(b);null!==t&&t.redo()}},Pi.prototype.$j=function(){if(this.isComplete){var a=this.changes;a.ka();for(var b=new Mt,t=0;t<a.count;t++){var e=a.M(t);if(null!==e&&e.change===ki&&e.object){var n=b.get(e.object);n||(n=new Mt,b.set(e.object,n));var o=n.get(e.propertyName);null===o?n.set(e.propertyName,-1):(0<o&&a.cd(o,null),n.set(e.propertyName,t))}}for(t=b=0;t<a.count;t++)null!==(e=a.M(t))&&(t>b&&a.cd(b,e),b++);for(;a.length>b;)a.pop();a.freeze()}},v.Object.defineProperties(Pi.prototype,{changes:{get:function(){return this.o}},name:{get:function(){return this.xa},set:function(a){this.xa=a}},isComplete:{get:function(){return this.j},set:function(a){this.j=a}}}),Pi.prototype.optimize=Pi.prototype.$j,Pi.prototype.redo=Pi.prototype.redo,Pi.prototype.canRedo=Pi.prototype.canRedo,Pi.prototype.undo=Pi.prototype.undo,Pi.prototype.canUndo=Pi.prototype.canUndo,Pi.prototype.clear=Pi.prototype.clear,Pi.className="Transaction",Ni.prototype.toString=function(a){var b="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;b+="[";for(var t=this.nestedTransactionNames.count,e=0;e<t;e++)0<e&&(b+=" "),b+=this.nestedTransactionNames.M(e);if(b+="]",void 0!==a&&0<a)for(t=this.history.count,e=0;e<t;e++)b+="\n "+this.history.M(e).toString(a-1);return b},Ni.prototype.clear=function(){var a=this.history;a.ka();for(var b=a.count-1;0<=b;b--){var t=a.M(b);null!==t&&t.clear()}a.clear(),this.Ce=-1,a.freeze(),this.Fe=!1,this.Mp=null,this.bi=0,this.Ie.ka(),this.Ie.clear(),this.Ie.freeze(),this.gl.clear(),this.Ct=this.qq=this.Ft=this.Et=!1},Ni.prototype.copyProperties=function(a){this.isEnabled=a.isEnabled,this.maxHistoryLength=a.maxHistoryLength,this.checksTransactionLevel=a.checksTransactionLevel},(e=Ni.prototype).Xw=function(a){this.Ot.add(a)},e.Rx=function(a){this.Ot.remove(a)},e.Ea=function(a){if(void 0===a&&(a=""),null===a&&(a=""),this.isUndoingRedoing)return!1;!0===this.st&&(this.st=!1,this.bi++,this.isInternalTransaction||this.Pb("StartingFirstTransaction",a,this.currentTransaction),0<this.bi&&this.bi--),this.isEnabled&&(this.Ie.ka(),this.Ie.add(a),this.Ie.freeze(),null===this.currentTransaction?this.gl.add(0):this.gl.add(this.currentTransaction.changes.count)),this.bi++;var b=1===this.transactionLevel;return b&&(this.isInternalTransaction||this.Pb("StartedTransaction",a,this.currentTransaction)),b},e.eb=function(a){return void 0===a&&(a=""),Ci(this,!0,a)},e.Kf=function(){return Ci(this,!1,"")},e.lx=function(){if(!this.isUndoingRedoing&&this.canRedo()){var a=this.history;a.ka();for(var b=a.count-1;b>this.historyIndex;b--){var t=a.M(b);null!==t&&t.clear(),a.mb(b),this.qq=!0}a.freeze()}},Ni.prototype.canUndo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToUndo;return!(null===a||!a.canUndo())},Ni.prototype.undo=function(){if(this.canUndo()){var a=this.transactionToUndo;try{this.Fe=!0,this.Pb("StartingUndo","Undo",a),this.Ce--,a.undo()}catch(t){j("undo error: "+t.toString())}finally{this.Pb("FinishedUndo","Undo",a),this.Fe=!1}}},Ni.prototype.canRedo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToRedo;return!(null===a||!a.canRedo())},Ni.prototype.redo=function(){if(this.canRedo()){var a=this.transactionToRedo;try{this.Fe=!0,this.Pb("StartingRedo","Redo",a),this.Ce++,a.redo()}catch(t){j("redo error: "+t.toString())}finally{this.Pb("FinishedRedo","Redo",a),this.Fe=!1}}},Ni.prototype.Pb=function(a,b,t){void 0===t&&(t=null);var e=new bi;for(e.change=wi,e.propertyName=a,e.object=t,e.oldValue=b,a=this.models;a.next();)b=a.value,e.model=b,b.cs(e)},Ni.prototype.Tu=function(a){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(a)){var b=this.currentTransaction;null===b&&(this.Mp=b=new Pi);var t=a.copy();(b=b.changes).ka(),b.add(t),b.freeze(),this.checksTransactionLevel&&0>=this.transactionLevel&&!this.st&&(null!==(a=a.diagram)&&!1===a.pi||j("Change not within a transaction: "+t.toString()))}},Ni.prototype.skipsEvent=function(a){if(null===a||0>a.change.value)return!0;if(null===(a=a.object))return!1;if(void 0!==a.layer){if(null!==(a=a.layer)&&a.isTemporary)return!0}else if(a.isTemporary)return!0;return!1},v.Object.defineProperties(Ni.prototype,{models:{get:function(){return this.Ot.iterator}},isEnabled:{get:function(){return this.Jd},set:function(a){this.Jd=a}},transactionToUndo:{get:function(){return 0<=this.historyIndex&&this.historyIndex<=this.history.count-1?this.history.M(this.historyIndex):null}},transactionToRedo:{get:function(){return this.historyIndex<this.history.count-1?this.history.M(this.historyIndex+1):null}},isUndoingRedoing:{get:function(){return this.Fe}},history:{get:function(){return this.u}},maxHistoryLength:{get:function(){return this.o},set:function(a){this.o=a}},historyIndex:{get:function(){return this.Ce}},currentTransaction:{get:function(){return this.Mp}},transactionLevel:{get:function(){return this.bi}},isInTransaction:{get:function(){return 0<this.bi}},checksTransactionLevel:{get:function(){return this.j},set:function(a){this.j=a}},nestedTransactionNames:{get:function(){return this.Ie}},isPendingClear:{get:function(){return this.Et},set:function(a){this.Et=a}},isPendingUnmodified:{get:function(){return this.Ft},set:function(a){this.Ft=a}},isInternalTransaction:{get:function(){return this.Ct},set:function(a){this.Ct=a}},isJustDiscarded:{get:function(){return this.qq}}}),Ni.prototype.handleChanged=Ni.prototype.Tu,Ni.prototype.redo=Ni.prototype.redo,Ni.prototype.undo=Ni.prototype.undo,Ni.prototype.canUndo=Ni.prototype.canUndo,Ni.prototype.discardHistoryAfterIndex=Ni.prototype.lx,Ni.prototype.rollbackTransaction=Ni.prototype.Kf,Ni.prototype.commitTransaction=Ni.prototype.eb,Ni.prototype.startTransaction=Ni.prototype.Ea,Ni.prototype.removeModel=Ni.prototype.Rx,Ni.prototype.addModel=Ni.prototype.Xw,Ni.prototype.clear=Ni.prototype.clear,Ni.className="UndoManager",Ti.prototype.toString=function(){return""!==this.name?this.name+" Tool":E(this.constructor)},Ti.prototype.updateAdornments=function(){},Ti.prototype.canStart=function(){return this.isEnabled},Ti.prototype.doStart=function(){},Ti.prototype.doActivate=function(){this.isActive=!0},Ti.prototype.doDeactivate=function(){this.isActive=!1},Ti.prototype.doStop=function(){},Ti.prototype.doCancel=function(){this.transactionResult=null,this.stopTool()},Ti.prototype.stopTool=function(){var a=this.diagram;a.currentTool===this&&(a.currentTool=null,a.currentCursor="")},Ti.prototype.doMouseDown=function(){!this.isActive&&this.canStart()&&this.doActivate()},Ti.prototype.doMouseMove=function(){},Ti.prototype.doMouseUp=function(){this.stopTool()},Ti.prototype.doMouseWheel=function(){},Ti.prototype.canStartMultiTouch=function(){return!0},Ti.prototype.standardPinchZoomStart=function(){var a=this.diagram,b=a.lastInput,t=b.Ro(0,St.allocAt(NaN,NaN)),e=b.Ro(1,St.allocAt(NaN,NaN));if(t.w()&&e.w()&&(this.doCancel(),a.Pl("hasGestureZoom"))){a.Bw=a.scale;var n=e.x-t.x,o=e.y-t.y;a.Jw=Math.sqrt(n*n+o*o),b.bubbles=!1}St.free(t),St.free(e)},Ti.prototype.standardPinchZoomMove=function(){var a=this.diagram,b=a.lastInput,t=b.Ro(0,St.allocAt(NaN,NaN)),e=b.Ro(1,St.allocAt(NaN,NaN));if(t.w()&&e.w()&&(this.doCancel(),a.Pl("hasGestureZoom"))){var n=e.x-t.x,o=e.y-t.y;o=Math.sqrt(n*n+o*o)/a.Jw,n=new St((Math.min(e.x,t.x)+Math.max(e.x,t.x))/2,(Math.min(e.y,t.y)+Math.max(e.y,t.y))/2),o*=a.Bw;var g=a.commandHandler;if(o!==a.scale&&g.canResetZoom(o)){var r=a.zoomPoint;a.zoomPoint=n,g.resetZoom(o),a.zoomPoint=r}b.bubbles=!1}St.free(t),St.free(e)},Ti.prototype.doKeyDown=function(){"Esc"===this.diagram.lastInput.key&&this.doCancel()},Ti.prototype.doKeyUp=function(){},Ti.prototype.Ea=function(a){return void 0===a&&(a=this.name),this.transactionResult=null,this.diagram.Ea(a)},Ti.prototype.stopTransaction=function(){var a=this.diagram;return null===this.transactionResult?a.Kf():a.eb(this.transactionResult)},Ti.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.lastInput,t=a.Nl(b.documentPoint,!1);if(null!==t){if(K?b.meta:b.control){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!b.isSelected),a.R("ChangedSelection",a.selection)}else if(b.shift){if(!t.isSelected){for(a.R("ChangingSelection",a.selection),b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!0),a.R("ChangedSelection",a.selection)}}else if(!t.isSelected){for(b=t;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&a.select(b)}}else!b.left||(K?b.meta:b.control)||b.shift||a.clearSelection()}},Ti.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null),void 0===b&&(b=function(a){return!a.layer.isTemporary});var t=this.diagram,e=t.lastInput;return a=t.jc(e.documentPoint,a,b),e.targetObject=a,function(a,b,t){if(b.handled=!1,null===a||a.If()){var e=0;b.left?e=1===b.clickCount?1:2===b.clickCount?2:1:b.right&&1===b.clickCount&&(e=3);var n="ObjectSingleClicked";if(null!==a){switch(e){case 1:n="ObjectSingleClicked";break;case 2:n="ObjectDoubleClicked";break;case 3:n="ObjectContextClicked"}0!==e&&t.R(n,a)}else{switch(e){case 1:n="BackgroundSingleClicked";break;case 2:n="BackgroundDoubleClicked";break;case 3:n="BackgroundContextClicked"}0!==e&&t.R(n)}if(null!==a)for(;null!==a;){switch(t=null,e){case 1:t=a.click;break;case 2:t=a.doubleClick?a.doubleClick:a.click;break;case 3:t=a.contextClick}if(null!==t&&(t(b,a),b.handled))break;a=a.panel}else{switch(a=null,e){case 1:a=t.click;break;case 2:a=t.doubleClick?t.doubleClick:t.click;break;case 3:a=t.contextClick}null!==a&&a(b)}}}(a,e,t),e.handled},Ti.prototype.standardMouseOver=function(){var a=this.diagram,b=a.lastInput;if(!0!==a.animationManager.Ab){var t=a.skipsUndoManager;a.skipsUndoManager=!0;var e=a.viewportBounds.ca(b.documentPoint)?a.jc(b.documentPoint,null,null):null;!b.event||"pointercancel"!==b.event.type&&"pointerout"!==b.event.type||(e=null),b.targetObject=e;var n=!1;if(e!==a.Bk){var o=a.Bk,g=o;for(a.Bk=e,this.doCurrentObjectChanged(o,e),b.handled=!1;null!==o;){var r=o.mouseLeave;if(null!==r){if(e===o)break;if(null!==e&&e.rg(o))break;if(r(b,o,e),n=!0,b.handled)break}o=o.panel}for(o=g,b.handled=!1;null!==e;){if(null!==(g=e.mouseEnter)){if(o===e)break;if(null!==o&&o.rg(e))break;if(g(b,e,o),n=!0,b.handled)break}e=e.panel}e=a.Bk}if(null!==e){for(o=e,g="";null!==o&&""===(g=o.cursor);)o=o.panel;for(a.currentCursor=g,b.handled=!1,o=e;null!==o&&(null===(e=o.mouseOver)||(e(b,o),n=!0,!b.handled));)o=o.panel}else this.doUpdateCursor(null),null!==(e=a.mouseOver)&&(e(b),n=!0);n&&a.ac(),a.skipsUndoManager=t}},Ti.prototype.doUpdateCursor=function(){var a=this.diagram;a&&(a.currentCursor="")},Ti.prototype.doCurrentObjectChanged=function(){},Ti.prototype.standardMouseWheel=function(){var a=this.diagram,b=a.lastInput,t=b.delta;if(0!==t&&a.documentBounds.w()){var e=a.commandHandler,n=a.toolManager.mouseWheelBehavior;if(null!==e&&(n===Oi&&!b.shift||n===Fi&&b.control))(0<t?e.canIncreaseZoom():e.canDecreaseZoom())&&(n=a.zoomPoint,a.zoomPoint=b.viewPoint,0<t?e.increaseZoom():e.decreaseZoom(),a.zoomPoint=n),b.bubbles=!1;else if(n===Oi&&b.shift||n===Fi&&!b.control){e=a.position.copy();var o=b.event;n=o.deltaMode;var g=o.deltaX;o=o.deltaY;var r="pixel";if(0===g&&0===o||b.shift)!b.shift&&a.allowVerticalScroll?(t=3*t*a.scrollVerticalLineChange,a.scroll(r,0<t?"up":"down",Math.abs(t))):b.shift&&a.allowHorizontalScroll&&(t=3*t*a.scrollHorizontalLineChange,a.scroll(r,0<t?"left":"right",Math.abs(t)));else{switch(n){case 0:r="pixel";break;case 1:r="line";break;case 2:r="page"}0!==g&&a.allowHorizontalScroll&&(g*=a.scrollHorizontalLineChange/16,a.scroll(r,0<g?"right":"left",Math.abs(g))),0!==o&&a.allowVerticalScroll&&(o*=a.scrollVerticalLineChange/16,a.scroll(r,0<o?"down":"up",Math.abs(o)))}this.doWheelChange(a,e,b)}}},Ti.prototype.doWheelChange=function(a,b,t){a.position.D(b)&&0===t.event.wheelDeltaX||(t.bubbles=!1)},Ti.prototype.standardWaitAfter=function(a,b){void 0===b&&(b=this.diagram.lastInput),this.cancelWaitAfter();var t=this,e=b.clone(this.yy);this.Yr=N((function(){t.doWaitAfter(e)}),a)},Ti.prototype.cancelWaitAfter=function(){-1!==this.Yr&&M.clearTimeout(this.Yr),this.Yr=-1},Ti.prototype.doWaitAfter=function(){},Ti.prototype.findToolHandleAt=function(a,b){return null===(a=this.diagram.jc(a,(function(a){for(;null!==a&&!(a.panel instanceof hc);)a=a.panel;return a})))?null:a.part.category===b?a:null},Ti.prototype.isBeyondDragSize=function(a,b){var t=this.diagram;void 0===a&&(a=t.firstInput.viewPoint),void 0===b&&(b=t.lastInput.viewPoint);var e=t.toolManager.dragSize,n=e.width;return e=e.height,t.firstInput.isTouchEvent&&(n+=6,e+=6),Math.abs(b.x-a.x)>n||Math.abs(b.y-a.y)>e},v.Object.defineProperties(Ti.prototype,{diagram:{get:function(){return this.H},set:function(a){a instanceof zo&&(this.H=a)}},name:{get:function(){return this.xa},set:function(a){this.xa=a}},isEnabled:{get:function(){return this.Jd},set:function(a){this.Jd=a}},isActive:{get:function(){return this.nb},set:function(a){this.nb=a}},transactionResult:{get:function(){return this.vm},set:function(a){this.vm=a}}}),Ti.prototype.startTransaction=Ti.prototype.Ea,Ti.className="Tool",y(Li,Ti),Li.prototype.initializeStandardTools=function(){},Li.prototype.updateAdornments=function(a){var b=this.currentToolTip;if(b instanceof hc&&this.Lp===a){var t=b.adornedObject;(null!==a?t.part===a:null===t)?this.showToolTip(b,t):this.hideToolTip()}},Li.prototype.doMouseDown=function(){var a=this.diagram,b=a.lastInput;if(b.isTouchEvent&&this.gestureBehavior===Ii&&(b.bubbles=!1),b.isMultiTouch){if(this.cancelWaitAfter(),this.gestureBehavior===zi)return void(b.bubbles=!0);if(this.gestureBehavior===Ii)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomStart()}for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.M(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseDown()))}1===a.lastInput.button&&(this.mouseWheelBehavior===Fi?this.mouseWheelBehavior=Oi:this.mouseWheelBehavior===Oi&&(this.mouseWheelBehavior=Fi)),this.doActivate(),this.standardWaitAfter(this.holdDelay,b)},Li.prototype.doMouseMove=function(){var a=this.diagram,b=a.lastInput;if(b.isMultiTouch){if(this.gestureBehavior===zi)return void(b.bubbles=!0);if(this.gestureBehavior===Ii)return;if(a.currentTool.canStartMultiTouch())return void a.currentTool.standardPinchZoomMove()}if(this.isActive)for(var t=this.mouseMoveTools.length,e=0;e<t;e++){var n=this.mouseMoveTools.M(e);if(n.diagram=this.diagram,n.canStart())return a.doFocus(),a.currentTool=n,void(a.currentTool===n&&(n.isActive||n.doActivate(),n.doMouseMove()))}Ai(this,a),null===(a=b.event)||"pointermove"!==a.type&&a.cancelable||(b.bubbles=!0)},Li.prototype.doCurrentObjectChanged=function(a,b){null===(a=this.currentToolTip)||null!==b&&a instanceof hc&&(b===a||b.rg(a))||this.hideToolTip()},Li.prototype.doWaitAfter=function(a){var b=this.diagram;null!==b.ta&&(this.doMouseHover(),this.isActive||this.doToolTip(),a.isTouchEvent&&!b.lastInput.handled&&((a=a.copy()).button=2,a.buttons=2,b.lastInput=a,b.pu=!0,b.doMouseUp()))},Li.prototype.doMouseHover=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.jc(b.documentPoint,null,null));var t=b.targetObject;if(null!==t)for(b.handled=!1;null!==t&&(null===(a=this.isActive?t.mouseHold:t.mouseHover)||(a(b,t),!b.handled));)t=t.panel;else null!==(t=this.isActive?a.mouseHold:a.mouseHover)&&t(b)},Li.prototype.doToolTip=function(){var a=this.diagram,b=a.lastInput;if(null===b.targetObject&&(b.targetObject=a.jc(b.documentPoint,null,null)),null!==(b=b.targetObject)){if(!((a=this.currentToolTip)instanceof hc)||b!==a&&!b.rg(a)){for(;null!==b;){if(null!==(a=b.toolTip))return void this.showToolTip(a,b);b=b.panel}this.hideToolTip()}}else null!==(b=a.toolTip)?this.showToolTip(b,null):this.hideToolTip()},Li.prototype.showToolTip=function(a,b){var t=this.diagram;if(a!==this.currentToolTip&&this.hideToolTip(),a instanceof hc){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category="ToolTip",null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.Va(),this.positionToolTip(a,b)}else a instanceof Ln&&a!==this.currentToolTip&&a.show(b,t,this);if(this.currentToolTip=a,-1!==this.zj&&(M.clearTimeout(this.zj),this.zj=-1),0<(a=this.toolTipDuration)&&1/0!==a){var n=this;this.zj=N((function(){n.hideToolTip()}),a)}},Li.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y=t.y+20/b.scale+e.height>n.bottom?t.y-(e.height+5/b.scale):t.y+20/b.scale,t.y<n.y&&(t.y=n.y),a.position=t}},Li.prototype.hideToolTip=function(){-1!==this.zj&&(M.clearTimeout(this.zj),this.zj=-1);var a=this.diagram,b=this.currentToolTip;null!==b&&(b instanceof hc?(a.remove(b),null!==this.Lp&&this.Lp.Jf(b.category),b.data=null,b.adornedObject=null):b instanceof Ln&&null!==b.hide&&b.hide(a,this),this.currentToolTip=null)},Li.prototype.doMouseUp=function(){this.cancelWaitAfter();var a=this.diagram;if(this.isActive)for(var b=this.mouseUpTools.length,t=0;t<b;t++){var e=this.mouseUpTools.M(t);if(e.diagram=this.diagram,e.canStart())return a.doFocus(),a.currentTool=e,void(a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}a.doFocus(),this.doDeactivate()},Li.prototype.doMouseWheel=function(){this.standardMouseWheel()},Li.prototype.doKeyDown=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyDown()},Li.prototype.doKeyUp=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyUp()},Li.prototype.findTool=function(a){for(var b=this.mouseDownTools.length,t=0;t<b;t++){var e=this.mouseDownTools.M(t);if(e.name===a)return e}for(b=this.mouseMoveTools.length,t=0;t<b;t++)if((e=this.mouseMoveTools.M(t)).name===a)return e;for(b=this.mouseUpTools.length,t=0;t<b;t++)if((e=this.mouseUpTools.M(t)).name===a)return e;return null},Li.prototype.replaceTool=function(a,b){null!==b&&(b.diagram=this.diagram);for(var t=this.mouseDownTools.length,e=0;e<t;e++){var n=this.mouseDownTools.M(e);if(n.name===a)return null!==b?this.mouseDownTools.cd(e,b):this.mouseDownTools.mb(e),n}for(t=this.mouseMoveTools.length,e=0;e<t;e++)if((n=this.mouseMoveTools.M(e)).name===a)return null!==b?this.mouseMoveTools.cd(e,b):this.mouseMoveTools.mb(e),n;for(t=this.mouseUpTools.length,e=0;e<t;e++)if((n=this.mouseUpTools.M(e)).name===a)return null!==b?this.mouseUpTools.cd(e,b):this.mouseUpTools.mb(e),n;return null},Li.prototype.gb=function(a,b,t){null!==b&&(b.name=a,b.diagram=this.diagram),this.findTool(a)?this.replaceTool(a,b):null!==b&&t.add(b)},v.Object.defineProperties(Li.prototype,{mouseWheelBehavior:{get:function(){return this.ia},set:function(a){this.ia=a}},gestureBehavior:{get:function(){return this.u},set:function(a){this.u=a}},currentToolTip:{get:function(){return this.j},set:function(a){this.j=a,this.Lp=null!==a&&a instanceof hc?a.adornedPart:null}},mouseDownTools:{get:function(){return this.hb}},mouseMoveTools:{get:function(){return this.ob}},mouseUpTools:{get:function(){return this.Ib}},hoverDelay:{get:function(){return this.V},set:function(a){this.V=a}},holdDelay:{get:function(){return this.F},set:function(a){this.F=a}},dragSize:{get:function(){return this.o},set:function(a){this.o=a.J()}},toolTipDuration:{get:function(){return this.Ha},set:function(a){this.Ha=a}}}),Li.prototype.replaceStandardTool=Li.prototype.gb;var ji,Fi=new W(Li,"WheelScroll",0),Oi=new W(Li,"WheelZoom",1),Bi=new W(Li,"WheelNone",2),Di=new W(Li,"GestureZoom",3),Ii=new W(Li,"GestureCancel",4),zi=new W(Li,"GestureNone",5);function Ri(){Ti.call(this),this.name="Dragging",this.u=this.Sw=this.ob=!0,this.o=this.Ha=this.V=this.Oe=null,this.Xm=this.Ib=!1,this.sl=new St(NaN,NaN),this.Er=new St,this.hb=!0,this.Hk=100,this.Cg=[],this.te=(new at).freeze(),this.ia=new Ds,this.An=null,this.F="copy",this.Oc="",this.Pc="no-drop"}function Ei(a,b){if(a.dragsLink){var t=a.diagram;t.allowRelink&&(t.model.Vj()&&1===b.count&&b.first()instanceof Oc?(a.draggedLink=b.first(),a.draggedLink.canRelinkFrom()&&a.draggedLink.canRelinkTo()&&a.draggedLink.Dj(),a.Oe=t.toolManager.findTool("Relinking"),null===a.Oe&&(a.Oe=new pn,a.Oe.diagram=t),a.Oe.originalLink=a.draggedLink):(a.draggedLink=null,a.Oe=null))}}function Vi(a){var b=a.diagram,t=b.skipsUndoManager;b.skipsUndoManager=!0,Wi(a,b.lastInput,null),b.skipsUndoManager=t,a.Cg.length=0}function Yi(){var a=nn;Xi(a),Ki(a);var b=a.diagram;a.sl.w()&&(b.position=a.sl),b.ug()}function Gi(a,b){if(null===a.copiedParts){var t=a.diagram;if((!b||!t.isReadOnly&&!t.isModelReadOnly)&&null!==a.draggedParts){var e=t.undoManager;for(e.isEnabled&&e.isInTransaction?null!==e.currentTransaction&&0<e.currentTransaction.changes.count&&(t.undoManager.Kf(),t.Ea("Drag")):Ki(a),t.skipsUndoManager=!b,t.partManager.addsToTemporaryLayer=!b,a.startPoint=t.firstInput.documentPoint,b=a.copiesEffectiveCollection?a.draggedParts.Lf():t.selection,b=t.Jj(b,t,!0),t=new Mt,e=a.draggedParts.iterator;e.next();){var n=e.key;if(n.Zc()&&n.canCopy()){var o=b.I(n);null!==o&&(o.location=n.location,o.Va(),t.add(o,a.Pd(o.location)))}}for(b=b.iterator;b.next();)(e=b.value)instanceof Oc&&e.canCopy()&&t.add(e,a.Pd());a.copiedParts=t,Ei(a,t.Lf()),null!==a.draggedLink&&(b=(t=a.draggedLink).routeBounds,Ic(t,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2))),a.doUpdateCursor(null)}}}function Xi(a){var b=a.diagram;if(null!==a.copiedParts){if(b.Hs(a.copiedParts.Lf(),!1),a.copiedParts=null,null!==a.draggedParts)for(var t=a.draggedParts.iterator;t.next();)t.key instanceof Oc&&(t.value.point=new St(0,0));a.doUpdateCursor(null)}b.skipsUndoManager=!1,b.partManager.addsToTemporaryLayer=!1,a.startPoint=b.firstInput.documentPoint}function Ui(a){if(null!==a.draggedLink){if(a.dragsLink&&null!==a.Oe){var b=a.Oe;b.diagram.remove(b.temporaryFromNode),b.diagram.remove(b.temporaryToNode),a.Oe.originalLink=null}a.draggedLink=null,a.Oe=null}}function qi(a,b,t){var e=a.diagram,n=a.startPoint,o=St.alloc();o.assign(e.lastInput.documentPoint),a.moveParts(b,o.re(n),t),St.free(o),!0===e.Gf("temporaryPixelRatio")&&null===e.Yh&&30<e.$w&&(Go(e),e.gk())}function Ki(a){if(null!==a.draggedParts){for(var b=a.diagram,t=a.draggedParts.iterator;t.next();){var e=t.key;e.Zc()&&(e.location=t.value.point)}for(t=a.draggedParts.iterator;t.next();)if((e=t.key)instanceof Oc&&e.suspendsRouting){var n=t.value.point;a.draggedParts.add(e,a.Pd()),Ic(e,-n.x,-n.y)}b.bd()}}function Hi(a,b){var t=a.diagram;a.dragsLink&&(null!==a.draggedLink&&(a.draggedLink.fromNode=null,a.draggedLink.toNode=null),_i(a,!1));var e=a.findDragOverObject(b),n=t.lastInput;n.targetObject=e,a.doUpdateCursor(e);var o=t.skipsUndoManager,g=!1;try{if(t.skipsUndoManager=!0,g=Wi(a,n,e),!a.isActive&&null===nn)return;var r=null!==e?e.part:null;if(null===r||t.handlesDragDropForTopLevelParts&&r.isTopLevel&&!(r instanceof Cc)){var h=t.mouseDragOver;null!==h&&(h(n),g=!0)}if(!a.isActive&&null===nn)return;if(a.doDragOver(b,e),!a.isActive&&null===nn)return}finally{t.skipsUndoManager=o,g&&t.bd()}a.An=e,t.isReadOnly||!t.allowMove&&!t.allowCopy||!t.allowHorizontalScroll&&!t.allowVerticalScroll||t.fs(n.viewPoint)}function Wi(a,b,t){var e=!1,n=a.Cg.length,o=0<n?a.Cg[0]:null;if(t===o)return!1;b.handled=!1;for(var g=0;g<n;g++){var r=a.Cg[g],h=r.mouseDragLeave;if(null!==h&&(h(b,r,t),e=!0,b.handled))break}if(a.Cg.length=0,!a.isActive&&null===nn||null===t)return e;for(b.handled=!1,n=t;null!==n;)a.Cg.push(n),n=Ji(n);for(n=a.Cg.length,t=0;t<n&&(null===(r=(g=a.Cg[t]).mouseDragEnter)||(r(b,g,o),e=!0,!b.handled));t++);return e}function Ji(a){var b=a.panel;return null!==b?b:a instanceof zu&&!(a instanceof Cc)&&(null!==(a=a.containingGroup)&&a.handlesDragDropForMembers)?a:null}function Zi(a,b,t){var e=a.Oe;if(null===e)return null;var n=a.diagram.og(b,e.portGravity,(function(a){return e.findValidLinkablePort(a,t)}));a=St.alloc();var o=1/0,g=null;for(n=n.iterator;n.next();){var r=n.value;if(null!==r.part){var h=r.ga(fe,a);(h=b.Bf(h))<o&&(g=r,o=h)}}return St.free(a),g}function _i(a,b){var t=a.draggedLink;if(null!==t&&!(2>t.pointsCount)){var e=a.diagram;if(!e.isReadOnly){var n=a.Oe;if(null!==n){var o=null,g=null;null===t.fromNode&&(null!==(o=Zi(a,t.i(0),!1))&&(g=o.part));var r=null,h=null;null===t.toNode&&(null!==(r=Zi(a,t.i(t.pointsCount-1),!0))&&(h=r.part)),n.isValidLink(g,o,h,r)?b?(t.defaultFromPoint=t.i(0),t.defaultToPoint=t.i(t.pointsCount-1),t.suspendsRouting=!1,t.fromNode=g,null!==o&&(t.fromPortId=o.portId),t.toNode=h,null!==r&&(t.toPortId=r.portId),t.fromPort!==e.Mx&&e.R("LinkRelinked",t,e.Mx),t.toPort!==e.Nx&&e.R("LinkRelinked",t,e.Nx)):gn(n,g,o,h,r):gn(n,null,null,null,null)}}}}function $i(a,b){var t=a.diagram;a.dragsLink&&_i(a,!0),Vi(a);var e=a.findDragOverObject(b),n=t.lastInput;if(n.targetObject=e,null!==e){n.handled=!1;for(var o=e;null!==o;){var g=o.mouseDrop;if(null!==g&&(g(n,o),n.handled))break;Qi(a,n,o),o=Ji(o)}}else null!==(o=t.mouseDrop)&&o(n);if(a.isActive||null!==nn){for(n=(a.copiedParts||a.draggedParts).iterator;n.next();)(o=n.key)instanceof uc&&o.linksConnected.each((function(a){a.suspendsRouting=!1}));if(a.doDropOnto(b,e),a.isActive||null!==nn){for(a=Ut.alloc(),b=t.selection.iterator;b.next();)(e=b.value)instanceof uc&&tn(t,e,a);Ut.free(a)}}}function Qi(a,b,t){a=a.diagram,t=t.part,!a.handlesDragDropForTopLevelParts||!t.isTopLevel||t instanceof Cc||null!==(t=a.mouseDrop)&&t(b)}function tn(a,b,t){var e=!1;if(t=b.getAvoidableRect(t),a.viewportBounds.Re(t)&&(e=!0),0!==(a=a.Nu(t,(function(a){return a.part}),(function(a){return a instanceof Oc}),!0,(function(a){return a instanceof Oc}),e)).count)for(a=a.iterator;a.next();)!(t=a.value).Td(b)&&t.isAvoiding&&t.bb()}function en(a,b,t,e){if(null===a.copiedParts){var n=a.diagram;if(!n.isReadOnly&&!n.isModelReadOnly){n.skipsUndoManager=!t,n.partManager.addsToTemporaryLayer=!t,a.startPoint=e.documentPoint,t=n.Jj(b,n,!0);var o=Ut.alloc();n=e=1/0;for(var g=-1/0,r=-1/0,h=b.iterator;h.next();){var l=h.value;if(l.isVisible()){var c=l.location;l=c.x,c=c.y,isNaN(l)||isNaN(c)||(l<e&&(e=l),c<n&&(n=c),l>g&&(g=l),c>r&&(r=c))}}for(1/0===e?o.h(0,0,0,0):o.h(e,n,g-e,r-n),e=o.x+o.width/2,n=o.y+o.height/2,Ut.free(o),o=a.Er,g=new Mt,r=St.alloc(),h=b.iterator;h.next();)(l=h.value)instanceof Oc&&l.canCopy()&&(null!==(c=t.I(l))&&(c.points=l.points,Ic(c,o.x-e,o.y-n),c.suspendsRouting=!0,g.add(c,a.Pd())));for(b=b.iterator;b.next();)(l=b.value).Zc()&&l.canCopy()&&(null!==(h=t.I(l))&&(l=l.location,r.h(o.x-(e-l.x),o.y-(n-l.y)),h.location=r,h.Va(),g.add(h,a.Pd(r))));St.free(r),a.copiedParts=g,Ei(a,g.Lf()),null!==a.draggedLink&&(b=(t=a.draggedLink).routeBounds,Ic(t,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2))),a.doUpdateCursor(null)}}}Li.className="ToolManager",Li.WheelScroll=Fi,Li.WheelZoom=Oi,Li.WheelNone=Bi,Li.GestureZoom=Di,Li.GestureCancel=Ii,Li.GestureNone=zi,y(Ri,Ti),Ri.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly&&!a.allowDragOut||!a.allowMove&&!a.allowCopy&&!a.allowDragOut||!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.isTouchEvent&&b.timestamp-a.firstInput.timestamp<this.Hk))&&null!==this.findDraggablePart()},Ri.prototype.findDraggablePart=function(){var a=this.diagram;if(null===(a=a.Nl(a.firstInput.documentPoint,!1)))return null;for(;null!==a&&!a.canSelect();)a=a.containingGroup;return null!==a&&(a.canMove()||a.canCopy())?a:null},Ri.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.Nl(a.firstInput.documentPoint,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.containingGroup;this.currentPart=b,null===this.currentPart||this.currentPart.isSelected||(a.R("ChangingSelection",a.selection),b=a.lastInput,(K?b.meta:b.control)||b.shift||a.clearSelection(!0),this.currentPart.isSelected=!0,a.R("ChangedSelection",a.selection))}}},Ri.prototype.doActivate=function(){var a=this.diagram;this.An=null,null===this.currentPart&&this.standardMouseSelect();var b=this.currentPart;null!==b&&(b.canMove()||b.canCopy())&&(a.Fu(!0),nn=null,this.isActive=!0,this.sl.set(a.position),Ei(this,a.selection),this.Cg.length=0,a.animationManager.Cc(),this.draggedParts=this.computeEffectiveCollection(a.selection,this.dragOptions),this.Sw=this.diagram.layout.isRealtime,this.diagram.layout.isRealtime=!1,a.Ms=!0,!0===a.Gf("temporaryPixelRatio")&&30<a.$w&&Go(a),Sr(a,this.draggedParts),this.Ea("Drag"),this.startPoint=a.firstInput.documentPoint,a.isMouseCaptured=!0,a.allowDragOut&&(this.isDragOutStarted=!0,this.Xm=!1,nn=this,on=this.diagram,this.doSimulatedDragOut()))},Ri.prototype.computeEffectiveCollection=function(a,b){return this.diagram.commandHandler.computeEffectiveCollection(a,b)},Ri.prototype.Pd=function(a){return void 0===a?new ks(ct):this.isGridSnapEnabled?new ks(new St(Math.round(1e3*a.x)/1e3,Math.round(1e3*a.y)/1e3)):new ks(a.copy())},Ri.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;if(this.diagram.layout.isRealtime=this.Sw,a.Fu(!1),a.ug(),Vi(this),Pr(a,this.draggedParts),this.draggedParts=this.currentPart=this.An=null,this.Xm=this.isDragOutStarted=!1,0<ji.count){for(var b=ji,t=b.length,e=0;e<t;e++){var n=b.M(e);Ui(n),Xi(n),Vi(n),n.diagram.ug()}b.clear()}Ui(this),this.sl.h(NaN,NaN),null!==on&&(on.currentCursor=""),nn=on=null,Xi(this),a.isMouseCaptured=!1,a.currentCursor="",a.Ms=!1,this.stopTransaction(),Xo(a,!0)},Ri.prototype.stopTransaction=function(){var a=this.diagram,b=Ti.prototype.stopTransaction.call(this);return b&&null!==a.undoManager.transactionToUndo&&a.undoManager.transactionToUndo.$j(),b},Ri.prototype.doCancel=function(){Xi(this),Ki(this);var a=this.diagram;this.sl.w()&&(a.position=this.sl),this.stopTool()},Ri.prototype.doKeyDown=function(){var a=this.diagram,b=a.lastInput;this.isActive&&("Esc"===b.key?this.doCancel():b.key!==a.previousInput.key&&this.doMouseMove())},Ri.prototype.doKeyUp=function(){this.isActive&&this.doMouseMove()},Ri.prototype.moveParts=function(a,b,t){void 0===t&&(t=!1);var e=this.diagram;null!==e&&wr(e,a,b,this.dragOptions,t)},Ri.prototype.findDragOverObject=function(a){var b=this;return Qo(this.diagram,a,null,(function(a){return null===a?a=!0:a=!!(null===(a=a.part)||a instanceof hc||a.layer.isTemporary||b.draggedParts&&b.draggedParts.contains(a)||b.copiedParts&&b.copiedParts.contains(a)),!a}))},Ri.prototype.doUpdateCursor=function(a){var b=this.diagram;null!==a&&this.An===a||(!this.diagram.currentTool.isActive||this.mayCopy()?b.currentCursor=this.copyCursor:this.mayMove()?b.currentCursor=this.moveCursor:this.mayDragOut()&&(b.currentCursor=this.nodropCursor))},Ri.prototype.doDragOver=function(){},Ri.prototype.doDropOnto=function(){},Ri.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;this.simulatedMouseMove(b.event,b.documentPoint,b.targetDiagram)||null===this.currentPart||null===this.draggedParts||(this.mayCopy()?(Gi(this,!1),Sr(a,this.copiedParts),qi(this,this.copiedParts,!1),Pr(a,this.copiedParts)):this.mayMove()?(Xi(this),qi(this,this.draggedParts,!0)):this.mayDragOut()?(Gi(this,!1),qi(this,this.copiedParts,!1)):Xi(this),Hi(this,a.lastInput.documentPoint))}},Ri.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;if(!this.simulatedMouseUp(b.event,b.documentPoint,b.targetDiagram)){b=!1;var t=this.mayCopy();if(t&&null!==this.copiedParts?(Xi(this),Gi(this,!0),Sr(a,this.copiedParts),qi(this,this.copiedParts,!1),Pr(a,this.copiedParts),null!==this.copiedParts&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0})))):(b=!0,Xi(this),this.mayMove()&&(qi(this,this.draggedParts,!0),Hi(this,a.lastInput.documentPoint))),this.Xm=!0,$i(this,a.lastInput.documentPoint),this.isActive){var e=t?this.copiedParts.Lf():this.draggedParts.Lf();this.copiedParts=null,b&&function(a){if(null!==a.draggedParts)for(var b=a.draggedParts.iterator;b.next();){var t=b.key;t instanceof uc&&(null===(t=t.containingGroup)||null===t.placeholder||a.draggedParts.contains(t)||t.placeholder.v())}}(this),a.Ya(),Pr(a,this.draggedParts),this.transactionResult=t?"Copy":"Move",a.R(t?"SelectionCopied":"SelectionMoved",e)}this.stopTool(),t&&a.R("ChangedSelection",a.selection)}}},Ri.prototype.simulatedMouseMove=function(a,b,t){if(null===nn)return!1;var e=nn.diagram;t instanceof zo||(t=null);var n=on;return t!==n&&(null!==n&&n!==e&&(n.ug(),nn.isDragOutStarted=!1,null!==(n=n.toolManager.findTool("Dragging"))&&n.doSimulatedDragLeave()),on=t,null!==t&&t!==e&&(Yi(),null!==(n=t.toolManager.findTool("Dragging"))&&(ji.contains(n)||ji.add(n),n.doSimulatedDragEnter())),this.doUpdateCursor(null)),!(null===t||t===e||!t.allowDrop||t.isReadOnly||!t.allowInsert)&&(null!==(e=t.toolManager.findTool("Dragging"))&&(null!==a&&(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.np(b),t.lastInput.down=!1,t.lastInput.up=!1,e.doSimulatedDragOver()),!0)},Ri.prototype.simulatedMouseUp=function(a,b,t){if(null===nn)return!1;var e=on,n=nn.diagram;if(null===t)return nn.doCancel(),!0;if(t!==e){var o=e.toolManager.findTool("Dragging");if(null!==e&&e!==n&&null!==o)return e.ug(),nn.isDragOutStarted=!1,o.doSimulatedDragLeave(),!1;on=t,null!==(e=t.toolManager.findTool("Dragging"))&&(Yi(),ji.contains(e)||ji.add(e),e.doSimulatedDragEnter())}return t!==this.diagram&&(null!==a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=t.getMouse(a)):null===b&&(b=new St),t.lastInput.documentPoint=b,t.lastInput.viewPoint=t.np(b),t.lastInput.down=!1,t.lastInput.up=!0,null!==(a=t.toolManager.findTool("Dragging"))&&a.doSimulatedDrop(),null!==(a=nn)&&(t=a.mayCopy(),a.transactionResult=t?"Copy":"Move",a.stopTool()),!0)},Ri.prototype.mayCopy=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowCopy||(K?!a.lastInput.alt:!a.lastInput.control))return!1;for(a=a.selection.iterator;a.next();)if(a.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},Ri.prototype.mayDragOut=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(!a.allowDragOut||!a.allowCopy||a.allowMove)return!1;for(a=a.selection.iterator;a.next();)if(a.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())},Ri.prototype.mayMove=function(){var a=this.diagram;if(a.isReadOnly||!a.allowMove)return!1;for(a=a.selection.iterator;a.next();)if(a.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())},Ri.prototype.computeBorder=function(a,b,t){return this.Xm||null===this.draggedParts||this.draggedParts.contains(a)?null:t.assign(b)},Ri.prototype.Az=function(){return nn},Ri.prototype.mayDragIn=function(){var a=this.diagram;if(!a.allowDrop||a.isReadOnly||a.isModelReadOnly||!a.allowInsert)return!1;return null!==nn&&nn.diagram.model.dataFormat===a.model.dataFormat},Ri.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.diagram;a.animationManager.Cc(),lr(a),a.animationManager.Cc(),null!==(a=nn)&&(a.diagram.Ms=!1),this.doUpdateCursor(null)}},Ri.prototype.doSimulatedDragLeave=function(){null!==nn&&nn.doSimulatedDragOut(),this.doCancel()},Ri.prototype.doSimulatedDragOver=function(){var a=this.diagram;a.animationManager.Cm=!0;var b=nn;if(null!==b&&null!==b.draggedParts){if(!this.mayDragIn())return;en(this,b.draggedParts.Lf(),!1,a.firstInput),qi(this,this.copiedParts,!1),Hi(this,a.lastInput.documentPoint)}a.animationManager.Cm=!1},Ri.prototype.doSimulatedDrop=function(){var a=this.diagram,b=nn;if(null!==b){var t=b.diagram;if(b.Xm=!0,Xi(this),!this.mayDragIn())return;a.animationManager.Cm=!0,a.R("ChangingSelection",a.selection),this.Ea("Drop"),en(this,b.draggedParts.Lf(),!0,a.lastInput),qi(this,this.copiedParts,!1);var e=new at;null!==this.copiedParts&&(a.clearSelection(!0),this.copiedParts.iteratorKeys.each((function(a){a.isSelected=!0,e.add(a)}))),$i(this,a.lastInput.documentPoint),a.Ya(),null!==this.copiedParts&&(this.transactionResult="ExternalCopy"),this.copiedParts=null,a.doFocus(),a.R("ExternalObjectsDropped",e,t),this.stopTransaction(),a.R("ChangedSelection",a.selection)}a.animationManager.Cm=!1},Ri.prototype.doSimulatedDragOut=function(){var a=this.diagram;a.Ms=!1,this.mayCopy()||this.mayMove()?a.currentCursor="":a.currentCursor=this.nodropCursor,this.An=null},Ri.prototype.computeMove=function(a,b,t,e){return null!==(t=this.diagram)?t.computeMove(a,b,this.dragOptions,e):new St},v.Object.defineProperties(Ri.prototype,{isCopyEnabled:{get:function(){return this.ob},set:function(a){this.ob=a}},copiesEffectiveCollection:{get:function(){return this.u},set:function(a){this.u=a}},dragOptions:{get:function(){return this.ia},set:function(a){this.ia=a}},isGridSnapEnabled:{get:function(){return this.dragOptions.isGridSnapEnabled},set:function(a){this.dragOptions.isGridSnapEnabled=a}},isComplexRoutingRealtime:{get:function(){return this.hb},set:function(a){this.hb=a}},isGridSnapRealtime:{get:function(){return this.dragOptions.isGridSnapRealtime},set:function(a){this.dragOptions.isGridSnapRealtime=a}},gridSnapCellSize:{get:function(){return this.dragOptions.gridSnapCellSize},set:function(a){this.dragOptions.gridSnapCellSize.D(a)||(a=a.J(),this.dragOptions.gridSnapCellSize=a)}},gridSnapCellSpot:{get:function(){return this.dragOptions.gridSnapCellSpot},set:function(a){this.dragOptions.gridSnapCellSpot.D(a)||(a=a.J(),this.dragOptions.gridSnapCellSpot=a)}},gridSnapOrigin:{get:function(){return this.dragOptions.gridSnapOrigin},set:function(a){this.dragOptions.gridSnapOrigin.D(a)||(a=a.J(),this.dragOptions.gridSnapOrigin=a)}},dragsLink:{get:function(){return this.dragOptions.dragsLink},set:function(a){this.dragOptions.dragsLink=a}},dragsTree:{get:function(){return this.dragOptions.dragsTree},set:function(a){this.dragOptions.dragsTree=a}},copyCursor:{get:function(){return this.F},set:function(a){this.F=a}},moveCursor:{get:function(){return this.Oc},set:function(a){this.Oc=a}},nodropCursor:{get:function(){return this.Pc},set:function(a){this.Pc=a}},currentPart:{get:function(){return this.V},set:function(a){this.V=a}},copiedParts:{get:function(){return this.o},set:function(a){this.o=a}},draggedParts:{get:function(){return this.Ha},set:function(a){this.Ha=a}},draggingParts:{get:function(){return null!==this.copiedParts?this.copiedParts.Lf():null!==this.draggedParts?this.draggedParts.Lf():this.te}},draggedLink:{get:function(){return this.diagram.draggedLink},set:function(a){this.diagram.draggedLink=a}},isDragOutStarted:{get:function(){return this.Ib},set:function(a){this.Ib=a}},startPoint:{get:function(){return this.Er},set:function(a){this.Er.D(a)||this.Er.assign(a)}},delay:{get:function(){return this.Hk},set:function(a){this.Hk=a}}}),Ri.prototype.getDraggingSource=Ri.prototype.Az;var nn=null,on=null;function rn(){Ti.call(this),this.te=100,this.Ha=!1,this.u="pointer";var a=new Oc,b=new Ll;b.isPanelMain=!0,b.stroke="blue",a.add(b),(b=new Ll).toArrow="Standard",b.fill="blue",b.stroke="blue",a.add(b),a.layerName="Tool",this.Ci=a,a=new uc,(b=new Ll).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Ot,a.add(b),a.selectable=!1,a.layerName="Tool",this.Bi=a,this.j=b,a=new uc,(b=new Ll).portId="",b.figure="Rectangle",b.fill=null,b.stroke="magenta",b.strokeWidth=2,b.desiredSize=Ot,a.add(b),a.selectable=!1,a.layerName="Tool",this.Di=a,this.o=b,this.Pc=this.Oc=this.ob=this.hb=this.Ib=null,this.ia=!0,this.hy=new Mt,this.Of=this.gj=this.Pf=null}function sn(a,b,t,e){if(b===t)return!0;var n=b.fromNode;return!(null===n||!n.isLinkLabel||(e.add(n),!sn(a,n.labeledLink,t,e)))||!(null===(b=b.toNode)||!b.isLinkLabel||(e.add(b),!sn(a,b.labeledLink,t,e)))}function an(a,b,t,e,n){if(b===t)return!0;if(null===b||null===t)return!1;for(var o=b.linksConnected;o.next();){var g=o.value;if(g!==e&&(!n||g.isTreeLink)&&g.toNode===b&&((g=g.fromNode)!==b&&an(a,g,t,e,n)))return!0}return!1}function hn(a,b,t,e,n){if(t===e)return!0;if(null===t||null===e||b.contains(t))return!1;b.add(t);for(var o=t.linksConnected;o.next();){var g=o.value;if(g!==n&&g.toNode===t&&((g=g.fromNode)!==t&&hn(a,b,g,e,n)))return!0}return!1}function ln(a,b,t,e,n){if(t===e)return!0;if(null===t||null===e||b.contains(t))return!1;b.add(t);for(var o=t.linksConnected;o.next();){var g=o.value;if(g!==n){var r=g.fromNode;if(g=g.toNode,(r=r===t?g:r)!==t&&ln(a,b,r,e,n))return!0}}return!1}function un(){rn.call(this),this.name="Linking",this.V={},this.F=null,this.K=cn,this.Xd=null}Ri.className="DraggingTool",ji=new ot,G("draggingTool",(function(){return this.findTool("Dragging")}),(function(a){this.gb("Dragging",a,this.mouseMoveTools)})),Li.prototype.doCancel=function(){null!==nn&&nn.doCancel(),Ti.prototype.doCancel.call(this)},y(rn,Ti),rn.prototype.doStop=function(){this.diagram.ug(),this.originalToPort=this.originalToNode=this.originalFromPort=this.originalFromNode=this.originalLink=null,this.validPortsCache.clear(),this.targetPort=null},rn.prototype.copyPortProperties=function(a,b,t,e,n){if(null!==a&&null!==b&&null!==t&&null!==e){var o=b.Df(),g=Vt.alloc();g.width=b.naturalBounds.width*o,g.height=b.naturalBounds.height*o,e.desiredSize=g,Vt.free(g),n?(e.toSpot=b.toSpot,e.toEndSegmentLength=b.toEndSegmentLength):(e.fromSpot=b.fromSpot,e.fromEndSegmentLength=b.fromEndSegmentLength),t.locationSpot=fe,o=St.alloc(),t.location=b.ga(fe,o),St.free(o),e.angle=b.li(),null!==this.portTargeted&&this.portTargeted(a,b,t,e,n)}},rn.prototype.setNoTargetPortProperties=function(a,b,t){null!==b&&(b.desiredSize=Ot,b.fromSpot=ae,b.toSpot=ae),null!==a&&(a.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,a,b,t)},rn.prototype.doMouseDown=function(){this.isActive&&this.doMouseMove()},rn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof uc){var b=this.targetPort.part;this.isForwards?this.copyPortProperties(b,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(b,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.fs(a.lastInput.viewPoint)}},rn.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var t=a.part;if(!(t instanceof uc))return null;for(;null!==a;){var e=b?a.toLinkable:a.fromLinkable;if(!0===e&&(null!==a.portId||a instanceof uc)&&(b?this.isValidTo(t,a):this.isValidFrom(t,a)))return a;if(!1===e)break;a=a.panel}return null},rn.prototype.findTargetPort=function(a){var b=this.diagram,t=b.lastInput.documentPoint,e=this.portGravity;0>=e&&(e=.1);var n=this,o=b.og(t,e,(function(b){return n.findValidLinkablePort(b,a)}),null,!0);for(e=1/0,b=null,o=o.iterator;o.next();){var g=o.value,r=g.part;if(r instanceof uc){var h=g.ga(fe,St.alloc()),l=t.x-h.x,c=t.y-h.y;St.free(h),(h=l*l+c*c)<e&&(null!==(l=this.validPortsCache.I(g))?l&&(b=g,e=h):a&&this.isValidLink(this.originalFromNode,this.originalFromPort,r,g)||!a&&this.isValidLink(r,g,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(g,!0),b=g,e=h):this.validPortsCache.add(g,!1))}}return null!==b&&((t=b.part)instanceof uc&&(null===t.layer||t.layer.allowLink))?b:null},rn.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.fromLinkable))return!1;var t=b.fromMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalFromNode&&b===this.originalFromPort)return!0;if(null===(b=b.portId)&&(b=""),a.Lo(b).count>=t)return!1}return!0},rn.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.toLinkable))return!1;var t=b.toMaxLinks;if(1/0>t){if(null!==this.originalLink&&a===this.originalToNode&&b===this.originalToPort)return!0;if(null===(b=b.portId)&&(b=""),a.Sd(b).count>=t)return!1}return!0},rn.prototype.isInSameNode=function(a,b){return null!==a&&null!==b&&(a===b||(a=a.part,b=b.part,null!==a&&a===b))},rn.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var t=a.part;if(!(t instanceof uc))return!1;null===(a=a.portId)&&(a="");var e=b.part;if(!(e instanceof uc))return!1;for(null===(b=b.portId)&&(b=""),b=e.Sd(b);b.next();)if((e=b.value).fromNode===t&&e.fromPortId===a)return!0;return!1},rn.prototype.isValidLink=function(a,b,t,e){if(!this.isValidFrom(a,b)||!this.isValidTo(t,e)||!(null===b||null===e||(b.fromLinkableSelfNode&&e.toLinkableSelfNode||!this.isInSameNode(b,e))&&(b.fromLinkableDuplicates&&e.toLinkableDuplicates||!this.isLinked(b,e)))||null!==this.originalLink&&(null!==a&&this.isLabelDependentOnLink(a,this.originalLink)||null!==t&&this.isLabelDependentOnLink(t,this.originalLink))||null!==a&&null!==t&&(null===a.data&&null!==t.data||null!==a.data&&null===t.data)||!this.isValidCycle(a,t,this.originalLink))return!1;if(null!==a){var n=a.linkValidation;if(null!==n&&!n(a,b,t,e,this.originalLink))return!1}return!(null!==t&&null!==(n=t.linkValidation)&&!n(a,b,t,e,this.originalLink))&&(null===(n=this.linkValidation)||n(a,b,t,e,this.originalLink))},rn.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var t=a.labeledLink;if(null===t)return!1;if(t===b)return!0;var e=new at;return e.add(a),sn(this,t,b,e)},rn.prototype.isValidCycle=function(a,b,t){if(void 0===t&&(t=null),null===a||null===b)return this.isUnconnectedLinkValid;var e=this.diagram.validCycle;if(e!==os){if(e===hs){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=b.linksConnected;e.next();){var n=e.value;if(n!==t&&n.isTreeLink&&n.toNode===b)return!1}return!an(this,a,b,t,!0)}if(e===ls){if(null!==(e=t||this.temporaryLink)&&!e.isTreeLink)return!0;for(e=a.linksConnected;e.next();)if((n=e.value)!==t&&n.isTreeLink&&n.fromNode===a)return!1;return!an(this,a,b,t,!0)}if(e===rs)return a===b?a=!0:((e=new at).add(b),a=hn(this,e,a,b,t)),!a;if(e===ss)return!an(this,a,b,t,!1);if(e===as)return a===b?a=!0:((e=new at).add(b),a=ln(this,e,a,b,t)),!a}return!0},v.Object.defineProperties(rn.prototype,{portGravity:{get:function(){return this.te},set:function(a){0<=a&&(this.te=a)}},isUnconnectedLinkValid:{get:function(){return this.Ha},set:function(a){this.Ha=a}},linkingCursor:{get:function(){return this.u},set:function(a){this.u=a}},temporaryLink:{get:function(){return this.Ci},set:function(a){this.Ci=a}},temporaryFromNode:{get:function(){return this.Bi},set:function(a){(this.Bi=a)&&(this.j=a.port)}},temporaryFromPort:{get:function(){return this.j},set:function(a){if(null!==this.j){var b=this.j.panel;if(null!==b){var t=b.O.indexOf(this.j);b.mb(t),b.Hb(t,a)}}this.j=a}},temporaryToNode:{get:function(){return this.Di},set:function(a){(this.Di=a)&&(this.o=a.port)}},temporaryToPort:{get:function(){return this.o},set:function(a){if(null!==this.o){var b=this.o.panel;if(null!==b){var t=b.O.indexOf(this.o);b.mb(t),b.Hb(t,a)}}this.o=a}},originalLink:{get:function(){return this.Ib},set:function(a){this.Ib=a}},originalFromNode:{get:function(){return this.hb},set:function(a){this.hb=a}},originalFromPort:{get:function(){return this.ob},set:function(a){this.ob=a}},originalToNode:{get:function(){return this.Oc},set:function(a){this.Oc=a}},originalToPort:{get:function(){return this.Pc},set:function(a){this.Pc=a}},isForwards:{get:function(){return this.ia},set:function(a){this.ia=a}},validPortsCache:{get:function(){return this.hy}},targetPort:{get:function(){return this.Pf},set:function(a){this.Pf=a}},linkValidation:{get:function(){return this.gj},set:function(a){this.gj=a}},portTargeted:{get:function(){return this.Of},set:function(a){this.Of=a}}}),rn.className="LinkingBaseTool",y(un,rn),un.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowLink||!a.model.ws()||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()},un.prototype.findLinkablePort=function(){var a=this.diagram,b=this.startObject;if(null===b&&(b=a.jc(a.firstInput.documentPoint,null,null)),null===b)return null;if(!((a=b.part)instanceof uc))return null;var t=this.direction;if(t===cn||t===fn){var e=this.findValidLinkablePort(b,!1);if(null!==e||this.startObject===a&&(e=a.port,this.findValidLinkablePort(e,!1)))return this.isForwards=!0,e}return(t===cn||t===dn)&&(null!==(b=this.findValidLinkablePort(b,!0))||this.startObject===a&&(b=a.port,this.findValidLinkablePort(b,!0)))?(this.isForwards=!1,b):null},un.prototype.doActivate=function(){var a=this.diagram,b=this.findLinkablePort();null===b?this.stopTool():(this.Ea(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.isForwards?(null!==this.temporaryToNode&&(this.temporaryToNode.location=a.lastInput.documentPoint),this.originalFromPort=b,(b=this.originalFromPort.part)instanceof uc&&(this.originalFromNode=b),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)):(null!==this.temporaryFromNode&&(this.temporaryFromNode.location=a.lastInput.documentPoint),this.originalToPort=b,(b=this.originalToPort.part)instanceof uc&&(this.originalToNode=b),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)),a.add(this.temporaryFromNode),this.temporaryFromNode&&this.temporaryFromNode.Va(),a.add(this.temporaryToNode),this.temporaryToNode&&this.temporaryToNode.Va(),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.bb(),a.add(this.temporaryLink)),this.isActive=!0)},un.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.stopTransaction()},un.prototype.doStop=function(){rn.prototype.doStop.call(this),this.startObject=null},un.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=this.transactionResult=null,t=null,e=null,n=null,o=null;try{var g=this.targetPort=this.findTargetPort(this.isForwards);if(null!==g){var r=g.part;r instanceof uc&&(this.isForwards?(null!==this.originalFromNode&&(b=this.originalFromNode,t=this.originalFromPort),e=r,n=g):(b=r,t=g,null!==this.originalToNode&&(e=this.originalToNode,n=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(b=this.originalFromNode,t=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(e=this.originalToNode,n=this.originalToPort);null!==b||null!==e?null!==(o=this.insertLink(b,t,e,n))?(null===g&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint),a.allowSelect&&(a.R("ChangingSelection",a.selection),a.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,a.R("LinkDrawn",o)):this.doNoLink(b,t,e,n):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&a.allowSelect&&a.R("ChangedSelection",a.selection)}}},un.prototype.isNewTreeLink=function(){var a=this.archetypeLinkData;if(null===a)return!0;if(a instanceof Oc)return a.isTreeLink;var b=this.diagram;return null===b||(a=b.partManager.getLinkCategoryForData(a),null===(b=b.partManager.findLinkTemplateForCategory(a))||b.isTreeLink)},un.prototype.insertLink=function(a,b,t,e){return this.diagram.partManager.insertLink(a,b,t,e)},un.prototype.doNoLink=function(){},v.Object.defineProperties(un.prototype,{archetypeLinkData:{get:function(){return this.V},set:function(a){this.V=a}},archetypeLabelNodeData:{get:function(){return this.F},set:function(a){this.F=a}},direction:{get:function(){return this.K},set:function(a){this.K=a}},startObject:{get:function(){return this.Xd},set:function(a){this.Xd=a}}});var cn=new W(un,"Either",0),fn=new W(un,"ForwardsOnly",0),dn=new W(un,"BackwardsOnly",0);function pn(){rn.call(this),this.name="Relinking";var a=new Ll;a.figure="Diamond",a.desiredSize=Dt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=0,this.V=a,(a=new Ll).figure="Diamond",a.desiredSize=Dt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor=this.linkingCursor,a.segmentIndex=-1,this.Xd=a,this.F=null,this.Ew=new Ut}function gn(a,b,t,e,n){null!==b?(a.copyPortProperties(b,t,a.temporaryFromNode,a.temporaryFromPort,!1),a.diagram.add(a.temporaryFromNode)):a.diagram.remove(a.temporaryFromNode),null!==e?(a.copyPortProperties(e,n,a.temporaryToNode,a.temporaryToPort,!0),a.diagram.add(a.temporaryToNode)):a.diagram.remove(a.temporaryToNode)}function mn(){Ti.call(this),this.name="LinkReshaping";var a=new Ll;a.figure="Rectangle",a.desiredSize=Bt,a.fill="lightblue",a.stroke="dodgerblue",this.o=a,(a=new Ll).figure="Diamond",a.desiredSize=Dt,a.fill="lightblue",a.stroke="dodgerblue",a.cursor="move",this.u=a,this.F=3,this.Ss=this.j=null,this.Fw=new St,this.Xq=new ot}function yn(a,b,t,e,n,o){return o?Math.abs(b.y-t.y)<a.resegmentingDistance&&Math.abs(t.y-e.y)<a.resegmentingDistance&&Math.abs(e.y-n.y)<a.resegmentingDistance:Math.abs(b.x-t.x)<a.resegmentingDistance&&Math.abs(t.x-e.x)<a.resegmentingDistance&&Math.abs(e.x-n.x)<a.resegmentingDistance}un.className="LinkingTool",un.Either=cn,un.ForwardsOnly=fn,un.BackwardsOnly=dn,y(pn,rn),pn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Oc){var b="RelinkFrom",t=null;if(a.isSelected&&!this.diagram.isReadOnly){var e=a.selectionObject;null!==e&&a.canRelinkFrom()&&a.actualBounds.w()&&a.isVisible()&&e.actualBounds.w()&&e.Ed()&&(null===(t=a.Oj(b))&&(t=this.makeAdornment(e,!1),a.bh(b,t)))}null===t&&a.Jf(b),b="RelinkTo",t=null,a.isSelected&&!this.diagram.isReadOnly&&(null!==(e=a.selectionObject)&&a.canRelinkTo()&&a.actualBounds.w()&&a.isVisible()&&e.actualBounds.w()&&e.Ed()&&(null===(t=a.Oj(b))?(t=this.makeAdornment(e,!0),a.bh(b,t)):t.v())),null===t&&a.Jf(b)}},pn.prototype.makeAdornment=function(a,b){var t=new hc;return t.type=Eh.Link,null!==(b=b?this.toHandleArchetype:this.fromHandleArchetype)&&t.add(b.copy()),t.adornedObject=a,t},pn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowRelink||!a.model.ws()||!a.lastInput.left)return!1;var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");return null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo")),null!==b},pn.prototype.doActivate=function(){var a=this.diagram;if(null===this.originalLink){var b=this.handle;if(null===b&&(null===(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom"))&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"))),null===b)return;var t=b.part;if(!(t instanceof hc&&t.adornedPart instanceof Oc))return;this.handle=b,this.isForwards=null===t||"RelinkTo"===t.category,this.originalLink=t.adornedPart}this.Ea(this.name),a.isMouseCaptured=!0,a.currentCursor=this.linkingCursor,this.originalFromPort=this.originalLink.fromPort,this.originalFromNode=this.originalLink.fromNode,this.originalToPort=this.originalLink.toPort,this.originalToNode=this.originalLink.toNode,this.Ew.set(this.originalLink.actualBounds),null!==this.originalLink&&0<this.originalLink.pointsCount&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=Ft),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.i(0))),null===this.originalLink.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=Ft),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.i(this.originalLink.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.bb(),a.add(this.temporaryLink)),this.isActive=!0},pn.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.adjusting=a.adjusting,b.corner=a.corner;var t=a.curve;t!==uf&&t!==lf||(t=af),b.curve=t,b.curviness=a.curviness,b.isTreeLink=a.isTreeLink,b.points=a.points,b.routing=a.routing,b.smoothness=a.smoothness,b.fromSpot=a.fromSpot,b.fromEndSegmentLength=a.fromEndSegmentLength,b.fromShortLength=a.fromShortLength,b.toSpot=a.toSpot,b.toEndSegmentLength=a.toEndSegmentLength,b.toShortLength=a.toShortLength}},pn.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink),a.remove(this.temporaryFromNode),a.remove(this.temporaryToNode),a.isMouseCaptured=!1,a.currentCursor="",this.stopTransaction()},pn.prototype.doStop=function(){rn.prototype.doStop.call(this),this.handle=null},pn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;this.transactionResult=null;var b=this.originalFromNode,t=this.originalFromPort,e=this.originalToNode,n=this.originalToPort,o=this.originalLink;try{if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){var g=this.targetPort.part;g instanceof uc&&(this.isForwards?(e=g,n=this.targetPort):(b=g,t=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?n=e=null:t=b=null:o=null;null!==o?(this.reconnectLink(o,this.isForwards?e:b,this.isForwards?n:t,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=a.lastInput.documentPoint:o.defaultFromPoint=a.lastInput.documentPoint,o.bb()),this.transactionResult=this.name,a.R("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards),this.originalLink.Wo(this.Ew)}finally{this.stopTool()}}},pn.prototype.reconnectLink=function(a,b,t,e){return t=null!==t&&null!==t.portId?t.portId:"",e?(a.toNode=b,a.toPortId=t):(a.fromNode=b,a.fromPortId=t),!0},pn.prototype.doNoRelink=function(){},v.Object.defineProperties(pn.prototype,{fromHandleArchetype:{get:function(){return this.V},set:function(a){this.V=a}},toHandleArchetype:{get:function(){return this.Xd},set:function(a){this.Xd=a}},handle:{get:function(){return this.F},set:function(a){if(null!==a&&!(a.part instanceof hc))throw Error("new handle is not in an Adornment: "+a);this.F=a}}}),pn.className="RelinkingTool",G("linkingTool",(function(){return this.findTool("Linking")}),(function(a){this.gb("Linking",a,this.mouseMoveTools)})),G("relinkingTool",(function(){return this.findTool("Relinking")}),(function(a){this.gb("Relinking",a,this.mouseDownTools)})),y(mn,Ti),mn.prototype.Ru=function(a){return a&&0!==a.reshapingBehavior.value?a.reshapingBehavior:vn},mn.prototype.nm=function(a,b){a.reshapingBehavior=b},mn.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Oc){var b=null;if(a.isSelected&&!this.diagram.isReadOnly){var t=a.path;null!==t&&a.canReshape()&&a.actualBounds.w()&&a.isVisible()&&t.actualBounds.w()&&t.Ed()&&(null===(b=a.Oj(this.name))||b.Aw!==a.pointsCount||b.Uw!==a.resegmentable)&&(null!==(b=this.makeAdornment(t))&&(b.Aw=a.pointsCount,b.Uw=a.resegmentable,a.bh(this.name,b)))}null===b&&a.Jf(this.name)}},mn.prototype.makeAdornment=function(a){var b=a.part,t=b.pointsCount,e=b.isOrthogonal,n=null;if(null!==b.points&&1<t){(n=new hc).type=Eh.Link,t=b.firstPickIndex;var o=b.lastPickIndex,g=e?1:0;if(b.resegmentable&&b.computeCurve()!==hf)for(var r=t+g;r<o-g;r++){var h=this.makeResegmentHandle(a,r);null!==h&&(h.segmentIndex=r,h.segmentFraction=.5,h.fromMaxLinks=999,n.add(h))}for(g=t+1;g<o;g++)if(null!==(r=this.makeHandle(a,g))){if(r.segmentIndex=g,g!==t)if(g===t+1&&e){h=b.i(t);var l=b.i(t+1);$e.B(h.x,l.x)&&$e.B(h.y,l.y)&&(l=b.i(t-1)),$e.B(h.x,l.x)?(this.nm(r,bn),r.cursor="n-resize"):$e.B(h.y,l.y)&&(this.nm(r,xn),r.cursor="w-resize")}else g===o-1&&e?(h=b.i(o-1),l=b.i(o),$e.B(h.x,l.x)&&$e.B(h.y,l.y)&&(h=b.i(o+1)),$e.B(h.x,l.x)?(this.nm(r,bn),r.cursor="n-resize"):$e.B(h.y,l.y)&&(this.nm(r,xn),r.cursor="w-resize")):g!==o&&(this.nm(r,wn),r.cursor="move");n.add(r)}n.adornedObject=a}return n},mn.prototype.makeHandle=function(){var a=this.handleArchetype;return null===a?null:a.copy()},mn.prototype.makeResegmentHandle=function(){var a=this.midHandleArchetype;return null===a?null:a.copy()},mn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowReshape||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},mn.prototype.doActivate=function(){var a=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle){var b=this.handle.part.adornedPart;if(b instanceof Oc){if(this.Ss=b,a.isMouseCaptured=!0,this.Ea(this.name),b.resegmentable&&999===this.handle.fromMaxLinks){var t=b.points.copy(),e=this.getResegmentingPoint();if(t.Hb(this.handle.segmentIndex+1,e),b.isOrthogonal&&t.Hb(this.handle.segmentIndex+1,e),b.points=t,b.Xb(),b.updateAdornments(),this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.Fw=b.i(this.handle.segmentIndex),this.Xq=b.points.copy(),this.isActive=!0}}},mn.prototype.doDeactivate=function(){this.stopTransaction(),this.Ss=this.handle=null,this.isActive=this.diagram.isMouseCaptured=!1},mn.prototype.stopTransaction=function(){var a=this.diagram,b=Ti.prototype.stopTransaction.call(this);return b&&null!==a.undoManager.transactionToUndo&&a.undoManager.transactionToUndo.$j(),b},mn.prototype.doCancel=function(){var a=this.adornedLink;null!==a&&(a.points=this.Xq),this.stopTool()},mn.prototype.getResegmentingPoint=function(){return this.handle.ga(fe)},mn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeReshape(a.lastInput.documentPoint),this.reshape(a))},mn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.computeReshape(a.lastInput.documentPoint);if(this.reshape(b),null!==(b=this.adornedLink)&&b.resegmentable){var t=this.handle.segmentIndex,e=b.i(t-1),n=b.i(t),o=b.i(t+1);if(b.isOrthogonal){if(t>b.firstPickIndex+1&&t<b.lastPickIndex-1){var g=b.i(t-2);if(Math.abs(e.x-n.x)<this.resegmentingDistance&&Math.abs(e.y-n.y)<this.resegmentingDistance&&(yn(this,g,e,n,o,!0)||yn(this,g,e,n,o,!1))){var r=b.points.copy();yn(this,g,e,n,o,!0)?(r.cd(t-2,new St(g.x,(o.y+g.y)/2)),r.cd(t+1,new St(o.x,(o.y+g.y)/2))):(r.cd(t-2,new St((o.x+g.x)/2,g.y)),r.cd(t+1,new St((o.x+g.x)/2,o.y))),r.mb(t),r.mb(t-1),b.points=r,b.Xb()}else g=b.i(t+2),Math.abs(n.x-o.x)<this.resegmentingDistance&&Math.abs(n.y-o.y)<this.resegmentingDistance&&(yn(this,e,n,o,g,!0)||yn(this,e,n,o,g,!1))&&(r=b.points.copy(),yn(this,e,n,o,g,!0)?(r.cd(t-1,new St(e.x,(e.y+g.y)/2)),r.cd(t+2,new St(g.x,(e.y+g.y)/2))):(r.cd(t-1,new St((e.x+g.x)/2,e.y)),r.cd(t+2,new St((e.x+g.x)/2,g.y))),r.mb(t+1),r.mb(t),b.points=r,b.Xb())}}else g=St.alloc(),$e.qh(e.x,e.y,o.x,o.y,n.x,n.y,g)&&g.Bf(n)<this.resegmentingDistance*this.resegmentingDistance&&((e=b.points.copy()).mb(t),b.points=e,b.Xb()),St.free(g)}a.Ya(),this.transactionResult=this.name,a.R("LinkReshaped",this.adornedLink,this.Xq)}this.stopTool()},mn.prototype.reshape=function(a){var b=this.adornedLink;b.uh();var t=this.handle.segmentIndex,e=this.Ru(this.handle);if(b.isOrthogonal)if(t===b.firstPickIndex+1)t=b.firstPickIndex+1,e===bn?(b.L(t,b.i(t-1).x,a.y),b.L(t+1,b.i(t+2).x,a.y)):e===xn&&(b.L(t,a.x,b.i(t-1).y),b.L(t+1,a.x,b.i(t+2).y));else if(t===b.lastPickIndex-1)t=b.lastPickIndex-1,e===bn?(b.L(t-1,b.i(t-2).x,a.y),b.L(t,b.i(t+1).x,a.y)):e===xn&&(b.L(t-1,a.x,b.i(t-2).y),b.L(t,a.x,b.i(t+1).y));else{e=t;var n=b.i(e),o=b.i(e-1),g=b.i(e+1);$e.B(o.x,n.x)&&$e.B(n.y,g.y)?($e.B(o.x,b.i(e-2).x)&&!$e.B(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.L(e-1,a.x,o.y),$e.B(g.y,b.i(e+2).y)&&!$e.B(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.L(e+1,g.x,a.y)):$e.B(o.y,n.y)&&$e.B(n.x,g.x)?($e.B(o.y,b.i(e-2).y)&&!$e.B(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.L(e-1,o.x,a.y),$e.B(g.x,b.i(e+2).x)&&!$e.B(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.L(e+1,a.x,g.y)):$e.B(o.x,n.x)&&$e.B(n.x,g.x)?($e.B(o.x,b.i(e-2).x)&&!$e.B(o.y,b.i(e-2).y)?(b.m(e,a.x,o.y),t++,e++):b.L(e-1,a.x,o.y),$e.B(g.x,b.i(e+2).x)&&!$e.B(g.y,b.i(e+2).y)?b.m(e+1,a.x,g.y):b.L(e+1,a.x,g.y)):$e.B(o.y,n.y)&&$e.B(n.y,g.y)&&($e.B(o.y,b.i(e-2).y)&&!$e.B(o.x,b.i(e-2).x)?(b.m(e,o.x,a.y),t++,e++):b.L(e-1,o.x,a.y),$e.B(g.y,b.i(e+2).y)&&!$e.B(g.x,b.i(e+2).x)?b.m(e+1,g.x,a.y):b.L(e+1,g.x,a.y)),b.L(t,a.x,a.y)}else b.L(t,a.x,a.y),e=b.fromNode,n=b.fromPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),1===t&&b.computeSpot(!0,n).Mc()&&(o=n.ga(fe,St.alloc()),e=b.getLinkPointFromPoint(e,n,o,a,!0,St.alloc()),b.L(0,e.x,e.y),St.free(o),St.free(e)),e=b.toNode,n=b.toPort,null!==e&&(null!==(o=e.findVisibleNode())&&o!==e&&(n=(e=o).port)),t===b.pointsCount-2&&b.computeSpot(!1,n).Mc()&&(t=n.ga(fe,St.alloc()),a=b.getLinkPointFromPoint(e,n,t,a,!1,St.alloc()),b.L(b.pointsCount-1,a.x,a.y),St.free(t),St.free(a));b.zf()},mn.prototype.computeReshape=function(a){var b=this.adornedLink,t=this.handle.segmentIndex;switch(this.Ru(this.handle)){case wn:return a;case bn:return new St(b.i(t).x,a.y);case xn:return new St(a.x,b.i(t).y);default:return b.i(t)}},v.Object.defineProperties(mn.prototype,{handleArchetype:{get:function(){return this.o},set:function(a){this.o=a}},midHandleArchetype:{get:function(){return this.u},set:function(a){this.u=a}},handle:{get:function(){return this.j},set:function(a){if(null!==a&&!(a.part instanceof hc))throw Error("new handle is not in an Adornment: "+a);this.j=a}},adornedLink:{get:function(){return this.Ss}},resegmentingDistance:{get:function(){return this.F},set:function(a){this.F=a}},originalPoint:{get:function(){return this.Fw}},originalPoints:{get:function(){return this.Xq}}}),mn.prototype.setReshapingBehavior=mn.prototype.nm,mn.prototype.getReshapingBehavior=mn.prototype.Ru;var vn=new W(mn,"None",0),xn=new W(mn,"Horizontal",1),bn=new W(mn,"Vertical",2),wn=new W(mn,"All",3);function kn(){Ti.call(this),this.name="Resizing",this.o=new Vt(1,1).freeze(),this.j=new Vt(9999,9999).freeze(),this.yg=new Vt(NaN,NaN).freeze(),this.V=!1,this.ia=!0,this.ue=null;var a=new Ll;a.alignmentFocus=fe,a.figure="Rectangle",a.desiredSize=Bt,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.F=a,this.u=null,this.Wq=new St,this.Dw=new Vt,this.Sn=new St,this.qt=new Vt(0,0),this.pt=new Vt(1/0,1/0),this.ot=new Vt(1,1)}function Mn(){Ti.call(this),this.name="Rotating",this.ia=45,this.V=2,this.Sn=new St,this.ue=null;var a=new Ll;a.figure="Ellipse",a.desiredSize=Dt,a.fill="lightblue",a.stroke="dodgerblue",a.strokeWidth=1,a.cursor="pointer",this.o=a,this.j=null,this.Cw=0,this.jr=new St(NaN,NaN),this.u=0,this.F=50}function Sn(){Ti.call(this),this.name="ClickSelecting"}function Pn(){Ti.call(this),this.name="Action",this.nk=null}function Nn(){Ti.call(this),this.name="ClickCreating",this.Ri=null,this.o=!0,this.j=!1,this.mw=new St(0,0)}function Cn(){Ti.call(this),this.name="DragSelecting",this.Hk=175,this.o=!1;var a=new zu;a.layerName="Tool",a.selectable=!1;var b=new Ll;b.name="SHAPE",b.figure="Rectangle",b.fill=null,b.stroke="magenta",a.add(b),this.j=a}function Tn(){Ti.call(this),this.name="Panning",this.Wt=new St,this.xy=new St,this.xg=!1;var a=this;this.Kw=function(){var b=a.diagram;null!==b&&b.removeEventListener(M.document,"scroll",a.Kw,!1),a.stopTool()}}function Ln(){this.F=this.u=this.j=this.o=null}function An(a,b,t){this.text=a,this.hx=b,this.visible=t}function jn(){Ti.call(this),this.name="ContextMenu",this.o=this.gt=this.j=null,this.yw=new St,this.it=null,this.Dt=!1;var a=this;this.su=function(){a.stopTool()}}function Fn(a){return a.preventDefault(),!1}function On(a){var b=a.diagram;if(a.isActive){var t=a.currentContextMenu;if(null!==t){var e=null;t instanceof Ln||null!==(e=b.jc(b.lastInput.documentPoint,null,null))&&e.rg(t)&&a.standardMouseClick(null,null),a.maybeStopTool(e)}}else a.canStart()&&(Bn(a,!0),a.isActive||a.stopTool())}function Bn(a,b,t){if(void 0===t&&(t=null),!a.Dt&&(a.Dt=!0,b&&a.standardMouseSelect(),b=a.standardMouseClick(),a.Dt=!1,!b)){if(a.isActive=!0,b=Dn,null===t&&(t=a.findObjectWithContextMenu()),null!==t){var e=t.contextMenu;null!==e?(a.currentObject=t instanceof qs?t:null,a.showContextMenu(e,a.currentObject)):null!==b&&a.showContextMenu(b,a.currentObject)}else null!==b&&a.showContextMenu(b,null);a.currentContextMenu instanceof hc&&!a.currentContextMenu.visible&&a.stopTool()}}mn.className="LinkReshapingTool",mn.None=vn,mn.Horizontal=xn,mn.Vertical=bn,mn.All=wn,G("linkReshapingTool",(function(){return this.findTool("LinkReshaping")}),(function(a){this.gb("LinkReshaping",a,this.mouseDownTools)})),y(kn,Ti),kn.prototype.updateAdornments=function(a){if(!(null===a||a instanceof Oc)){if(a.isSelected&&!this.diagram.isReadOnly){var b=a.resizeObject,t=a.Oj(this.name);if(null!==b&&a.canResize()&&a.actualBounds.w()&&a.isVisible()&&b.actualBounds.w()&&b.Ed()&&(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t))return b=b.li(),tc(a)&&this.updateResizeHandles(t,b),void a.bh(this.name,t)}a.Jf(this.name)}},kn.prototype.makeAdornment=function(a){var b=a.part.resizeAdornmentTemplate;if(null===b){(b=new hc).type=Eh.Spot,b.locationSpot=fe;var t=new Fc;t.isPanelMain=!0,b.add(t),b.add(this.makeHandle(a,he)),b.add(this.makeHandle(a,ue)),b.add(this.makeHandle(a,me)),b.add(this.makeHandle(a,pe)),b.add(this.makeHandle(a,ze)),b.add(this.makeHandle(a,Ee)),b.add(this.makeHandle(a,Ve)),b.add(this.makeHandle(a,Re))}else if(al(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},kn.prototype.makeHandle=function(a,b){return null===(a=this.handleArchetype)?null:((a=a.copy()).alignment=b,a)},kn.prototype.updateResizeHandles=function(a,b){if(null!==a)if(!a.alignment.Yb()&&("pointer"===a.cursor||0<a.cursor.indexOf("resize")))t:{var t=a.alignment;if(t.Mc()&&(t=fe),0>=t.x)b=0>=t.y?b+225:1<=t.y?b+135:b+180;else if(1<=t.x)0>=t.y?b+=315:1<=t.y&&(b+=45);else if(0>=t.y)b+=270;else{if(!(1<=t.y))break t;b+=90}0>b?b+=360:360<=b&&(b-=360),a.cursor=22.5>b?"e-resize":67.5>b?"se-resize":112.5>b?"s-resize":157.5>b?"sw-resize":202.5>b?"w-resize":247.5>b?"nw-resize":292.5>b?"n-resize":337.5>b?"ne-resize":"e-resize"}else if(a instanceof Eh)for(a=a.elements;a.next();)this.updateResizeHandles(a.value,b)},kn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowResize||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},kn.prototype.doActivate=function(){var a=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&(a.isMouseCaptured=!0,a.animationManager.Cc(),this.Ea(this.name),this.Wq.set(this.adornedObject.ga(this.handle.alignment.gv())),this.Sn.set(this.adornedObject.part.location),this.Dw.set(this.adornedObject.desiredSize),this.ot=this.computeCellSize(),this.qt=this.computeMinSize(),this.pt=this.computeMaxSize(),this.isActive=!0))},kn.prototype.doDeactivate=function(){var a=this.diagram;this.stopTransaction(),this.ue=this.handle=null,this.isActive=a.isMouseCaptured=!1},kn.prototype.stopTransaction=function(){var a=this.diagram,b=Ti.prototype.stopTransaction.call(this);return b&&null!==a.undoManager.transactionToUndo&&a.undoManager.transactionToUndo.$j(),b},kn.prototype.doCancel=function(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()},kn.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive){var b=this.qt,t=this.pt,e=this.ot,n=this.adornedObject.ps(a.lastInput.documentPoint,St.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),a.bd(),St.free(n)}},kn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.qt,t=this.pt,e=this.ot,n=this.adornedObject.ps(a.lastInput.documentPoint,St.alloc()),o=this.computeReshape();b=this.computeResize(n,this.handle.alignment,b,t,e,o),this.resize(b),St.free(n),a.Ya(),this.transactionResult=this.name,a.R("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()},kn.prototype.resize=function(a){var b=this.diagram,t=this.adornedObject;if(null!==t){if(t.desiredSize=a.size,(a=t.part).Va(),t=t.ga(this.handle.alignment.gv()),a instanceof Cc){var e=new ot;if(e.add(a),!this.dragsMembers&&null===a.placeholder){var n=new Ds;n.dragsMembers=!1}b.moveParts(e,this.oppositePoint.copy().re(t),!0,n)}else a.location=a.location.copy().re(t).add(this.oppositePoint);b.bd()}},kn.prototype.computeResize=function(a,b,t,e,n,o){b.Mc()&&(b=fe);var g=this.adornedObject.naturalBounds,r=g.x,h=g.y,l=g.x+g.width,c=g.y+g.height,f=1;if(!o){f=g.width;var p=g.height;0>=f&&(f=1),0>=p&&(p=1),f=p/f}return p=St.alloc(),$e.Mo(a.x,a.y,r,h,n.width,n.height,p),a=g.copy(),0>=b.x?0>=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width,a.y=c-a.height)):1<=b.y?(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=Math.max(l-a.x,t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.x=l-a.width)):(a.x=Math.max(p.x,l-e.width),a.x=Math.min(a.x,l-t.width),a.width=l-a.x,o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=Math.max(c-a.y,t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width),a.y=c-a.height)):1<=b.y?(a.width=Math.max(Math.min(p.x-r,e.width),t.width),a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(1<=a.height/a.width?(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f):(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width))):(a.width=Math.max(Math.min(p.x-r,e.width),t.width),o||(a.height=Math.max(Math.min(f*a.width,e.height),t.height),a.width=a.height/f,a.y=h+.5*(c-h-a.height))):0>=b.y?(a.y=Math.max(p.y,c-e.height),a.y=Math.min(a.y,c-t.height),a.height=c-a.y,o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))):1<=b.y&&(a.height=Math.max(Math.min(p.y-h,e.height),t.height),o||(a.width=Math.max(Math.min(a.height/f,e.width),t.width),a.height=f*a.width,a.x=r+.5*(l-r-a.width))),St.free(p),a},kn.prototype.computeReshape=function(){var a=Ss;return this.adornedObject instanceof Ll&&(a=Fl(this.adornedObject)),!(a===Ps||this.diagram.lastInput.shift)},kn.prototype.computeMinSize=function(){var a=this.adornedObject.minSize.copy(),b=this.minSize;return!isNaN(b.width)&&b.width>a.width&&(a.width=b.width),!isNaN(b.height)&&b.height>a.height&&(a.height=b.height),a},kn.prototype.computeMaxSize=function(){var a=this.adornedObject.maxSize.copy(),b=this.maxSize;return!isNaN(b.width)&&b.width<a.width&&(a.width=b.width),!isNaN(b.height)&&b.height<a.height&&(a.height=b.height),a},kn.prototype.computeCellSize=function(){var a=new Vt(NaN,NaN),b=this.adornedObject.part;return null!==b&&(b=b.resizeCellSize,!isNaN(b.width)&&0<b.width&&(a.width=b.width),!isNaN(b.height)&&0<b.height&&(a.height=b.height)),b=this.cellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height),b=this.diagram,(isNaN(a.width)||isNaN(a.height))&&b&&(null!==(b=b.grid)&&b.visible&&this.isGridSnapEnabled&&(b=b.gridCellSize,isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height))),(isNaN(a.width)||0===a.width||1/0===a.width)&&(a.width=1),(isNaN(a.height)||0===a.height||1/0===a.height)&&(a.height=1),a},v.Object.defineProperties(kn.prototype,{handleArchetype:{get:function(){return this.F},set:function(a){this.F=a}},handle:{get:function(){return this.u},set:function(a){if(null!==a&&!(a.part instanceof hc))throw Error("new handle is not in an Adornment: "+a);this.u=a}},adornedObject:{get:function(){return this.ue},set:function(a){if(null!==a&&a.part instanceof hc)throw Error("new handle must not be in an Adornment: "+a);this.ue=a}},minSize:{get:function(){return this.o},set:function(a){if(!this.o.D(a)){var b=a.width;isNaN(b)&&(b=0),a=a.height,isNaN(a)&&(a=0),this.o.h(b,a)}}},maxSize:{get:function(){return this.j},set:function(a){if(!this.j.D(a)){var b=a.width;isNaN(b)&&(b=1/0),a=a.height,isNaN(a)&&(a=1/0),this.j.h(b,a)}}},cellSize:{get:function(){return this.yg},set:function(a){this.yg.D(a)||this.yg.assign(a)}},isGridSnapEnabled:{get:function(){return this.V},set:function(a){this.V=a}},dragsMembers:{get:function(){return this.ia},set:function(a){this.ia=a}},oppositePoint:{get:function(){return this.Wq},set:function(a){this.Wq.D(a)||this.Wq.assign(a)}},originalDesiredSize:{get:function(){return this.Dw}},originalLocation:{get:function(){return this.Sn}}}),kn.className="ResizingTool",G("resizingTool",(function(){return this.findTool("Resizing")}),(function(a){this.gb("Resizing",a,this.mouseDownTools)})),y(Mn,Ti),Mn.prototype.updateAdornments=function(a){if(null!==a){if(a.ph()){var b=a.rotateObject;if(b===a||b===a.path||b.isPanelMain)return}if(a.isSelected&&!this.diagram.isReadOnly&&(null!==(b=a.rotateObject)&&a.canRotate()&&a.actualBounds.w()&&a.isVisible()&&b.actualBounds.w()&&b.Ed())){var t=a.Oj(this.name);if(null!==t&&t.adornedObject===b||(t=this.makeAdornment(b)),null!==t)return t.angle=b.li(),null===t.placeholder&&(t.location=this.computeAdornmentLocation(b)),void a.bh(this.name,t)}a.Jf(this.name)}},Mn.prototype.makeAdornment=function(a){var b=a.part.rotateAdornmentTemplate;if(null===b){(b=new hc).type=Eh.Position,b.locationSpot=fe;var t=this.handleArchetype;null!==t&&b.add(t.copy())}else if(al(b),null===(b=b.copy()))return null;return b.adornedObject=a,b},Mn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(a.isReadOnly||!a.allowRotate||!a.lastInput.left)&&null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name)},Mn.prototype.doActivate=function(){var a=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null!==this.adornedObject&&(a.isMouseCaptured=!0,a.delaysLayout=!0,this.Ea(this.name),this.Cw=this.adornedObject.angle,this.jr=this.computeRotationPoint(this.adornedObject),this.Sn=this.adornedObject.part.location.copy(),this.isActive=!0)},Mn.prototype.computeRotationPoint=function(a){var b=a.part,t=b.locationObject;return b.rotationSpot.sb()?a.ga(b.rotationSpot):a===b||a===t?t.ga(b.locationSpot):a.ga(fe)},Mn.prototype.computeAdornmentLocation=function(a){var b=this.rotationPoint;b.w()||(b=this.computeRotationPoint(a)),b=a.ps(b);var t=this.handleAngle;0>t?t+=360:360<=t&&(t-=360),t=Math.round(45*Math.round(t/45));var e=this.handleDistance;return 0===t?b.x=a.naturalBounds.width+e:45===t?(b.x=a.naturalBounds.width+e,b.y=a.naturalBounds.height+e):90===t?b.y=a.naturalBounds.height+e:135===t?(b.x=-e,b.y=a.naturalBounds.height+e):180===t?b.x=-e:225===t?(b.x=-e,b.y=-e):270===t?b.y=-e:315===t&&(b.x=a.naturalBounds.width+e,b.y=-e),a.ga(b)},Mn.prototype.doDeactivate=function(){var a=this.diagram;this.stopTransaction(),this.ue=this.handle=null,this.jr=new St(NaN,NaN),this.isActive=a.isMouseCaptured=!1},Mn.prototype.stopTransaction=function(){var a=this.diagram,b=Ti.prototype.stopTransaction.call(this);return b&&null!==a.undoManager.transactionToUndo&&a.undoManager.transactionToUndo.$j(),b},Mn.prototype.doCancel=function(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()},Mn.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeRotate(a.lastInput.documentPoint),this.rotate(a))},Mn.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){a.delaysLayout=!1;var b=this.computeRotate(a.lastInput.documentPoint);this.rotate(b),a.Ya(),this.transactionResult=this.name,a.R("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()},Mn.prototype.rotate=function(a){var b=this.adornedObject;if(null!==b){b.angle=a,(b=b.part).Va();var t=b.locationObject,e=b.rotateObject;(t===e||t.rg(e))&&(t=this.Sn.copy(),b.location=t.re(this.rotationPoint).rotate(a-this.originalAngle).add(this.rotationPoint)),this.diagram.bd()}},Mn.prototype.computeRotate=function(a){a=this.rotationPoint.ab(a)-this.handleAngle;var b=this.adornedObject.panel;null!==b&&(a-=b.li()),360<=a?a-=360:0>a&&(a+=360),b=Math.min(Math.abs(this.snapAngleMultiple),180);var t=Math.min(Math.abs(this.snapAngleEpsilon),b/2);return!this.diagram.lastInput.shift&&0<b&&0<t&&(a%b<t?a=Math.floor(a/b)*b:a%b>b-t&&(a=(Math.floor(a/b)+1)*b)),360<=a?a-=360:0>a&&(a+=360),a},v.Object.defineProperties(Mn.prototype,{handleArchetype:{get:function(){return this.o},set:function(a){this.o=a}},handle:{get:function(){return this.j},set:function(a){if(null!==a&&!(a.part instanceof hc))throw Error("new handle is not in an Adornment: "+a);this.j=a}},adornedObject:{get:function(){return this.ue},set:function(a){if(null!==a&&a.part instanceof hc)throw Error("new handle must not be in an Adornment: "+a);this.ue=a}},snapAngleMultiple:{get:function(){return this.ia},set:function(a){this.ia=a}},snapAngleEpsilon:{get:function(){return this.V},set:function(a){this.V=a}},originalAngle:{get:function(){return this.Cw}},rotationPoint:{get:function(){return this.jr},set:function(a){this.jr=a.copy()}},handleAngle:{get:function(){return this.u},set:function(a){this.u=a}},handleDistance:{get:function(){return this.F},set:function(a){this.F=a}}}),Mn.className="RotatingTool",G("rotatingTool",(function(){return this.findTool("Rotating")}),(function(a){this.gb("Rotating",a,this.mouseDownTools)})),y(Sn,Ti),Sn.prototype.canStart=function(){return!(!this.isEnabled||this.isBeyondDragSize())},Sn.prototype.doMouseUp=function(){this.isActive&&(this.standardMouseSelect(),!this.standardMouseClick()&&this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()},Sn.className="ClickSelectingTool",y(Pn,Ti),Pn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram,b=a.lastInput,t=a.jc(b.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}));return null!==t&&(!!t.isActionable&&(this.nk=t,a.Bk=a.jc(b.documentPoint,null,null),!0))},Pn.prototype.doMouseDown=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.nk;null!==b&&(a.targetObject=b,null!==b.actionDown&&b.actionDown(a,b))}else this.canStart()&&this.doActivate()},Pn.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.nk;null!==b&&(a.targetObject=b,null!==b.actionMove&&b.actionMove(a,b))}},Pn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.nk;if(null===b)return;a.targetObject=b,null!==b.actionUp&&b.actionUp(a,b),this.standardMouseClick((function(a){for(;null!==a.panel&&(!a.isActionable||a!==b);)a=a.panel;return a}),(function(a){return a===b}))}this.stopTool()},Pn.prototype.doCancel=function(){var a=this.diagram.lastInput,b=this.nk;null!==b&&(a.targetObject=b,null!==b.actionCancel&&b.actionCancel(a,b),this.stopTool())},Pn.prototype.doStop=function(){this.nk=null},Pn.className="ActionTool",y(Nn,Ti),Nn.prototype.canStart=function(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===a.lastInput.clickCount&&(this.mw=a.lastInput.viewPoint.copy()),2!==a.lastInput.clickCount||this.isBeyondDragSize(this.mw))return!1}else if(1!==a.lastInput.clickCount)return!1;return a.currentTool===this||null===a.Nl(a.lastInput.documentPoint,!0)},Nn.prototype.doMouseUp=function(){var a=this.diagram;this.isActive&&this.insertPart(a.lastInput.documentPoint),this.stopTool()},Nn.prototype.insertPart=function(a){var b=this.diagram,t=this.archetypeNodeData;if(null===t)return null;var e=null;try{if(b.R("ChangingSelection",b.selection),this.Ea(this.name),t instanceof zu)t.Zc()&&(al(t),null!==(e=t.copy())&&b.add(e));else if(null!==t){var n=b.model.copyNodeData(t);F(n)&&(b.model.xf(n),e=b.Lc(n))}if(null!==e){var o=St.allocAt(a.x,a.y);this.isGridSnapEnabled&&Mr(this.diagram,e,a,o),e.location=o,b.allowSelect&&(b.clearSelection(!0),e.isSelected=!0),St.free(o)}b.Ya(),this.transactionResult=this.name,b.R("PartCreated",e)}finally{this.stopTransaction(),b.R("ChangedSelection",b.selection)}return e},v.Object.defineProperties(Nn.prototype,{archetypeNodeData:{get:function(){return this.Ri},set:function(a){this.Ri=a}},isDoubleClick:{get:function(){return this.o},set:function(a){this.o=a}},isGridSnapEnabled:{get:function(){return this.j},set:function(a){this.j=a}}}),Nn.className="ClickCreatingTool",y(Cn,Ti),Cn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(!a.allowSelect)return!1;var b=a.lastInput;return!(!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.timestamp-a.firstInput.timestamp<this.delay||null!==a.Nl(b.documentPoint,!0)))},Cn.prototype.doActivate=function(){var a=this.diagram;this.isActive=!0,a.isMouseCaptured=!0,a.skipsUndoManager=!0,a.add(this.box),this.doMouseMove()},Cn.prototype.doDeactivate=function(){var a=this.diagram;a.ug(),a.remove(this.box),a.skipsUndoManager=!1,this.isActive=a.isMouseCaptured=!1},Cn.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive&&null!==this.box){var b=this.computeBoxBounds(),t=this.box.fb("SHAPE");null===t&&(t=this.box.Qb());var e=Vt.alloc().h(b.width,b.height);t.desiredSize=e,this.box.lm(b.x,b.y,!1),Vt.free(e),(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.fs(a.lastInput.viewPoint)}},Cn.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;a.remove(this.box);try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),this.selectInRect(this.computeBoxBounds()),a.R("ChangedSelection",a.selection)}finally{a.currentCursor=""}}this.stopTool()},Cn.prototype.computeBoxBounds=function(){var a=this.diagram;return new Ut(a.firstInput.documentPoint,a.lastInput.documentPoint)},Cn.prototype.selectInRect=function(a){var b=this.diagram,t=b.lastInput;if(a=b.ux(a,this.isPartialInclusion),K?t.meta:t.control)if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected&&(b.isSelected=!1);else for(a=a.iterator;a.next();)(b=a.value).isSelected=!b.isSelected;else if(t.shift)for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0);else{for(t=new ot,b=b.selection.iterator;b.next();){var e=b.value;a.contains(e)||t.add(e)}for(b=t.iterator;b.next();)b.value.isSelected=!1;for(a=a.iterator;a.next();)(b=a.value).isSelected||(b.isSelected=!0)}},v.Object.defineProperties(Cn.prototype,{delay:{get:function(){return this.Hk},set:function(a){this.Hk=a}},isPartialInclusion:{get:function(){return this.o},set:function(a){this.o=a}},box:{get:function(){return this.j},set:function(a){this.j=a}}}),Cn.className="DragSelectingTool",y(Tn,Ti),Tn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(!a.allowHorizontalScroll&&!a.allowVerticalScroll||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize())},Tn.prototype.doActivate=function(){var a=this.diagram;this.xg?(a.lastInput.bubbles=!0,a.addEventListener(M.document,"scroll",this.Kw,!1)):(a.currentCursor="move",a.isMouseCaptured=!0,this.Wt.assign(a.position)),this.isActive=!0},Tn.prototype.doDeactivate=function(){var a=this.diagram;a.currentCursor="",this.isActive=a.isMouseCaptured=!1},Tn.prototype.doCancel=function(){var a=this.diagram;a.position=this.Wt,a.isMouseCaptured=!1,this.stopTool()},Tn.prototype.doMouseMove=function(){this.move()},Tn.prototype.doMouseUp=function(){this.move(),this.stopTool()},Tn.prototype.move=function(){var a=this.diagram;if(this.isActive&&a)if(this.xg)a.lastInput.bubbles=!0;else{var b=a.position,t=a.firstInput.documentPoint,e=a.lastInput.documentPoint,n=b.x+t.x-e.x;t=b.y+t.y-e.y,a.allowHorizontalScroll||(n=b.x),a.allowVerticalScroll||(t=b.y),a.position=this.xy.h(n,t)}},v.Object.defineProperties(Tn.prototype,{bubbles:{get:function(){return this.xg},set:function(a){this.xg=a}},originalPosition:{get:function(){return this.Wt}}}),Tn.className="PanningTool",G("clickCreatingTool",(function(){return this.findTool("ClickCreating")}),(function(a){this.gb("ClickCreating",a,this.mouseUpTools)})),G("clickSelectingTool",(function(){return this.findTool("ClickSelecting")}),(function(a){this.gb("ClickSelecting",a,this.mouseUpTools)})),G("panningTool",(function(){return this.findTool("Panning")}),(function(a){this.gb("Panning",a,this.mouseMoveTools)})),G("dragSelectingTool",(function(){return this.findTool("DragSelecting")}),(function(a){this.gb("DragSelecting",a,this.mouseMoveTools)})),G("actionTool",(function(){return this.findTool("Action")}),(function(a){this.gb("Action",a,this.mouseDownTools)})),v.Object.defineProperties(Ln.prototype,{mainElement:{get:function(){return this.u},set:function(a){this.u=a}},show:{get:function(){return this.o},set:function(a){this.o!==a&&(this.o=a)}},hide:{get:function(){return this.j},set:function(a){this.j!==a&&(this.j=a)}},valueFunction:{get:function(){return this.F},set:function(a){this.F=a}}}),Ln.className="HTMLInfo",An.className="ContextMenuButtonInfo",y(jn,Ti),jn.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!(this.isBeyondDragSize()||!a.lastInput.right||1<a.lastInput.clickCount)&&!!(a.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())},jn.prototype.doStart=function(){this.yw.set(this.diagram.firstInput.documentPoint)},jn.prototype.doStop=function(){this.hideContextMenu(),this.currentObject=null},jn.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.lastInput,e=null;if(a instanceof zo||(e=a instanceof qs?a:b.jc(t.documentPoint,null,(function(a){return!a.layer.isTemporary}))),null!==e){for(a=e;null!==a;){if(null!==a.contextMenu)return a;a=a.panel}if(b.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return e.part}else if(null!==b.contextMenu)return b;return null},jn.prototype.doActivate=function(){},jn.prototype.doMouseDown=function(){if(Ti.prototype.doMouseDown.call(this),this.isActive&&this.currentContextMenu instanceof hc){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doMouseDown(),a.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&On(this)},jn.prototype.doMouseUp=function(){if(this.isActive&&this.currentContextMenu instanceof hc){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doCancel(),a.doDeactivate())}On(this)},jn.prototype.maybeStopTool=function(){this.stopTool(),this.canStart()&&(this.diagram.currentTool=this,this.doMouseUp())},jn.prototype.doMouseMove=function(){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()},jn.prototype.showContextMenu=function(a,b){var t=this.diagram;if(a!==this.currentContextMenu&&this.hideContextMenu(),a instanceof hc){a.layerName="Tool",a.selectable=!1,a.scale=1/t.scale,a.category=this.name,null!==a.placeholder&&(a.placeholder.scale=t.scale);var e=a.diagram;null!==e&&e!==t&&e.remove(a),t.add(a),null!==b?a.adornedObject=b:a.data=t.model,a.Va(),this.positionContextMenu(a,b)}else a instanceof Ln&&a.show(b,t,this);this.currentContextMenu=a},jn.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.diagram,t=b.lastInput.documentPoint.copy(),e=a.measuredBounds,n=b.viewportBounds;b.lastInput.isTouchEvent&&(t.x-=e.width),t.x+e.width>n.right&&(t.x-=e.width+5/b.scale),t.x<n.x&&(t.x=n.x),t.y+e.height>n.bottom&&(t.y-=e.height+5/b.scale),t.y<n.y&&(t.y=n.y),a.position=t}},jn.prototype.hideContextMenu=function(){var a=this.diagram,b=this.currentContextMenu;null!==b&&(b instanceof hc?(a.remove(b),null!==this.gt&&this.gt.Jf(b.category),b.data=null,b.adornedObject=null):b instanceof Ln&&(null!==b.hide?b.hide(a,this):null!==b.mainElement&&(b.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())},jn.prototype.showDefaultContextMenu=function(){var a=this.diagram;null===this.it&&(this.it=function(a){var b=new ot;return b.add(new An("Copy",(function(a){a.commandHandler.copySelection()}),(function(a){return a.commandHandler.canCopySelection()}))),b.add(new An("Cut",(function(a){a.commandHandler.cutSelection()}),(function(a){return a.commandHandler.canCutSelection()}))),b.add(new An("Delete",(function(a){a.commandHandler.deleteSelection()}),(function(a){return a.commandHandler.canDeleteSelection()}))),b.add(new An("Paste",(function(b){b.commandHandler.pasteSelection(a.mouseDownPoint)}),(function(b){return b.commandHandler.canPasteSelection(a.mouseDownPoint)}))),b.add(new An("Select All",(function(a){a.commandHandler.selectAll()}),(function(a){return a.commandHandler.canSelectAll()}))),b.add(new An("Undo",(function(a){a.commandHandler.undo()}),(function(a){return a.commandHandler.canUndo()}))),b.add(new An("Redo",(function(a){a.commandHandler.redo()}),(function(a){return a.commandHandler.canRedo()}))),b.add(new An("Scroll To Part",(function(a){a.commandHandler.scrollToPart()}),(function(a){return a.commandHandler.canScrollToPart()}))),b.add(new An("Zoom To Fit",(function(a){a.commandHandler.zoomToFit()}),(function(a){return a.commandHandler.canZoomToFit()}))),b.add(new An("Reset Zoom",(function(a){a.commandHandler.resetZoom()}),(function(a){return a.commandHandler.canResetZoom()}))),b.add(new An("Group Selection",(function(a){a.commandHandler.groupSelection()}),(function(a){return a.commandHandler.canGroupSelection()}))),b.add(new An("Ungroup Selection",(function(a){a.commandHandler.ungroupSelection()}),(function(a){return a.commandHandler.canUngroupSelection()}))),b.add(new An("Edit Text",(function(a){a.commandHandler.editTextBlock()}),(function(a){return a.commandHandler.canEditTextBlock()}))),b}(this)),Rn.innerHTML="",zn.addEventListener("pointerdown",this.su,!1);var b=this,t=C("ul");t.className="goCXul",Rn.appendChild(t),t.innerHTML="";for(var e=this.it.iterator;e.next();){var n=e.value,o=n.visible;if("function"==typeof n.hx&&("function"!=typeof o||o(a))){(o=C("li")).className="goCXli";var g=C("a");g.className="goCXa",g.href="#",g.ky=n.hx,g.addEventListener("pointerdown",(function(t){return this.ky(a),b.stopTool(),t.preventDefault(),!1}),!1),g.textContent=n.text,o.appendChild(g),t.appendChild(o)}}Rn.style.display="block",zn.style.display="block"},jn.prototype.hideDefaultContextMenu=function(){if(null!==this.currentContextMenu&&this.currentContextMenu===Dn){Rn.style.display="none",zn.style.display="none";var a=this.diagram;null!==a&&a.removeEventListener(zn,"pointerdown",this.su,!1),this.currentContextMenu=null}},v.Object.defineProperties(jn.prototype,{currentContextMenu:{get:function(){return this.j},set:function(a){this.j=a,this.gt=a instanceof hc?a.adornedPart:null}},defaultTouchContextMenu:{get:function(){return!1===In&&null===Dn&&$r&&function(a){var b=new Ln;b.show=function(a,b,t){t.showDefaultContextMenu()},b.hide=function(a,b){b.hideDefaultContextMenu()},Dn=b,a.su=function(){a.stopTool()},b=C("div");var t=C("div");b.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",t.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";var e=C("style");M.document.getElementsByTagName("head")[0].appendChild(e),e.sheet.insertRule(".goCXul { list-style: none; }",0),e.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),e.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0),null!==(e=a.diagram)&&(e.addEventListener(b,"contextmenu",Fn,!1),e.addEventListener(b,"selectstart",Fn,!1),e.addEventListener(t,"contextmenu",Fn,!1)),b.className="goCXforeground",t.className="goCXbackground",M.document.body&&(M.document.body.appendChild(b),M.document.body.appendChild(t)),Rn=b,zn=t,In=!0}(this),Dn},set:function(a){null===a&&(In=!0),Dn=a}},currentObject:{get:function(){return this.o},set:function(a){this.o=a}},mouseDownPoint:{get:function(){return this.yw}}});var Dn=null,In=!1,zn=null,Rn=null;function En(){Ti.call(this),this.name="TextEditing",this.Zh=new Yl,this.ia=null,this.V=Kn,this.vj=null,this.qa=Wn,this.u=1,this.F=!0,this.o=null,this.j=new Ln,this.jt=null,function(a,b){if($r){var t=C("textarea");a.jt=t,t.addEventListener("input",(function(){if(null!==a.textBlock){var b=a.Lx(this.value);this.style.width=20+b.measuredBounds.width*this.wA+"px",this.rows=b.lineCount}}),!1),t.addEventListener("keydown",(function(b){if(!b.isComposing&&null!==a.textBlock){var t=b.key;"Enter"===t?(!1===a.textBlock.isMultiline&&b.preventDefault(),a.acceptText(Un)):"Tab"===t?(a.acceptText(Xn),b.preventDefault()):"Escape"===t&&(a.doCancel(),null!==a.diagram&&a.diagram.doFocus())}}),!1),t.addEventListener("focus",(function(){if(null!==a.currentTextEditor&&a.state!==Wn){var b=a.jt;a.qa===Jn&&(a.qa=Zn),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),t.addEventListener("blur",(function(){if(null!==a.currentTextEditor&&a.state!==Wn){var b=a.jt;"function"==typeof b.focus&&b.focus(),"function"==typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}}),!1),b.valueFunction=function(){return t.value},b.mainElement=t,b.show=function(a,b,e){if(a instanceof Yl&&e instanceof En)if(e.state===$n)t.style.border="3px solid red",t.focus();else{var n=a.ga(fe),o=b.position,r=b.scale,h=a.Df()*r;h<e.minimumEditorScale&&(h=e.minimumEditorScale);var l=a.naturalBounds.width*h+6,c=a.naturalBounds.height*h+2,p=(n.x-o.x)*r;n=(n.y-o.y)*r,o=a.verticalAlignment,r=(a.lineHeight+a.spacingAbove+a.spacingBelow)*a.lineCount*h,c=o.y*c-o.y*r+o.offsetY-(.5*c-.5*r)-r/2,t.value=a.text,b.div.style.font=a.font,t.style.position="absolute",t.style.zIndex="100",t.style.font="inherit",t.style.fontSize=100*h+"%",t.style.lineHeight="normal",t.style.width=l+"px",t.style.left=(p-l/2|0)-1+"px",t.style.top=(n+c|0)-1+"px",t.style.textAlign=a.textAlign,t.style.margin="0",t.style.padding="1px",t.style.border="0",t.style.outline="none",t.style.whiteSpace="pre-wrap",t.style.overflow="hidden",t.rows=a.lineCount,t.wA=h,t.className="goTXarea",b.div.appendChild(t),t.focus(),e.selectsTextOnActivate&&(t.select(),t.setSelectionRange(0,9999))}},b.hide=function(a){a.div.removeChild(t)}}}(this,this.j)}function Vn(a){var b=a.textBlock,t=a.diagram,e=a.currentTextEditor;if(null!==b&&null!==e){var n=b.text,o="";null!==e.valueFunction&&(o=e.valueFunction()),a.isValidText(b,n,o)?(a.Ea(a.name),a.qa=Qn,a.transactionResult=a.name,b.text=o,a.doSuccess(n,o),null!==t&&t.R("TextEdited",b,n),a.stopTransaction(),a.stopTool(),null!==t&&t.doFocus()):(a.qa=$n,a.doError(n,o))}}jn.className="ContextMenuTool",G("contextMenuTool",(function(){return this.findTool("ContextMenu")}),(function(a){this.gb("ContextMenu",a,this.mouseUpTools)})),y(En,Ti),En.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||a.isReadOnly||to&&to!==this&&(to.acceptText(Gn),to&&to!==this)||!a.lastInput.left||this.isBeyondDragSize())return!1;var b=a.jc(a.lastInput.documentPoint);return!!(null!==b&&b instanceof Yl&&b.editable&&b.part.canEdit())&&!(null===(b=b.part)||this.starting===Kn&&!b.isSelected||this.starting===Hn&&2>a.lastInput.clickCount)},En.prototype.doStart=function(){to=this,null!==this.textBlock&&this.doActivate()},En.prototype.doActivate=function(){if(!this.isActive){var a=this.diagram;if(null!==a){var b=this.textBlock;if(null===b&&(b=a.jc(a.lastInput.documentPoint)),null!==b&&b instanceof Yl&&(this.textBlock=b,null!==b.part)){a.animationManager.Cc(),this.isActive=!0,this.qa=Jn;var t=this.defaultTextEditor;null!==b.textEditor&&(t=b.textEditor),this.Zh=this.textBlock.copy();var e=new Ut(this.textBlock.ga(he),this.textBlock.ga(me));a.tv(e),t.show(b,a,this),this.currentTextEditor=t}}}},En.prototype.doCancel=function(){this.stopTool()},En.prototype.doMouseUp=function(){this.canStart()&&this.doActivate()},En.prototype.doMouseDown=function(){this.isActive&&this.acceptText(Gn)},En.prototype.acceptText=function(a){switch(a){case Gn:this.qa===Qn?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():this.qa!==Jn&&this.qa!==$n&&this.qa!==Zn||(this.qa=_n,Vn(this));break;case Yn:case Un:case Xn:Un===a&&!0===this.textBlock.isMultiline||this.qa!==Jn&&this.qa!==$n&&this.qa!==Zn||(this.qa=_n,Vn(this))}},En.prototype.doError=function(a,b){var t=this.textBlock;null!==t.errorFunction&&t.errorFunction(this,a,b),(a=this.currentTextEditor)&&a.show(t,this.diagram,this)},En.prototype.doSuccess=function(a,b){var t=this.textBlock;null!==t.textEdited&&t.textEdited(t,a,b)},En.prototype.doDeactivate=function(){var a=this.diagram;null!==a&&(this.qa=Wn,null!==this.currentTextEditor&&this.currentTextEditor.hide(a,this),this.textBlock=null,this.isActive=!1)},En.prototype.doStop=function(){to=null},En.prototype.isValidText=function(a,b,t){var e=this.textValidation;return!(null!==e&&!e(a,b,t))&&!(null!==(e=a.textValidation)&&!e(a,b,t))},En.prototype.Lx=function(a){var b=this.Zh;return b.text=a,b.measure(this.textBlock.Ih,1/0),b},v.Object.defineProperties(En.prototype,{textBlock:{get:function(){return this.ia},set:function(a){this.ia=a}},currentTextEditor:{get:function(){return this.o},set:function(a){this.o=a}},defaultTextEditor:{get:function(){return this.j},set:function(a){this.j=a}},starting:{get:function(){return this.V},set:function(a){this.V=a}},textValidation:{get:function(){return this.vj},set:function(a){this.vj=a}},minimumEditorScale:{get:function(){return this.u},set:function(a){this.u=a}},selectsTextOnActivate:{get:function(){return this.F},set:function(a){this.F=a}},state:{get:function(){return this.qa},set:function(a){this.qa!==a&&(this.qa=a)}}}),En.prototype.measureTemporaryTextBlock=En.prototype.Lx;var Yn=new W(En,"LostFocus",0),Gn=new W(En,"MouseDown",1),Xn=new W(En,"Tab",2),Un=new W(En,"Enter",3),qn=new W(En,"SingleClick",0),Kn=new W(En,"SingleClickSelected",1),Hn=new W(En,"DoubleClick",2),Wn=new W(En,"StateNone",0),Jn=new W(En,"StateActive",1),Zn=new W(En,"StateEditing",2),_n=new W(En,"StateValidating",3),$n=new W(En,"StateInvalid",4),Qn=new W(En,"StateValidated",5),to=null;function eo(a){go||(fo(),go=!0),this.H=Lo,this.Nk=this.Ab=this.uq=this.cc=!1,this.Qw=!0,this.Ok=mo,this.Cm=!1,this.Gh=this.Jd=!0,this.Dg=600,this.cw=this.Ow=!1,this.Zd=new at,this.ce=new xo,this.ce.Yd=this,this.Ei=new at,this.ou=new at,this.Rr=new at,this.nr=new at,a&&Object.assign(this,a)}function io(a,b){a.Jd&&a.canStart(b)&&(a.Zd.add(b),a.defaultAnimation.isAnimating&&a.Cc(),ur(a.H),a.Ab=!0)}function no(a){if(a.Jd&&a.Ab){var b=a.ce,t=a.H,e=a.Zd.contains("Model");e&&(a.Nk=!0,a.Ok===mo?(b.isViewportUnconstrained=!0,b.vc.clear(),b.add(t,"position",t.position.copy().offset(0,-200),t.position),b.add(t,"opacity",0,1)):a.Ok===vo&&b.vc.clear(),a.Qw=!(a.Ok!==yo||!t.cu.D(t.pa)),t.R("InitialAnimationStarting",a)),e&&!a.Gh||0===b.vc.count?(a.Zd.clear(),a.Ab=!1,b.vc.clear(),bo(b,t),a.Nk=!1,t.N()):(a.Zd.clear(),t.kg=!1,e=b.vc.get(t),t.autoScale!==es&&null!==e&&(delete e.start.scale,delete e.end.scale),M.requestAnimationFrame((function(){!1===a.Ab||b.cc||(t.Gf("temporaryPixelRatio")&&Go(t),Uo(t),a.Ab=!1,b.start(),b.cc&&(so(a),t.Ya(),th(b,0),lr(t,!0),ao(a),t.R("AnimationStarting",a)))})))}}function oo(a){return a.Zd.contains("Trigger")&&1===a.Zd.count}function ro(a,b,t,e){a.isTicking||oo(a)||b instanceof Oc&&(null!==b.fromNode||null!==b.toNode)||a.ce.add(b,"position",t,e,!1)}function so(a){if(!a.uq){var b=a.H;a.Ow=b.skipsUndoManager,a.cw=b.skipsModelSourceBindings,b.skipsUndoManager=!0,b.skipsModelSourceBindings=!0,a.uq=!0}}function ao(a){var b=a.H;b.skipsUndoManager=a.Ow,b.skipsModelSourceBindings=a.cw,a.uq=!1}function ho(a,b,t){!a.Ab||b.D(t)||oo(a)||(a.H.pi||(b=t.copy()),wo(a.ce,a.H,"position",b,t))}function lo(a,b,t){b.fd&&(b.Tg=t,a.nr.add(b))}function uo(a,b){for(b=b.findLinksConnected();b.next();){var t=b.value;t.fd&&(t.Tg=t.points.copy(),a.nr.add(t))}}function co(a,b,t,e,n){null===a&&(a=[0,0,0,0]),null===b&&(b=[0,0,0,0]);var o=a[0],g=a[1],r=a[2];a=a[3];var h=b[0],l=b[1],c=b[2];return b=b[3],0===r||100===r?(o=h,g=l):0!==c&&100!==c||(h=o,l=g),180<Math.abs(h-o)&&(h>o?o+=360:h+=360),"hsla("+(o=n(t,o,h-o,e)%360)+", "+(g=n(t,g,l-g,e))+"%, "+(r=n(t,r,c-r,e))+"%, "+(t=n(t,a,b-a,e))+")"}function fo(){function a(a,b,t,e,g,n){a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))}var b=new Mt;b.add("position:diagram",a),b.add("position",a),b.add("position:part",(function(a,b,t,e,g,n){g<n?a.lm(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!1):a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("location",(function(a,b,t,e,g,n){g<n?a.lm(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!0):a.location=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("position:placeholder",(function(a,b,t,e,g,n){g<n?a.lm(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n),!1):a.position=new St(e(g,b.x,t.x-b.x,n),e(g,b.y,t.y-b.y,n))})),b.add("position:nodeCollapse",(function(a,b,t,e,g,n){var o=a.actualBounds,r=t.actualBounds;t=r.x+r.width/2-o.width/2,o=r.y+r.height/2-o.height/2,g<n?a.lm(e(g,b.x,t-b.x,n),e(g,b.y,o-b.y,n),!1):a.position=new St(e(g,b.x,t-b.x,n),e(g,b.y,o-b.y,n))})),b.add("desiredSize",(function(a,b,t,e,g,n){a.desiredSize=new Ut(e(g,b.width,t.width-b.width,n),e(g,b.height,t.height-b.height,n))})),b.add("width",(function(a,b,t,e,g,n){a.width=e(g,b,t-b,n)})),b.add("height",(function(a,b,t,e,g,n){a.height=e(g,b,t-b,n)})),b.add("fill",(function(a,b,t,e,g,n){a.fill=co(b,t,g,n,e)})),b.add("stroke",(function(a,b,t,e,g,n){a.stroke=co(b,t,g,n,e)})),b.add("strokeWidth",(function(a,b,t,e,g,n){a.strokeWidth=e(g,b,t-b,n)})),b.add("strokeDashOffset",(function(a,b,t,e,g,n){a.strokeDashOffset=e(g,b,t-b,n)})),b.add("background",(function(a,b,t,e,g,n){a.background=co(b,t,g,n,e)})),b.add("areaBackground",(function(a,b,t,e,g,n){a.areaBackground=co(b,t,g,n,e)})),b.add("opacity",(function(a,b,t,e,g,n){a.opacity=e(g,b,t-b,n)})),b.add("scale",(function(a,b,t,e,g,n){a.scale=e(g,b,t-b,n)})),b.add("angle",(function(a,b,t,e,g,n){a.angle=e(g,b,t-b,n)})),po=b}En.className="TextEditingTool",En.LostFocus=Yn,En.MouseDown=Gn,En.Tab=Xn,En.Enter=Un,En.SingleClick=qn,En.SingleClickSelected=Kn,En.DoubleClick=Hn,En.StateNone=Wn,En.StateActive=Jn,En.StateEditing=Zn,En.StateValidating=_n,En.StateInvalid=$n,En.StateValidated=Qn,G("textEditingTool",(function(){return this.findTool("TextEditing")}),(function(a){this.gb("TextEditing",a,this.mouseUpTools)})),eo.prototype.Xe=function(a){this.H=a},eo.prototype.canStart=function(){return!0},(e=eo.prototype).fv=function(a){return this.ce.fv(a)},e.Xu=function(a){return this.ce.Xu(a)},e.Cc=function(a){var b=this.ce;if(!0===this.Ab&&(this.Nk=this.Ab=!1,this.Zd.clear(),0<b.vc.count&&this.H.ac()),this.cc){if(b.Ll(!0),b.vc.clear(),bo(b,null),!0===a)for(a=this.Ei.Fa(),b=0;b<a.length;b++)a[b].Ll(!0)}else b.vc.clear(),bo(b,this.H)},e.Ll=function(a){a===this.defaultAnimation&&this.defaultAnimation.vc.clear(),this.Ei.remove(a),0===this.Ei.count&&(this.cc=!1,this.H.ac()),a===this.defaultAnimation&&(this.defaultAnimation.vc.clear(),this.H.R("AnimationFinished",this))},e.Cj=function(a,b){this.Ab&&(this.Zd.contains("Expand Tree")||this.Zd.contains("Expand SubGraph"))&&(this.ce.Cj(a,b),uo(this,a))},e.Aj=function(a,b){this.Ab&&(this.Zd.contains("Collapse Tree")||this.Zd.contains("Collapse SubGraph"))&&(this.ce.Aj(a,b),wo(this.ce,b,"position",b.position,b.position),uo(this,a))},v.Object.defineProperties(eo.prototype,{animationReasons:{get:function(){return this.Zd}},isEnabled:{get:function(){return this.Jd},set:function(a){(this.Jd=a)&&this.Ei.each((function(a){a.isAnimating||1/0!==a.runCount||a.start()}))}},duration:{get:function(){return this.Dg},set:function(a){1>a&&A(a,">= 1",eo,"duration"),this.Dg=a}},isAnimating:{get:function(){return this.cc}},isTicking:{get:function(){return this.uq}},isInitial:{get:function(){return this.Gh},set:function(a){this.Gh=a}},defaultAnimation:{get:function(){return this.ce}},activeAnimations:{get:function(){return this.Ei}},initialAnimationStyle:{get:function(){return this.Ok},set:function(a){this.Ok=a}}}),eo.prototype.stopAnimation=eo.prototype.Cc;var po=null,go=!1,mo=new W(eo,"Default",1),yo=new W(eo,"AnimateLocations",2),vo=new W(eo,"None",3);function xo(a){this.uu=this.Nw=this.Yd=this.H=null,this.Wk=this.cc=this.j=!1,this.bn=this.Qd=0,this.Kp=this.nt=So,this.Vk=this.fo=!1,this.bu=1,this.$t=0,this.Gd=this.Dg=NaN,this.gw=0,this.cn=null,this.o=ct,this.vc=new Mt,this.St=new Mt,this.xl=new at,this.Tt=new at,this.dw=us,a&&Object.assign(this,a)}function bo(a,b){if(a.St.clear(),a.Vk=!1,a.$t=0,a.Gd=NaN,0<a.xl.count&&a.xl.clear(),0<a.Tt.count&&a.Tt.clear(),null!==b)for(a=b.links;a.next();)a.value.Tg=null}function wo(a,b,t,e,n,o){var g=a.vc;if(b instanceof zo&&"position"===t&&(t="position:diagram"),"fill"!==t&&"stroke"!==t&&"background"!==t&&"areaBackground"!==t||(Qa(e),eh(),e=[xh.j,xh.u,xh.o,xh.F],Qa(n),eh(),n=[xh.j,xh.u,xh.o,xh.F]),g.contains(b)){var r=g.I(b),h=r.start,l=r.end;void 0===h[t]&&(h[t]=ko(e)),l[t]=ko(n)}else l={},(h={})[t]=ko(e),l[t]=ko(n),r=h.position,b instanceof qs&&r instanceof St&&!r.w()&&b.diagram.animationManager.Zd.contains("Expand SubGraph")&&r.assign(l.position),r=new No(h,l,o),g.add(b,r);(g=h[t])instanceof St&&!g.w()&&g.assign(a.o),o&&0===t.indexOf("position:")&&b instanceof zu?r.Ku.location=ko(b.location):o&&(r.Ku[t]=ko(e))}function ko(a){return a instanceof St||a instanceof Vt?a.copy():a}function Mo(a,b){if(!a.Wk||b){var t=a.Yd;if(!1!==a.cc){var e=+new Date,n=e>a.bn?a.Gd:e-a.Qd;b&&((n=a.gw)<a.Gd?(a.Qd=+new Date-n,a.bn=a.Qd+a.Gd):n=a.Gd),so(t),th(a,n),lr(a.H,!0),ao(t),e>a.bn&&(a.fo&&!a.Vk?(a.Qd=+new Date,a.bn=a.Qd+a.Gd,a.Vk=!0):a.Ll(!1))}}}function th(a,b){for(var t=a.Gd,e=a.vc.iterator,n=a.Vk;e.next();){var o=e.key;if(!(o instanceof qs&&null===o.diagram)){var g=e.value,r=n?g.end:g.start;g=n?g.start:g.end;var h,l=po;for(h in g)"position"===h&&(g["position:placeholder"]||g["position:nodeCollapse"])||null===l.get(h)||l.get(h)(o,r[h],g[h],a.Kp,b,t,a)}}}function So(a,b,t,e){return 1>(a/=e/2)?t/2*a*a+b:-t/2*(--a*(a-2)-1)+b}function Po(a,b,t,e){return a===e?b+t:t*(1-Math.pow(2,-10*a/e))+b}function No(a,b,t){this.start=a,this.end=b,this.Ku={},this.Hu=t,this.nv=!1}function Co(a,b,t){this.xd=null,this.rf=a,this.ro=t||Ao,this.tk=null,void 0!==b&&(this.tk=b,void 0===t&&(this.ro=jo))}eo.className="AnimationManager",eo.defineAnimationEffect=function(a,b){go||(fo(),go=!0),po.add(a,b)},eo.Default=mo,eo.AnimateLocations=yo,eo.None=vo,xo.prototype.suspend=function(){this.Wk=!0},xo.prototype.advanceTo=function(a,b){b&&(this.Wk=!1),this.fo&&a>=this.Gd&&(this.Vk=!0,a-=this.Gd),this.gw=a,Mo(this,!0),so(this.Yd),lr(this.H),ao(this.Yd),this.H.redraw()},(e=xo.prototype).start=function(){if(0===this.vc.count||this.cc)return this;for(var a=this.H,b=this.vc.iterator;b.next();){var t=b.key;null===a&&(t instanceof zo?a=t:t instanceof qs&&(a=t.diagram))}return null===a?this:(this.H=a,this.Yd=a.animationManager,!1===(b=this.Yd).isEnabled||(this.Gd=isNaN(this.Dg)?b.duration:this.Dg,this.Kp=this.nt,b.Nk&&b.Ok===mo&&this===b.defaultAnimation&&(this.Kp=Po,this.Gd=isNaN(this.Dg)?600===b.duration?900:b.duration:this.Dg),this.dw=a.scrollMode,this.isViewportUnconstrained&&(a.sj=cs),so(b),this.xl.each((function(b){b.data=null,a.add(b)})),ao(b),this.cc=!0,this.Qd=+new Date,this.bn=this.Qd+this.Gd,function(a,b){function t(){if(0<n.Rr.count&&(e.addAll(n.Rr),n.Rr.clear(),n.cc=!0),!1!==n.cc&&0!==e.count){n.ou.addAll(e);for(var a=n.ou.iterator;a.next();){var b=a.value;if(!1!==b.cc){t:if(0<b.xl.count)var o=!0;else{for(o=b.vc.iterator;o.next();){var r=o.key;if(r instanceof qs&&null!==r.diagram||r instanceof zo){o=!0;break t}}o=!1}o?Mo(b,!1):b.Wk=!0}}n.ou.clear(),!1!==n.cc&&(so(n),lr(n.H),ao(n)),M.requestAnimationFrame(t)}}var e=a.Ei,n=a;a.cc?a.Rr.add(b):(a.cc=!0,e.add(b),M.requestAnimationFrame((function(){t()})))}(b,this)),this)},e.Iy=function(a,b){return a.Zc()?(this.xl.add(a),this.H=b,this):this},e.add=function(a,b,t,e,n){if("position"===b&&t.Xa(e))return this;if(null===this.H&&(a instanceof zo?this.H=a:a instanceof qs&&null!==a.diagram&&(this.H=a.diagram)),a instanceof zu){if(!a.isAnimated)return this;"position"===b&&(b="position:part")}return wo(this,a,b,t,e,n),this},e.fv=function(a){return!!this.cc&&(null!==(a=this.vc.I(a))&&a.nv)},e.Xu=function(a){return!!this.cc&&(null!==(a=this.vc.I(a))&&(a.start.position||a.start.location))},e.stop=function(){return this.cc?(this.Ll(!0),this):this},e.Ll=function(a){if(null!==this.uu&&this.uu.io.remove(this.Nw),this.cc){var b=this.H,t=this.Yd;this.Wk=this.cc=t.Nk=!1,so(t);for(var e=this.vc,n=this.xl.iterator;n.next();)b.remove(n.value);for(n=this.Tt.iterator;n.next();)n.value.v();n=this.fo,e=e.iterator;for(var o=po;e.next();){var r,g=e.key,h=e.value,l=n?h.end:h.start,c=n?h.start:h.end,f=h.Ku;for(r in c)if(null!==o.get(r)){var p=r;!h.Hu||"position:nodeCollapse"!==p&&"position:placeholder"!==p||(p="position"),o.get(p)(g,l[r],void 0!==f[r]?f[r]:h.Hu?l[r]:c[r],this.Kp,this.Gd,this.Gd,this)}h.Hu&&void 0!==f.location&&g instanceof zu&&(g.location=f.location),h.nv&&g instanceof zu&&g.$b(!1)}if(b.zs.clear(),Xo(b,!1),b.Ya(),b.N(),lr(b,!0),t.defaultAnimation===this){for(r=t.nr.iterator;r.next();)null!==(n=r.value).Tg&&(n.points=n.Tg,n.Tg=null);t.nr.clear()}lr(b,!0),this.isViewportUnconstrained&&(b.scrollMode=this.dw),ao(t),this.$t++,!a&&this.bu>this.$t?(this.Vk=!1,this.start()):(this.cn&&this.cn(this),bo(this,null),t.Ll(this),b.ac())}},e.Cj=function(a,b){var t=b.actualBounds,e=null;if(b instanceof Cc&&(e=b.placeholder),null!==e?(t=e.ga(he),e=e.padding,t.x+=e.left,t.y+=e.top,this.add(a,"position",t,a.position,!1)):this.add(a,"position",new St(t.x+t.width/2,t.y+t.height/2),a.position,!1),this.add(a,"scale",.01,a.scale,!1),a instanceof Cc)for(a=a.memberParts;a.next();)(e=a.value)instanceof uc&&this.Cj(e,b)},e.Aj=function(a,b){if(a.isVisible()){var t=null;if(b instanceof Cc&&(t=b.placeholder),null!==t){var e=t.ga(he);t=t.padding,e.x+=t.left,e.y+=t.top,this.add(a,"position:placeholder",a.position,e,!0)}else this.add(a,"position:nodeCollapse",a.position,b,!0);if(this.add(a,"scale",a.scale,.01,!0),(e=this.vc).contains(a)&&(e.I(a).nv=!0),a instanceof Cc)for(a=a.memberParts;a.next();)(e=a.value)instanceof uc&&this.Aj(e,b)}},e.Ez=function(a){var b=this.St.get(a);return null===b&&(b={},this.St.add(a,b)),b},v.Object.defineProperties(xo.prototype,{duration:{get:function(){return this.Dg},set:function(a){1>a&&A(a,">= 1",xo,"duration"),this.Dg=a}},reversible:{get:function(){return this.fo},set:function(a){this.fo=a}},runCount:{get:function(){return this.bu},set:function(a){0<a?this.bu=a:T("Animation.runCount value must be a positive integer.")}},finished:{get:function(){return this.cn},set:function(a){this.cn!==a&&(this.cn=a)}},easing:{get:function(){return this.nt},set:function(a){this.nt=a}},isViewportUnconstrained:{get:function(){return this.j},set:function(a){this.j=a}},isAnimating:{get:function(){return this.cc}}}),xo.prototype.getTemporaryState=xo.prototype.Ez,xo.prototype.stop=xo.prototype.stop,xo.prototype.add=xo.prototype.add,xo.prototype.addTemporaryPart=xo.prototype.Iy,xo.className="Animation",xo.EaseLinear=function(a,b,t,e){return t*a/e+b},xo.EaseInOutQuad=So,xo.EaseInQuad=function(a,b,t,e){return t*(a/=e)*a+b},xo.EaseOutQuad=function(a,b,t,e){return-t*(a/=e)*(a-2)+b},xo.EaseInExpo=function(a,b,t,e){return 0===a?b:t*Math.pow(2,10*(a/e-1))+b},xo.EaseOutExpo=Po,No.className="AnimationState",Co.prototype.copy=function(){var a=new Co(this.rf);a.ro=this.ro;var b=this.tk;if(null!==b){var t={};void 0!==b.duration&&(t.duration=b.duration),void 0!==b.finished&&(t.finished=b.finished),void 0!==b.easing&&(t.easing=b.easing),a.tk=t}return a},v.Object.defineProperties(Co.prototype,{propertyName:{get:function(){return this.rf},set:function(a){this.rf=a}},animationSettings:{get:function(){return this.tk},set:function(a){this.tk=a}},startCondition:{get:function(){return this.ro},set:function(a){this.ro=a}}});var To,Lo,Ao=new W(Co,"Default",1),jo=new W(Co,"Immediate",2),Fo=new W(Co,"Bundled",3);function Oo(a){ht(this),this.H=null,this.Pa=new ot,this.xa="",this.pb=1,this.o=!1,this.j=this.Uh=this.u=this.Oi=this.Ni=this.Mi=this.Li=this.Ji=this.Ki=this.Ii=this.Qi=this.Hi=this.Pi=this.Gi=this.Fi=!0,this.Yq=[],a&&Object.assign(this,a)}function Bo(a,b){var t=1;return 1!==a.pb&&(t=b.globalAlpha,b.globalAlpha=t*a.pb),t}function Do(a,b,t,e,n){if(a.visible&&0!==a.pb&&(n||!a.isTemporary)){var o=(n=a.Pa.s).length;if(0!==o){var g=Bo(a,b),r=a.Yq;r.length=0;for(var h=t.scale,l=Ut.alloc(),c=0;c<o;c++){var f=n[c];e.contains(f)&&a.Nj(b,f,t,r,h,l,!1)}Ut.free(l),b.globalAlpha=g}}}function Io(a,b,t){if(b=function(a,b,t){var e=t.zOrder;if(isNaN(e))return b;a=a.Pa;var n=a.count;if(1>=n)return b;if(0>b&&(b=a.indexOf(t)),0>b)return-1;for(var o=b-1,g=NaN;0<=o&&(g=a.M(o).zOrder,isNaN(g));)o--;for(var r=b+1,h=NaN;r<n&&(h=a.M(r).zOrder,isNaN(h));)r++;if(!isNaN(g)&&g>e)for(;;){if(-1===o||g<=e){if(++o===b)break;return a.mb(b),a.Hb(o,t),o}for(g=NaN;0<=--o&&(g=a.M(o).zOrder,isNaN(g)););}else if(!isNaN(h)&&h<e)for(;;){if(r===n||h>=e){if(--r===b)break;return a.mb(b),a.Hb(r,t),r}for(h=NaN;++r<n&&(h=a.M(r).zOrder,isNaN(h)););}return b}(a,b,t),t instanceof Cc&&null!==t&&isNaN(t.zOrder)){if(0!==t.memberParts.count){for(var e=-1,n=a.Pa.s,o=n.length,g=0;g<o;g++){var r=n[g];if(r===t&&(b=g,0<=e))break;if(0>e&&r.containingGroup===t&&(e=g,0<=b))break}!(0>e)&&e<b&&((n=a.Pa).mb(b),n.Hb(e,t))}null!==(b=t.containingGroup)&&Io(a,-1,b)}null!==t.svg&&t.svg.remove()}function zo(a,b){if(xs||(function(){if($r){var a=M.document.createElement("canvas"),b=a.getContext("2d"),t=X("7ca11abfd022028846");b[t]=X("398c3597c01238");for(var e=["5da73c80a36455d7038e4972187c3cae51fd22",S.Dx+"4ae6247590da4bb21c324ba3a84e385776",Ze.xF+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",$e.za],n=1;5>n;n++)b[X("7ca11abfd7330390")](X(e[n-1]),10,15*n);for(b[t]=X("39f046ebb36e4b"),t=1;5>t;t++)b[X("7ca11abfd7330390")](X(e[t-1]),10,15*t);4===e.length&&"5"===e[0][0]&&"7"===e[3][0]||(Ze.prototype.Cd=Ze.prototype.Eu),vs=a}}(),xs=!0),ht(this),Lo=this,this.wb=!0,this.Ka=null,this.ya=this.Aa=0,this.ta=null,$r){var t=this,e=function(){t.removeEventListener(M.document,"DOMContentLoaded",e,!1),t.setRTL()};null!==M.document.body?this.setRTL():t.addEventListener(M.document,"DOMContentLoaded",e,!1)}this.nl=null,Zr.add("Model",fd);var n=this;return this.Ib=function(a){var b=n.partManager;if(a.model===b.diagram.model&&b.diagram.aa){b.diagram.aa=!1;try{var t=a.change;""===a.modelChange&&t===ki&&b.updateDataBindings(a.object,a.propertyName)}finally{b.diagram.aa=!0}}},this.Oc=function(a){n.partManager.doModelChanged(a)},this.gu=this.ju=null,Ro(this),this.model=Hd(),this.Wg=!0,qo(this),this.layout=new Uf,this.Wg=!1,this.bk=this.dk=this.ek=this.ck=this.ui=this.aA=this.Zj=this.Ov=null,this.gk=function(){},this.preventDefault=null,this.qn=!1,this.Yf=new bs,void 0!==a&&("string"==typeof a||M.Element&&a instanceof Element?Yo(this,a):b=a),this.wb=!1,b&&this.mm(b),this}function Ro(a){a.Yd=new eo,a.Yd.Xe(a),a.Eb=17,a.Gw=!1,a.sn=!1,a.au="default",a.Wa=new ot,a.pj=new Mt,a.ml="default",a.Tx(),a.Sx(),a.pb=1,a.pa=new St(NaN,NaN).freeze(),a.cu=new St(NaN,NaN),a.Ca=1,a.Op=1,a.yt=new St(NaN,NaN).freeze(),a.zt=NaN,a.Nt=1e-4,a.Lt=100,a.Bb=new Ze,a.yu=new St(NaN,NaN).freeze(),a.tt=new Ut(NaN,NaN,NaN,NaN).freeze(),a.rj=new oe(0,0,0,0).freeze(),a.sj=us,a.mu=!1,a.Yt=null,a.eu=null,a.yh=es,a.yk=Fe,a.Fg=es,a.oq=Fe,a.xt=he,a.At=he,a.Fc=!0,a.on=!1,a.De=new at,a.Eh=new Mt,a.Wm=!0,a.tp=250,a.uk=-1,a.wp=new oe(16,16,16,16).freeze(),a.kg=!1,a.Ik=!1,a.en=!0,a.aq=new vi,a.aq.diagram=a,a.Qg=new vi,a.Qg.diagram=a,a.cj=new vi,a.cj.diagram=a,a.zg=null,a.pf=null,a.pu=!1,function(a){function b(a){var b=a.toLowerCase(),n=new ot;t.add(a,n),t.add(b,n),e.add(a,a),e.add(b,a)}var t=new Mt,e=new Mt;b("InitialAnimationStarting"),b("AnimationStarting"),b("AnimationFinished"),b("BackgroundSingleClicked"),b("BackgroundDoubleClicked"),b("BackgroundContextClicked"),b("ClipboardChanged"),b("ClipboardPasted"),b("DocumentBoundsChanged"),b("ExternalObjectsDropped"),b("GainedFocus"),b("InitialLayoutCompleted"),b("LayoutCompleted"),b("LinkDrawn"),b("LinkRelinked"),b("LinkReshaped"),b("LostFocus"),b("Modified"),b("ObjectSingleClicked"),b("ObjectDoubleClicked"),b("ObjectContextClicked"),b("PartCreated"),b("PartResized"),b("PartRotated"),b("SelectionMoved"),b("SelectionCopied"),b("SelectionDeleting"),b("SelectionDeleted"),b("SelectionGrouped"),b("SelectionUngrouped"),b("ChangingSelection"),b("ChangedSelection"),b("SubGraphCollapsed"),b("SubGraphExpanded"),b("TextEdited"),b("TreeCollapsed"),b("TreeExpanded"),b("ViewportBoundsChanged"),b("InvalidateDraw"),a.iw=t,a.hw=e}(a),a.ai=new at,a.Gt=!0,a.tu=fs,a.pw=!1,a.vu=os,a.ht="auto",a.Np="auto",a.zh=null,a.Fh=null,a.Bh=null,a.Qh=null,a.Oh=null,a.Nh=null,a.Pt=null,a.Lh=null,a.wt=!1,a.Mh=null,a.Ph=null,a.$h=null,a.Ch=null,a.Qt=!1,a.Xt={},a.oj=[null,null],a.Wg=!1,a.Iw=!1,a.nu=!1,a.kt=!1,a.rw=!0,a.ld=!1,a.$i=!1,a.Tw=!0,a.Ce=-2,a.Og=new Mt,a.Wn=new ot,a.Gg=!1,a.Jd=!0,a.Ts=!0,a.Fi=!0,a.Gi=!0,a.Us=!1,a.Vs=!0,a.Pi=!0,a.Hi=!0,a.Qi=!0,a.Xs=!0,a.Ii=!0,a.Ki=!0,a.Ji=!0,a.Li=!0,a.Mi=!0,a.Ni=!0,a.Oi=!0,a.Ys=!0,a.$s=!0,a.qw=!1,a.Uk=!1,a.ln=!0,a.mn=!0,a.Ws=!0,a.Zs=!0,a.hu=16,a.lu=16,a.pr=!1,a.fu=!1,a.ku=0,a.iu=0,a.zb=new oe(5).freeze(),a.Hw=(new at).freeze(),a.Mt=999999999,a.nw=(new at).freeze(),a.Zi=!0,a.Ee=!0,a.vd=!0,a.Be=!1,a.gf=!1,a.xh=!0,a.hf=!1,a.sy=new at,a.ow=new at,a.Xh=null,a.aw=new Vt(8,8),a.bw=999,a.Bw=1,a.Jw=0,a.gc={scale:1,position:new St,bounds:new Ut,Py:new Vt,bA:new Vt,Oz:!1},a.gc.canvasSize=a.gc.Py,a.gc.newCanvasSize=a.gc.bA,a.gc.isScroll=!1,a.Rw=new Ut(NaN,NaN,NaN,NaN).freeze(),a.vo=new Vt(NaN,NaN).freeze(),a.Rp=new Ut(NaN,NaN,NaN,NaN).freeze(),a.Ht=!1,a.Lg=new Mt;var b=new uc,t=new Yl;t.bind(new tp("text","",V)),b.add(t),a.ny=b,a.Lg.add("",b),b=new uc,(t=new Yl).stroke="brown",t.bind(new tp("text","",V)),b.add(t),a.Lg.add("Comment",b),(b=new uc).selectable=!1,b.avoidable=!1,(t=new Ll).figure="Ellipse",t.fill="black",t.stroke=null,t.desiredSize=new Vt(3,3).ja(),b.add(t),a.Lg.add("LinkLabel",b),a.Yi=new Mt,(b=new Cc).selectionObjectName="GROUPPANEL",b.type=Eh.Vertical,(t=new Yl).font="bold 12pt sans-serif",t.bind(new tp("text","",V)),b.add(t),(t=new Eh(Eh.Auto)).name="GROUPPANEL";var e=new Ll;e.figure="Rectangle",e.fill="rgba(128,128,128,0.2)",e.stroke="black",t.add(e),(e=new Fc).padding=new oe(5,5,5,5).ja(),t.add(e),b.add(t),a.ly=b,a.Yi.add("",b),a.Kh=new Mt,b=new Oc,(t=new Ll).isPanelMain=!0,b.add(t),(t=new Ll).toArrow="Standard",t.fill="black",t.stroke=null,t.strokeWidth=0,b.add(t),a.my=b,a.Kh.add("",b),b=new Oc,(t=new Ll).isPanelMain=!0,t.stroke="brown",b.add(t),a.Kh.add("Comment",b),(b=new hc).type=Eh.Auto,(t=new Ll).fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),(t=new Fc).margin=new oe(1.5,1.5,1.5,1.5).ja(),b.add(t),a.Rt=b,a.vt=b,(b=new hc).type=Eh.Link,(t=new Ll).isPanelMain=!0,t.fill=null,t.stroke="dodgerblue",t.strokeWidth=3,b.add(t),a.Jt=b,a.fe=null,a.lq=!1,a.Bk=null,a.partManager=new fd,a.toolManager=new Li,a.toolManager.initializeStandardTools(),a.defaultTool=a.toolManager,a.currentTool=a.defaultTool,a.mt=null,a.Vm=new Ds,a.Ut=null,a.Vt=null,a.Lr=!1,a.commandHandler=Vo(),a.cq=null,a.eq=mt,a.Pw=!1,a.Nb=1,a.Yh=null,a.Nq=1,a.Rq=0,a.zw=[0,0,0,0,0],a.Sq=0,a.xq=1,a.tw=0,a.uw=new St,a.zy=500,a.vp=new St,a.vq=!1}function Eo(a,b){a.animationManager.Cc(!0),a.Hw=(new at).freeze(),a.nw=(new at).freeze();var t=a.skipsUndoManager,e=null!==a.dc&&void 0!==a.dc;e&&(a.skipsUndoManager=!0);var n=null;null!==a.fe&&(null!==(n=a.fe.part)&&a.remove(n));var o=[],g=a.Wa.length;if(b){for(b=0;b<g;b++)for(var r=a.Wa.s[b].parts;r.next();){var h=r.value;h!==n&&null===h.data&&o.push(h)}for(b=0;b<o.length;b++)a.remove(o[b])}for(b=0;b<g;b++)a.Wa.s[b].clear();return a.partManager.clear(),a.De.clear(),a.Eh.clear(),a.ai.clear(),a.Bk=null,a.Wn.clear(),bu(),a.Og.clear(),H=[],null!==n&&(a.add(n),a.partManager.parts.remove(n)),e&&(a.skipsUndoManager=t),o}function Vo(){return null}function Yo(a,b){if($r){if(null!=b||T("Diagram setup requires an argument DIV."),null!==a.Ka&&T("Diagram has already completed setup."),"string"==typeof b?a.Ka=M.document.getElementById(b):b instanceof HTMLDivElement?a.Ka=b:T("No DIV or DIV id supplied: "+b),null===a.Ka&&T("Invalid DIV id; could not get element with id: "+b),void 0!==a.Ka.H&&T("Invalid div id; div already has a Diagram associated with it."),!a.nl&&M.ResizeObserver){var t=P((function(){a.ac()}),250);a.nl=new M.ResizeObserver((function(){t()})),a.nl.observe(a.Ka)}"static"===M.getComputedStyle(a.Ka,null).position&&(a.Ka.style.position="relative");var e="rgba(2"+(b=5)+"5, 255, 255, 0)";b--,a.Ka.style["-webkit-tap-highlight-color"]=e,a.Ka.innerHTML="",a.Ka.H=a,a.Ka.goDiagram=a,a.Ka.go=M.go;var n=new Xa(a);if(void 0!==n.style&&(n.style.position="absolute",n.style.top="0px",n.style.left="0px","rtl"===M.getComputedStyle(a.Ka,null).getPropertyValue("direction")&&(a.sn=!0),n.style.zIndex="2",n.style.userSelect="none",n.style.MozUserSelect="none",n.style.touchAction="none",n.style.letterSpacing="normal !important",n.style.wordSpacing="normal !important"),a.ta=n,a.ib=n.context,e=a.ib,a.Nb=a.computePixelRatio(),a.viewSize.w()||(a.Aa=a.Ka.clientWidth||1,a.ya=a.Ka.clientHeight||1),mr(a,a.Aa,a.ya),a.Ka.insertBefore(n.Oa,a.Ka.firstChild),(n=new Xa(null)).width=1,n.height=1,a.jw=n,a.oy=n.context,$r){n=C("div");var o=C("div");n.style.position="absolute",n.style.overflow="auto",n.style.width=a.Aa+"px",n.style.height=a.ya+"px",n.style.zIndex="1",o.style.position="absolute",o.style.width="1px",o.style.height="1px",a.Ka.appendChild(n),n.appendChild(o),n.onscroll=Ho,n.addEventListener("pointerdown",Wo),n.H=a,n.uy=!0,n.vy=!0,a.ju=n,a.gu=o}a.gk=P((function(){a.Yh=null,a.N()}),300),a.Ov=P((function(){Uo(a)}),250),a.preventDefault=function(a){return a.preventDefault(),!1},a.Zj=function(b){if(a.isEnabled){var t=er(a,b,!0);t.bubbles=!0;var e=0,n=0;t.delta=0,void 0!==b.deltaX?(0!==b.deltaX&&(e=0<b.deltaX?1:-1),0!==b.deltaY&&(n=0<b.deltaY?1:-1),t.delta=Math.abs(b.deltaX)>Math.abs(b.deltaY)?-e:-n):void 0!==b.wheelDeltaX?(0!==b.wheelDeltaX&&(e=0<b.wheelDeltaX?-1:1),0!==b.wheelDeltaY&&(n=0<b.wheelDeltaY?-1:1),t.delta=Math.abs(b.wheelDeltaX)>Math.abs(b.wheelDeltaY)?-e:-n):void 0!==b.wheelDelta&&0!==b.wheelDelta&&(t.delta=0<b.wheelDelta?1:-1),a.doMouseWheel(),or(t,b)}},a.aA=function(b){a.isEnabled&&(a.Uk=!1,er(a,b,!0),(b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())},a.ui=function(b){if(a.isEnabled){a.Uk=!0;var t=a.Xt;void 0===t[b.pointerId]&&(t[b.pointerId]=b);var e=!1;if(null===(t=a.oj)[0]||t[0].pointerId!==b.pointerId&&t[0].pointerType===b.pointerType)if(null!==t[1]&&t[1].pointerId===b.pointerId)t[1]=b,e=!0;else if(null===t[0])t[0]=b;else{if(null!==t[1])return void b.preventDefault();t[1]=b,e=!0}else t[0]=b;(t="touch"===b.pointerType||"pen"===b.pointerType)&&(a.pu=!1,a.vq=!0);var n=e;e=nr(a,b,!0,!1,!0,n),rr(a,b,e),e.targetDiagram=ir(b,b.target),e.targetObject=null,n||e.clone(a.aq),n=a.uw,t=t?25:10,b.timeStamp-a.tw<a.zy&&!(Math.abs(n.x-b.screenX)>t||Math.abs(n.y-b.screenY)>t)?a.xq++:a.xq=1,e.clickCount=a.xq,a.tw=b.timeStamp,a.uw.sg(b.screenX,b.screenY),a.doMouseDown(),1===b.button?b.preventDefault():or(e,b)}},a.ck=function(b){if(a.isEnabled){a.Uk=!0;var t=a.oj;if(null===t[0]||t[0].pointerId!==b.pointerId&&t[0].pointerType===b.pointerType){if(null!==t[1]&&t[1].pointerId===b.pointerId)return void(t[1]=b);if(null!==t[0])return;t[0]=b}else t[0]=b;if(t[0].pointerId===b.pointerId){t=nr(a,b,!1,!1,!1,null!==t[1]);var e=M.document.elementFromPoint(b.clientX,b.clientY)||null;null!==e&&void 0!==e.shadowRoot&&null!==e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(b.clientX,b.clientY));var n=a,o=b;e&&e.H&&(o=b,n=e.H),t.targetDiagram=n,rr(a,o,t),t.targetObject=null,a.doMouseMove(),or(t,b)}}},a.ek=function(b){if(a.isEnabled){a.Uk=!0;var t="touch"===b.pointerType||"pen"===b.pointerType,e=a.Xt;if(t&&a.pu)delete e[b.pointerId],b.preventDefault();else if(null===(e=a.oj)[0]||e[0].pointerId!==b.pointerId&&e[0].pointerType===b.pointerType)null!==e[1]&&e[1].pointerId===b.pointerId&&(e[1]=null);else{e[0]=null,e=nr(a,b,!1,!0,!0,!1);var n=M.document.elementFromPoint(b.clientX,b.clientY)||null;null!==n&&void 0!==n.shadowRoot&&null!==n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(b.clientX,b.clientY)),null!==n&&n.H instanceof zo&&n.H!==a&&rr(n.H,b,e),null===n&&(n=b.target),rr(a,b,e),e.clickCount=a.xq,e.targetDiagram=ir(b,n),e.targetObject=null,a.doMouseUp(),or(e,b),t&&(a.vq=!1)}}},a.dk=function(b){if(a.isEnabled){a.Uk=!1;var t=a.Xt;t[b.pointerId]&&delete t[b.pointerId],null!==(t=a.oj)[0]&&t[0].pointerId===b.pointerId&&(t[0]=null),null!==t[1]&&t[1].pointerId===b.pointerId&&(t[1]=null),"touch"!==b.pointerType&&"pen"!==b.pointerType&&((b=a.currentTool).cancelWaitAfter(),b.standardMouseOver())}},a.bk=function(b){var t=a.oj;null!==t[0]&&t[0].pointerId===b.pointerId?(t[0]=null,a.vq=!1):null!==t[1]&&t[1].pointerId===b.pointerId&&(t[1]=null)},a.Up=e.Z["d"+Os[1]+Os[2]+"wI"+ys.slice(1,5)]["b"+ip.slice(1,b)](e.Z,vs,b,b),e.Vc(!0),function(a){var b=a.ta.Oa;b instanceof HTMLCanvasElement||(b=a.div),a.addEventListener(b,"pointerdown",a.ui,!1),a.addEventListener(b,"pointermove",a.ck,!1),a.addEventListener(b,"pointerup",a.ek,!1),a.addEventListener(b,"pointerout",a.dk,!1),a.addEventListener(b,"pointercancel",a.bk,!1),a.addEventListener(b,"pointerenter",a.bz,!1),a.addEventListener(b,"pointerleave",a.cz,!1),a.addEventListener(b,"wheel",a.Zj,!1),a.addEventListener(b,"keydown",a.Qz,!1),a.addEventListener(b,"keyup",a.Rz,!1),a.addEventListener(b,"blur",a.Ny,!1),a.addEventListener(b,"focus",a.Oy,!1),a.addEventListener(b,"selectstart",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(b,"contextmenu",(function(a){return a.preventDefault(),!1}),!1),a.addEventListener(M,"resize",a.Ov,!1)}(a),"svg"===a.ml&&(b=a.pj.get("svg"),a.Ka.appendChild(b.Oa),a.ib=b.context)}}function Go(a){30<a.Rq&&(a.Yh=1)}function Xo(a,b){null!==a.Yh&&(a.Yh=null,b&&a.gk(),$&&$.nx||(a.Rq=0,a.zw=[0,0,0,0,0],a.Sq=0))}function Uo(a){if(null!==a.ta){var b=a.Ka;if(null!==b&&0!==b.clientWidth&&0!==b.clientHeight){a.Gw||a.setScrollWidth();var t=a.gf?a.Eb:0,e=a.Be?a.Eb:0,n=a.Nb;a.Nb=a.computePixelRatio(),a.Nb!==n&&(a.on=!0,a.ac()),b.clientWidth===a.Aa+t&&b.clientHeight===a.ya+e||(a.Ee=!0,a.Fc=!0,null!==(b=a.layout)&&b.isViewportSized&&a.autoScale===es&&(a.Ik=!0,b.C()),a.ld||a.ac())}}}function qo(a){var b=new Oo;b.name="Background",a.zl(b),(b=new Oo).name="",a.zl(b),(b=new Oo).name="Foreground",a.zl(b),(b=new Oo).name="Adornment",b.isTemporary=!0,b.isInDocumentBounds=!1,a.zl(b),(b=new Oo).name="Tool",b.isTemporary=!0,b.isInDocumentBounds=!0,a.zl(b),(b=new Oo).name="Grid",b.allowSelect=!1,b.pickable=!1,b.isTemporary=!0,b.isInDocumentBounds=!1,a.Ww(b,a.Pj("Background"))}function Ko(a){var b=new Eh(Eh.Grid);b.name="GRID";var t=new Ll;return t.figure="LineH",t.stroke="lightgray",t.strokeWidth=.5,t.interval=1,b.add(t),(t=new Ll).figure="LineH",t.stroke="gray",t.strokeWidth=.5,t.interval=5,b.add(t),(t=new Ll).figure="LineH",t.stroke="gray",t.strokeWidth=1,t.interval=10,b.add(t),(t=new Ll).figure="LineV",t.stroke="lightgray",t.strokeWidth=.5,t.interval=1,b.add(t),(t=new Ll).figure="LineV",t.stroke="gray",t.strokeWidth=.5,t.interval=5,b.add(t),(t=new Ll).figure="LineV",t.stroke="gray",t.strokeWidth=1,t.interval=10,b.add(t),(t=new zu).add(b),t.layerName="Grid",t.zOrder=0,t.isInDocumentBounds=!1,t.isAnimated=!1,t.pickable=!1,t.locationObjectName="GRID",a.add(t),a.partManager.parts.remove(t),b.visible=!1,b}function Ho(){this.H.fu?this.H.fu=!1:this.H.isEnabled?this.H.kx(this):yr(this.H)}function Wo(a){this.H.isEnabled?(this.H.ku=a.target.scrollTop,this.H.iu=a.target.scrollLeft):yr(this.H)}function Jo(a,b){if(a.fixedBounds.w())return b.assign(a.fixedBounds),b.Bo(a.zb),b;for(var t=!0,e=a.Wa.s,n=e.length,o=0;o<n;o++){var g=e[o];if(g.visible&&g.isInDocumentBounds)for(var r=(g=g.Pa.s).length,h=0;h<r;h++){var l=g[h];l.isInDocumentBounds&&l.isVisible()&&((l=l.actualBounds).w()&&(t?(t=!1,b.assign(l)):b.ed(l)))}}return t&&b.h(0,0,0,0),b.Bo(a.zb),b}function Zo(a,b){if((b||a.hf)&&!a.wb&&null!==a.ta&&a.documentBounds.w()){if(a.wb=!0,b){var t=a.initialPosition;if(t.w())return a.wb=!1,void(a.position=t);(t=St.alloc()).xi(a.documentBounds,a.initialDocumentSpot);var e=a.viewportBounds;e=Ut.allocAt(0,0,e.width,e.height);var n=St.alloc();n.xi(e,a.initialViewportSpot),n.h(t.x-n.x,t.y-n.y),a.position=n,Ut.free(e),St.free(n),St.free(t)}t=a.yh,b&&a.Fg!==es&&(t=a.Fg);var o=t!==es?_o(a,t):a.scale;t=a.pa.x,e=a.pa.y,n=a.Aa/o;var g=a.ya/o,r=a.yk,h=a.oq;b&&!r.sb()&&(h.sb()||h.Yb())&&(r=h.Yb()?fe:h),$o(a,a.documentBounds,n,g,r,b),b=a.scale,a.scale=o,a.wb=!1,o=a.viewportBounds,$e.B(o.x,t)&&$e.B(o.y,e)&&$e.B(o.width,n)&&$e.B(o.height,g)||a.onViewportBoundsChanged(new Ut(t,e,n,g),o,b,!1)}}function _o(a,b){var t=a.Op;if(null===a.ta)return t;a.Va();var e=a.documentBounds;if(!e.w())return t;var n=e.width;e=e.height;var o=a.Aa+(a.gf?a.Eb:0),g=a.ya+(a.Be?a.Eb:0),r=o/n,h=g/e;return b===is?((b=Math.min(h,r))>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):b===ns?((b=h>r?(g-a.Eb)/e:(o-a.Eb)/n)>t&&(b=t),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):a.scale}function $o(a,b,t,e,n,o){var g=St.allocAt(a.pa.x,a.pa.y),r=g.x,h=g.y;if(null!==a.cq){var l=St.alloc();r=(l=a.cq.ga(he,l)).x-a.eq.x/a.scale,h=l.y-a.eq.y/a.scale,n=ae,St.free(l)}(o||a.scrollMode===us)&&(n.sb()&&(t>b.width&&(r=b.x+(n.x*b.width+n.offsetX)-(n.x*t-n.offsetX)),e>b.height&&(h=b.y+(n.y*b.height+n.offsetY)-(n.y*e-n.offsetY))),n=a.rj,o=t-b.width,t<b.width+n.left+n.right?(r=Math.min(r+t/2,b.right+Math.max(o,n.right)-t/2),r=Math.max(r,b.left-Math.max(o,n.left)+t/2),r-=t/2):r>b.left?r=b.left:r<b.right-t&&(r=b.right-t),t=e-b.height,e<b.height+n.top+n.bottom?(h=Math.min(h+e/2,b.bottom+Math.max(t,n.bottom)-e/2),h=Math.max(h,b.top-Math.max(t,n.top)+e/2),h-=e/2):h>b.top?h=b.top:h<b.bottom-e&&(h=b.bottom-e)),g.x=isFinite(r)?r:-a.zb.left,g.y=isFinite(h)?h:-a.zb.top,null!==a.positionComputation&&(b=a.positionComputation(a,g),g.x=b.x,g.y=b.y),ho(a.Yd,a.pa,g),a.pa.h(g.x,g.y),Br(a),St.free(g)}function Qo(a,b,t,e){for(void 0===t&&(t=null),void 0===e&&(e=null),ur(a),a=a.Wa.iteratorBackwards;a.next();){var n=a.value;if(n.visible&&!n.isTemporary&&null!==(n=n.jc(b,t,e)))return n}return null}function er(a,b,t){var e=a.Qg;return a.Qg=a.cj,a.cj=e,e.diagram=a,e.event=b,t?rr(a,b,e):(e.viewPoint=a.Qg.viewPoint,e.documentPoint=a.Qg.documentPoint),a=0,b.ctrlKey&&(a+=1),b.altKey&&(a+=2),b.shiftKey&&(a+=4),b.metaKey&&(a+=8),e.modifiers=a,e.button=b.button,void 0!==b.buttons&&(e.buttons=b.buttons),K&&0===b.button&&b.ctrlKey&&(e.button=2),e.down=!1,e.up=!1,e.clickCount=1,e.delta=0,e.handled=!1,e.bubbles=!1,e.timestamp=b.timeStamp,e.isMultiTouch=!1,e.targetDiagram=ir(b,b.target),e.targetObject=null,e}function ir(a,b){return null===b?null:(b=b.H)?b:((b=a.path)||"function"!=typeof a.composedPath||(b=a.composedPath()),b&&b[0]&&b[0].H?b[0].H:null)}function nr(a,b,t,e,n,o){var g=a.Qg;return a.Qg=a.cj,a.cj=g,g.diagram=a,g.clickCount=1,a=g.delta=0,b.ctrlKey&&(a+=1),b.altKey&&(a+=2),b.shiftKey&&(a+=4),b.metaKey&&(a+=8),g.modifiers=a,g.event=b,g.timestamp=b.timeStamp,g.button=b.button,g.buttons=b.buttons,K&&0===b.button&&b.ctrlKey&&(g.button=2),g.down=t,g.up=e,g.handled=!1,g.bubbles=n,g.isMultiTouch=o,g}function or(a,b){return!!a.bubbles||(void 0!==b.stopPropagation&&b.stopPropagation(),!1!==b.cancelable&&b.preventDefault(),b.cancelBubble=!0,!1)}function rr(a,b,t){var e=a.ta,n=a.Aa,o=a.ya,g=0,r=0;null!==e&&(e=e.getBoundingClientRect(),g=b.clientX-n/e.width*e.left,r=b.clientY-o/e.height*e.top),t.viewPoint.h(g,r),null!==a.Bb?(b=St.allocAt(g,r),a.Bb.Cd(b),t.documentPoint.assign(b),St.free(b)):t.documentPoint.h(g,r)}function sr(a,b,t){if(null!==a.oj[0]){b=a.oj[b];var e=a.ta;null!==e&&(e=e.getBoundingClientRect(),t.h(b.clientX-a.Aa/e.width*e.left,b.clientY-a.ya/e.height*e.top))}}function ar(a,b,t){!a.Ee||a.wb||a.animationManager.defaultAnimation.isAnimating||yr(a)||(b&&ur(a),t&&Zo(a,!1))}function lr(a,b){if(!a.ld&&(a.kg=!1,null!==a.Ka||a.vo.w())){a.ld=!0;var t=a.animationManager,e=a.Wn;if(!t.isAnimating&&0!==e.length){for(var n=e.s,o=n.length,g=0;g<o;g++){var r=n[g];ga(r,!1),r.v()}e.clear()}0<(e=a.ow).count&&(e.each((function(a){a.Nv()})),e.clear()),n=e=!1,t.defaultAnimation.isAnimating&&(n=!0,e=a.skipsUndoManager,a.skipsUndoManager=!0),t.Ab||Uo(a),ar(a,!1,!0),null!==a.fe&&(a.fe.visible&&!a.lq&&(Lr(a),a.lq=!0),!a.fe.visible&&a.lq&&(a.lq=!1)),ur(a),o=!1,a.hf&&!a.xh||(a.hf?Rr(a,!a.Ik):(a.Ea("Initial Layout"),!1===t.isEnabled&&t.Cc(),Rr(a,!1)),o=!0),a.Ik=!1,ur(a),a.nu||function(a){a.ld||ur(a),a.Va()}(a),ar(a,!0,!1),g=!1,o?((t=Ut.alloc()).assign(a.viewportBounds),a.hf||(g=a.hf=!0,a.skipsUndoManager||(a.undoManager.isPendingClear=!0),a.undoManager.isPendingUnmodified=!0,function(a){if(a.Fg!==es)a.scale=_o(a,a.Fg);else if(a.yh!==es)a.scale=_o(a,a.yh);else{var b=a.initialScale;isFinite(b)&&0<b&&(a.scale=b)}Zo(a,!0),b=a.Wa.s,a.Fd(b,b.length,a,a.viewportBounds),a.R("InitialLayoutCompleted"),a.cu.assign(a.pa),Lr(a)}(a)),a.R("LayoutCompleted"),ar(a,!0,!1),Ut.free(t)):t.Nk&&t.Qw&&(a.Fg!==es?a.scale=_o(a,a.Fg):a.yh!==es?a.scale=_o(a,a.yh):(t=a.initialScale,isFinite(t)&&0<t&&(a.scale=t)),Zo(a,!0)),o&&g&&a.eb("Initial Layout"),ur(a),b||a.hc(a.ib),n&&(a.skipsUndoManager=e),a.ld=!1}}function ur(a){if(0!==a.De.count&&(a.ld||!a.animationManager.isTicking)){for(var b=0;23>b;b++){var t=a.De.iterator;if(null===t||0===a.De.count)break;a.De=new at,a.Nv(t,a.De)}a.nodes.each((function(a){a instanceof Cc&&0!=(65536&a.U)!=!1&&(a.U=65536^a.U)}))}}function cr(a,b){for(var t=z(),e=z(),n=b.memberParts;n.next();){var o=n.value;o.isVisible()&&(o instanceof Cc?(pa(o)||ma(o)||_u(o))&&cr(a,o):o instanceof Oc?o.fromNode===b||o.toNode===b?e.push(o):t.push(o):(o.measure(1/0,1/0),o.arrange()))}for(a=t.length,n=0;n<a;n++)(o=t[n]).measure(1/0,1/0),o.arrange();for(R(t),b.measure(1/0,1/0),b.arrange(),a=e.length,b=0;b<a;b++)(t=e[b]).measure(1/0,1/0),t.arrange();R(e)}function fr(a,b,t,e,n,o,g,r,h,l){if(null!==a.Ka){null===a.ta&&T("No canvas specified"),void 0===g&&(g=null),void 0===r&&(r=null),void 0===h&&(h=!1),void 0===l&&(l=!1),gr(a),a.ib.Vc(!0),a.vd=!0,a.$i=!0;var c=a.Ca;a.Ca=n;var f=a.Wa.s,p=f.length;try{var q=new Ut(o.x,o.y,e.width/n,e.height/n),d=q.copy();d.Bo(t),Lr(a,d),ur(a),a.Fd(f,p,a,q),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,e.width,e.height),null!==r&&""!==r&&(b.fillStyle=r,b.ox(0,0,e.width,e.height));var u=a.Nb;b.scale(u,u);var m=Ze.alloc();m.reset(),m.translate(t.left,t.top),m.scale(n),0===o.x&&0===o.y||m.translate(-o.x,-o.y),b.setTransform(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),b.yc(),b instanceof Aa&&ja(b,m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),Ze.free(m),dr(a,b),b.globalAlpha=a.pb;var y=a.Pj("Grid");if(g){var v=new at,x=g.iterator;for(x.reset();x.next();){var w=x.value;w instanceof zu&&(l||w.layer!==y)&&(w.Fj(),v.add(w))}for(l=0;l<p;l++)Do(f[l],b,a,v,h);v.each((function(a){return a.Fj()}))}else for(v=0;v<p;v++){var k=f[v];k===y?l&&k.hc(b,a,!0):k.hc(b,a,h)}a.$i=!1,a.Yf&&ws(a.Yf,a)&&a.Up()}finally{a.Ca=c,a.ib.Vc(!0),a.vd=!0,a.Fd(f,p,a,a.viewportBounds),Lr(a),a.ib instanceof Aa&&(a.ib.Mj.PA(),a.redraw())}}}function dr(a,b){null!==(a=a.Rg)&&(void 0!==a.imageSmoothingEnabled&&b.Wx(!!a.imageSmoothingEnabled),null!=(a=a.defaultFont)&&(b.font=a))}function pr(a,b){var t,e=a instanceof Eh,n=a instanceof zo;for(t in b){""===t&&T("Setting properties requires non-empty property names");var o=a,g=t;if(e||n){var r=t.indexOf(".");if(0<r){var h=t.substring(0,r);e?o=a.fb(h):null==(o=a[h])&&(o=a.toolManager[h]),F(o)?g=t.substr(r+1):T("Unable to find object named: "+h+" in "+a.toString()+" when trying to set property: "+t)}}if("_"!==g[0]&&!Y(o,g)){if(n&&"ModelChanged"===g){a.Yw(b[g]);continue}if(n&&"Changed"===g){a.Pe(b[g]);continue}if(n&&Y(a.toolManager,g))o=a.toolManager;else{if(n&&Vr(a,g)){a.Bj(g,b[g]);continue}if(a instanceof Ad&&"Changed"===g){a.Pe(b[g]);continue}T('Trying to set undefined property "'+g+'" on object: '+o.toString())}}o[g]=b[t],"_"===g[0]&&o instanceof qs&&o.Vw(g)}}function gr(a){!1!==a.on&&(a.on=!1,mr(a,a.Aa,a.ya))}function mr(a,b,t){Br(a);var e=a.Nb;a.ta.resize(b*e,t*e,b,t)&&(a.Fc=!0,a.ib.Vc(!0))}function yr(a){var b=a.ta;if(null===b||a.vo.w())return!0;var t=a.Aa,e=a.ya,n=a.Ka,o=!1,g=a.gf?a.Eb:0,r=a.Be?a.Eb:0,h=n.clientWidth||t+g,l=n.clientHeight||e+r,c=a.viewportBounds;n=c.x;var f=c.y,p=c.width,q=c.height;if(h===t+g&&l===e+r||(a.gf=!1,a.Be=!1,r=g=0,a.Aa=h,a.ya=l,o=a.on=!0,Br(a)),!a.hf||!a.viewportBounds.w())return!0;var d=a.ju,u=a.gu;if(a.Ee=!1,!(o||a.gf||a.Be||a.ln||a.mn))return!0;var m=a.documentBounds,y=0,v=0,x=0,w=0,k=c.width,M=c.height,S=a.rj;a.contentAlignment.sb()?(m.width>k&&(y=S.left,v=S.right),m.height>M&&(x=S.top,w=S.bottom)):(y=S.left,v=S.right,x=S.top,w=S.bottom);var P=m.width+y+v,N=m.height+x+w,C=P>h/(S=a.scale),T=N>l/S;if(!(o||a.gf||a.Be||C||T))return!0;y=m.x-y,h=c.x,v=m.right+v,l=c.right+g,x=m.y-x;var L=c.y;m=m.bottom+w,c=c.bottom+r;var A="1px";if(w="1px",a.scrollMode===us&&(C||T)&&(C&&a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(C=1,y+1<h&&(C=Math.max((h-y)*S+a.Aa,C)),v>l+1&&(C=Math.max((v-l)*S+a.Aa,C)),k+g+1<P&&(C=Math.max((P-k)*S+a.Aa,C)),A=C.toString()+"px"),T&&a.hasVerticalScrollbar&&a.allowVerticalScroll&&(C=1,x+1<L&&(C=Math.max((L-x)*S+a.ya,C)),m>c+1&&(C=Math.max((m-c)*S+a.ya,C)),M+r+1<N&&(C=Math.max((N-M)*S+a.ya,C)),w=C.toString()+"px")),T="1px"!==w,(C="1px"!==A)&&T||!C&&!T||(T&&(l-=a.Eb),C&&(c-=a.Eb),P<k+g||!a.hasHorizontalScrollbar||!a.allowHorizontalScroll||(g=1,y+1<h&&(g=Math.max((h-y)*S+a.Aa,g)),v>l+1&&(g=Math.max((v-l)*S+a.Aa,g)),k+1<P&&(g=Math.max((P-k)*S+a.Aa,g)),A=g.toString()+"px"),C="1px"!==A,g=a.ya,C!==a.Be&&(g=C?a.ya-a.Eb:a.ya+a.Eb),N<M+r||!a.hasVerticalScrollbar||!a.allowVerticalScroll||(r=1,x+1<L&&(r=Math.max((L-x)*S+g,r)),m>c+1&&(r=Math.max((m-c)*S+g,r)),M+1<N&&(r=Math.max((N-M)*S+g,r)),w=r.toString()+"px"),T="1px"!==w),a.pr&&C===a.Be&&T===a.gf)return t===a.Aa&&e===a.ya||a.bd(),!1;if(C!==a.Be&&(a.ya="1px"===A?a.ya+a.Eb:Math.max(a.ya-a.Eb,1),o=!0),a.Be=C,u.style.width=A,T!==a.gf&&(a.Aa="1px"===w?a.Aa+a.Eb:Math.max(a.Aa-a.Eb,1),o=!0,a.sn&&(r=St.alloc(),T?(b.style.left=a.Eb+"px",a.position=r.h(a.pa.x+a.Eb/a.scale,a.pa.y)):(b.style.left="0px",a.position=r.h(a.pa.x-a.Eb/a.scale,a.pa.y)),St.free(r))),o&&Br(a),a.gf=T,u.style.height=w,a.fu=!0,o&&(a.on=!0),b=d.scrollLeft,a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(k+1<P?b=(a.position.x-y)*S:y+1<h?b=d.scrollWidth-d.clientWidth:v>l+1&&(b=a.position.x*S)),a.sn)switch(a.au){case"negative":b=-(d.scrollWidth-b-d.clientWidth);break;case"reverse":b=d.scrollWidth-b-d.clientWidth}return d.scrollLeft=b,a.hasVerticalScrollbar&&a.allowVerticalScroll&&(M+1<N?d.scrollTop=(a.position.y-x)*S:x+1<L?d.scrollTop=d.scrollHeight-d.clientHeight:m>c+1&&(d.scrollTop=a.position.y*S)),h=a.Aa,l=a.ya,d.style.width=h+(a.gf?a.Eb:0)+"px",d.style.height=l+(a.Be?a.Eb:0)+"px",t===h&&e===l&&!a.animationManager.Ab||(t=Ut.allocAt(n,f,p,q),a.onViewportBoundsChanged(t,a.viewportBounds,S,o),Ut.free(t),!1)}function vr(a,b,t){var e=b.layer;null!==e&&e.diagram===a&&(b.isSelected=!1,b.isHighlighted=!1,b.C(2),t&&b.Kj(),0<=(t=e.qc(-1,b,!1))&&a.cb(Si,"parts",e,b,null,t,null),null!==(a=b.layerChanged)&&a(b,e,null))}function xr(a,b,t,e,n,o){if(!b.contains(t)&&(void 0===o&&(o=!1),!e||o||t.canMove()||t.canCopy()))if(void 0===n&&(n=kr(a)),t instanceof uc){if(b.add(t,a.Pd(n,t,t.location)),t instanceof Cc&&(null!==t.placeholder||n.dragsMembers))for(o=t.memberParts;o.next();)xr(a,b,o.value,e,n,n.groupsAlwaysMove);for(o=t.linksConnected;o.next();){var g=o.value;if(!b.contains(g)){var r=g.fromNode,h=g.toNode;null!==r&&b.contains(r)&&null!==h&&b.contains(h)&&xr(a,b,g,e,n)}}if(n.dragsTree)for(t=t.Ou();t.next();)xr(a,b,t.value,e,n)}else if(t instanceof Oc)for(b.add(t,a.Pd(n,t)),t=t.labelNodes;t.next();)xr(a,b,t.value,e,n);else t instanceof hc||b.add(t,a.Pd(n,t,t.location))}function wr(a,b,t,e,n){if(null!==b&&0!==b.count){var o=St.alloc(),g=St.alloc();g.assign(t),isNaN(g.x)&&(g.x=0),isNaN(g.y)&&(g.y=0),(t=a.Lr)||Sr(a,b);for(var r=z(),h=z(),l=b.iterator,c=St.alloc();l.next();){var f=l.key,p=l.value;if(f.Zc()){var q=Nr(a,f,b);null!==q?r.push(new Bs(f,p,q)):n&&!f.canMove()||(q=p.point,o.assign(q),a.computeMove(f,o.add(g),e,c),f.location=c,void 0===p.shifted&&(p.shifted=new St),p.shifted.assign(c.re(q)))}else l.key instanceof Oc&&h.push(l.sa)}for(St.free(c),n=r.length,l=0;l<n;l++)f=r[l],o.assign(f.info.point),void 0===f.Su.shifted&&(f.Su.shifted=new St),f.node.location=o.add(f.Su.shifted);for(n=St.alloc(),l=St.alloc(),f=h.length,p=0;p<f;p++){var d=h[p];if((q=d.key)instanceof Oc)if(q.suspendsRouting){q.Tg=null,c=q.fromNode;var u=q.toNode;if(null!==a.draggedLink&&e.dragsLink)if(u=d.value.point,null===q.dragComputation)b.add(q,a.Pd(e,q,g)),Ic(q,g.x-u.x,g.y-u.y);else{d=St.allocAt(0,0),(c=q.i(0))&&c.w()&&d.assign(c);var m=c=St.alloc().assign(d).add(g);e.isGridSnapEnabled&&(e.isGridSnapRealtime||a.lastInput.up)&&Mr(a,q,c,m=St.alloc(),e),c.assign(q.dragComputation(q,c,m)).re(d),b.add(q,a.Pd(e,q,c)),Ic(q,c.x-u.x,c.y-u.y),St.free(d),St.free(c),m!==c&&St.free(m)}else null!==c&&(n.assign(c.location),null!==(m=b.I(c))&&n.re(m.point)),null!==u&&(l.assign(u.location),null!==(m=b.I(u))&&l.re(m.point)),null!==c&&null!==u?n.Xa(l)?(c=d.value.point,(u=o).assign(n),u.re(c),b.add(q,a.Pd(e,q,n)),Ic(q,u.x,u.y)):(q.suspendsRouting=!1,q.bb()):(d=d.value.point,c=null!==c?n:null!==u?l:g,b.add(q,a.Pd(e,q,c)),Ic(q,c.x-d.x,c.y-d.y))}else null!==q.fromNode&&null!==q.toNode||(c=d.value.point,b.add(q,a.Pd(e,q,g)),Ic(q,g.x-c.x,g.y-c.y))}St.free(o),St.free(g),St.free(n),St.free(l),R(r),R(h),t||(ur(a),Pr(a,b))}}function kr(a){var b=a.toolManager.findTool("Dragging");return null!==b?b.dragOptions:a.Vm}function Mr(a,b,t,e,n){if(void 0===n&&(n=kr(a)),e.assign(t),null!==b){var o=a.grid;a=(b=n.gridSnapCellSize).width,b=b.height;var g=n.gridSnapOrigin,r=g.x;if(g=g.y,n=n.gridSnapCellSpot,null!==o){var h=o.gridCellSize;isNaN(a)&&(a=h.width),isNaN(b)&&(b=h.height),o=o.gridOrigin,isNaN(r)&&(r=o.x),isNaN(g)&&(g=o.y)}(o=St.allocAt(0,0)).yi(0,0,a,b,n),$e.Mo(t.x,t.y,r+o.x,g+o.y,a,b,e),St.free(o)}}function Sr(a,b){if(null!==b)for(a.Lr=!0,a=b.iterator;a.next();)(b=a.key)instanceof Oc&&(b.suspendsRouting=!0)}function Pr(a,b){if(null!==b){for(b=b.iterator;b.next();){var t=b.key;t instanceof Oc&&(t.suspendsRouting=!1,Gc(t)&&t.bb())}a.Lr=!1}}function Nr(a,b,t){if(null!==(b=b.containingGroup)){if(null!==(a=Nr(a,b,t)))return a;if(null!==(a=t.I(b)))return a}return null}function Cr(a,b,t){if(null!==b.diagram&&b.diagram!==a&&T("Cannot share a Layer with another Diagram: "+b+" of "+b.diagram),null===t?null!==b.diagram&&T("Cannot add an existing Layer to this Diagram again: "+b):(t.diagram!==a&&T("Existing Layer must be in this Diagram: "+t+" not in "+t.diagram),b===t&&T("Cannot move a Layer before or after itself: "+b)),b.diagram!==a){b=b.name,t=(a=a.Wa).count;for(var e=0;e<t;e++)a.M(e).name===b&&T("Cannot add Layer with the name '"+b+"'; a Layer with the same name is already present in this Diagram.")}}function Tr(a,b,t){var e=a.animationManager;if(a.wb||a.ld)a.Ca=t,Br(a),a.N(),a.Ee=!0,e.Ab&&(oo(e)||e.ce.add(e.H,"scale",b,a.Ca));else if(null===a.ta)a.Ca=t,Br(a);else{a.wb=!0;var n=a.viewportBounds.copy(),o=a.Aa,g=a.ya,r=a.zoomPoint.x,h=a.zoomPoint.y,l=a.contentAlignment;isNaN(r)&&(l.$c()?l.Hf(ve)?r=0:l.Hf(xe)&&(r=o-1):r=l.sb()?l.x*(o-1):o/2),isNaN(h)&&(l.$c()?l.Hf(ye)?h=0:l.Hf(be)&&(h=g-1):h=l.sb()?l.y*(g-1):g/2),null===a.scaleComputation||a.animationManager.defaultAnimation.isAnimating||(t=a.scaleComputation(a,t)),t<a.minScale&&(t=a.minScale),t>a.maxScale&&(t=a.maxScale),o=St.allocAt(a.pa.x+r/b-r/t,a.pa.y+h/b-h/t),a.position=o,St.free(o),a.Ca=t,Br(a),a.wb=!1,a.onViewportBoundsChanged(n,a.viewportBounds,b,!1),Zo(a,!1),e.Ab&&(oo(e)||e.ce.add(e.H,"scale",b,a.Ca))}}function Lr(a,b){var t=a.fe;if(null!==t&&t.visible){for(var e=Vt.alloc(),n=1,o=1,g=t.O.s,r=g.length,h=0;h<r;h++){var l=g[h],c=Math.abs(l.interval);2>c||(Uh(l.figure)?o=o*c/$e.vx(o,c):n=n*c/$e.vx(n,c))}if(g=t.gridCellSize,e.h(o*g.width,n*g.height),void 0!==b)n=b.width,o=b.height,a=b.x,g=b.y;else{if(b=Ut.alloc(),a=a.viewportBounds,b.h(a.x,a.y,a.width,a.height),!b.w())return void Ut.free(b);n=b.width,o=b.height,a=b.x,g=b.y,Ut.free(b)}t.width=n+2*e.width,t.height=o+2*e.height,b=St.alloc(),$e.Mo(a,g,0,0,e.width,e.height,b),b.offset(-e.width,-e.height),Vt.free(e),t.part.location=b,St.free(b)}}function Ar(a){var b=a.isModified;a.Tw!==b&&(a.Tw=b,a.R("Modified"))}function jr(a,b){for(var t=(b=b.O.s).length,e=0;e<t;e++)Fr(a,b[e])}function Fr(a,b){if(b instanceof xu){var t=b.element;if(null!==t&&t instanceof HTMLImageElement){t.Bg instanceof at&&t.Bg.add(a);var e=b.Eg;if(null!==e&&!0===e.rq&&null!==b.diagram&&b.diagram.Wn.add(b),t.gn)if(t=t.getAttribute("src")||"",null===(e=a.Og.I(t)))(e=[]).push(b),a.Og.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}}function Or(a,b){if(b instanceof xu){var t=b.element;if(null!==t&&t instanceof HTMLImageElement&&t.gn){var e=t.getAttribute("src")||"",n=a.Og.I(e);if(null!==n)for(var o=0;o<n.length;o++)if(n[o]===b){n.splice(o,1),0===n.length&&(a.Og.remove(e),t.Eq&&t.removeEventListener("load",t.Eq),t.Xp&&t.removeEventListener("error",t.Xp),delete t.Eq,delete t.Xp,t.Bg instanceof at&&t.Bg.remove(a),bu(e));break}}}}function Br(a){var b=a.pa,t=a.Ca;a.Rw.h(b.x,b.y,Math.max(a.Aa,0)/t,Math.max(a.ya,0)/t),a.vd=!0}function Dr(a,b){a.Zi=!1;var t=a.Rp;t.D(b)||(t=t.copy(),a.Rp.assign(b),Zo(a,!1),a.R("DocumentBoundsChanged",void 0,t),a.Ee=!0,a.N())}function Ir(a,b){for(var t=a.ai.iterator;t.next();)zr(a,t.value,b);a.layout&&(b?a.layout.isValidLayout=!1:a.layout.C())}function zr(a,b,t){if(null!==b){for(var e=b.fl.iterator;e.next();)zr(a,e.value,t);null!==b.layout&&(t?b.layout.isValidLayout=!1:b.layout.C())}}function Rr(a,b){if(a.xh&&!a.kt){var t=a.aa;a.aa=!0;var e=a.undoManager.transactionLevel,n=a.layout,o=a.animationManager;try{0===e&&(a.undoManager.isInternalTransaction=!0,a.Ea("Layout")),1>=e&&!o.defaultAnimation.isAnimating&&!o.Ab&&(b||io(o,"Layout")),a.xh=!1;for(var g=a.ai.iterator;g.next();)Er(a,g.value,b,e);n.isValidLayout||(!b||n.isRealtime||null===n.isRealtime||0===e?(n.doLayout(a),ur(a),n.isValidLayout=!0):a.xh=!0)}finally{b=a.undoManager.isInternalTransaction,0===e&&(a.eb("Layout"),a.undoManager.isInternalTransaction=!1),!b||0!==e&&1!==e||no(o),a.aa=t}}}function Er(a,b,t,e){if(null!==b){for(var n=b.fl.iterator;n.next();)Er(a,n.value,t,e);null===(n=b.layout)||n.isValidLayout||(!t||n.isRealtime||0===e?(b.rh=!b.location.w(),n.doLayout(b),b.C(32),cr(a,b),n.isValidLayout=!0):a.xh=!0)}}function Vr(a,b){var t=a.hw.I(b);return null!==t?t:a.hw.I(b.toLowerCase())}function Yr(a,b){var t=a.iw.I(b);return null!==t||null!==(t=a.iw.I(b.toLowerCase()))?t:void T("Unknown DiagramEvent name: "+b)}function Gr(a){if(a.animationManager.isTicking)return!1;var b=a.currentTool;return b!==a.toolManager.findTool("Dragging")||(!a.Lr||b.isComplexRoutingRealtime)}function Xr(a,b,t,e){var n=a.Xh;if(null===n&&(a.Xh=n=new Nf(a.avoidanceCellSize)),n.us||n.group!==t||n.Yx!==e){if(n.Hx=Math.max(n.Ns+1,Math.floor(a.avoidanceLimit/a.avoidanceCellSize.width)),n.Ix=Math.max(n.Ns+1,Math.floor(a.avoidanceLimit/a.avoidanceCellSize.height)),null!==t&&(t=Ur(a,t)),null===t){b=Ut.alloc(),a.computeOccupiedArea(b),b.Bc(100,100),n.initialize(b);for(var o=a.nodes;o.next();){var g=o.value,r=g.layer;null!==r&&r.visible&&!r.isTemporary&&qr(a,g,e,b)}Ut.free(b)}else{for(0<t.memberParts.count&&((b=a.computePartsBounds(t.memberParts,!1)).Bc(20,20),n.initialize(b)),b=Ut.alloc(),o=t.memberParts;o.next();)(g=o.value)instanceof uc&&qr(a,g,e,b);Ut.free(b)}n.group=t,n.Yx=e,n.us=!1}else b&&Lf(n);return n}function Ur(a,b){return b.avoidable&&!b.isLinkLabel?b:null!==b.containingGroup?Ur(a,b.containingGroup):null}function qr(a,b,t,e){if(b!==t&&b.isVisible())if(b.avoidable&&!b.isLinkLabel){b=b.getAvoidableRect(e),a=a.Xh;var n=b.x,o=b.y;if(Cf(a,n,o))for(t=(o-a.Od)/a.tc|0,e=Math.min((n+b.width-a.Nd)/a.sc|0,a.di),b=Math.min((o+b.height-a.Od)/a.tc|0,a.ei),n=(n-a.Nd)/a.sc|0;n<=e;n++)if((o=a.bc[n]).fill)o.fill(Df,t,b+1);else for(var g=t;g<=b;g++)o[g]=Df}else if(b instanceof Cc)for(b=b.memberParts;b.next();)(n=b.value)instanceof uc&&qr(a,n,t,e)}function Kr(a,b){null===a.Xh||a.Xh.us||void 0!==b&&(!b.avoidable||b.isLinkLabel)||(a.Xh.us=!0)}function Hr(a){-1===a.uk&&(a.uk=N((function(){if(-1!==a.uk&&(a.ug(),null!==a.lastInput.event)){var b=a.computeAutoScrollPosition(a.vp);b.Xa(a.position)||(a.position=b,a.lastInput.documentPoint=a.Os(a.vp),a.doMouseMove(),a.Zi=!0,b=Ut.alloc(),a.computeBounds(b),b.ed(a.documentBounds),Dr(a,b),Ut.free(b),a.Fc=!0,a.bd(),Hr(a))}}),a.tp))}function Wr(a,b,t){function e(){var a=+new Date;for(o=!0,g.reset();g.next();)if(!g.value[0].$k){o=!1;break}o||a-l>h?b(t,n,r):M.requestAnimationFrame(e)}for(var n=t.callback,o=!0,g=a.Og.iterator;g.next();)if(!g.value[0].$k){o=!1;break}if("function"!=typeof n||o)return b(t,n,a);var r=a,h=t.callbackTimeout||300,l=+new Date;return M.requestAnimationFrame((function(){e()})),null}function Jr(a,b,t,e){if(a.animationManager.Cc(),a.bd(),null===a.ta)return null;"object"!=typeof b&&T("properties argument must be an Object.");var n=b.size||null,o=b.scale||null;void 0!==b.scale&&isNaN(b.scale)&&(o="NaN");var g=b.maxSize;void 0===b.maxSize&&(g="SVG"===t?new Vt(1/0,1/0):new Vt(2e3,2e3));var r=b.position||null,h=b.parts||null,l=void 0===b.padding?1:b.padding,c=b.background||null,f=b.omitTemporary;void 0===f&&(f=!0);var p=b.document||document,q=b.elementFinished||null,d=b.showTemporary;void 0===d&&(d=!f),void 0===(b=b.showGrid)&&(b=d),null!==n&&isNaN(n.width)&&isNaN(n.height)&&(n=null),"number"==typeof l?l=new oe(l):l instanceof oe||T("MakeImage padding must be a Margin or a number."),l.left=Math.max(l.left,0),l.right=Math.max(l.right,0),l.top=Math.max(l.top,0),l.bottom=Math.max(l.bottom,0),a.ib.Vc(!0);var u=(f=new Xa(null,p,void 0,!0)).context;if(!(n||o||h||r))return f.width=a.Aa+Math.ceil(l.left+l.right),f.height=a.ya+Math.ceil(l.top+l.bottom),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.gs=q,fr(a,e.context,l,new Vt(f.width,f.height),a.Ca,a.pa,h,c,d,b),e.context):(a.Wm=!1,fr(a,u,l,new Vt(f.width,f.height),a.Ca,a.pa,h,c,d,b),a.Wm=!0,f.context);var m=a.Op,y=a.documentBounds.copy();if(y.Fv(a.zb),d)for(var v=a.Wa.s,x=v.length,w=0;w<x;w++){var k=v[w];if(k.visible&&k.isTemporary)for(var M=(k=k.Pa.s).length,S=0;S<M;S++){var P=k[S];P.isInDocumentBounds&&P.isVisible()&&((P=P.actualBounds).w()&&y.ed(P))}}if(v=new St(y.x,y.y),null!==h){for(x=new Ut(0,0,0,0),w=!0,(k=h.iterator).reset();k.next();)(M=k.value)instanceof zu&&(null!==(S=M.layer)&&!S.visible||null!==S&&!d&&S.isTemporary||!M.isVisible()||(M=M.actualBounds).w()&&(w?(w=!1,x.assign(M)):x.ed(M)));y.width=x.width,y.height=x.height,v.x=x.x,v.y=x.y}return null!==r&&r.w()&&(v=r,o||(o=m)),x=r=0,null!==l&&(r=l.left+l.right,x=l.top+l.bottom),w=k=0,null!==n&&(k=n.width,w=n.height,isFinite(k)&&(k=Math.max(0,k-r)),isFinite(w)&&(w=Math.max(0,w-x))),null!==n&&null!==o?("NaN"===o&&(o=m),n.w()?(n=k,y=w):isNaN(w)?(n=k,y=y.height*o):(n=y.width*o,y=w)):null!==n?n.w()?(o=Math.min(k/y.width,w/y.height),n=k,y=w):isNaN(w)?(o=k/y.width,n=k,y=y.height*o):(o=w/y.height,n=y.width*o,y=w):null!==o?"NaN"===o&&g.w()?(o=Math.min((g.width-r)/y.width,(g.height-x)/y.height))>m?(o=m,n=y.width,y=y.height):(n=g.width,y=g.height):(n=y.width*o,y=y.height*o):(o=m,n=y.width,y=y.height),null!==l?(n+=r,y+=x):l=new oe(0),null!==g&&(m=g.width,g=g.height,isNaN(m)&&(m=2e3),isNaN(g)&&(g=2e3),isFinite(m)&&(n=Math.min(n,m)),isFinite(g)&&(y=Math.min(y,g))),f.width=Math.ceil(n),f.height=Math.ceil(y),"SVG"===t?null===e?null:(e.resize(f.width,f.height,f.width,f.height),e.ownerDocument=p,e.gs=q,fr(a,e.context,l,new Vt(Math.ceil(n),Math.ceil(y)),o,v,h,c,d,b),e.context):(a.Wm=!1,fr(a,u,l,new Vt(Math.ceil(n),Math.ceil(y)),o,v,h,c,d,b),a.Wm=!0,f.context)}Co.className="AnimationTrigger",Co.Default=Ao,Co.Immediate=jo,Co.Bundled=Fo,(e=Oo.prototype).clear=function(){for(var a=this.Pa,b=0;b<a.length;b++){var t=a.s[b];t.Ig=null,ia(t)}a.clear(),this.Yq.length=0},e.Xe=function(a){this.H=a},e.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var t=0,e=0,n=0,o=0,g=0,r=this.Pa.iterator;r.next();){var h=r.value;h instanceof Cc?n++:h instanceof uc?e++:h instanceof Oc?o++:h instanceof hc?g++:t++}if(r="",0<t&&(r+=t+" Parts "),0<e&&(r+=e+" Nodes "),0<n&&(r+=n+" Groups "),0<o&&(r+=o+" Links "),0<g&&(r+=g+" Adornments "),1<a)for(a=this.Pa.iterator;a.next();)r+="\n    "+(t=a.value).toString(),null!==(e=t.data)&&ut(e)&&(r+=" #"+ut(e)),t instanceof uc?r+=" "+V(e):t instanceof Oc&&(r+=" "+V(t.fromNode)+" "+V(t.toNode));return b+" "+this.Pa.count+": "+r},e.jc=function(a,b,t){if(void 0===b&&(b=null),void 0===t&&(t=null),!1===this.Uh)return null;var e=!1;null!==this.diagram&&this.diagram.viewportBounds.ca(a)&&(e=!0);for(var n=St.alloc(),o=this.Pa.s,g=o.length;g--;){var r=o[g];if((!0!==e||!1!==tc(r))&&r.isVisible()&&(n.assign(a),Tt(n,r.oe),null!==(r=r.jc(n,b,t))&&(null!==b&&(r=b(r)),null!==r&&(null===t||t(r)))))return St.free(n),r}return St.free(n),null},e.ji=function(a,b,t,e){if(void 0===b&&(b=null),void 0===t&&(t=null),e instanceof ot||e instanceof at||(e=new at),!1===this.Uh)return e;var n=!1;null!==this.diagram&&this.diagram.viewportBounds.ca(a)&&(n=!0);for(var o=St.alloc(),g=this.Pa.s,r=g.length;r--;){var h=g[r];if((!0!==n||!1!==tc(h))&&h.isVisible()){o.assign(a),Tt(o,h.oe);var l=h;h.ji(o,b,t,e)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||e.add(l))}}return St.free(o),e},e.Cf=function(a,b,t,e,n){if(void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ot||n instanceof at||(n=new at),!1===this.Uh)return n;var o=!1;null!==this.diagram&&this.diagram.viewportBounds.Re(a)&&(o=!0);for(var g=this.Pa.s,r=g.length;r--;){var h=g[r];if((!0!==o||!1!==tc(h))&&h.isVisible()){var l=h;h.Cf(a,b,t,e,n)&&(null!==b&&(l=b(l)),null===l||null!==t&&!t(l)||n.add(l))}}return n},e.Nu=function(a,b,t,e,n,o,g){if(!1===this.Uh)return n;for(var r=this.Pa.s,h=r.length;h--;){var l=r[h];if((!0!==g||!1!==tc(l))&&o(l)&&l.isVisible()){var c=l;l.Cf(a,b,t,e,n)&&(null!==b&&(c=b(c)),null===c||null!==t&&!t(c)||n.add(c))}}return n},e.og=function(a,b,t,e,n,o){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ot||n instanceof at)&&(o=n),n=!0),o instanceof ot||o instanceof at||(o=new at),!1===this.Uh)return o;var g=!1;null!==this.diagram&&this.diagram.viewportBounds.ca(a)&&(g=!0);for(var r=St.alloc(),h=St.alloc(),l=this.Pa.s,c=l.length;c--;){var f=l[c];if((!0!==g||!1!==tc(f))&&f.isVisible()){r.assign(a),Tt(r,f.oe),h.h(a.x+b,a.y),Tt(h,f.oe);var p=f;f.og(r,h,t,e,n,o)&&(null!==t&&(p=t(p)),null===p||null!==e&&!e(p)||o.add(p))}}return St.free(r),St.free(h),o},e.Fd=function(a,b){if(this.visible){var t=this.Pa.s,e=t.length;if(0!==e){a=z();for(var n=z(),o=0;o<e;o++){var g=t[o];if(g.vw=o,g instanceof Oc){if(!1===g.fd)continue}else if(g instanceof hc&&null!==g.adornedPart)continue;var r=g.actualBounds;g.isVisible()&&_t(r,b)?(g.Fd(!0),a.push(g)):(g.Fd(!1),null!==g.adornments&&0<g.adornments.count&&n.push(g))}for(b=0;b<a.length;b++)for(Eu(t=a[b]),t=t.adornments;t.next();)(e=t.value).measure(1/0,1/0),e.arrange(),e.Fd(!0);for(b=0;b<n.length;b++)Eu(n[b]);R(a),R(n)}}},e.hc=function(a,b,t){if(this.visible&&0!==this.pb&&(void 0===t&&(t=!0),t||!this.isTemporary)){var e=(t=this.Pa.s).length;if(0!==e){if(a.isTemporary)for(var n=0;n<e;n++)t[n].Fj();n=Bo(this,a);var o=this.Yq;o.length=0;for(var g=b.scale,r=Ut.alloc(),h=0;h<e;h++)this.Nj(a,t[h],b,o,g,r,!0);if(Ut.free(r),a.isTemporary)for(b=0;b<e;b++)t[b].Fj();a.globalAlpha=n}}},e.Nj=function(a,b,t,e,n,o,g){if(g&&!tc(b))a.Gs(b);else{if(null!==e&&b instanceof Oc&&(b.isOrthogonal&&e.push(b),!1===b.fd))return void a.Gs(b);for(g=!1,e=b.containingGroup;null!==e;)g?null!==e.tb&&o.Ex(e.tb):null!==e.tb&&(g=!0,o.assign(e.tb)),e=e.containingGroup;var r=b.actualBounds;if(e=!1,g&&b.isVisible()){if(!o.Yc(r))return void a.Gs(b);e=!o.Re(r)}e&&(a.save(),a instanceof Aa?a.ak=o.copy():(a.beginPath(),a.rect(o.x,o.y,o.width,o.height),a.clip())),r.width*n>t.Nq||r.height*n>t.Nq?b.hc(a,t):(n=b.actualBounds,o=b.naturalBounds,0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y)||!b.isVisible()||(t=b.transform,null!==b.areaBackground&&(na(b,a,b.areaBackground,!0,!0,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null===b.areaBackground&&null===b.background&&(na(b,a,"rgba(0,0,0,0.3)",!0,!1,o,n),a.fillRect(n.x,n.y,n.width,n.height)),null!==b.background&&(a.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),na(b,a,b.background,!0,!1,o,n),a.fillRect(0,0,o.width/2,o.height/2),t.vs()||(b=1/(t.m11*t.m22-t.m12*t.m21),a.transform(t.m22*b,-t.m12*b,-t.m21*b,t.m11*b,b*(t.m21*t.dy-t.m22*t.dx),b*(t.m12*t.dx-t.m11*t.dy)))))),e&&(a.restore(),a.Vc(!0))}},e.g=function(a,b,t,e,n){var o=this.diagram;null!==o&&o.cb(ki,a,this,b,t,e,n)},e.oi=function(a,b,t){var e=this.Pa;if(b.Ig=this,null===this&&ia(b),a>=e.count)a=e.count;else if(e.M(a)===b)return-1;return e.Hb(a,b),b.Uo(t),null!==(e=this.diagram)&&(t?e.N():e.oi(b)),Io(this,a,b),a},e.qc=function(a,b,t){if(!t&&b.layer!==this&&null!==b.layer)return b.layer.qc(a,b,t);var e=this.Pa;if(0>a||a>=e.length){if(0>(a=e.indexOf(b)))return-1}else if(e.M(a)!==b&&0>(a=e.indexOf(b)))return-1;return b.Vo(t),e.mb(a),null!==(e=this.diagram)&&(t?e.N():e.qc(b)),b.Ig=null,ia(b),a},v.Object.defineProperties(Oo.prototype,{parts:{get:function(){return this.Pa.iterator}},partsBackwards:{get:function(){return this.Pa.iteratorBackwards}},diagram:{get:function(){return this.H}},name:{get:function(){return this.xa},set:function(a){var b=this.xa;if(b!==a){var t=this.diagram;if(null!==t)for(""===b&&T("Cannot rename default Layer to: "+a),t=t.layers;t.next();)t.value.name===a&&T("Layer.name is already present in this diagram: "+a);for(this.xa=a,this.g("name",b,a),a=this.Pa.iterator;a.next();)a.value.layerName=this.xa}}},opacity:{get:function(){return this.pb},set:function(a){var b=this.pb;b!==a&&((0>a||1<a)&&A(a,"0 <= value <= 1",Oo,"opacity"),this.pb=a,this.g("opacity",b,a),null!==(a=this.diagram)&&a.N())}},isTemporary:{get:function(){return this.o},set:function(a){var b=this.o;b!==a&&((this.o=a)&&(this.isInDocumentBounds=!1),this.g("isTemporary",b,a))}},visible:{get:function(){return this.u},set:function(a){var b=this.u;if(b!==a){for(this.u=a,this.g("visible",b,a),b=this.Pa.iterator;b.next();)b.value.$b(a);null!==(a=this.diagram)&&a.N()}}},pickable:{get:function(){return this.Uh},set:function(a){var b=this.Uh;b!==a&&(this.Uh=a,this.g("pickable",b,a))}},isInDocumentBounds:{get:function(){return this.j},set:function(a){this.j!==a&&(this.j=a,null!==this.diagram&&this.diagram.Ya())}},allowCopy:{get:function(){return this.Fi},set:function(a){var b=this.Fi;b!==a&&(this.Fi=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.Gi},set:function(a){var b=this.Gi;b!==a&&(this.Gi=a,this.g("allowDelete",b,a))}},allowTextEdit:{get:function(){return this.Pi},set:function(a){var b=this.Pi;b!==a&&(this.Pi=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.Hi},set:function(a){var b=this.Hi;b!==a&&(this.Hi=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.Qi},set:function(a){var b=this.Qi;b!==a&&(this.Qi=a,this.g("allowUngroup",b,a))}},allowLink:{get:function(){return this.Ii},set:function(a){var b=this.Ii;b!==a&&(this.Ii=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.Ki},set:function(a){var b=this.Ki;b!==a&&(this.Ki=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.Ji},set:function(a){var b=this.Ji;b!==a&&(this.Ji=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.Li},set:function(a){var b=this.Li;b!==a&&(this.Li=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.Mi},set:function(a){var b=this.Mi;b!==a&&(this.Mi=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.Ni},set:function(a){var b=this.Ni;b!==a&&(this.Ni=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.Oi},set:function(a){var b=this.Oi;b!==a&&(this.Oi=a,this.g("allowSelect",b,a))}}}),Oo.prototype.findObjectsNear=Oo.prototype.og,Oo.prototype.findObjectsIn=Oo.prototype.Cf,Oo.prototype.findObjectsAt=Oo.prototype.ji,Oo.prototype.findObjectAt=Oo.prototype.jc,Oo.className="Layer",zo.prototype.clear=function(){this.animationManager.Cc(),this.model.clear(),Qr=null,ts="",Eo(this,!1),this.Wn.clear(),bu(),this.Og.clear(),this.Xh=null,this.Ya(),this.Va(),this.N()},zo.prototype.reset=function(){this.clear(),this.wb=!0,Ro(this),Br(this),this.Wg=!0,qo(this),this.layout=new Uf,this.Wg=!1,this.model=Hd(),this.model.undoManager=new Ni,this.wb=this.qn=!1,this.N()},zo.prototype.setRTL=function(a){null===(a=void 0===a?this.div:a)&&(a=M.document.body);var b=C("div");b.dir="rtl",b.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",b.textContent="A",a.appendChild(b);var t="reverse";0<b.scrollLeft?t="default":(b.scrollLeft=1,0===b.scrollLeft&&(t="negative")),a.removeChild(b),this.au=t},zo.prototype.setScrollWidth=function(a){null===(a=void 0===a?this.div:a)&&(a=M.document.body);var b=0;if($r){var t=_r;b=To,null===t&&((t=_r=C("p")).style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",(b=To=C("div")).style.position="absolute",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.boxSizing="content-box",b.appendChild(t)),b.style.overflow="hidden",a.appendChild(b);var e=t.offsetWidth;b.style.overflow="scroll",e===(t=t.offsetWidth)&&(t=b.clientWidth),a.removeChild(b),0!==(b=e-t)||K||(b=11)}this.Eb=b,this.Gw=!0},zo.prototype.qb=function(a){a.classType===zo&&(this.autoScale=a)},zo.prototype.toString=function(a){void 0===a&&(a=0);var b="";if(this.div&&this.div.id&&(b=this.div.id),b='Diagram "'+b+'"',0>=a)return b;for(var t=this.Wa.iterator;t.next();)b+="\n  "+t.value.toString(a-1);return b},zo.prototype.addEventListener=function(a,b,t,e){a.addEventListener(b,t,{capture:e,passive:!1})},zo.prototype.removeEventListener=function(a,b,t,e){a.removeEventListener(b,t,{capture:e})},zo.prototype.computePixelRatio=function(){return null!==this.Yh?this.Yh:M.devicePixelRatio||1},zo.prototype.doMouseMove=function(){this.currentTool.doMouseMove()},zo.prototype.doMouseDown=function(){this.currentTool.doMouseDown()},zo.prototype.doMouseUp=function(){this.currentTool.doMouseUp()},zo.prototype.doMouseWheel=function(){this.currentTool.doMouseWheel()},zo.prototype.doKeyDown=function(){this.currentTool.doKeyDown()},zo.prototype.doKeyUp=function(){this.currentTool.doKeyUp()},zo.prototype.doFocus=function(){this.focus()},zo.prototype.focus=function(){if(this.ta)if(this.scrollsPageOnFocus)this.ta.focus();else{var a=M.scrollX||M.pageXOffset,b=M.scrollY||M.pageYOffset;this.ta.focus(),M.scrollTo(a,b)}},zo.prototype.Oy=function(){this.H.R("GainedFocus")},zo.prototype.Ny=function(){this.H.R("LostFocus")},zo.prototype.kx=function(a){if(null!==this.ta){var b=this.ju,t=this.gu;this.pr=!0;var e=this.documentBounds,n=this.viewportBounds,o=this.rj,g=e.x-o.left,r=e.y-o.top,h=e.width+o.left+o.right,l=e.height+o.top+o.bottom,c=e.right+o.right;o=e.bottom+o.bottom;var f=n.x;e=n.y;var p=n.width,q=n.height,d=n.right,u=n.bottom;n=this.scale;var m=a.scrollLeft;if(this.sn)switch(this.au){case"negative":m=m+a.scrollWidth-a.clientWidth;break;case"reverse":m=a.scrollWidth-m-a.clientWidth}var y=m;p<h||q<l?(m=St.allocAt(this.position.x,this.position.y),this.allowHorizontalScroll&&this.iu!==y&&(m.x=y/n+g,this.iu=y),this.allowVerticalScroll&&this.ku!==a.scrollTop&&(m.y=a.scrollTop/n+r,this.ku=a.scrollTop),this.position=m,St.free(m),this.Ee=this.pr=!1):(m=St.alloc(),a.uy&&this.allowHorizontalScroll&&(g<f&&(this.position=m.h(y+g,this.position.y)),c>d&&(this.position=m.h(-(b.scrollWidth-this.Aa)+y-this.Aa/n+c,this.position.y))),a.vy&&this.allowVerticalScroll&&(r<e&&(this.position=m.h(this.position.x,a.scrollTop+r)),o>u&&(this.position=m.h(this.position.x,-(b.scrollHeight-this.ya)+a.scrollTop-this.ya/n+o))),St.free(m),this.vd=!0,this.Ee=this.pr=!1,e=this.documentBounds,n=this.viewportBounds,c=e.right,d=n.right,o=e.bottom,u=n.bottom,g=e.x,f=n.x,r=e.y,e=n.y,p>=h&&g>=f&&c<=d&&(t.style.width="1px"),q>=l&&r>=e&&o<=u&&(t.style.height="1px"))}},zo.prototype.computeBounds=function(a){return void 0===a&&(a=new Ut),ur(this),Jo(this,a)},zo.prototype.computePartsBounds=function(a,b){void 0===b&&(b=!1);var t=null;if(O(a))for(var e=0;e<a.length;e++){var n=a[e];!b&&n instanceof Oc||(n.Va(),null===t?t=n.actualBounds.copy():t.ed(n.actualBounds))}else for(a=a.iterator;a.next();)e=a.value,!b&&e instanceof Oc||(e.Va(),null===t?t=e.actualBounds.copy():t.ed(e.actualBounds));return null===t?new Ut(NaN,NaN,0,0):t},zo.prototype.zoomToFit=function(){var a=this.sj;this.sj=us,this.scale=_o(this,is),a!==us&&(Zo(this,!1),$o(this,this.documentBounds,this.Aa/this.Ca,this.ya/this.Ca,this.yk,!1)),this.sj=a},(e=zo.prototype).BA=function(a,b){void 0===b&&(b=is);var t=a.width,e=a.height;if(!(0===t||0===e||isNaN(t)&&isNaN(e))){var n=1;if(b===is||b===ns)if(isNaN(t))n=this.viewportBounds.height*this.scale/e;else if(isNaN(e))n=this.viewportBounds.width*this.scale/t;else{n=this.Aa;var o=this.ya;n=b===ns?o/e>n/t?(o-(this.Be?this.Eb:0))/e:(n-(this.gf?this.Eb:0))/t:Math.min(o/e,n/t)}this.scale=n,this.position=new St(a.x,a.y)}},e.Jy=function(a,b){this.Va();var t=this.documentBounds,e=this.viewportBounds;this.position=new St(t.x+(a.x*t.width+a.offsetX)-(b.x*e.width-b.offsetX),t.y+(a.y*t.height+a.offsetY)-(b.y*e.height-b.offsetY))},e.zz=function(a){if(a instanceof qs){this.cq=a;var b=St.alloc();this.eq=this.np(a.ga(he,b)),St.free(b)}else this.cq=null,this.eq=mt},e.Nl=function(a,b){if(void 0===b&&(b=!0),b){if((a=Qo(this,a,(function(a){return a.part}),(function(a){return a.canSelect()})))instanceof zu)return a}else if((a=Qo(this,a,(function(a){return a.part})))instanceof zu)return a;return null},e.jc=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null),ur(this);for(var e=this.Wa.iteratorBackwards;e.next();){var n=e.value;if(n.visible&&null!==(n=n.jc(a,b,t)))return n}return null},e.lz=function(a,b,t){return void 0===b&&(b=!0),function(a,b,t,e,n){for(void 0===t&&(t=null),void 0===e&&(e=null),n instanceof ot||n instanceof at||(n=new at),ur(a),a=a.Wa.iteratorBackwards;a.next();){var o=a.value;o.visible&&!o.isTemporary&&o.ji(b,t,e,n)}return n}(this,a,(function(a){return a.part}),b?function(a){return a instanceof zu&&a.canSelect()}:null,t)},e.ji=function(a,b,t,e){void 0===b&&(b=null),void 0===t&&(t=null),e instanceof ot||e instanceof at||(e=new at),ur(this);for(var n=this.Wa.iteratorBackwards;n.next();){var o=n.value;o.visible&&o.ji(a,b,t,e)}return e},e.ux=function(a,b,t,e){return void 0===b&&(b=!1),void 0===t&&(t=!0),function(a,b,t,e,n){var o=null;for(void 0===o&&(o=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ot||n instanceof at||(n=new at),ur(a),a=a.Wa.iteratorBackwards;a.next();){var g=a.value;g.visible&&!g.isTemporary&&g.Cf(b,o,t,e,n)}return n}(this,a,(function(a){return a instanceof zu&&(!t||a.canSelect())}),b,e)},e.Cf=function(a,b,t,e,n){void 0===b&&(b=null),void 0===t&&(t=null),void 0===e&&(e=!1),n instanceof ot||n instanceof at||(n=new at),ur(this);for(var o=this.Wa.iteratorBackwards;o.next();){var g=o.value;g.visible&&g.Cf(a,b,t,e,n)}return n},e.Nu=function(a,b,t,e,n,o){var g=new at;ur(this);for(var r=this.Wa.iteratorBackwards;r.next();){var h=r.value;h.visible&&h.Nu(a,b,t,e,g,n,o)}return g},e.mz=function(a,b,t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),function(a,b,t,e,n,o){var g=null;void 0===g&&(g=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ot||n instanceof at)&&(o=n),n=!0);for(o instanceof ot||o instanceof at||(o=new at),ur(a),a=a.Wa.iteratorBackwards;a.next();){var r=a.value;r.visible&&!r.isTemporary&&r.og(b,t,g,e,n,o)}return o}(this,a,b,(function(a){return a instanceof zu&&(!e||a.canSelect())}),t,n)},e.og=function(a,b,t,e,n,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=!0),!1!==n&&!0!==n&&((n instanceof ot||n instanceof at)&&(o=n),n=!0),o instanceof ot||o instanceof at||(o=new at),ur(this);for(var g=this.Wa.iteratorBackwards;g.next();){var r=g.value;r.visible&&r.og(a,b,t,e,n,o)}return o},zo.prototype.acceptEvent=function(a){return er(this,a,a instanceof MouseEvent)},zo.prototype.Qz=function(a){var b=this.H;if(!this.H.isEnabled)return!1;var t=er(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.down=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del";break;case 48:t.key="0";break;case 187:case 61:case 107:t.key="Add";break;case 189:case 173:case 109:t.key="Subtract";break;case 27:t.key="Esc"}return b.doKeyDown(),or(t,a)},zo.prototype.Rz=function(a){var b=this.H;if(!b.isEnabled)return!1;var t=er(b,a,!1);switch(t.key=String.fromCharCode(a.which),t.up=!0,a.which){case 8:t.key="Backspace";break;case 33:t.key="PageUp";break;case 34:t.key="PageDown";break;case 35:t.key="End";break;case 36:t.key="Home";break;case 37:t.key="Left";break;case 38:t.key="Up";break;case 39:t.key="Right";break;case 40:t.key="Down";break;case 45:t.key="Insert";break;case 46:t.key="Del"}return b.doKeyUp(),or(t,a)},zo.prototype.bz=function(a){var b=this.H;if(!b.isEnabled)return!1;var t=er(b,a,!0);return null!==b.mouseEnter&&b.mouseEnter(t),b.currentTool.standardMouseOver(),or(t,a)},zo.prototype.cz=function(a){var b=this.H;if(!b.isEnabled)return!1;var t=er(b,a,!0);return null!==b.mouseLeave&&b.mouseLeave(t),or(t,a)},zo.prototype.getMouse=function(a){var b=this.ta;if(null===b)return new St(0,0);var t=b.getBoundingClientRect();return b=a.clientX-this.Aa/t.width*t.left,a=a.clientY-this.ya/t.height*t.top,null!==this.Bb?Tt(new St(b,a),this.Bb):new St(b,a)},zo.prototype.Ya=function(){this.Zi||(this.Zi=!0,this.ac(!1))},zo.prototype.redraw=function(){this.wb||this.ld||(this.N(),this.bd())},(e=zo.prototype).Pz=function(){return this.kg},e.Xy=function(a){void 0===a&&(a=null);var b=this.animationManager,t=b.isEnabled;b.Cc(),b.isEnabled=!1,lr(this),this.hf=!1,this.cu=new St(NaN,NaN),b.isEnabled=t,this.ld=!0;var e=this;null!==a&&N((function(){e.ld=!1,io(b,"Model"),a(e)}),1)},e.ac=function(a){if(void 0===a&&(a=!1),!0!==this.kg&&!(this.wb||!1===a&&this.ld)){this.kg=!0;var b=this;M.requestAnimationFrame((function(){b.kg&&b.bd()}))}},e.bd=function(){this.en&&!this.kg||(this.en&&(this.en=!1),lr(this))},e.Nv=function(a,b){for(a.reset();a.next();){var t=a.value;!t.Zc()||t instanceof Cc||(t.si()?(t.measure(1/0,1/0),t.arrange()):b.add(t))}for(a.reset();a.next();)(t=a.value)instanceof Cc&&t.isVisible()&&cr(this,t);for(a.reset();a.next();)(t=a.value)instanceof Oc&&t.isVisible()&&(t.si()?(t.measure(1/0,1/0),t.arrange()):b.add(t));for(a.reset();a.next();)(t=a.value)instanceof hc&&t.isVisible()&&(t.si()?(t.measure(1/0,1/0),t.arrange()):b.add(t))},e.Fd=function(a,b,t,e){if(this.vd||this.animationManager.isAnimating)for(var n=0;n<b;n++)a[n].Fd(t,e)},e.hc=function(a){if(null!==this.Ka)if(null===this.ta&&T("No canvas specified"),"svg"===this.ml){if(null!==this.Ka){var b=this.animationManager;if(!b.Ab&&(!b.isAnimating||b.isTicking)){gr(this);var t=this.Aa,e=this.ya;if(a.Gv.resize(t,e,t,e),e=(t=this.Wa.s).length,this.Fd(t,e,this,this.viewportBounds),this.Fc||b.isAnimating){b=this.pa;var n=this.Ca,o=Math.round(b.x*n)/n,g=Math.round(b.y*n)/n,r=this.Bb;for(r.reset(),1!==n&&r.scale(n),0===b.x&&0===b.y||r.translate(-o,-g),a.ti=null,ja(a,r.m11,r.m12,r.m21,r.m22,r.dx,r.dy),1!==this.pb&&(a.globalAlpha=this.pb),dr(this,a),b=this.Nb,this.ta.context.setTransform(b,0,0,b,0,0),this.ta.context.clearRect(0,0,this.Aa,this.ya),b=0;b<e;b++)t[b].hc(a,this);a=!1,this.Yf?ws(this.Yf,this)&&(a=this.Up()):a=!0,a&&(Ze.prototype.Cd=Ze.prototype.Eu),this.Fc=this.vd=!1}}}}else t:if(o=this.animationManager,!o.Ab&&(!o.isAnimating||o.isTicking)&&(t=new Date,gr(this),"0"!==this.Ka.style.opacity)){if(e=a!==this.ib,n=(b=this.Wa.s).length,this.Fd(b,n,this,this.viewportBounds),e)a.Vc(!0),this.vd=!0;else if(!this.Fc&&!o.isAnimating)break t;(o=this.Bb).reset(),g=this.Nb,r=this.pa;var h=this.Ca,l=Math.round(r.x*h)/h,c=Math.round(r.y*h)/h;for(1!==h&&o.scale(h),0===r.x&&0===r.y||o.translate(-l,-c),a.setTransform(g,0,0,g,0,0),a.clearRect(0,0,this.Aa,this.ya),1!==this.pb&&(a.globalAlpha=this.pb),dr(this,a),r=0;r<n;r++)a.setTransform(g,0,0,g,0,0),a.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),a.yc(),b[r].hc(a,this);if(b=!1,this.Yf?ws(this.Yf,this)&&(b=this.Up()):b=!0,b&&(Ze.prototype.Cd=Ze.prototype.Eu),e?(this.ib.Vc(!0),this.vd=!0):this.Fc=this.vd=!1,b=+new Date-+t,e=$&&$.nx,t=this.zw,e||null===this.Yh){for(t[this.Sq]=b,this.Sq=(this.Sq+1)%t.length,n=b=0;n<t.length;n++)b+=t[n];this.Rq=b/t.length}if(1!==this.pb&&(a.globalAlpha=1),e)for(a.setTransform(1,0,0,1,0,0),e=0;e<t.length;e++)a.fillText(t[e].toString(),20,150+20*e)}},e.Gf=function(a){return this.Rg[a]},e.Xx=function(a,b){"minDrawingLength"===a&&(this.Nq=b),this.Rg[a]=b,this.redraw()},e.Tx=function(){this.Rg=new _,this.Rg.drawShadows=!0,this.Rg.textGreeking=!0,this.Rg.viewportOptimizations=!K&&!U,this.Rg.temporaryPixelRatio=!0,this.Rg.pictureRatioOptimization=!0,this.Nq=this.Rg.minDrawingLength=1},e.Pl=function(a){return this.nn[a]},e.sA=function(a,b){this.nn[a]=b},e.Sx=function(){this.nn=new _,this.nn.extraTouchArea=10,this.nn.extraTouchThreshold=10,this.nn.hasGestureZoom=!0},e.set=function(a){return Object.assign(this,a),this},e.Du=function(a){return this.mm(a)},e.mm=function(a){return pr(this,a),this},e.bx=function(){if(0!==this.Eh.count&&!(1<this.undoManager.transactionLevel)){for(;0<this.Eh.count;){var a=this.Eh;for(this.Eh=new Mt,a=a.iterator;a.next();){var b=a.key;b.Wo(a.value),b.rc()}}this.N()}},e.N=function(a){if(void 0===a)this.Fc=!0,this.ac();else{var b=this.viewportBounds;a.w()&&b.Yc(a)&&(this.Fc=!0,this.ac())}this.R("InvalidateDraw")},zo.prototype.invalidateViewport=function(a,b){if(!0!==this.Fc)if(this.Fc=!0,"svg"===this.ml)this.bd();else{var t=!0===this.Gf("temporaryPixelRatio");if(!0===this.Gf("viewportOptimizations")&&this.scrollMode!==cs&&this.rj.hi(0,0,0,0)&&b.width===a.width&&b.height===a.height){var e=this.scale,n=Math.max(a.y,b.y),o=Math.min(a.y+a.height,b.y+b.height);if(0<Math.max(0,Math.min(a.x+a.width,b.x+b.width)-Math.max(a.x,b.x))*e&&0<Math.max(0,o-n)*e){if(!(this.ld||(this.kg=!1,null===this.Ka||(this.ld=!0,this.documentBounds.w()||(e=Ut.alloc(),Dr(this,this.computeBounds(e)),Ut.free(e)),e=this.ta,null===e||e instanceof La)))){var g=this.Nb;n=this.Aa*g;var r=this.ya*g,h=this.scale*g;o=Math.round(Math.round(b.x*h)-Math.round(a.x*h)),b=Math.round(Math.round(b.y*h)-Math.round(a.y*h)),h=this.jw,a=this.oy,h.width!==n&&(h.width=n),h.height!==r&&(h.height=r),a.clearRect(0,0,n,r),h=190*g;var l=70*g,c=Math.max(o,0),f=Math.max(b,0),p=Math.floor(n-c),q=Math.floor(r-f);a.drawImage(e.Oa,c,f,p,q,0,0,p,q),ws(this.Yf,this)&&a.clearRect(0,0,h,l),e=z(),a=z(),q=Math.abs(o),p=Math.abs(b);var d=0===c?0:n-q;c=St.allocAt(d,0),q=St.allocAt(q+d,r),a.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y)));var u=this.Bb;if(u.reset(),u.scale(g,g),1!==this.Ca&&u.scale(this.Ca),(0!==(g=this.pa).x||0!==g.y)&&isFinite(g.x)&&isFinite(g.y)&&u.translate(-g.x,-g.y),Tt(c,u),Tt(q,u),e.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y))),d=0===f?0:r-p,c.h(0,d),q.h(n,p+d),a.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y))),Tt(c,u),Tt(q,u),e.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y))),ws(this.Yf,this)&&(n=0<o?0:-o,r=0<b?0:-b,c.h(n,r),q.h(h+n,l+r),a.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y))),Tt(c,u),Tt(q,u),e.push(new Ut(Math.min(c.x,q.x),Math.min(c.y,q.y),Math.abs(c.x-q.x),Math.abs(c.y-q.y)))),St.free(c),St.free(q),ar(this,!1,!0),null===this.Ka&&T("No div specified"),null===this.ta&&T("No canvas specified"),!this.animationManager.Ab&&(n=this.ib,this.Fc)){for(gr(this),r=this.Nb,n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,this.Aa*r,this.ya*r),n.drawImage(this.jw.Oa,0<o?0:Math.round(-o),0<b?0:Math.round(-b)),o=this.pa,g=this.Ca,h=Math.round(o.x*g)/g,l=Math.round(o.y*g)/g,(b=this.Bb).reset(),1!==g&&b.scale(g),0===o.x&&0===o.y||b.translate(-h,-l),n.save(),n.beginPath(),o=a.length,g=0;g<o;g++)0!==(h=a[g]).width&&0!==h.height&&n.rect(Math.floor(h.x),Math.floor(h.y),Math.ceil(h.width),Math.ceil(h.height));for(n.clip(),n.setTransform(r,0,0,r,0,0),n.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),n.yc(),o=(b=this.Wa.s).length,this.Fd(b,o,this,this.viewportBounds),dr(this,n),n.globalAlpha=this.pb,r=0;r<o;r++)if(h=e,(g=b[r]).visible&&0!==g.pb){l=Bo(g,n),(f=g.Yq).length=0,c=this.scale,p=Ut.alloc(),u=(q=g.Pa.s).length,d=h.length;for(var m=0;m<u;m++){var y=q[m],v=Uu(y,y.actualBounds);t:{for(var x=2/c,w=4/c,k=0;k<d;k++){var M=h[k];if(0!==M.width&&0!==M.height&&v.Vu(M.x-x,M.y-x,M.width+w,M.height+w)){v=!0;break t}}v=!1}v&&g.Nj(n,y,this,f,c,p,!0)}Ut.free(p),n.globalAlpha=l}n.restore(),n.Vc(!0),this.Yf&&ws(this.Yf,this)&&this.Up(),this.Fc=this.vd=!1,this.gk()}R(e),R(a),this.ld=!1}}else this.bd();t&&(Go(this),this.bd(),Xo(this,!0))}else t?(Go(this),this.bd(),Xo(this,!0)):this.bd()}},(e=zo.prototype).add=function(a){var b=a.diagram;if(b!==this&&(null!==b&&T("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString()),null===(b=this.Pj(a.layerName))&&(b=this.Pj("")),null===b&&T('Cannot add a Part when unable find a Layer named "'+a.layerName+'" and there is no default Layer'),a.layer!==b)){var t=b.oi(99999999,a,a.diagram===this);0<=t&&this.cb(Mi,"parts",b,null,a,null,t),b.isTemporary||this.Ya(),a.C(1),null!==(t=a.layerChanged)&&t(a,null,b)}},e.oi=function(a){this.partManager.oi(a);var b=this;Kh(a,(function(a){jr(b,a)})),(a instanceof hc||a instanceof Cc&&null!==a.placeholder)&&a.v(),null!==a.data&&Kh(a,(function(a){vd(b.partManager,a)})),!0!==ma(a)&&!0!==_u(a)||this.De.add(a),Ju(a,!0,this),rc(a)?(a.actualBounds.w()&&this.N(Uu(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.w()&&this.N(Uu(a,a.actualBounds)),this.ac()},e.qc=function(a){a.Dj(),this.partManager.qc(a);var b=this;null!==a.data&&Kh(a,(function(a){xd(b.partManager,a,b)})),this.De.remove(a),rc(a)?(a.actualBounds.w()&&this.N(Uu(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.w()&&this.N(Uu(a,a.actualBounds)),this.ac()},e.remove=function(a){vr(this,a,!0)},e.Hs=function(a,b){if(void 0===b&&(b=!1),O(a))for(var t=a.length,e=0;e<t;e++){var n=a[e];b&&!n.canDelete()||this.remove(n)}else for((t=new at).addAll(a),a=t.iterator;a.next();)t=a.value,b&&!t.canDelete()||this.remove(t)},e.Jj=function(a,b,t){return void 0===t&&(t=!1),this.partManager.Jj(a,b,t)},zo.prototype.moveParts=function(a,b,t,e){if(void 0===t&&(t=!1),void 0===e&&(e=kr(this)),null!==this.toolManager){var n=new Mt;if(null!==a)if(O(a))for(var o=0;o<a.length;o++)xr(this,n,a[o],t,e);else for(a=a.iterator;a.next();)xr(this,n,a.value,t,e);else{for(a=this.parts;a.next();)xr(this,n,a.value,t,e);for(a=this.nodes;a.next();)xr(this,n,a.value,t,e);for(a=this.links;a.next();)xr(this,n,a.value,t,e)}wr(this,n,b,e,t)}},zo.prototype.computeMove=function(a,b,t,e){if(void 0===e&&(e=new St),e.assign(b),null===a)return e;var n=b,o=t.isGridSnapEnabled;o&&(t.isGridSnapRealtime||this.lastInput.up)&&Mr(this,a,b,n=St.alloc(),t),t=null!==a.dragComputation?a.dragComputation(a,b,n):n;var g=a.minLocation,r=g.x;isNaN(r)&&(r=o?Math.round(1e3*a.location.x)/1e3:a.location.x),g=g.y,isNaN(g)&&(g=o?Math.round(1e3*a.location.y)/1e3:a.location.y);var h=a.maxLocation,l=h.x;return isNaN(l)&&(l=o?Math.round(1e3*a.location.x)/1e3:a.location.x),h=h.y,isNaN(h)&&(h=o?Math.round(1e3*a.location.y)/1e3:a.location.y),e.h(Math.max(r,Math.min(t.x,l)),Math.max(g,Math.min(t.y,h))),n!==b&&St.free(n),e},(e=zo.prototype).Pd=function(a,b,t){if(void 0===t)return new ks(ct);var e=a.isGridSnapEnabled;return a.groupsSnapMembers||null===b.containingGroup||(e=!1),new ks(e?new St(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3):t.copy())},e.zl=function(a){Cr(this,a,null),a.Xe(this);var b=this.Wa,t=b.count-1;if(!a.isTemporary)for(;0<=t&&b.M(t).isTemporary;)t--;return b.Hb(t+1,a),null!==this.dc&&this.cb(Mi,"layers",this,null,a,null,t+1),this.N(),this.Ya(),this},e.Ww=function(a,b){Cr(this,a,b),a.Xe(this);var t=this.Wa,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.dc&&this.cb(Si,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.M(n)===b){t.Hb(n,a);break}return null!==this.dc&&this.cb(Mi,"layers",this,null,a,null,n),this.N(),0>e&&this.Ya(),this},e.Cy=function(a,b){Cr(this,a,b),a.Xe(this);var t=this.Wa,e=t.indexOf(a);0<=e&&(t.remove(a),null!==this.dc&&this.cb(Si,"layers",this,a,null,e,null));var n,o=t.count;for(n=0;n<o;n++)if(t.M(n)===b){t.Hb(n+1,a);break}return null!==this.dc&&this.cb(Mi,"layers",this,null,a,null,n+1),this.N(),0>e&&this.Ya(),this},e.kA=function(a){if(a.diagram!==this&&T("Cannot remove a Layer from another Diagram: "+a+" of "+a.diagram),""!==a.name){var b=this.Wa,t=b.indexOf(a);if(b.remove(a)){for(b=a.Pa.copy().iterator;b.next();){var e=b.value,n=e.layerName;n!==a.name?e.layerName=n:e.layerName=""}null!==this.dc&&this.cb(Si,"layers",this,a,null,t,null),this.N(),this.Ya()}}},e.Pj=function(a){for(var b=this.layers;b.next();){var t=b.value;if(t.name===a)return t}return null},e.Yw=function(a){return null===this.pf&&(this.pf=new ot),this.pf.add(a),this.model.Pe(a),this},e.mA=function(a){null!==this.pf&&(this.pf.remove(a),0===this.pf.count&&(this.pf=null)),this.model.hk(a)},e.Pe=function(a){return null===this.zg&&(this.zg=new ot),this.zg.add(a),this},e.hk=function(a){null!==this.zg&&(this.zg.remove(a),0===this.zg.count&&(this.zg=null))},e.cs=function(a){if(this.skipsUndoManager||this.model.skipsUndoManager||this.model.undoManager.Tu(a),a.change!==wi&&(this.isModified=!0),null!==this.zg)for(var b=this.zg,t=b.length,e=0;e<t;e++)b.M(e)(a)},e.cb=function(a,b,t,e,n,o,g){void 0===o&&(o=null),void 0===g&&(g=null);var r=new bi;r.diagram=this,r.change=a,r.propertyName=b,r.object=t,r.oldValue=e,r.oldParam=o,r.newValue=n,r.newParam=g,this.cs(r)},e.g=function(a,b,t,e,n){this.cb(ki,a,this,b,t,e,n)},zo.prototype.changeState=function(a,b){if(null!==a&&a.diagram===this){var t=this.skipsModelSourceBindings;try{this.skipsModelSourceBindings=!0;var e=a.change;if(e===ki){var n=a.object;if(_d(n,a.propertyName,a.I(b)),n instanceof qs){var o=n.part;null!==o&&o.Xb()}this.isModified=!0}else if(e===Mi){var g=a.object,r=a.newParam,h=a.newValue;if(g instanceof Eh)if("number"==typeof r&&h instanceof qs){b?g.qc(r):g.Hb(r,h);var l=g.part;null!==l&&l.Xb()}else"number"==typeof r&&h instanceof Ml&&(h.isRow?nl(g,r,b?void 0:h):rl(g,r,b?void 0:h));else if(g instanceof Oo){var c=!0===a.oldParam;"number"==typeof r&&h instanceof zu&&(b?(h.isSelected=!1,h.isHighlighted=!1,h.Xb(),g.qc(c?r:-1,h,c)):g.oi(r,h,c))}else g instanceof zo?"number"==typeof r&&h instanceof Oo&&(b?this.Wa.mb(r):(h.Xe(this),this.Wa.Hb(r,h))):T("unknown ChangedEvent.Insert object: "+a.toString());this.isModified=!0}else if(e===Si){var f=a.object,p=a.oldParam,q=a.oldValue;if(f instanceof Eh)"number"==typeof p&&q instanceof qs?b?f.Hb(p,q):f.qc(p):"number"==typeof p&&q instanceof Ml&&(q.isRow?nl(f,p,b?q:void 0):rl(f,p,b?q:void 0));else if(f instanceof Oo){var d=!0===a.newParam;"number"==typeof p&&q instanceof zu&&(b?0>f.Pa.indexOf(q)&&f.oi(p,q,d):(q.isSelected=!1,q.isHighlighted=!1,q.Xb(),f.qc(d?p:-1,q,d)))}else f instanceof zo?"number"==typeof p&&q instanceof Oo&&(b?(q.Xe(this),this.Wa.Hb(p,q)):this.Wa.mb(p)):T("unknown ChangedEvent.Remove object: "+a.toString());this.isModified=!0}else e!==wi&&T("unknown ChangedEvent: "+a.toString())}finally{this.skipsModelSourceBindings=t}}},zo.prototype.Ea=function(a){return this.undoManager.Ea(a)},zo.prototype.eb=function(a){return this.undoManager.eb(a)},zo.prototype.Kf=function(){return this.undoManager.Kf()},zo.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.Ea(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.eb(b):this.undoManager.Kf(),this.skipsUndoManager=t}},zo.prototype.updateAllTargetBindings=function(a){this.partManager.updateAllTargetBindings(a)},zo.prototype.qp=function(){this.partManager.qp()},zo.prototype.onViewportBoundsChanged=function(a,b,t,e){if(!a.D(b)){void 0===e&&(e=!1),e||(this.Ee=!0),this.vd=!0;var n=this.layout;null===n||!n.isViewportSized||this.autoScale!==es||a.width===b.width&&a.height===b.height||n.C(),n=this.currentTool,!0===this.Uk&&n instanceof Li&&(this.lastInput.documentPoint=this.Os(this.lastInput.viewPoint),Ai(n,this)),this.wb||this.invalidateViewport(a,b),Lr(this),this.gc.scale=t,this.gc.position.x=a.x,this.gc.position.y=a.y,this.gc.bounds.assign(a),this.gc.canvasSize.width=Math.round(a.width*t),this.gc.canvasSize.height=Math.round(a.height*t),this.gc.newCanvasSize.width=this.Aa,this.gc.newCanvasSize.height=this.ya,this.gc.isScroll=e,this.R("ViewportBoundsChanged",this.gc,a),this.isVirtualized&&this.links.each((function(a){a.isAvoiding&&a.actualBounds.Yc(b)&&a.bb()}))}},zo.prototype.clearSelection=function(a){void 0===a&&(a=!1);var b=this.selection;if(0!==b.count){a||this.R("ChangingSelection",b);for(var t=b.Fa(),e=t.length,n=0;n<e;n++)t[n].isSelected=!1;b.ka(),b.clear(),b.freeze(),a||this.R("ChangedSelection",b)}},zo.prototype.select=function(a){null!==a&&a.diagram===this&&(!a.isSelected||1<this.selection.count)&&(this.R("ChangingSelection",this.selection),this.clearSelection(!0),a.isSelected=!0,this.R("ChangedSelection",this.selection))},zo.prototype.rA=function(a){if(this.R("ChangingSelection",this.selection),this.clearSelection(!0),O(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];e instanceof zu||T("Diagram.selectCollection given something that is not a Part: "+e),e.isSelected=!0}else for(a=a.iterator;a.next();)(b=a.value)instanceof zu||T("Diagram.selectCollection given something that is not a Part: "+b),b.isSelected=!0;this.R("ChangedSelection",this.selection)},zo.prototype.clearHighlighteds=function(){var a=this.highlighteds;if(0<a.count){for(var b=a.Fa(),t=b.length,e=0;e<t;e++)b[e].isHighlighted=!1;a.ka(),a.clear(),a.freeze()}},(e=zo.prototype).Iz=function(a){null!==a&&a.diagram===this&&(!a.isHighlighted||1<this.highlighteds.count)&&(this.clearHighlighteds(),a.isHighlighted=!0)},e.Jz=function(a){a=(new at).addAll(a);for(var b=this.highlighteds.copy().gp(a).iterator;b.next();)b.value.isHighlighted=!1;for(a=a.iterator;a.next();)(b=a.value)instanceof zu||T("Diagram.highlightCollection given something that is not a Part: "+b),b.isHighlighted=!0},e.scroll=function(a,b,t){void 0===t&&(t=1);var e="up"===b||"down"===b,n=0,o=St.alloc();if("pixel"===a)n=t;else if("line"===a)n=t*(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===a)a=e?this.viewportBounds.height:this.viewportBounds.width,0!==(a*=this.scale)&&(n=t*Math.max(a-(e?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0));else{if("document"===a)return n=this.documentBounds,t=this.viewportBounds,"up"===b?this.position=o.h(t.x,n.y):"left"===b?this.position=o.h(n.x,t.y):"down"===b?this.position=o.h(t.x,n.bottom-t.height):"right"===b&&(this.position=o.h(n.right-t.width,t.y)),void St.free(o);T("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+a)}n/=this.scale,t=this.position,"up"===b?this.position=o.h(t.x,t.y-n):"down"===b?this.position=o.h(t.x,t.y+n):"left"===b?this.position=o.h(t.x-n,t.y):"right"===b?this.position=o.h(t.x+n,t.y):T("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+b),St.free(o)},e.tv=function(a){var b=this.viewportBounds;b.Re(a)||((a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a)},e.ds=function(a){var b=this.viewportBounds;(a=a.center).x-=b.width/2,a.y-=b.height/2,this.position=a},e.np=function(a){var b=this.Bb;b.reset(),1!==this.Ca&&b.scale(this.Ca);var t=this.pa;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),a.copy().transform(this.Bb)},e.zA=function(a){var b=this.Bb,t=a.x,e=a.y,n=t+a.width,o=e+a.height,g=b.m11,r=b.m12,h=b.m21,l=b.m22,c=b.dx,f=b.dy,p=t*g+e*h+c;b=t*r+e*l+f;var q=n*g+e*h+c;return a=n*r+e*l+f,e=t*g+o*h+c,t=t*r+o*l+f,g=n*g+o*h+c,n=n*r+o*l+f,o=Math.min(p,q),p=Math.max(p,q),q=Math.min(b,a),b=Math.max(b,a),o=Math.min(o,e),p=Math.max(p,e),q=Math.min(q,t),b=Math.max(b,t),o=Math.min(o,g),p=Math.max(p,g),new Ut(o,q=Math.min(q,n),p-o,(b=Math.max(b,n))-q)},e.Os=function(a){var b=this.Bb;b.reset(),1!==this.Ca&&b.scale(this.Ca);var t=this.pa;return(0!==t.x||0!==t.y)&&isFinite(t.x)&&isFinite(t.y)&&b.translate(-t.x,-t.y),Tt(a.copy(),this.Bb)},zo.prototype.doModelChanged=function(a){var b=this;if(a.model===this.model){var t=a.change,e=a.propertyName;if(t===wi&&"S"===e[0])if("StartingFirstTransaction"===e){var n=this;(a=this.toolManager).mouseDownTools.each((function(a){return a.diagram=n})),a.mouseMoveTools.each((function(a){return a.diagram=n})),a.mouseUpTools.each((function(a){return a.diagram=n})),this.ld||this.hf||(this.Ik=!0,this.en&&(this.kg=!0))}else"StartingUndo"===e||"StartingRedo"===e?((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Cc(),this.R("ChangingSelection",this.selection)):"StartedTransaction"===e&&((a=this.animationManager).defaultAnimation.isAnimating&&!this.skipsUndoManager&&a.Cc());else if(this.aa){this.aa=!1;try{if(""===a.modelChange&&t===wi){"FinishedUndo"!==e&&"FinishedRedo"!==e||(this.R("ChangedSelection",this.selection),ur(this));var o=this.animationManager;"RolledBackTransaction"===e&&o.Cc(),this.bx(),this.Ik=!0,this.bd(),0!==this.undoManager.transactionLevel&&1!==this.undoManager.transactionLevel||no(o),"CommittedTransaction"===e&&this.undoManager.isJustDiscarded&&(this.Ce=Math.min(this.Ce,this.undoManager.historyIndex-1)),"CommittedTransaction"!==e&&"RolledBackTransaction"!==e||!this.undoManager.isPendingUnmodified||setTimeout((function(){b.isModified=!1}),1);var g=a.isTransactionFinished;if(g&&(Ar(this),this.zs.clear(),function(a){for(a=a.Ei.iterator;a.next();)a.value.Wk=!1}(this.animationManager)),!this.Qt&&g&&this.lastInput.targetDiagram){this.Qt=!0;var r=this;N((function(){r.currentTool.standardMouseOver(),r.Qt=!1}),10)}}}finally{this.aa=!0}}}},zo.prototype.Wd=function(){this.partManager.Wd()},zo.prototype.Aj=function(a,b){this.Yd.Aj(a,b)},zo.prototype.Cj=function(a,b){this.Yd.Cj(a,b)},zo.prototype.findPartForKey=function(a){return this.partManager.findPartForKey(a)},zo.prototype.Wb=function(a){return this.partManager.Wb(a)},zo.prototype.findLinkForKey=function(a){return this.partManager.findLinkForKey(a)},(e=zo.prototype).Lc=function(a){return this.partManager.Lc(a)},e.ii=function(a){return this.partManager.ii(a)},e.Kc=function(a){return this.partManager.Kc(a)},e.ls=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.ls.apply(this.partManager,b instanceof Array?b:h(r(b)))},e.ks=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];return this.partManager.ks.apply(this.partManager,b instanceof Array?b:h(r(b)))},e.Va=function(){if(this.Zi){var a=Ut.alloc();Dr(this,this.computeBounds(a)),Ut.free(a)}},e.rz=function(){for(var a=new at,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&a.add(t)}for(b=this.links;b.next();)(t=b.value).isTopLevel&&a.add(t);return a.iterator},e.qz=function(){return this.ai.iterator},e.Uz=function(a){ur(this),a&&Ir(this,!0),this.ld?Rr(this,!1):(this.Ik=!0,lr(this))},e.yz=function(){for(var a=new ot,b=this.nodes;b.next();){var t=b.value;t.isTopLevel&&null===t.kh()&&a.add(t)}return a.iterator},e.Bj=function(a,b){return null!==(a=Yr(this,a))&&a.add(b),this},e.$l=function(a,b){null!==(a=Yr(this,a))&&a.remove(b)},e.R=function(a,b,t){var e=Yr(this,a),n=new xi;if(n.diagram=this,null!==(a=Vr(this,a))&&(n.name=a),void 0!==b&&(n.subject=b),void 0!==t&&(n.parameter=t),1===(b=e.length))e.M(0)(n);else if(0!==b)for(e=e.Fa(),t=0;t<b;t++)(0,e[t])(n)},e.Xj=function(a,b){return Xr(this,!1,null,b||null).Xj(a.x,a.y,a.width,a.height)},zo.prototype.computeOccupiedArea=function(a){return this.isVirtualized?this.viewportBounds.copy():this.Zi?Jo(this,a):a.assign(this.documentBounds)},zo.prototype.fs=function(a){this.vp.assign(a),this.computeAutoScrollPosition(this.vp).Xa(this.position)?this.ug():Hr(this)},zo.prototype.ug=function(){-1!==this.uk&&(M.clearTimeout(this.uk),this.uk=-1)},zo.prototype.computeAutoScrollPosition=function(a){var b=this.position,t=this.wp;if(0>=t.top&&0>=t.left&&0>=t.right&&0>=t.bottom)return b;var e=this.viewportBounds,n=this.scale;e=Ut.allocAt(0,0,e.width*n,e.height*n);var o=St.allocAt(0,0);if(a.x>=e.x&&a.x<e.x+t.left&&this.allowHorizontalScroll){var g=Math.max(this.scrollHorizontalLineChange,1);g|=0,o.x-=g,a.x<e.x+t.left/2&&(o.x-=g),a.x<e.x+t.left/4&&(o.x-=4*g)}else a.x<=e.x+e.width&&a.x>e.x+e.width-t.right&&this.allowHorizontalScroll&&(g=Math.max(this.scrollHorizontalLineChange,1),g|=0,o.x+=g,a.x>e.x+e.width-t.right/2&&(o.x+=g),a.x>e.x+e.width-t.right/4&&(o.x+=4*g));return a.y>=e.y&&a.y<e.y+t.top&&this.allowVerticalScroll?(g=Math.max(this.scrollVerticalLineChange,1),g|=0,o.y-=g,a.y<e.y+t.top/2&&(o.y-=g),a.y<e.y+t.top/4&&(o.y-=4*g)):a.y<=e.y+e.height&&a.y>e.y+e.height-t.bottom&&this.allowVerticalScroll&&(g=Math.max(this.scrollVerticalLineChange,1),g|=0,o.y+=g,a.y>e.y+e.height-t.bottom/2&&(o.y+=g),a.y>e.y+e.height-t.bottom/4&&(o.y+=4*g)),o.Xa(ct)||(b=new St(b.x+o.x/n,b.y+o.y/n)),Ut.free(e),St.free(o),b},(e=zo.prototype).Bs=function(){return null},e.av=function(){return null},e.$r=function(a,b){this.pj.add(a,b)},e.Fu=function(a){(this.Pw=a)||this.nodes.each((function(a){a instanceof Cc&&(a.Zp=null)}))},e.Wz=function(a){return $r?(void 0===a&&(a={}),a.returnType="Image",this.Jx(a)):null},e.Jx=function(a){return void 0===a&&(a={}),Wr(this,this.Xz,a)},e.Xz=function(a,b,t){var e=Jr(t,a,"canvas",null);if(null===e)return null;var n=null;if(null!==(t=e.Z.canvas))switch(n=a.returnType,n=void 0===n?"string":n.toLowerCase(),n){case ys+"data":n=e.getImageData(0,0,t.width,t.height);break;case ys:(e=(a.document||document).createElement("img")).src=t.toDataURL(a.type,a.details),n=e;break;case"blob":return"function"!=typeof b&&T('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.'),"function"==typeof t.toBlob?(t.toBlob(b,a.type,a.details),"toBlob"):(b(null),null);default:n=t.toDataURL(a.type,a.details)}return"function"==typeof b?(b(n),null):n},v.Object.defineProperties(zo.prototype,{renderer:{get:function(){return this.ml},set:function(a){this instanceof Rs||(""===a&&(a="default"),(a=a.toLowerCase())!==this.ml&&(this.ml=a,"default"===a||"canvas"===a?(null!==(a=this.pj.get("svg"))&&a.Oa.remove(),this.ta&&(this.ib=this.ta.context)):"svg"===a?(this.pj.contains("svg")?a=this.pj.get("svg"):(a=new La(this,M.document),this.$r("svg",a)),null!==this.div&&this.div.appendChild(a.Oa),this.ib=a.context,this.ta&&(this.ta.context.setTransform(this.Nb,0,0,this.Nb,0,0),this.ta.context.clearRect(0,0,this.Aa,this.ya))):"debug"!==a||this.pj.contains("SVG")||(a=new La(this,M.document),this.$r("SVG",a),a.Oa.style.backgroundColor="whitesmoke",null!==this.div&&this.div.after(a.Oa)),this.gk()))}},div:{get:function(){return this.Ka},set:function(a){if(this.Ka!==a){var b=this.Ka;null!==b?(b.H=void 0,b.goDiagram=void 0,b.go=void 0,b.innerHTML="",null!==this.ta&&(b=this.ta.Oa,this.removeEventListener(b,"pointermove",this.ck,!1),this.removeEventListener(b,"pointerdown",this.ui,!1),this.removeEventListener(b,"pointerup",this.ek,!1),this.removeEventListener(b,"pointerout",this.dk,!1),this.removeEventListener(b,"pointercancel",this.bk,!1),this.ta.mx()),this.nl&&(this.nl.disconnect(),this.nl=null),null!==(b=this.toolManager)&&(b.mouseDownTools.each((function(a){a.cancelWaitAfter()})),b.mouseMoveTools.each((function(a){a.cancelWaitAfter()})),b.mouseUpTools.each((function(a){a.cancelWaitAfter()}))),b.cancelWaitAfter(),this.currentTool.doCancel(),this.ta=null,this.removeEventListener(M,"resize",this.Ov,!1),this.removeEventListener(M,"wheel",this.Zj,!0),Lo===this&&(Lo=null)):null===this.ui&&(this.hf=!1),this.Ka=null,null!==a&&((b=a.H)&&(b.div=null),Yo(this,a),this.gk())}}},$w:{get:function(){return this.Rq}},pi:{get:function(){return this.hf}},draggedLink:{get:function(){return this.mt},set:function(a){this.mt!==a&&(this.mt=a,null!==a&&(this.Ut=a.fromPort,this.Vt=a.toPort))}},Mx:{get:function(){return this.Ut},set:function(a){this.Ut=a}},Nx:{get:function(){return this.Vt},set:function(a){this.Vt=a}},animationManager:{get:function(){return this.Yd}},undoManager:{get:function(){return this.dc.undoManager}},skipsUndoManager:{get:function(){return this.Wg},set:function(a){this.Wg=a,this.dc.skipsUndoManager=a}},delaysLayout:{get:function(){return this.kt},set:function(a){this.kt=a}},opacity:{get:function(){return this.pb},set:function(a){var b=this.pb;b!==a&&((0>a||1<a)&&A(a,"0 <= value <= 1",zo,"opacity"),this.pb=a,this.g("opacity",b,a),this.N())}},validCycle:{get:function(){return this.vu},set:function(a){var b=this.vu;b!==a&&(this.vu=a,this.g("validCycle",b,a))}},layers:{get:function(){return this.Wa.iterator}},isModelReadOnly:{get:function(){var a=this.dc;return null!==a&&a.isReadOnly},set:function(a){var b=this.dc;null!==b&&(b.isReadOnly=a)}},isReadOnly:{get:function(){return this.Gg},set:function(a){var b=this.Gg;b!==a&&(this.Gg=a,this.g("isReadOnly",b,a))}},isEnabled:{get:function(){return this.Jd},set:function(a){var b=this.Jd;b!==a&&(this.Jd=a,this.g("isEnabled",b,a))}},allowClipboard:{get:function(){return this.Ts},set:function(a){var b=this.Ts;b!==a&&(this.Ts=a,this.g("allowClipboard",b,a))}},allowCopy:{get:function(){return this.Fi},set:function(a){var b=this.Fi;b!==a&&(this.Fi=a,this.g("allowCopy",b,a))}},allowDelete:{get:function(){return this.Gi},set:function(a){var b=this.Gi;b!==a&&(this.Gi=a,this.g("allowDelete",b,a))}},allowDragOut:{get:function(){return this.Us},set:function(a){var b=this.Us;b!==a&&(this.Us=a,this.g("allowDragOut",b,a))}},allowDrop:{get:function(){return this.Vs},set:function(a){var b=this.Vs;b!==a&&(this.Vs=a,this.g("allowDrop",b,a))}},allowTextEdit:{get:function(){return this.Pi},set:function(a){var b=this.Pi;b!==a&&(this.Pi=a,this.g("allowTextEdit",b,a))}},allowGroup:{get:function(){return this.Hi},set:function(a){var b=this.Hi;b!==a&&(this.Hi=a,this.g("allowGroup",b,a))}},allowUngroup:{get:function(){return this.Qi},set:function(a){var b=this.Qi;b!==a&&(this.Qi=a,this.g("allowUngroup",b,a))}},allowInsert:{get:function(){return this.Xs},set:function(a){var b=this.Xs;b!==a&&(this.Xs=a,this.g("allowInsert",b,a))}},allowLink:{get:function(){return this.Ii},set:function(a){var b=this.Ii;b!==a&&(this.Ii=a,this.g("allowLink",b,a))}},allowRelink:{get:function(){return this.Ki},set:function(a){var b=this.Ki;b!==a&&(this.Ki=a,this.g("allowRelink",b,a))}},allowMove:{get:function(){return this.Ji},set:function(a){var b=this.Ji;b!==a&&(this.Ji=a,this.g("allowMove",b,a))}},allowReshape:{get:function(){return this.Li},set:function(a){var b=this.Li;b!==a&&(this.Li=a,this.g("allowReshape",b,a))}},allowResize:{get:function(){return this.Mi},set:function(a){var b=this.Mi;b!==a&&(this.Mi=a,this.g("allowResize",b,a))}},allowRotate:{get:function(){return this.Ni},set:function(a){var b=this.Ni;b!==a&&(this.Ni=a,this.g("allowRotate",b,a))}},allowSelect:{get:function(){return this.Oi},set:function(a){var b=this.Oi;b!==a&&(this.Oi=a,this.g("allowSelect",b,a))}},allowUndo:{get:function(){return this.Ys},set:function(a){var b=this.Ys;b!==a&&(this.Ys=a,this.g("allowUndo",b,a))}},allowZoom:{get:function(){return this.$s},set:function(a){var b=this.$s;b!==a&&(this.$s=a,this.g("allowZoom",b,a))}},hasVerticalScrollbar:{get:function(){return this.mn},set:function(a){var b=this.mn;b!==a&&(this.mn=a,this.Ee=!0,this.N(),this.g("hasVerticalScrollbar",b,a),Zo(this,!1))}},hasHorizontalScrollbar:{get:function(){return this.ln},set:function(a){var b=this.ln;b!==a&&(this.ln=a,this.Ee=!0,this.N(),this.g("hasHorizontalScrollbar",b,a),Zo(this,!1))}},allowHorizontalScroll:{get:function(){return this.Ws},set:function(a){var b=this.Ws;b!==a&&(this.Ws=a,this.g("allowHorizontalScroll",b,a),Zo(this,!1))}},allowVerticalScroll:{get:function(){return this.Zs},set:function(a){var b=this.Zs;b!==a&&(this.Zs=a,this.g("allowVerticalScroll",b,a),Zo(this,!1))}},scrollHorizontalLineChange:{get:function(){return this.hu},set:function(a){var b=this.hu;b!==a&&(0>a&&A(a,">= 0",zo,"scrollHorizontalLineChange"),this.hu=a,this.g("scrollHorizontalLineChange",b,a))}},scrollVerticalLineChange:{get:function(){return this.lu},set:function(a){var b=this.lu;b!==a&&(0>a&&A(a,">= 0",zo,"scrollVerticalLineChange"),this.lu=a,this.g("scrollVerticalLineChange",b,a))}},lastInput:{get:function(){return this.cj},set:function(a){this.cj=a}},previousInput:{get:function(){return this.Qg},set:function(a){this.Qg=a}},firstInput:{get:function(){return this.aq},set:function(a){this.aq=a}},currentCursor:{get:function(){return this.ht},set:function(a){if(""===a&&(a=this.Np),this.ht!==a){var b=this.ta,t=this.Ka;if(null!==b&&null!==t){this.ht=a;var e=b.style.cursor;b.style.cursor=a,t.style.cursor=a,b.style.cursor===e&&(b.style.cursor="-webkit-"+a,t.style.cursor="-webkit-"+a,b.style.cursor===e&&(b.style.cursor="-moz-"+a,t.style.cursor="-moz-"+a,b.style.cursor===e&&(b.style.cursor=a,t.style.cursor=a)))}}}},defaultCursor:{get:function(){return this.Np},set:function(a){""===a&&(a="auto");var b=this.Np;b!==a&&(this.Np=a,this.g("defaultCursor",b,a))}},click:{get:function(){return this.zh},set:function(a){var b=this.zh;b!==a&&(this.zh=a,this.g("click",b,a))}},doubleClick:{get:function(){return this.Fh},set:function(a){var b=this.Fh;b!==a&&(this.Fh=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return this.Bh},set:function(a){var b=this.Bh;b!==a&&(this.Bh=a,this.g("contextClick",b,a))}},mouseOver:{get:function(){return this.Qh},set:function(a){var b=this.Qh;b!==a&&(this.Qh=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return this.Oh},set:function(a){var b=this.Oh;b!==a&&(this.Oh=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return this.Nh},set:function(a){var b=this.Nh;b!==a&&(this.Nh=a,this.g("mouseHold",b,a))}},mouseDragOver:{get:function(){return this.Pt},set:function(a){var b=this.Pt;b!==a&&(this.Pt=a,this.g("mouseDragOver",b,a))}},mouseDrop:{get:function(){return this.Lh},set:function(a){var b=this.Lh;b!==a&&(this.Lh=a,this.g("mouseDrop",b,a))}},handlesDragDropForTopLevelParts:{get:function(){return this.wt},set:function(a){var b=this.wt;b!==a&&(this.wt=a,this.g("handlesDragDropForTopLevelParts",b,a))}},mouseEnter:{get:function(){return this.Mh},set:function(a){var b=this.Mh;b!==a&&(this.Mh=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return this.Ph},set:function(a){var b=this.Ph;b!==a&&(this.Ph=a,this.g("mouseLeave",b,a))}},toolTip:{get:function(){return this.$h},set:function(a){var b=this.$h;b!==a&&(this.$h=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return this.Ch},set:function(a){var b=this.Ch;b!==a&&(this.Ch=a,this.g("contextMenu",b,a))}},commandHandler:{get:function(){return this.nb},set:function(a){this.nb!==a&&(this.nb=a,a.Xe(this))}},toolManager:{get:function(){return this.te},set:function(a){this.te!==a&&(this.te=a,a.diagram=this)}},defaultTool:{get:function(){return this.ob},set:function(a){var b=this.ob;b!==a&&(this.ob=a,a.diagram=this,this.currentTool===b&&(this.currentTool=a))}},currentTool:{get:function(){return this.hb},set:function(a){var b=this.hb;b&&(b.isActive&&b.doDeactivate(),b.cancelWaitAfter(),b.doStop()),null===a&&(a=this.defaultTool),null!==a&&(this.hb=a,a.diagram=this,a.doStart())}},selection:{get:function(){return this.Hw}},maxSelectionCount:{get:function(){return this.Mt},set:function(a){var b=this.Mt;if(b!==a)if(0<=a&&!isNaN(a)){if(this.Mt=a,this.g("maxSelectionCount",b,a),!this.undoManager.isUndoingRedoing&&0<(a=this.selection.count-a)){this.R("ChangingSelection",this.selection),b=this.selection.Fa();for(var t=0;t<a;t++)b[t].isSelected=!1;this.R("ChangedSelection",this.selection)}}else A(a,">= 0",zo,"maxSelectionCount")}},nodeSelectionAdornmentTemplate:{get:function(){return this.Rt},set:function(a){var b=this.Rt;b!==a&&(this.Rt=a,this.g("nodeSelectionAdornmentTemplate",b,a))}},groupSelectionAdornmentTemplate:{get:function(){return this.vt},set:function(a){var b=this.vt;b!==a&&(this.vt=a,this.g("groupSelectionAdornmentTemplate",b,a))}},linkSelectionAdornmentTemplate:{get:function(){return this.Jt},set:function(a){var b=this.Jt;b!==a&&(this.Jt=a,this.g("linkSelectionAdornmentTemplate",b,a))}},highlighteds:{get:function(){return this.nw}},isModified:{get:function(){var a=this.undoManager;return a.isEnabled?null!==a.currentTransaction||this.qn&&this.Ce!==a.historyIndex:this.qn},set:function(a){if(this.qn!==a){this.qn=a;var b=this.undoManager;!a&&b.isEnabled&&(this.Ce=b.historyIndex),a||Ar(this)}}},model:{get:function(){return this.dc},set:function(a){var b=this.dc;if(b!==a){this.currentTool.doCancel(),b&&b.undoManager!==a.undoManager&&b.undoManager.isInTransaction&&T("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.Cc(!0);var t=Eo(this,!0);this.hf=!1,this.en=!0,this.Ce=-2,this.kg=!1;var e=this.wb;this.wb=!0,io(this.animationManager,"Model"),b&&(null!==this.pf&&this.pf.each((function(a){return b.hk(a)})),b.hk(this.Oc)),this.dc=a,this.partManager=function(a){return null!==(a=Zr.get(a))?new a:new fd}(this.dc.type);for(var n=0;n<t.length;n++)this.add(t[n]);a.Pe(this.Ib),this.partManager.addAllModeledParts(),a.hk(this.Ib),a.Pe(this.Oc),null!==this.pf&&this.pf.each((function(b){return a.Pe(b)})),this.wb=e,this.Ya(),this.wb||this.N(),b&&a.undoManager.copyProperties(b.undoManager)}}},aa:{get:function(){return this.rw},set:function(a){this.rw=a}},zs:{get:function(){return this.sy}},skipsModelSourceBindings:{get:function(){return this.Iw},set:function(a){this.Iw=a}},Ms:{get:function(){return this.nu},set:function(a){this.nu=a}},nodeTemplate:{get:function(){return this.Lg.I("")},set:function(a){var b=this.Lg.I("");b!==a&&(this.Lg.add("",a),this.g("nodeTemplate",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},nodeTemplateMap:{get:function(){return this.Lg},set:function(a){var b=this.Lg;b!==a&&(this.Lg=a,this.g("nodeTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},groupTemplate:{get:function(){return this.Yi.I("")},set:function(a){var b=this.Yi.I("");b!==a&&(this.Yi.add("",a),this.g("groupTemplate",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},groupTemplateMap:{get:function(){return this.Yi},set:function(a){var b=this.Yi;b!==a&&(this.Yi=a,this.g("groupTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},linkTemplate:{get:function(){return this.Kh.I("")},set:function(a){var b=this.Kh.I("");b!==a&&(this.Kh.add("",a),this.g("linkTemplate",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},linkTemplateMap:{get:function(){return this.Kh},set:function(a){var b=this.Kh;b!==a&&(this.Kh=a,this.g("linkTemplateMap",b,a),this.undoManager.isUndoingRedoing||this.Wd())}},isMouseCaptured:{get:function(){return this.qw},set:function(a){var b=this.ta;null!==b&&((b=b.Oa)instanceof SVGElement||(a?(this.lastInput.bubbles=!1,this.removeEventListener(b,"pointermove",this.ck,!1),this.removeEventListener(b,"pointerdown",this.ui,!1),this.removeEventListener(b,"pointerup",this.ek,!1),this.removeEventListener(b,"pointerout",this.dk,!1),this.removeEventListener(b,"pointercancel",this.bk,!1),this.addEventListener(M,"pointermove",this.ck,!0),this.addEventListener(M,"pointerdown",this.ui,!0),this.addEventListener(M,"pointerup",this.ek,!0),this.addEventListener(M,"pointerout",this.dk,!0),this.addEventListener(M,"pointercancel",this.bk,!0),this.removeEventListener(b,"wheel",this.Zj,!1),this.addEventListener(M,"wheel",this.Zj,!0),this.addEventListener(M,"selectstart",this.preventDefault,!1)):(this.removeEventListener(M,"pointermove",this.ck,!0),this.removeEventListener(M,"pointerdown",this.ui,!0),this.removeEventListener(M,"pointerup",this.ek,!0),this.removeEventListener(M,"pointerout",this.dk,!0),this.removeEventListener(M,"pointercancel",this.bk,!0),this.addEventListener(b,"pointermove",this.ck,!1),this.addEventListener(b,"pointerdown",this.ui,!1),this.addEventListener(b,"pointerup",this.ek,!1),this.addEventListener(b,"pointerout",this.dk,!1),this.addEventListener(b,"pointercancel",this.bk,!1),this.removeEventListener(M,"wheel",this.Zj,!0),this.removeEventListener(M,"selectstart",this.preventDefault,!1),this.addEventListener(b,"wheel",this.Zj,!1)),this.qw=a))}},position:{get:function(){return this.pa},set:function(a){var b=St.alloc().assign(this.pa);if(!b.D(a)){var t=this.viewportBounds.copy();this.pa.assign(a),ho(this.animationManager,b,this.pa),this.wb||null===this.ta&&!this.vo.w()?Br(this):(this.wb=!0,a=this.scale,$o(this,this.Rp,this.Aa/a,this.ya/a,this.yk,!1),this.wb=!1),this.wb||this.onViewportBoundsChanged(t,this.viewportBounds,this.Ca,!1)}St.free(b)}},initialPosition:{get:function(){return this.yt},set:function(a){this.yt.D(a)||(this.yt=a.J())}},initialScale:{get:function(){return this.zt},set:function(a){this.zt!==a&&(this.zt=a)}},grid:{get:function(){return null===this.fe&&(this.fe=Ko(this)),this.fe},set:function(a){var b=this.fe;if(b!==a){null===b&&(b=this.fe=Ko(this)),a.type!==Eh.Grid&&T("Diagram.grid must be a Panel of type Panel.Grid");var t=b.panel;null!==t&&t.remove(b),this.fe=a,a.name="GRID",null!==t&&t.add(a),Lr(this),this.N(),this.g("grid",b,a)}}},viewportBounds:{get:function(){return this.Rw}},viewSize:{get:function(){return this.vo},set:function(a){var b=this.viewSize;b.D(a)||(this.vo=a=a.J(),this.ya=this.Aa=0,a.w()?(this.Aa=a.width,this.ya=a.height):null!==this.Ka&&(this.Aa=this.Ka.clientWidth||1,this.ya=this.Ka.clientHeight||1),Br(this),this.Ya(),this.g("viewSize",b,a),this.redraw())}},fixedBounds:{get:function(){return this.tt},set:function(a){var b=this.tt;b.D(a)||(-1/0!==a.width&&1/0!==a.height&&-1/0!==a.height||T("fixedBounds width/height must not be Infinity"),this.tt=a=a.J(),this.Ya(),this.g("fixedBounds",b,a))}},scrollMargin:{get:function(){return this.rj},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.rj;b.D(a)||(this.rj=a=a.J(),this.g("scrollMargin",b,a),this.gk())}},scrollMode:{get:function(){return this.sj},set:function(a){var b=this.sj;b!==a&&(this.sj=a,a===us&&Zo(this,!1),this.g("scrollMode",b,a),this.Ee=!0,this.N())}},scrollsPageOnFocus:{get:function(){return this.mu},set:function(a){var b=this.mu;b!==a&&(this.mu=a,this.g("scrollsPageOnFocus",b,a))}},positionComputation:{get:function(){return this.Yt},set:function(a){var b=this.Yt;b!==a&&(this.Yt=a,Zo(this,!1),this.g("positionComputation",b,a))}},scaleComputation:{get:function(){return this.eu},set:function(a){var b=this.eu;b!==a&&(this.eu=a,Tr(this,this.scale,this.scale),this.g("scaleComputation",b,a))}},documentBounds:{get:function(){return this.Rp}},isVirtualized:{get:function(){return this.Ht},set:function(a){var b=this.Ht;b!==a&&(this.Ht=a,this.g("isVirtualized",b,a))}},scale:{get:function(){return this.Ca},set:function(a){var b=this.Ca;b!==a&&Tr(this,b,a)}},defaultScale:{get:function(){return this.Op},set:function(a){this.Op=a}},autoScale:{get:function(){return this.yh},set:function(a){var b=this.yh;b!==a&&(this.yh=a,this.g("autoScale",b,a),a!==es&&Zo(this,!1))}},initialAutoScale:{get:function(){return this.Fg},set:function(a){var b=this.Fg;b!==a&&(this.Fg=a,this.g("initialAutoScale",b,a))}},initialViewportSpot:{get:function(){return this.At},set:function(a){var b=this.At;b!==a&&(a.sb()||T("initialViewportSpot must be a specific Spot: "+a),this.At=a,this.g("initialViewportSpot",b,a))}},initialDocumentSpot:{get:function(){return this.xt},set:function(a){var b=this.xt;b!==a&&(a.sb()||T("initialViewportSpot must be a specific Spot: "+a),this.xt=a,this.g("initialDocumentSpot",b,a))}},minScale:{get:function(){return this.Nt},set:function(a){var b=this.Nt;b!==a&&(0<a?(this.Nt=a,this.g("minScale",b,a),a>this.scale&&(this.scale=a)):A(a,"> 0",zo,"minScale"))}},maxScale:{get:function(){return this.Lt},set:function(a){var b=this.Lt;b!==a&&(0<a?(this.Lt=a,this.g("maxScale",b,a),a<this.scale&&(this.scale=a)):A(a,"> 0",zo,"maxScale"))}},zoomPoint:{get:function(){return this.yu},set:function(a){this.yu.D(a)||(this.yu=a=a.J())}},contentAlignment:{get:function(){return this.yk},set:function(a){var b=this.yk;b.D(a)||(this.yk=a=a.J(),this.g("contentAlignment",b,a),Zo(this,!1))}},initialContentAlignment:{get:function(){return this.oq},set:function(a){var b=this.oq;b.D(a)||(this.oq=a=a.J(),this.g("initialContentAlignment",b,a))}},padding:{get:function(){return this.zb},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.zb;b.D(a)||(this.zb=a=a.J(),this.Ya(),this.g("padding",b,a))}},partManager:{get:function(){return this.Pc},set:function(a){var b=this.Pc;b!==a&&(null!==a.diagram&&T("Cannot share PartManagers between Diagrams: "+a.toString()),b&&b.Xe(null),this.Pc=a,a.Xe(this))}},nodes:{get:function(){return this.partManager.nodes.iterator}},links:{get:function(){return this.partManager.links.iterator}},parts:{get:function(){return this.partManager.parts.iterator}},layout:{get:function(){return this.Sc},set:function(a){var b=this.Sc;b!==a&&(this.Sc=a,a.diagram=this,a.group=null,this.xh=!0,this.g("layout",b,a),this.ac())}},isTreePathToChildren:{get:function(){return this.Gt},set:function(a){var b=this.Gt;if(b!==a&&(this.Gt=a,this.g("isTreePathToChildren",b,a),!this.undoManager.isUndoingRedoing))for(a=this.nodes;a.next();)yc(a.value)}},treeCollapsePolicy:{get:function(){return this.tu},set:function(a){var b=this.tu;b!==a&&(a!==fs&&a!==ds&&a!==ps&&T("Unknown Diagram.treeCollapsePolicy: "+a),this.tu=a,this.g("treeCollapsePolicy",b,a))}},Ue:{get:function(){return this.pw},set:function(a){this.pw=a}},avoidanceCellSize:{get:function(){return this.aw},set:function(a){this.Xh=null,this.aw=new Vt(Math.max(1,a.width),Math.max(1,a.height))}},avoidanceLimit:{get:function(){return this.bw},set:function(a){this.bw=Math.max(1,a)}},autoScrollInterval:{get:function(){return this.tp},set:function(a){var b=this.tp;b!==a&&(this.tp=a,this.g("autoScrollInterval",b,a))}},autoScrollRegion:{get:function(){return this.wp},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.wp;b.D(a)||(this.wp=a=a.J(),this.Ya(),this.g("autoScrollRegion",b,a))}}}),v.Object.defineProperties(zo,{licenseKey:{get:function(){return gs.kc()},set:function(a){gs.add(a.replace(/\s/g,""))}},version:{get:function(){return ms}}}),zo.prototype.makeImageData=zo.prototype.Jx,zo.prototype.makeImage=zo.prototype.Wz,zo.prototype.cacheGroupExternalLinks=zo.prototype.Fu,zo.prototype.addRenderer=zo.prototype.$r,zo.prototype.makeSVG=zo.prototype.av,zo.prototype.makeSvg=zo.prototype.Bs,zo.prototype.stopAutoScroll=zo.prototype.ug,zo.prototype.doAutoScroll=zo.prototype.fs,zo.prototype.isUnoccupied=zo.prototype.Xj,zo.prototype.raiseDiagramEvent=zo.prototype.R,zo.prototype.removeDiagramListener=zo.prototype.$l,zo.prototype.addDiagramListener=zo.prototype.Bj,zo.prototype.findTreeRoots=zo.prototype.yz,zo.prototype.layoutDiagram=zo.prototype.Uz,zo.prototype.findTopLevelGroups=zo.prototype.qz,zo.prototype.findTopLevelNodesAndLinks=zo.prototype.rz,zo.prototype.ensureBounds=zo.prototype.Va,zo.prototype.findLinksByExample=zo.prototype.ks,zo.prototype.findNodesByExample=zo.prototype.ls,zo.prototype.findLinkForData=zo.prototype.Kc,zo.prototype.findNodeForData=zo.prototype.ii,zo.prototype.findPartForData=zo.prototype.Lc,zo.prototype.findLinkForKey=zo.prototype.findLinkForKey,zo.prototype.findNodeForKey=zo.prototype.Wb,zo.prototype.findPartForKey=zo.prototype.findPartForKey,zo.prototype.rebuildParts=zo.prototype.Wd,zo.prototype.transformViewToDoc=zo.prototype.Os,zo.prototype.transformRectDocToView=zo.prototype.zA,zo.prototype.transformDocToView=zo.prototype.np,zo.prototype.centerRect=zo.prototype.ds,zo.prototype.scrollToRect=zo.prototype.tv,zo.prototype.scroll=zo.prototype.scroll,zo.prototype.highlightCollection=zo.prototype.Jz,zo.prototype.highlight=zo.prototype.Iz,zo.prototype.selectCollection=zo.prototype.rA,zo.prototype.select=zo.prototype.select,zo.prototype.updateAllRelationshipsFromData=zo.prototype.qp,zo.prototype.updateAllTargetBindings=zo.prototype.updateAllTargetBindings,zo.prototype.commit=zo.prototype.commit,zo.prototype.rollbackTransaction=zo.prototype.Kf,zo.prototype.commitTransaction=zo.prototype.eb,zo.prototype.startTransaction=zo.prototype.Ea,zo.prototype.raiseChanged=zo.prototype.g,zo.prototype.raiseChangedEvent=zo.prototype.cb,zo.prototype.removeChangedListener=zo.prototype.hk,zo.prototype.addChangedListener=zo.prototype.Pe,zo.prototype.removeModelChangedListener=zo.prototype.mA,zo.prototype.addModelChangedListener=zo.prototype.Yw,zo.prototype.findLayer=zo.prototype.Pj,zo.prototype.removeLayer=zo.prototype.kA,zo.prototype.addLayerAfter=zo.prototype.Cy,zo.prototype.addLayerBefore=zo.prototype.Ww,zo.prototype.addLayer=zo.prototype.zl,zo.prototype.moveParts=zo.prototype.moveParts,zo.prototype.copyParts=zo.prototype.Jj,zo.prototype.removeParts=zo.prototype.Hs,zo.prototype.remove=zo.prototype.remove,zo.prototype.add=zo.prototype.add,zo.prototype.clearDelayedGeometries=zo.prototype.bx,zo.prototype.setProperties=zo.prototype.mm,zo.prototype.attach=zo.prototype.Du,zo.prototype.set=zo.prototype.set,zo.prototype.resetInputOptions=zo.prototype.Sx,zo.prototype.setInputOption=zo.prototype.sA,zo.prototype.getInputOption=zo.prototype.Pl,zo.prototype.resetRenderingHints=zo.prototype.Tx,zo.prototype.setRenderingHint=zo.prototype.Xx,zo.prototype.getRenderingHint=zo.prototype.Gf,zo.prototype.maybeUpdate=zo.prototype.bd,zo.prototype.requestUpdate=zo.prototype.ac,zo.prototype.delayInitialization=zo.prototype.Xy,zo.prototype.isUpdateRequested=zo.prototype.Pz,zo.prototype.invalidateDocumentBounds=zo.prototype.Ya,zo.prototype.findObjectsNear=zo.prototype.og,zo.prototype.findPartsNear=zo.prototype.mz,zo.prototype.findObjectsIn=zo.prototype.Cf,zo.prototype.findPartsIn=zo.prototype.ux,zo.prototype.findObjectsAt=zo.prototype.ji,zo.prototype.findPartsAt=zo.prototype.lz,zo.prototype.findObjectAt=zo.prototype.jc,zo.prototype.findPartAt=zo.prototype.Nl,zo.prototype.focusObject=zo.prototype.zz,zo.prototype.alignDocument=zo.prototype.Jy,zo.prototype.zoomToRect=zo.prototype.BA,zo.prototype.zoomToFit=zo.prototype.zoomToFit,zo.prototype.diagramScroll=zo.prototype.kx,zo.prototype.focus=zo.prototype.focus;var Zr=new Mt,_r=null,$r=void 0!==M.document,Qr=null,ts="",es=new W(zo,"None",0),is=new W(zo,"Uniform",1),ns=new W(zo,"UniformToFill",2),os=new W(zo,"CycleAll",10),rs=new W(zo,"CycleNotDirected",11),ss=new W(zo,"CycleNotDirectedFast",12),as=new W(zo,"CycleNotUndirected",13),hs=new W(zo,"CycleDestinationTree",14),ls=new W(zo,"CycleSourceTree",15),us=new W(zo,"DocumentScroll",1),cs=new W(zo,"InfiniteScroll",2),fs=new W(zo,"TreeParentCollapsed",21),ds=new W(zo,"AllParentsCollapsed",22),ps=new W(zo,"AnyParentsCollapsed",23),gs=new ot,ms="2.3.11",ys="image",vs=null,xs=!1;function bs(){this.wy=null,this.j="zz@orderNum","63ad05bbe23a1786468a4c741b6d2"===this._tk?this.Rc=this.j=!0:this.Rc=null}function ws(a,b){if(b.ib.setTransform(b.Nb,0,0,b.Nb,0,0),b.ib.yc(),null===a.Rc)t:{b="f";var t=M[X("76a715b2f73f148a")][X("72ba13b5")]||"";if(a.Rc=!0,$r){var e=zo[X("76a115b6ed251eaf4692")];if(e)for(var n=gs.iterator;n.next()&&!(6>(e=X(e=n.value).split(X("39e9"))).length);){var o=X(e[1]).split(".");if("7da71ca0"!==e[4])break;var g=X(S[X("6cae19")]).split(".");if(o[0]>g[0]||o[0]===g[0]&&o[1]>=g[1]){var r=M[X("74a900bae4370f8b51")][X("6fbb13a1c2311e8a57")].toLowerCase();if(g=r[X("73a612b6fb191d")](X("3aad1ab6e022098b4dc4")),o=X(e[2]),-1<g&&(r=r[X("73a612b6fb191d")](o.toLowerCase()+"/"),a.Rc=!(-1<r&&r<g),!a.Rc))break;for(g=t[X("76ad18b4f73e")],r=t[X("73a612b6fb191d")](X("35e7"))+2;r<g;r++)b+=t[r];if(0>(g=b[X("73a612b6fb191d")](o))&&o!==X("7da71ca0ad381e90")&&(g=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>g&&(g=b[X("73a612b6fb191d")](X("76a715b2ef3e149757"))),0>g&&(g=b[X("73a612b6fb191d")](X("2bfa41fdb3784bca12"))),0>g&&(g=t[X("73a612b6fb191d")](X("7baa19a6f76c1988428554"))),a.Rc=!(0<=g&&g<b[X("73a612b6fb191d")](X("35"))||-1===b[X("73a612b6fb191d")](X("35"))),!a.Rc)break;if(t[X("73a612b6fb191d")](X("7fb002b6ed25128b4da25b2e"))&&(a.Rc=!(-1<t[X("73a612b6fb191d")](o)),!a.Rc))break;if(-1<(r=(g=M[X("76a715b2f73f148a")][X("69ad17a1e03e")])[X("73a612b6fb191d")](X("7fb002b6ed25128b4da25b2e")))&&(a.Rc=!(g[X("73a612b6fb191d")](o)>r),!a.Rc))break;if("#"===o[0]){g=M.document.createElement("div");for(var h=e[0].replace(/[A-Za-z]/g,"");4>h.length;)h+="9";if(r=h,h=h.substr(h.length-4),e="",e+=["gsh","gsf"][parseInt(h.substr(0,1),10)%2],e+=["Header","Background","Display","Feedback"][parseInt(h.substr(0,1),10)%4],g[X("79a417a0f0181a8946")]=e,M.document[X("78a712aa")]){M.document[X("78a712aa")][X("7bb806b6ed32388c4a875b")](g),h=M.getComputedStyle(g).getPropertyValue(X("78a704b7e62456904c9b12701b6532a8"));var l=M.getComputedStyle(g).getPropertyValue(X("75b817b0ea2202"));if(M.document[X("78a712aa")][X("68ad1bbcf533388c4a875b")](g),h){if(g=M[X("77a902b0eb1b1e804a8a")],l==="0."+parseInt(r,10)%100||-1!==h.indexOf(parseInt(o[1]+o[2],16))&&-1!==h.indexOf(parseInt(o[3]+o[4],16))){a.Rc=!1;break}if(g&&g(X("32ae19a1e0331fc94084537c067a67fa59f1386b89d006")).matches)for(e="."+e,o=0;o<document.styleSheets.length;o++)for(var c in g=document.styleSheets[o].rules||document.styleSheets[o].cssRules)if(e===g[c].selectorText){a.Rc=!1;break t}}}else a.Rc=null,a.Rc=!1}}}else{for(c=t[X("76ad18b4f73e")],n=t[X("73a612b6fb191d")](X("35e7"))+2;n<c;n++)b+=t[n];t=b[X("73a612b6fb191d")](X("7da71ca0ad381e90")),a.Rc=!(0<=t&&t<b[X("73a612b6fb191d")](X("35")))}}}return 0<a.Rc&&a!==a.wy}function ks(a){this.j=void 0===a?new St:a,this.o=new St}zo.className="Diagram",zo.fromDiv=function(a){var b=a;return"string"==typeof a&&(b=M.document.getElementById(a)),b instanceof HTMLDivElement&&b.H instanceof zo?b.H:null},zo.inherit=function(a,b){function t(){}if(Object.getPrototypeOf(a).prototype)throw Error("Used go.Diagram.inherit defining already defined class \n"+a);t.prototype=b.prototype,a.prototype=new t,a.prototype.constructor=a},zo.useDOM=function(a){$r=!!a&&void 0!==M.document},zo.isUsingDOM=function(){return $r},zo.None=es,zo.Uniform=is,zo.UniformToFill=ns,zo.CycleAll=os,zo.CycleNotDirected=rs,zo.CycleNotDirectedFast=ss,zo.CycleNotUndirected=as,zo.CycleDestinationTree=hs,zo.CycleSourceTree=ls,zo.DocumentScroll=us,zo.InfiniteScroll=cs,zo.TreeParentCollapsed=fs,zo.AllParentsCollapsed=ds,zo.AnyParentsCollapsed=ps,bs.className="DiagramHelper",v.Object.defineProperties(ks.prototype,{point:{get:function(){return this.j},set:function(a){this.j=a}},shifted:{get:function(){return this.o},set:function(a){this.o=a}}});var Ms,Ss,Ps,Ns,Cs,Ts,Ls,As,js,Fs,Os="DraggingInfo";function Bs(a,b,t){this.node=a,this.info=b,this.Su=t}function Ds(){this.reset()}function Is(a,b){if("string"==typeof a||M.Element&&a instanceof Element)var t=zo.call(this,a)||this;else t=zo.call(this)||this,b=a;return zs(t),b&&t.mm(b),t}function zs(a){a.allowDragOut=!0,a.allowMove=!1,a.isReadOnly=!0,a.contentAlignment=le,a.layout=new id}function Rs(a,b){if("string"==typeof a||M.Element&&a instanceof Element)var t=zo.call(this,a)||this;else t=zo.call(this)||this,b=a;var e=t;t.animationManager.isEnabled=!1,t.wb=!0,t.V=null,t.ln=!1,t.mn=!1,t.F=!0,t.u=!0,t.ia=0,t.o=!1,t.pl=null,t.Xx("drawShadows",!1),a=new zu;var n=new Ll;return n.stroke="magenta",n.strokeWidth=2,n.fill="transparent",n.name="BOXSHAPE",a.selectable=!0,a.selectionAdorned=!1,a.selectionObjectName="BOXSHAPE",a.locationObjectName="BOXSHAPE",a.resizeObjectName="BOXSHAPE",a.cursor="move",a.add(n),t.j=a,t.allowCopy=!1,t.allowDelete=!1,t.allowSelect=!0,t.autoScrollRegion=new oe(0,0,0,0),t.pa.h(0,0),t.toolManager.gb("Dragging",new Ys,t.toolManager.mouseMoveTools),t.click=function(){var a=e.observed;if(null!==a){var b=a.viewportBounds,t=e.lastInput.documentPoint;a.position=new St(t.x-b.width/2,t.y-b.height/2)}},t.Pf=function(){e.Ya(),Vs(e)},t.Xd=function(){null!==e.observed&&(e.Ya(),e.N())},t.Ha=function(){1>e.updateDelay?e.N():e.o||(e.o=!0,setTimeout((function(){return e.redraw()}),e.updateDelay))},t.Of=function(){null!==e.observed&&Vs(e)},t.autoScale=is,t.wb=!1,b&&Object.assign(t,b),t}function Es(a){var b=a.observed;if(null!==b){var t=a.drawsTemporaryLayers,e=a.drawsGrid&&t,n=b.grid;e&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)&&(Lr(b,n=Ut.alloc().assign(a.viewportBounds).ed(b.viewportBounds)),Ut.free(n),ur(b));var o=a.Bb;o.reset(),1!==a.scale&&o.scale(a.scale),0===a.position.x&&0===a.position.y||o.translate(-a.position.x,-a.position.y),(n=a.ib).scale(a.Nb,a.Nb),n.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),n.yc(),o=(b=b.Wa.s).length;for(var g=0;g<o;g++){var r=b[g],h=a;if(r.visible&&0!==r.opacity){var l=r.diagram.grid.part;if(!t&&r.isTemporary)e&&l.layer===r&&(r=Bo(r,n),l.hc(n,h),n.globalAlpha=r);else{for(var c=Bo(r,n),f=h.scale,p=Ut.alloc(),q=r.Pa.s,d=q.length,u=0;u<d;u++){var m=q[u];(e||m!==l)&&r.Nj(n,m,h,null,f,p,!1)}Ut.free(p),n.globalAlpha=c}}}}}function Vs(a){var b=a.box;if(null!==b){var t=a.observed;if(null!==t){a.Fc=!0,t=t.viewportBounds;var e=b.selectionObject,n=Vt.alloc();n.h(t.width,t.height),e.desiredSize=n,Vt.free(n),a=2/a.scale,e instanceof Ll&&(e.strokeWidth=a),b.location=new St(t.x-a/2,t.y-a/2),b.isSelected=!0}}}function Ys(){Ri.call(this),this.j=null}function Gs(){ht(this),this.H=Lo,this.Ha=this.u=this.o=!0,this.F=this.V=this.nb=this.ia=!1,this.ij=this.j=null,this.Ib=1.05,this.It=NaN,this.sw=null,this.zu=NaN,this.xu=ee,this.hb=!0,this.cg=null,this.ob=200}function Xs(a,b,t){if(b.isVisible())return t;if(b instanceof hc)Xs(a,b.adornedPart,t);else if(b instanceof Oc){var e=b.fromNode;null!==e&&Xs(a,e,t),null!==(b=b.toNode)&&Xs(a,b,t)}else b instanceof uc&&(null!==(e=b.labeledLink)&&Xs(a,e,t),null!==(e=b.pg())&&(e.isTreeExpanded||e.wasTreeExpanded||t.push(e),Xs(a,e,t))),null!==(b=b.containingGroup)&&(b.isSubGraphExpanded||b.wasSubGraphExpanded||t.push(b),Xs(a,b,t));return t}function Us(a){var b=z();for(a=a.iterator;a.next();){var t=a.value;t instanceof Oc||b.push(t)}a=new at,t=b.length;for(var e=0;e<t;e++){for(var n=b[e],o=!0,g=0;g<t;g++)if(n.Td(b[g])){o=!1;break}o&&a.add(n)}return R(b),a}function qs(){ht(this),this.l=30723,this.pb=1,this.an="",this.Ma=this.Me=null,this.pa=new St(NaN,NaN).freeze(),this.jd=Rt,this.Bb=new Ze,this.wh=new Ze,this.Mb=null,this.Ca=this.Jk=1,this.Lb=0,this.Kg=Ge,this.uc=new Ut(NaN,NaN,NaN,NaN).freeze(),this.Jb=new Ut(NaN,NaN,NaN,NaN).freeze(),this.ec=new Ut(0,0,NaN,NaN).freeze(),this.ba=this.Xn=this.Yn=null,this.rk=this.Kb=Fe,this.Ag=this.ho=0,this.V=this.tb=this.Dh=this.A=this.Ua=null,this.Uc=!1,this.io=this.Ng=null}function Ks(a){null===a.A?a.A=new dl:a.A.oc&&(a.A=a.A.copy())}function Hs(a,b,t){var e=a.ih();if(null!==e)for(var n=a.localBindings.iterator;n.next();){var o=n.value,g=null;if(null!==o.sourceName){if(null===(g=ep(o,e,a)))continue;o.rp(a,g,t,null)}else if(o.isToModel){var r=b.diagram;null===r||r.skipsModelSourceBindings||o.rp(a,r.model.modelData,t,e)}else{if(null===(r=e.data))continue;var h=b.diagram;null===h||h.skipsModelSourceBindings||o.rp(a,r,t,e)}g===a&&(null!==(r=e.js(o.Ai))&&o.Mv(r,g,t))}}function Ws(a,b,t,e){return!1!==a.pickable&&(e.multiply(a.transform),t?a.Yc(b,e):a.fh(b,e))}function Js(a,b,t,e,n){if(a.Jb.h(b,t,e,n),!a.desiredSize.w()){var o=a.uc;b=(t=a.Kg).right+t.left;var g=t.top+t.bottom;switch(t=o.width+b,o=o.height+g,e+=b,n+=g,b=sa(a,!0),t===e&&o===n&&(b=Ss),b){case Ss:(t>e||o>n)&&(ga(a,!0),a.measure(t>e?e:t,o>n?n:o,0,0));break;case Ms:ga(a,!0),a.measure(e,n,0,0);break;case Ns:ga(a,!0),a.measure(e,o,0,0);break;case Cs:ga(a,!0),a.measure(t,n,0,0)}}}function Zs(a,b){return null!==b&&($h(b)&&(b=b.panel),0!=(512&b.l)||(b.type===Eh.Auto||b.type===Eh.Spot)&&b.Qb()!==a)}function _s(a,b,t,e){na(a,b,a.areaBackground,!0,!0,t,e),a.areaBackground instanceof Ha&&a.areaBackground.type===uh?(b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.ng(a.areaBackground)):b.fillRect(e.x,e.y,e.width,e.height)}function $s(a,b,t,e){var n=a.jq(),o=t.x,g=t.y,r=t.width+n,h=t.height+n;na(a,b,a.Ma,!0,!1,t,e),a.Ma instanceof Ha&&a.Ma.type===uh?(b.beginPath(),b.rect(o-n/2,g-n/2,r,h),b.ng(a.Ma)):b.fillRect(o-n/2,g-n/2,r,h)}function Qs(a,b,t){for(var e=b.O.s,n=e.length,o=-1,g=0;g<n;g++)if(e[g]===a){o=g;break}if(-1!==(a=o))if(0===a)b.svg.gd?b.svg.gd.after(t):b.svg.Ma?b.svg.Ma.after(t):b.type===Eh.Table?null!==(b=0!==(b=b.svg.getElementsByClassName("gojs-ts")).length?b[0]:null)&&b.after(t):b.svg.prepend(t);else{for(;0!==a&&!b.M(a-1).Ed();)a--;0===a?b.svg.prepend(t):null!==(a=b.M(a-1).svg)?a.after(t):b.svg.appendChild(t)}}function ta(a,b){b=b.dataset,a instanceof qs&&(null!==a.portId&&(b.portId=a.portId),a instanceof Eh&&(isNaN(a.itemIndex)||(b.itemIndex=a.itemIndex.toString()),a instanceof zu&&(b.className=E(a),void 0!==a.key&&(b.key=a.key.toString()),a instanceof Oc&&(null!==a.fromNode&&(b.fromKey=a.fromNode.key.toString()),""!==a.fromPortId&&(b.fromPortId=a.fromPortId),null!==a.toNode&&(b.toKey=a.toNode.key.toString()),""!==a.toPortId&&(b.toPortId=a.toPortId)))))}function ea(a,b){null!==(b=b.getAttribute("clip-path"))&&(null!==(a=a.svg.getElementById(b.split("#")[1].slice(0,-1)))&&a.remove())}function ia(a){if(null!==a.svg){var b=a.svg.innerHTML.match(/url\(#((CLIP|GRAD).+?)\)/g),t=a.svg.ownerDocument;if(null!==b)for(var e=(b=r(b)).next();!e.done;e=b.next())null!==(e=t.getElementById(e.value.split("#")[1].slice(0,-1)))&&e.remove();a.svg.remove()}}function na(a,b,t,e,n,o,g){if(null!==t){var r=1,h=1;if("string"==typeof t)e?b.fillStyle=t:b.strokeStyle=t;else if(t.type===hh)e?b.fillStyle=t.color:b.strokeStyle=t.color;else{var l=a.jq();if(r=o.width,h=o.height,n?(r=g.width,h=g.height):e||(r+=l,h+=l),(o=b instanceof Ua)&&t.xe&&(t.type===ch||t.xk===r&&t.et===h))var c=t.xe;else{var f=0,p=0,q=0,d=0,u=0,m=0;if(m=u=0,n?(u=g.x,m=g.y):e||(u-=l/2,m-=l/2),f=t.start.x*r+t.start.offsetX,p=t.start.y*h+t.start.offsetY,q=t.end.x*r+t.end.offsetX,d=t.end.y*h+t.end.offsetY,f+=u,q+=u,p+=m,d+=m,t.type===lh)c=b.createLinearGradient(f,p,q,d);else if(t.type===uh)m=isNaN(t.endRadius)?Math.max(r,h)/2:t.endRadius,isNaN(t.startRadius)?(u=0,m=Math.max(r,h)/2):u=t.startRadius,c=b.createRadialGradient(f,p,u,q,d,m);else if(t.type===ch)try{c=b.createPattern(t.pattern,"repeat")}catch(t){c=null}if(t.type!==ch&&null!==(n=t.colorStops))for(n=n.iterator;n.next();)c.addColorStop(n.key,n.value);if(o&&(t.xe=c,null!==c&&(t.xk=r,t.et=h),null===c&&t.type===ch&&-1!==t.xk)){t.xk=-1;var y=a.diagram;null!==y&&-1===t.xk&&N((function(){y.redraw()}),600)}}e?b.fillStyle=c:b.strokeStyle=c}}}function oa(a){if(0!=(2048&a.l)==!0){var b=a.Bb;if(b.reset(),!a.Jb.w()||!a.uc.w())return void fa(a,!1);if(b.translate(a.Jb.x-a.uc.x,a.Jb.y-a.uc.y),1!==a.scale||0!==a.angle){var t=a.naturalBounds;a.mo(b,t.x,t.y,t.width,t.height)}fa(a,!1),da(a,!0)}0!=(4096&a.l)==!0&&(null===(b=a.panel)?(a.wh.set(a.Bb),a.Jk=a.scale,da(a,!1)):null!==b.oe&&((t=a.wh).reset(),b.se()?t.multiply(b.wh):null!==b.panel&&t.multiply(b.panel.wh),t.multiply(a.Bb),a.Jk=a.scale*b.Jk,da(a,!1)))}function ra(a){if(!ma(a)){var b=a.panel;null!==b?b.v():a.Dd()&&(null!==(b=a.diagram)&&(b.De.add(a),a instanceof uc&&a.Bd(),b.ac())),ya(a,!0)}}function sa(a,b){var t=a.stretch,e=a.panel;return null!==e&&e.type===Eh.Table?aa(a,e.Gb(a.row),e.Fb(a.column),b):null!==e&&e.type===Eh.Auto&&e.Qb()===a?ha(a,Ms,b):t===Ts?null!==e?e.type===Eh.Spot&&e.Qb()===a?ha(a,Ms,b):ha(a,(t=e.defaultStretch)===Ts?Ss:t,b):ha(a,Ss,b):ha(a,t,b)}function aa(a,b,t,e){var n=a.stretch;if(n!==Ts)return ha(a,n,e);var o=n=null;switch(b.stretch){case Cs:case Ms:o=!0}switch(t.stretch){case Ns:case Ms:n=!0}return b=a.panel.defaultStretch,null===n&&(n=b===Ns||b===Ms),null===o&&(o=b===Cs||b===Ms),ha(a,!0===n&&!0===o?Ms:!0===n?Ns:!0===o?Cs:Ss,e)}function ha(a,b,t){if(t)return b;if(b===Ss)return Ss;if((t=a.desiredSize).w())return Ss;if(a=a.angle,!isNaN(t.width))if(90!==a&&270!==a){if(b===Ns)return Ss;if(b===Ms)return Cs}else{if(b===Cs)return Ss;if(b===Ms)return Ns}if(!isNaN(t.height))if(90!==a&&270!==a){if(b===Cs)return Ss;if(b===Ms)return Ns}else{if(b===Ns)return Ss;if(b===Ms)return Cs}return b}function la(a,b){a.l=b?512|a.l:-513&a.l}function ua(a){return 0!=(1024&a.l)}function ca(a,b){a.l=b?1024|a.l:-1025&a.l}function fa(a,b){a.l=b?2048|a.l:-2049&a.l}function da(a,b){a.l=b?4096|a.l:-4097&a.l}function pa(a){return 0!=(8192&a.l)}function ga(a,b){a.l=b?8192|a.l:-8193&a.l}function ma(a){return 0!=(16384&a.l)}function ya(a,b){a.l=b?16384|a.l:-16385&a.l}function va(a){var b=a.part;if(b instanceof uc&&(null!==a.portId||a===b.port)){var t=b.diagram;null===t||t.undoManager.isUndoingRedoing||ol(b,a)}}function xa(a){var b=a.diagram;null===b||b.undoManager.isUndoingRedoing||(a instanceof Eh?a instanceof uc?a.Bd():a.pm(a,(function(a){va(a)})):va(a))}function ba(a,b){for(var t=1;t<arguments.length;++t);t=arguments;var e=null,n=null;if("function"==typeof a)n=a;else if("string"==typeof a){var o=Sa.I(a);"function"==typeof o?F(e=o(t=B(arguments)))||T('GraphObject.make invoked object builder "'+a+'", but it did not return an Object'):n=M.go[a]}if(null===e&&(null!=n&&n.constructor||T("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+a),e=new n),n=1,e instanceof zo&&1<t.length){o=e;var g=t[1];("string"==typeof g||g instanceof HTMLDivElement)&&(Yo(o,g),n++)}for(;n<t.length;n++)void 0===(o=t[n])?T("Undefined value at argument "+n+" for object being constructed by GraphObject.make: "+e):wa(e,o);return e}function wa(a,b){if("string"==typeof b)if(a instanceof Yl)a.text=b;else if(a instanceof Ll)a.figure=b;else if(a instanceof xu)a.source=b;else if(a instanceof Eh)null!==(b=bl.I(b))&&(a.type=b);else if(a instanceof Ha){var t=J(Ha,b);null!==t?a.type=t:T("Unknown Brush type as an argument to GraphObject.make: "+b)}else a instanceof Qe?null!==(b=J(Qe,b))&&(a.type=b):a instanceof hi&&(null!==(b=J(hi,b))&&(a.type=b));else if(b instanceof qs)a instanceof Eh||T("A GraphObject can only be added to a Panel, not to: "+a),a.add(b);else if(b instanceof Ml){var e;b.isRow&&"function"==typeof a.getRowDefinition?e=a.getRowDefinition(b.index):b.isRow||"function"!=typeof a.getColumnDefinition||(e=a.getColumnDefinition(b.index)),e instanceof Ml?Sl(e,b):T("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+a)}else if(b instanceof W)"function"==typeof a.qb&&a.qb(b);else if(b instanceof Mh)a.type=b;else if(b instanceof tp)a instanceof qs||a instanceof Ml?a.bind(b):T("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+a);else if(b instanceof Co)a instanceof qs?a.Jv(b):T("An AnimationTrigger can only be applied to a GraphObject, not to: "+a);else if(b instanceof ai)a instanceof Qe&&a.type===Qe.o?a.figures.add(b):T("A PathFigure can only be added to a Path Geometry, not to: "+a);else if(b instanceof hi)a instanceof ai?a.segments.add(b):T("A PathSegment can only be added to a PathFigure, not to: "+a);else if(b instanceof Uf)a instanceof zo||a instanceof Cc?a.layout=b:T("A Layout can only be assigned to a Diagram or a Group, not to: "+a);else if(Array.isArray(b))for(t=0;t<b.length;t++)wa(a,b[t]);else if("object"==typeof b&&null!==b)if(a instanceof Ha){for(var n in t=new _,b)e=parseFloat(n),isNaN(e)?t[n]=b[n]:a.addColorStop(e,b[n]);pr(a,t)}else if(a instanceof Ml){for(t in void 0!==b.row?((null==(n=b.row)||1/0===n||isNaN(n)||0>n)&&T("Must specify non-negative integer row for RowColumnDefinition "+b+", not: "+n),a.isRow=!0,a.index=n):void 0!==b.column&&((null==(n=b.column)||1/0===n||isNaN(n)||0>n)&&T("Must specify non-negative integer column for RowColumnDefinition "+b+", not: "+n),a.isRow=!1,a.index=n),n=new _,b)"row"!==t&&"column"!==t&&(n[t]=b[t]);pr(a,n)}else pr(a,b);else T('Unknown initializer "'+b+'" for object being constructed by GraphObject.make: '+a)}function ka(a,b){Sa.add(a,b)}function Ma(a,b,t){void 0===t&&(t=null);var e=a[1];if("function"==typeof t?t(e):"string"==typeof e)return a.splice(1,1),e;if(void 0===b)throw Error("no "+("function"==typeof t?"satisfactory":"string")+" argument for GraphObject builder "+a[0]);return b}ks.className="DraggingInfo",Bs.className="DraggingNodeInfoPair",Ds.prototype.reset=function(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new Vt(NaN,NaN).freeze(),this.gridSnapCellSpot=he,this.gridSnapOrigin=new St(NaN,NaN).freeze(),this.groupsSnapMembers=this.dragsTree=this.dragsLink=!1,this.dragsMembers=this.groupsAlwaysMove=!0},Ds.className="DraggingOptions",y(Is,zo),Is.prototype.reset=function(){zo.prototype.reset.call(this),zs(this)},Is.className="Palette",y(Rs,zo),Rs.prototype.computePixelRatio=function(){return 1},Rs.prototype.redraw=function(){if(this.o&&1<=this.updateDelay){this.o=!1;var a=this.ta,b=this.ib;if(null!==a&&null!==b){if(gr(this),null===this.pl){var t=new Xa(null);t.width=a.width,t.height=a.height,this.pl=t}try{this.ta=this.pl,this.ib=this.ta.context,this.ib.Vc(!0),this.ib.setTransform(1,0,0,1,0,0),this.ib.clearRect(0,0,this.ta.width,this.ta.height),Es(this)}finally{this.ta=a,this.ib=b}}}zo.prototype.redraw.call(this)},Rs.prototype.hc=function(){if(null===this.Ka&&T("No div specified"),null===this.ta&&T("No canvas specified"),!(this.ta instanceof La)&&(Eu(this.box),this.Fc)){var a=this.observed;if(null!==a&&!a.animationManager.defaultAnimation.isAnimating&&a.pi){gr(this);var b=this.ta;(a=this.ib).Vc(!0),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,b.width,b.height),1>this.updateDelay?Es(this):null!==this.pl&&(a.drawImage(this.pl.Oa,0,0),(b=this.Bb).reset(),1!==this.scale&&b.scale(this.scale),0===this.position.x&&0===this.position.y||b.translate(-this.position.x,-this.position.y),a.scale(this.Nb,this.Nb),a.transform(b.m11,b.m12,b.m21,b.m22,b.dx,b.dy),a.yc());for(var t=(b=this.Wa.s).length,e=0;e<t;e++)b[e].hc(a,this);this.Fc=this.vd=!1}}},Rs.prototype.computeBounds=function(){var a=this.observed;if(null===a)return ee;var b=a.documentBounds.copy();return b.ed(a.viewportBounds),b},Rs.prototype.invalidateViewport=function(){!0!==this.Fc&&(this.Fc=!0,this.ac())},Rs.prototype.onViewportBoundsChanged=function(a,b,t,e){this.wb||(this.vd=!0,this.N(),this.Ee=!0,this.Ya(),Vs(this),this.gc.scale=t,this.gc.position.x=a.x,this.gc.position.y=a.y,this.gc.bounds.assign(a),this.gc.Oz=e,this.R("ViewportBoundsChanged",this.gc,a))},v.Object.defineProperties(Rs.prototype,{observed:{get:function(){return this.V},set:function(a){var b=this.V;if(a instanceof Rs&&T("Overview.observed Diagram may not be an Overview itself: "+a),b!==a){if(null!==b&&(this.remove(this.box),b.$l("ViewportBoundsChanged",this.Pf),b.$l("DocumentBoundsChanged",this.Xd),b.$l("InvalidateDraw",this.Ha),b.$l("AnimationFinished",this.Of)),this.V=a,null!==a&&(a.Bj("ViewportBoundsChanged",this.Pf),a.Bj("DocumentBoundsChanged",this.Xd),a.Bj("InvalidateDraw",this.Ha),a.Bj("AnimationFinished",this.Of),this.add(this.box)),this.Ya(),null===a){this.pl=null;var t=this.ta,e=this.ib;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Ha(null),Vs(this),this.N();this.g("observed",b,a)}}},box:{get:function(){return this.j},set:function(a){var b=this.j;b!==a&&(this.j=a,this.remove(b),this.add(this.j),Vs(this),this.g("box",b,a))}},drawsTemporaryLayers:{get:function(){return this.F},set:function(a){this.F!==a&&(this.F=a,this.redraw())}},drawsGrid:{get:function(){return this.u},set:function(a){this.u!==a&&(this.u=a,this.redraw())}},updateDelay:{get:function(){return this.ia},set:function(a){0>a&&(a=0),this.ia!==a&&(this.ia=a)}}}),Rs.className="Overview",y(Ys,Ri),Ys.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||!a.allowMove||!a.allowSelect)return!1;var b=a.observed;if(null===b)return!1;var t=a.lastInput;return!(!t.left||a.currentTool!==this&&(!this.isBeyondDragSize()||t.isTouchEvent&&t.timestamp-a.firstInput.timestamp<this.delay))&&(null===this.findDraggablePart()&&(t=b.viewportBounds,this.j=new St(t.width/2,t.height/2),a=a.firstInput.documentPoint,b.position=new St(a.x-this.j.x,a.y-this.j.y)),!0)},Ys.prototype.doActivate=function(){this.j=null,Ri.prototype.doActivate.call(this)},Ys.prototype.doUpdateCursor=function(){var a=this.diagram,b=a.box;null!==b&&b.cursor&&(a.currentCursor=b.cursor)},Ys.prototype.moveParts=function(){var a=this.diagram,b=a.observed;if(null!==b){var t=a.box;if(null!==t){if(null===this.j){var e=a.firstInput.documentPoint;t=t.location,this.j=new St(e.x-t.x,e.y-t.y)}a=a.lastInput.documentPoint,b.position=new St(a.x-this.j.x,a.y-this.j.y)}}},Ys.className="OverviewDraggingTool",Gs.prototype.toString=function(){return"CommandHandler"},Gs.prototype.Xe=function(a){this.H=a},Gs.prototype.doKeyDown=function(){var a=this.diagram,b=a.lastInput,t=K?b.meta:b.control,e=b.shift,n=b.alt,o=b.key;!t||"C"!==o&&"Insert"!==o?t&&"X"===o||e&&"Del"===o?this.canCutSelection()&&this.cutSelection():t&&"V"===o||e&&"Insert"===o?this.canPasteSelection()&&this.pasteSelection():t&&"Y"===o||n&&e&&"Backspace"===o?this.canRedo()&&this.redo():t&&"Z"===o||n&&"Backspace"===o?this.canUndo()&&this.undo():"Del"===o||"Backspace"===o?this.canDeleteSelection()&&this.deleteSelection():t&&"A"===o?this.canSelectAll()&&this.selectAll():"Esc"===o?this.canStopCommand()&&this.stopCommand():"Up"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","up"):a.scroll("line","up")):"Down"===o?a.allowVerticalScroll&&(t?a.scroll("pixel","down"):a.scroll("line","down")):"Left"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","left"):a.scroll("line","left")):"Right"===o?a.allowHorizontalScroll&&(t?a.scroll("pixel","right"):a.scroll("line","right")):"PageUp"===o?e&&a.allowHorizontalScroll?a.scroll("page","left"):a.allowVerticalScroll&&a.scroll("page","up"):"PageDown"===o?e&&a.allowHorizontalScroll?a.scroll("page","right"):a.allowVerticalScroll&&a.scroll("page","down"):"Home"===o?t&&a.allowVerticalScroll?a.scroll("document","up"):!t&&a.allowHorizontalScroll&&a.scroll("document","left"):"End"===o?t&&a.allowVerticalScroll?a.scroll("document","down"):!t&&a.allowHorizontalScroll&&a.scroll("document","right"):" "===o?this.canScrollToPart()&&this.scrollToPart():"Subtract"===o?this.canDecreaseZoom()&&this.decreaseZoom():"Add"===o?this.canIncreaseZoom()&&this.increaseZoom():t&&"0"===o?this.canResetZoom()&&this.resetZoom():e&&"Z"===o?this.canZoomToFit()&&this.zoomToFit():t&&!e&&"G"===o?this.canGroupSelection()&&this.groupSelection():t&&e&&"G"===o?this.canUngroupSelection()&&this.ungroupSelection():"F2"===o||b.event&&"F2"===b.event.key?this.canEditTextBlock()&&this.editTextBlock():"ContextMenu"===o||b.event&&"ContextMenu"===b.event.key?this.canShowContextMenu()&&this.showContextMenu():b.bubbles=!0:this.canCopySelection()&&this.copySelection()},Gs.prototype.doKeyUp=function(){this.diagram.lastInput.bubbles=!0},Gs.prototype.stopCommand=function(){var a=this.diagram,b=a.currentTool;b instanceof Li&&a.allowSelect&&a.clearSelection(),null!==b&&b.doCancel()},Gs.prototype.canStopCommand=function(){return!0},Gs.prototype.selectAll=function(){var a=this.diagram;a.N();try{a.currentCursor="wait",a.R("ChangingSelection",a.selection);for(var b=a.parts;b.next();)b.value.isSelected=!0;for(var t=a.nodes;t.next();)t.value.isSelected=!0;for(var e=a.links;e.next();)e.value.isSelected=!0}finally{a.R("ChangedSelection",a.selection),a.currentCursor=""}},Gs.prototype.canSelectAll=function(){return this.diagram.allowSelect},Gs.prototype.deleteSelection=function(){var a=this.diagram;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.Ea("Delete"),a.R("SelectionDeleting",a.selection);for(var b=new at,t=a.selection.iterator;t.next();)sc(b,t.value,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(function(a){return a.canDelete()}));a.Hs(b,!0),a.R("SelectionDeleted",b)}finally{a.eb("Delete"),a.R("ChangedSelection",a.selection),a.currentCursor=""}},Gs.prototype.canDeleteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowDelete||0===a.selection.count)},Gs.prototype.copySelection=function(){var a=this.diagram,b=new at;for(a=a.selection.iterator;a.next();)sc(b,a.value,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(function(a){return a.canCopy()}));this.copyToClipboard(b)},Gs.prototype.canCopySelection=function(){var a=this.diagram;return!(!a.allowCopy||!a.allowClipboard||0===a.selection.count)},Gs.prototype.cutSelection=function(){this.copySelection(),this.deleteSelection()},Gs.prototype.canCutSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowCopy||!a.allowDelete||!a.allowClipboard||0===a.selection.count)},Gs.prototype.copyToClipboard=function(a){var b=this.diagram,t=null;if(null===a)Qr=null,ts="";else{t=b.model;var e=!1,n=!1,o=null;try{t.Sl()&&(e=t.Ij,t.Ij=this.copiesParentKey),t.Vj()&&(n=t.Hj,t.Hj=this.copiesGroupKey),o=b.Jj(a,null,!0)}finally{t.Sl()&&(t.Ij=e),t.Vj()&&(t.Hj=n),(t=new ot).addAll(o),Qr=t,ts=b.model.dataFormat}}b.R("ClipboardChanged",t)},Gs.prototype.pasteFromClipboard=function(){var a=new at,b=Qr;if(null===b)return a;var t=this.diagram;if(ts!==t.model.dataFormat)return a;var e=t.model,n=!1,o=!1,g=null;try{e.Sl()&&(n=e.Ij,e.Ij=this.copiesParentKey),e.Vj()&&(o=e.Hj,e.Hj=this.copiesGroupKey),g=t.Jj(b,t,!1)}finally{for(e.Sl()&&(e.Ij=n),e.Vj()&&(e.Hj=o),b=g.iterator;b.next();)t=b.value,e=b.key,t.location.w()||(e.location.w()?t.location=e.location:!t.position.w()&&e.position.w()&&(t.position=e.position)),a.add(t)}return a},Gs.prototype.pasteSelection=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.Ea("Paste");var t=this.pasteFromClipboard();0<t.count&&b.clearSelection(!0);for(var e=t.iterator;e.next();)e.value.isSelected=!0;if(null!==a){var n=b.computePartsBounds(b.selection);if(n.w())wr(b,this.computeEffectiveCollection(b.selection,b.Vm),new St(a.x-n.centerX,a.y-n.centerY),b.Vm,!1)}b.R("ClipboardPasted",t)}finally{b.eb("Paste"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},Gs.prototype.canPasteSelection=function(){var a=this.diagram;return!(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowClipboard||null===Qr||0===Qr.count||ts!==a.model.dataFormat)},Gs.prototype.undo=function(){this.diagram.undoManager.undo()},Gs.prototype.canUndo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canUndo())},Gs.prototype.redo=function(){this.diagram.undoManager.redo()},Gs.prototype.canRedo=function(){var a=this.diagram;return!a.isReadOnly&&!a.isModelReadOnly&&(a.allowUndo&&a.undoManager.canRedo())},Gs.prototype.decreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;b.autoScale===es&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},Gs.prototype.canDecreaseZoom=function(a){void 0===a&&(a=1/this.zoomFactor);var b=this.diagram;return b.autoScale===es&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},Gs.prototype.increaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;b.autoScale===es&&((a=b.scale*a)<b.minScale||a>b.maxScale||(b.scale=a))},Gs.prototype.canIncreaseZoom=function(a){void 0===a&&(a=this.zoomFactor);var b=this.diagram;return b.autoScale===es&&(!((a=b.scale*a)<b.minScale||a>b.maxScale)&&b.allowZoom)},Gs.prototype.resetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;a<b.minScale||a>b.maxScale||(b.scale=a)},Gs.prototype.canResetZoom=function(a){void 0===a&&(a=this.defaultScale);var b=this.diagram;return!(a<b.minScale||a>b.maxScale)&&b.allowZoom},Gs.prototype.zoomToFit=function(){var a=this.diagram,b=a.animationManager;b.Cc(),a.redraw();var t=a.position,e=a.scale;io(b,"Zoom To Fit"),this.isZoomToFitRestoreEnabled&&e===this.zu&&!isNaN(this.It)&&a.documentBounds.D(this.xu)?(a.scale=this.It,a.position=this.sw,this.zu=NaN,this.xu=ee):(this.It=e,this.sw=t.copy(),a.zoomToFit(),this.zu=a.scale,this.xu=a.documentBounds.copy()),no(b)},Gs.prototype.canZoomToFit=function(){return this.diagram.allowZoom},Gs.prototype.scrollToPart=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.Va(),null===a){try{null!==this.cg&&(this.cg.next()?a=this.cg.value:this.cg=null)}catch(t){this.cg=null}null===a&&(0<b.highlighteds.count?this.cg=b.highlighteds.iterator:0<b.selection.count&&(this.cg=b.selection.iterator),null!==this.cg&&this.cg.next()&&(a=this.cg.value))}if(null!==a){var t=b.animationManager;io(t,"Scroll To Part");var e=this.scrollToPartPause;if(0<e){var n=Xs(this,a,[a]);if(1===n.length)b.Ea(),b.ds(a.actualBounds),b.eb("Scroll To Part");else{var o=function(){b.Ea();for(var a=n.pop();0<n.length&&a instanceof uc&&a.isTreeExpanded&&(!(a instanceof Cc)||a.isSubGraphExpanded);)a=n.pop();0<n.length?(a instanceof zu&&b.tv(a.actualBounds),a instanceof uc&&!a.isTreeExpanded&&(a.isTreeExpanded=!0),a instanceof Cc&&!a.isSubGraphExpanded&&(a.isSubGraphExpanded=!0)):(a instanceof zu&&b.ds(a.actualBounds),b.$l("LayoutCompleted",g)),b.eb("Scroll To Part")},g=function(){N(o,(t.isEnabled?t.duration:0)+e)};b.Bj("LayoutCompleted",g),o()}}else{var r=b.position.copy();b.ds(a.actualBounds),r.Xa(b.position)&&t.Cc()}}},Gs.prototype.canScrollToPart=function(a){return void 0===a&&(a=null),(null===a||a instanceof zu)&&((0!==(a=this.diagram).selection.count||0!==a.highlighteds.count)&&(a.allowHorizontalScroll&&a.allowVerticalScroll))},Gs.prototype.collapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.Ea("Collapse Tree"),io(b.animationManager,"Collapse Tree");var t=new ot;if(null!==a&&a.isTreeExpanded)a.collapseTree(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof uc&&n.isTreeExpanded&&(n.collapseTree(),t.add(n))}b.R("TreeCollapsed",t)}finally{b.eb("Collapse Tree")}},Gs.prototype.canCollapseTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof uc&&a.isTreeExpanded))return!1;if(0<a.Po().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof uc&&b.isTreeExpanded&&0<b.Po().count)return!0;return!1},Gs.prototype.expandTree=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.Ea("Expand Tree"),io(b.animationManager,"Expand Tree");var t=new ot;if(null===a||a.isTreeExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof uc&&!n.isTreeExpanded&&(n.expandTree(),t.add(n))}}else a.expandTree(),t.add(a);b.R("TreeExpanded",t)}finally{b.eb("Expand Tree")}},Gs.prototype.canExpandTree=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a){if(!(a instanceof uc)||a.isTreeExpanded)return!1;if(0<a.Po().count)return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof uc&&!b.isTreeExpanded&&0<b.Po().count)return!0;return!1},Gs.prototype.groupSelection=function(){var a=this.diagram,b=a.model;if(b.Wj()){var t=this.archetypeGroupData;if(null!==t){var e=null;try{a.currentCursor="wait",a.R("ChangingSelection",a.selection),a.Ea("Group");for(var n=new ot,o=a.selection.iterator;o.next();){var g=o.value;g.Zc()&&g.canGroup()&&n.add(g)}for(var r=new ot,h=n.iterator;h.next();){var l=h.value;o=!1;for(var c=n.iterator;c.next();)if(l.Td(c.value)){o=!0;break}o||r.add(l)}if(0<r.count){var f=r.first().containingGroup;if(null!==f)for(;null!==f;){n=!1;for(var p=r.iterator;p.next();)if(!p.value.Td(f)){n=!0;break}if(!n)break;f=f.containingGroup}if(t instanceof Cc)al(t),null!==(e=t.copy())&&a.add(e);else if(b.Yu(t)){var q=b.copyNodeData(t);F(q)&&(b.xf(q),e=a.ii(q))}if(null!==e){null!==f&&this.isValidMember(f,e)&&(e.containingGroup=f);for(var d=r.iterator;d.next();){var u=d.value;this.isValidMember(e,u)&&(u.containingGroup=e)}a.clearSelection(!0),e.isSelected=!0}}a.R("SelectionGrouped",e)}finally{a.eb("Group"),a.R("ChangedSelection",a.selection),a.currentCursor=""}}}},Gs.prototype.canGroupSelection=function(){var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowGroup||!a.model.Wj()||null===this.archetypeGroupData)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Zc()&&b.canGroup())return!0}return!1},Gs.prototype.isValidMember=function(a,b){if(null===b||a===b||b instanceof Oc)return!1;if(null!==a){if(a===b||a.Td(b))return!1;var t=a.memberValidation;if(null!==t&&!t(a,b)||null===a.data&&null!==b.data||null!==a.data&&null===b.data)return!1}return null===(t=this.memberValidation)||t(a,b)},Gs.prototype.ungroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.model;if(t.Wj())try{b.currentCursor="wait",b.R("ChangingSelection",b.selection),b.Ea("Ungroup");var e=new ot;if(null!==a)e.add(a);else for(var n=b.selection.iterator;n.next();){var o=n.value;o instanceof Cc&&o.canUngroup()&&e.add(o)}var g=new ot;if(0<e.count){b.clearSelection(!0);for(var r=e.iterator;r.next();){var h=r.value;h.expandSubGraph();var l=h.containingGroup,c=null!==l&&null!==l.data?t.wa(l.data):void 0;g.addAll(h.memberParts);for(var f=g.iterator;f.next();){var p=f.value;if(p.isSelected=!0,!(p instanceof Oc)){var q=p.data;null!==q?t.lp(q,c):p.containingGroup=l}}b.remove(h)}}b.R("SelectionUngrouped",e,g)}finally{b.eb("Ungroup"),b.R("ChangedSelection",b.selection),b.currentCursor=""}},Gs.prototype.canUngroupSelection=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowDelete||!b.allowUngroup||!b.model.Wj())return!1;if(null!==a){if(!(a instanceof Cc))return!1;if(a.canUngroup())return!0}else for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof Cc&&b.canUngroup())return!0;return!1},Gs.prototype.addTopLevelParts=function(a,b){var t=!0;for(a=Us(a).iterator;a.next();){var e=a.value;null!==e.containingGroup&&(!b||this.isValidMember(null,e)?e.containingGroup=null:t=!1)}return t},Gs.prototype.collapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.Ea("Collapse SubGraph"),io(b.animationManager,"Collapse SubGraph");var t=new ot;if(null!==a&&a.isSubGraphExpanded)a.collapseSubGraph(),t.add(a);else if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof Cc&&n.isSubGraphExpanded&&(n.collapseSubGraph(),t.add(n))}b.R("SubGraphCollapsed",t)}finally{b.eb("Collapse SubGraph")}},Gs.prototype.canCollapseSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return!!(a instanceof Cc&&a.isSubGraphExpanded);for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof Cc&&b.isSubGraphExpanded)return!0;return!1},Gs.prototype.expandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;try{b.Ea("Expand SubGraph"),io(b.animationManager,"Expand SubGraph");var t=new ot;if(null===a||a.isSubGraphExpanded){if(null===a)for(var e=b.selection.iterator;e.next();){var n=e.value;n instanceof Cc&&!n.isSubGraphExpanded&&(n.expandSubGraph(),t.add(n))}}else a.expandSubGraph(),t.add(a);b.R("SubGraphExpanded",t)}finally{b.eb("Expand SubGraph")}},Gs.prototype.canExpandSubGraph=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly)return!1;if(null!==a)return a instanceof Cc&&!a.isSubGraphExpanded;for(a=b.selection.iterator;a.next();)if((b=a.value)instanceof Cc&&!b.isSubGraphExpanded)return!0;return!1},Gs.prototype.editTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram,t=b.toolManager.findTool("TextEditing");if(null!==t){if(null===a){a=null;for(var e=b.selection.iterator;e.next();){var n=e.value;if(n.canEdit()){a=n;break}}if(null===a)return;a=a.Ml((function(a){return a instanceof Yl&&a.editable}))}null!==a&&(b.currentTool=null,t.textBlock=a,b.currentTool=t)}},Gs.prototype.canEditTextBlock=function(a){void 0===a&&(a=null);var b=this.diagram;if(b.isReadOnly||b.isModelReadOnly||!b.allowTextEdit||null===b.toolManager.findTool("TextEditing"))return!1;if(null!==a){if(!(a instanceof Yl))return!1;if(null!==(a=a.part)&&a.canEdit())return!0}else for(b=b.selection.iterator;b.next();)if((a=b.value).canEdit()&&null!==(a=a.Ml((function(a){return a instanceof Yl&&a.editable}))))return!0;return!1},Gs.prototype.showContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");if(null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==(a=t.findObjectWithContextMenu(a)))){var e=b.lastInput,n=null;a instanceof qs?n=a.ga(fe):b.viewportBounds.ca(e.documentPoint)||(n=new St((n=b.viewportBounds).x+n.width/2,n.y+n.height/2)),null!==n&&(e.viewPoint=b.np(n),e.documentPoint=n,e.left=!1,e.right=!0,e.up=!0),b.currentTool=t,Bn(t,!1,a)}},Gs.prototype.canShowContextMenu=function(a){var b=this.diagram,t=b.toolManager.findTool("ContextMenu");return null!==t&&(void 0===a&&(a=0<b.selection.count?b.selection.first():b),null!==t.findObjectWithContextMenu(a))},Gs.prototype.computeEffectiveCollection=function(a,b){var t=this.diagram,e=t.toolManager.findTool("Dragging"),n=t.currentTool===e;if(void 0===b&&(b=n?e.dragOptions:t.Vm),e=new Mt,null===a)return e;for(var o=a.iterator;o.next();)xr(t,e,o.value,n,b);if(null!==t.draggedLink&&b.dragsLink)return e;for(o=a.iterator;o.next();)(a=o.value)instanceof Oc&&(null===(b=a.fromNode)||e.contains(b)?null===(b=a.toNode)||e.contains(b)||e.remove(a):e.remove(a));return e},v.Object.defineProperties(Gs.prototype,{diagram:{get:function(){return this.H}},copiesClipboardData:{get:function(){return this.o},set:function(a){this.o=a}},copiesConnectedLinks:{get:function(){return this.u},set:function(a){this.u=a}},deletesConnectedLinks:{get:function(){return this.Ha},set:function(a){this.Ha=a}},copiesTree:{get:function(){return this.ia},set:function(a){this.ia=a}},deletesTree:{get:function(){return this.nb},set:function(a){this.nb=a}},copiesParentKey:{get:function(){return this.V},set:function(a){this.V=a}},copiesGroupKey:{get:function(){return this.F},set:function(a){this.F=a}},archetypeGroupData:{get:function(){return this.j},set:function(a){this.j=a}},memberValidation:{get:function(){return this.ij},set:function(a){this.ij=a}},defaultScale:{get:function(){return this.diagram.defaultScale},set:function(a){this.diagram.defaultScale=a}},zoomFactor:{get:function(){return this.Ib},set:function(a){1<a||T("zoomFactor must be larger than 1.0, not: "+a),this.Ib=a}},isZoomToFitRestoreEnabled:{get:function(){return this.hb},set:function(a){this.hb=a}},scrollToPartPause:{get:function(){return this.ob},set:function(a){this.ob=a}}}),Gs.className="CommandHandler",Vo=function(){return new Gs},qs.prototype.cloneProtected=function(a){a.l=6144|this.l,a.pb=this.pb,a.an=this.an,a.Ma=this.Ma,a.pa.assign(this.pa),a.jd=this.jd.J(),null!==this.Mb?a.Mb=this.Mb.copy():a.Mb=null,a.Ca=this.Ca,a.Lb=this.Lb,a.Kg=this.Kg.J(),a.uc.assign(this.uc),a.Jb.assign(this.Jb),a.ec.assign(this.ec),a.Xn=this.Xn,null!==this.ba&&(a.ba=this.ba.copy()),a.Kb=this.Kb.J(),a.rk=this.rk.J(),a.ho=this.ho,a.Ag=this.Ag,null!==this.Ua&&(a.Ua=this.Ua.copy()),null!==this.A&&(a.A=this.A.oc?this.A:this.A.copy()),null!==this.Dh&&(a.Dh=B(this.Dh)),null!==this.tb&&(a.tb=this.tb.copy())},qs.prototype.Vw=function(a){var b=this.Dh;if(O(b)){for(var t=0;t<b.length;t++)if(b[t]===a)return}else this.Dh=b=[];b.push(a)},qs.prototype.Af=function(a){a.Yn=null,a.Ng=null,a.v()},qs.prototype.clone=function(){var a=new this.constructor;if(this.cloneProtected(a),null!==this.Dh)for(var b=0;b<this.Dh.length;b++){var t=this.Dh[b];a[t]=this[t]}return a},qs.prototype.copy=function(){return this.clone()},(e=qs.prototype).qb=function(a){a.classType===Oc?0===a.name.indexOf("Orient")?this.segmentOrientation=a:T("Unknown Link enum value for GraphObject.segmentOrientation property: "+a):a.classType===qs&&(this.stretch=a)},e.toString=function(){return E(this.constructor)+"#"+ut(this)},e.th=function(){null!==this.A&&(this.A.oc=!0)},e.Xc=function(){if(null===this.ba){var a=new Na;a.Xi=ae,a.yj=ae,a.Vi=10,a.wj=10,a.Wi=0,a.xj=0,this.ba=a}},e.cb=function(a,b,t,e,n,o,g){var r=this.part;if(null!==r&&(r.fk(a,b,t,e,n,o,g),t===this&&a===ki&&ua(this)&&Hs(this,r,b),o=this.diagram,null===this.animationTriggers||null===o||!o.pi||o.undoManager.isUndoingRedoing||o.animationManager.Cm||null!==(a=this.animationTriggers.get(b))&&o.animationManager.isEnabled&&!o.animationManager.isTicking&&(null===this.io&&(this.io=new Mt),g=0===o.undoManager.transactionLevel,a.startCondition===jo?g=!0:a.startCondition===Fo&&(g=!1),g?(function(a,b){null!==(a=a.tk)&&(a.duration&&(b.duration=a.duration),a.finished&&(b.finished=a.finished),a.easing&&(b.easing=a.easing))}(a,o=new xo),null!==(g=this.io.get(a))&&g.stop(),this.io.add(a,o),o.uu=this,o.Nw=a,o.add(this,b,e,n),o.start()):(io(o.animationManager,"Trigger"),o.animationManager.defaultAnimation.add(this,b,e,n))),this instanceof Eh&&t===r&&0!=(16777216&r.l)&&null!==r.data))for(e=(t=this.O.s).length,n=0;n<e;n++)(r=t[n])instanceof Eh&&Kh(r,(function(a){null!==a.data&&0!=(16777216&a.l)&&a.La(b)}))},e.js=function(a){return this.bindingId===a?this:null},e.g=function(a,b,t){this.cb(ki,a,this,b,t)},e.Ge=function(a,b,t,e){var n=this.uc;if(n.h(a,b,t,e),1!==this.Ca||0!==this.Lb){null===this.Mb&&(this.Mb=new Ze);var o=this.Mb;o.reset(),this.mo(o,a,b,t,e),o.op(n)}},e.tx=function(a,b,t){if(!1===this.pickable)return!1;var e=this.naturalBounds;return b=a.Bf(b),t?Lt(a.x,a.y,0,0,0,e.height)<=b||Lt(a.x,a.y,0,e.height,e.width,e.height)<=b||Lt(a.x,a.y,e.width,e.height,e.width,0)<=b||Lt(a.x,a.y,e.width,0,0,0)<=b:a.zd(0,0)<=b&&a.zd(0,e.height)<=b&&a.zd(e.width,0)<=b&&a.zd(e.width,e.height)<=b},e.se=function(){return!0},e.ca=function(a){var b=St.alloc();b.assign(a),this.transform.Ga(b);var t=this.actualBounds;if(!t.w())return St.free(b),!1;var e=this.diagram;if(null!==e&&e.vq){var n=e.Pl("extraTouchThreshold"),o=e.Pl("extraTouchArea"),g=o/2,r=this.naturalBounds,h=1/(e=this.Df()*e.scale);if(r.width*e<n&&r.height*e<n)return a=Qt(t.x-g*h,t.y-g*h,t.width+o*h,t.height+o*h,b.x,b.y),St.free(b),a}return n=!1,(this instanceof hc||this instanceof Ll?Qt(t.x-5,t.y-5,t.width+10,t.height+10,b.x,b.y):t.ca(b))&&(n=!(this.tb&&!this.tb.ca(b))&&(!(null===this.areaBackground||!t.ca(b))||(!(null===this.Ma||!this.ec.ca(a))||this.gh(a)))),St.free(b),n},e.gh=function(a){var b=this.naturalBounds;return Qt(0,0,b.width,b.height,a.x,a.y)},e.Re=function(a){if(0===this.angle)return this.actualBounds.Re(a);var b=this.naturalBounds;b=Ut.allocAt(0,0,b.width,b.height);var t=this.transform,e=!1,n=St.allocAt(a.x,a.y);return b.ca(t.Cd(n))&&(n.h(a.x,a.bottom),b.ca(t.Cd(n))&&(n.h(a.right,a.bottom),b.ca(t.Cd(n))&&(n.h(a.right,a.y),b.ca(t.Cd(n))&&(e=!0)))),St.free(n),Ut.free(b),e},e.fh=function(a,b){if(void 0===b)return a.Re(this.actualBounds);var t=this.naturalBounds,e=!1,n=St.allocAt(0,0);return a.ca(b.Ga(n))&&(n.h(0,t.height),a.ca(b.Ga(n))&&(n.h(t.width,t.height),a.ca(b.Ga(n))&&(n.h(t.width,0),a.ca(b.Ga(n))&&(e=!0)))),St.free(n),e},e.Yc=function(a,b){if(void 0===b&&(b=this.transform,0===this.angle))return a.Yc(this.actualBounds);var t=this.naturalBounds,e=St.allocAt(0,0),n=St.allocAt(0,t.height),o=St.allocAt(t.width,t.height),g=St.allocAt(t.width,0),r=!1;if(a.ca(b.Ga(e))||a.ca(b.Ga(n))||a.ca(b.Ga(o))||a.ca(b.Ga(g)))r=!0;else{t=Ut.allocAt(0,0,t.width,t.height);var h=St.allocAt(a.x,a.y);t.ca(b.Cd(h))?r=!0:(h.h(a.x,a.bottom),t.ca(b.Cd(h))?r=!0:(h.h(a.right,a.bottom),t.ca(b.Cd(h))?r=!0:(h.h(a.right,a.y),t.ca(b.Cd(h))&&(r=!0)))),St.free(h),Ut.free(t),!r&&($e.ts(a,e,n)||$e.ts(a,n,o)||$e.ts(a,o,g)||$e.ts(a,g,e))&&(r=!0)}return St.free(e),St.free(n),St.free(o),St.free(g),r},e.ga=function(a,b){if(void 0===b&&(b=new St),a instanceof qe){var t=this.naturalBounds;b.h(a.x*t.width+a.offsetX,a.y*t.height+a.offsetY)}else b.set(a);return this.oe.Ga(b),b},e.mi=function(a){void 0===a&&(a=new Ut);var b=this.naturalBounds,t=this.oe,e=St.allocAt(0,0).transform(t);return a.h(e.x,e.y,0,0),e.h(b.width,0).transform(t),$t(a,e.x,e.y,0,0),e.h(b.width,b.height).transform(t),$t(a,e.x,e.y,0,0),e.h(0,b.height).transform(t),$t(a,e.x,e.y,0,0),St.free(e),a},e.li=function(){var a=this.oe;return 1===a.m11&&0===a.m12?a=0:0>(a=180*Math.atan2(a.m12,a.m11)/Math.PI)&&(a+=360),a},e.Df=function(){if(0!=(4096&this.l)==!1)return this.Jk;var a=this.Ca;return null!==this.panel?a*this.panel.Df():a},e.ps=function(a,b){return void 0===b&&(b=new St),b.assign(a),this.oe.Cd(b),b},e.qs=function(a,b,t){return this.Rj(a.x,a.y,b.x,b.y,t)},e.Rj=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);return null!==this.areaBackground?(o=this.actualBounds,$e.Ff(o.left,o.top,o.right,o.bottom,a,b,t,e,n)):(g=a*r+b*l+f,a=a*h+b*c+p,b=t*r+e*l+f,t=t*h+e*c+p,n.h(0,0),e=this.naturalBounds,t=$e.Ff(0,0,e.width,e.height,g,a,b,t,n),n.transform(o),t)},qs.prototype.measure=function(a,b,t,e){if(!1!==pa(this)){var n=this.Kg,o=n.right+n.left;n=n.top+n.bottom,a=Math.max(a-o,0),b=Math.max(b-n,0),t=Math.max((t||0)-o,0),e=Math.max((e||0)-n,0),o=this.angle,n=this.desiredSize;var g=this.jq();90===o||270===o?(a=isFinite(n.height)?n.height+g:a,b=isFinite(n.width)?n.width+g:b):(a=isFinite(n.width)?n.width+g:a,b=isFinite(n.height)?n.height+g:b),n=t||0,g=e||0;var r=this instanceof Eh;switch(sa(this,!0)){case Ss:g=n=0,r&&(b=a=1/0);break;case Ms:isFinite(a)&&a>t&&(n=a),isFinite(b)&&b>e&&(g=b);break;case Ns:isFinite(a)&&a>t&&(n=a),g=0,r&&(b=1/0);break;case Cs:isFinite(b)&&b>e&&(g=b),n=0,r&&(a=1/0)}r=this.maxSize;var h=this.minSize;n>r.width&&h.width<r.width&&(n=r.width),g>r.height&&h.height<r.height&&(g=r.height),t=Math.max(n,h.width),e=Math.max(g,h.height),r.width<t&&(t=Math.min(h.width,t)),r.height<e&&(e=Math.min(h.height,e)),a=Math.min(r.width,a),b=Math.min(r.height,b),a=Math.max(t,a),b=Math.max(e,b),90!==o&&270!==o||(o=a,a=b,b=o,o=t,t=e,e=o),this.uc.ka(),this.Vl(a,b,t,e),this.uc.freeze(),this.uc.w()||T("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.uc.toString()),ga(this,!1)}},qs.prototype.Vl=function(){},qs.prototype.Dd=function(){return!1},qs.prototype.arrange=function(a,b,t,e,n){this.Tk();var o=Ut.alloc();o.assign(this.Jb),this.Jb.ka(),!1===ma(this)?this.Jb.h(a,b,t,e):this.eh(a,b,t,e),this.Jb.freeze(),this.tb=void 0===n?null:n,t=!1,void 0!==n?t=!0:(null!==(n=this.panel)&&$h(n)&&(n=n.panel),null!==n&&(n=n.ec,e=this.measuredBounds,null!==this.areaBackground&&(e=this.Jb),t=b+e.height,e=a+e.width,t=!(0<=a+.05&&e<=n.width+.05&&0<=b+.05&&t<=n.height+.05),this instanceof Yl&&(a=this.naturalBounds,this.Kq>a.height||this.Db>a.width))&&(t=!0)),this.l=t?256|this.l:-257&this.l,this.Jb.w()||T("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.Jb.toString()),this.Wl(o,this.Jb),ya(this,!1),Ut.free(o)},(e=qs.prototype).eh=function(){},e.Wl=function(a,b){var t=this.part;null!==t&&null!==t.diagram&&(t.selectionObject!==this&&t.resizeObject!==this&&t.rotateObject!==this||Qu(t,!0),this.N(),Wt(a,b)||(t.oh(),this.On(t)))},e.On=function(a){null!==this.portId&&(Qu(a,!0),a instanceof uc&&ol(a,this))},e.hc=function(a,b){if(!function(a,b,t){if(!(b instanceof Aa))return!1;if(!a.visible||0===a.opacity||a.Dd()&&!a.isVisible())return null!==a.svg&&null!==a.svg.parentNode&&a.svg.remove(),!0;var e=a.panel,n=a.mk(b);if(a.jk(b,t,n))return ta(a,a.svg),null!==a.svg.parentElement?(a.Dd()&&(b.ti=a.svg),!0):(a.Dd()?(null!==b.ti?b.ti.after(a.svg):b.Mj.prepend(a.svg),b.ti=a.svg):e&&Qs(a,e,a.svg),!0);if(a.Dd()&&a.isShadowed){var o=a.shadowOffset;b.Ev(o.x*t.scale*a.scale*t.Nb,o.y*t.scale*a.scale*t.Nb,a.shadowBlur),Ya(b),b.shadowColor=a.shadowColor}a instanceof Yl&&(b.font=a.font),b.yd=null;var g=a.transform;o=a instanceof Eh;var r=a instanceof Eh&&$h(a);0!=(4096&a.l)==!0&&oa(a);var h=a.Jb;if(b.rb.ha=[1,0,0,1,0,0],b.o=!1,n&&(b.o=!0,o&&r?(Ea(b,1,0,0,1,0,0),a.svg=b.ad):o?(Ea(b,g.m11,g.m12,g.m21,g.m22,g.dx,g.dy),a.svg=b.ad):Ea(b,1,0,0,1,0,0)),n=a.naturalBounds,null!==a.areaBackground){var l=g.copy().Uj();b.rb.ha=[l.m11,l.m12,l.m21,l.m22,l.dx,l.dy],_s(a,b,n,h),b.rb.ha=[1,0,0,1,0,0],b.yd.gd=b.ad,b.yd.prepend(b.ad)}return o||(b.rb.ha=[g.m11,g.m12,g.m21,g.m22,g.dx,g.dy]),null!==a.background&&(o?(r&&(b.rb.ha=[g.m11,g.m12,g.m21,g.m22,g.dx,g.dy]),$s(a,b,n,h),r&&(b.rb.ha=[1,0,0,1,0,0])):(b.rb.ha=[g.m11,g.m12,g.m21,g.m22,g.dx,g.dy],$s(a,b,n,h)),b.yd.Ma=b.ad,b.yd.prepend(b.ad)),g=b.yd,n=a.part,r=!1,n&&t.Gf("drawShadows")&&(r=n.isShadowed),b.clipInsteadOfFill&&(r=!1),a.Dd()&&r&&Ya(b),r&&!0===a.shadowVisible?Ya(b):r&&!1===a.shadowVisible&&ul(b),n=a.panel,r&&Zs(a,n)&&null===a.shadowVisible&&ul(b),b.Hl&&(l=t.computePixelRatio(),l="drop-shadow("+b.shadowOffsetX/l+"px "+b.shadowOffsetY/l+"px "+b.shadowBlur/l/2+"px "+b.shadowColor+")",null!==a.background&&g.Ma.setAttributeNS(null,"filter",l),null!==a.areaBackground&&g.gd.setAttributeNS(null,"filter",l)),r&&(null!==a.Ma||null!==a.areaBackground||Zs(a,n))?(la(a,!0),null===a.shadowVisible&&ul(b)):la(a,!1),n=r,a.hh(b,t),o&&b.nh.pop(),b.o&&b.nh.pop(),g=b.Gv.gs,r=o?a.svg:b.yd,l=a.svg,o||null===l||r===l||l.parentNode!==a.panel.svg?(a.svg=r,null!==g&&null===r&&(Va(b),b.nh.pop()),null===r||(a.Zo(b,e,h,r),b.Hl&&(t=t.computePixelRatio(),a.Dv(r,"drop-shadow("+b.shadowOffsetX/t+"px "+b.shadowOffsetY/t+"px "+b.shadowBlur/t/2+"px "+b.shadowColor+")")),n&&0!=(512&a.l)==!0&&Ya(b),a.Dd()&&ul(b),t=a.Dd()?a.opacity*b.globalAlpha:a.opacity,1!==t&&r.setAttributeNS(null,"opacity",t.toString()),""!==a.filter&&r.setAttributeNS(null,"filter",a.filter),a.Dd()?(b.ti?b.ti.after(r):b.Mj.prepend(r),b.ti=r):null!==e&&Qs(a,e,r),null!==g&&g(a,r),ta(a,r)),!0):(a.svg.replaceWith(r),a.svg=r,null!==r&&a.Zo(b,e,h,r),ea(b,l),!0)}(this,a,b)&&this.visible){var t=this.opacity;if(0!==t){var e=1;1!==t&&(e=a.globalAlpha,a.globalAlpha=e*t);var n="";""!==this.filter&&(n=a.filter,a.filter=this.filter);var o=this instanceof Eh&&$h(this),g=this.Jb;if(o){var r=this.Jb,h=this.ec,l=this.areaBackground,c=this.Ma;null===l&&null===c||a.yc(),null!==l&&(na(this,a,l,!0,!0,h,r),l instanceof Ha&&l.type===uh?(a.beginPath(),a.rect(r.x,r.y,r.width,r.height),a.ng(l)):a.fillRect(r.x,r.y,r.width,r.height)),null!==c&&(na(this,a,c,!0,!1,h,r),c instanceof Ha&&c.type===uh?(a.beginPath(),a.rect(r.x,r.y,r.width,r.height),a.ng(c)):a.fillRect(r.x,r.y,r.width,r.height)),this.hh(a,b)}if(!o&&(o||0!==g.width&&0!==g.height&&!isNaN(g.x)&&!isNaN(g.y))){o=this.transform,r=this.panel,0!=(4096&this.l)==!0&&oa(this),h=!1;var p,f=0;if((l=this.part)&&b.Gf("drawShadows")&&(h=l.isShadowed)&&(c=l.shadowOffset,f=Math.max(c.y,c.x)*b.scale*b.Nb),c=this.Dd(),!(p=b.$i||!c)){var d,q=this.naturalBounds,m=(p=this.wh).m11,u=p.m21,y=p.dx,v=p.m12,x=p.m22,w=p.dy,k=d=0;p=d*m+k*u+y;var M=d*v+k*x+w,S=(d=q.width+f)*m+(k=0)*u+y;d=d*v+k*x+w,k=Math.min(p,S);var P=Math.min(M,d),N=Math.max(p+0,S)-k,C=Math.max(M+0,d)-P;p=k,M=P,S=(d=q.width+f)*m+(k=q.height+f)*u+y,d=d*v+k*x+w,k=Math.min(p,S),P=Math.min(M,d),N=Math.max(p+N,S)-k,C=Math.max(M+C,d)-P,p=k,M=P,S=(d=0)*m+(k=q.height+f)*u+y,d=d*v+k*x+w,k=Math.min(p,S),P=Math.min(M,d),N=Math.max(p+N,S)-k,C=Math.max(M+C,d)-P,p=k,M=P,q=(f=b.viewportBounds).x,m=f.y,p=!(p>f.width+q||q>N+p||M>f.height+m||m>C+M)}if(p){if(p=0!=(256&this.l),a.clipInsteadOfFill&&(p=!1),this instanceof Yl&&(a.font=this.font),p){if(M=r.se()?r.naturalBounds:r.actualBounds,N=Math.max(g.x,M.x),C=Math.max(g.y,M.y),f=Math.min(g.right,M.right)-N,q=Math.min(g.bottom,M.bottom)-C,null!==(m=this.tb)&&(N=m.x,C=m.y,f=m.width,q=m.height),N>g.width+g.x||g.x>M.width+M.x)return 1!==t&&(a.globalAlpha=e),void(""!==this.filter&&(a.filter=n));a.save(),a.beginPath(),a.rect(N,C,f,q),a.clip()}if(c){if(!l.isVisible())return 1!==t&&(a.globalAlpha=e),void(""!==this.filter&&(a.filter=n));h&&(M=l.shadowOffset,a.Ev(M.x*b.scale*this.scale*b.Nb,M.y*b.scale*this.scale*b.Nb,l.shadowBlur),Ya(a),a.shadowColor=l.shadowColor)}h&&!0===this.shadowVisible?Ya(a):h&&!1===this.shadowVisible&&ul(a),l=this.naturalBounds,null!==this.areaBackground&&(a.yc(),_s(this,a,l,g)),a.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),h&&Zs(this,r)&&null===this.shadowVisible&&ul(a),null!==this.Ma&&(a.yc(),$s(this,a,l,g)),h&&(null!==this.Ma||null!==this.areaBackground||Zs(this,r))?(la(this,!0),null===this.shadowVisible&&ul(a)):la(this,!1),this.hh(a,b),h&&0!=(512&this.l)==!0&&Ya(a),c&&h&&ul(a),p&&(a.restore(),a.Vc(this instanceof Eh)),o.vs()||(b=1/(o.m11*o.m22-o.m12*o.m21),a.transform(o.m22*b,-o.m12*b,-o.m21*b,o.m11*b,b*(o.m21*o.dy-o.m22*o.dx),b*(o.m12*o.dx-o.m11*o.dy)))}}1!==t&&(a.globalAlpha=e),""!==this.filter&&(a.filter=n)}}},e.Dv=function(){},e.Zo=function(a,b,t,e){var n=0!=(256&this.l);if(a.clipInsteadOfFill&&(n=!1),n){var o=b.se()?b.naturalBounds:b.actualBounds;b=Math.max(t.x,o.x),n=Math.max(t.y,o.y);var g=Math.min(t.right,o.right)-b;t=Math.min(t.bottom,o.bottom)-n,null!==(o=this.tb)&&(b=o.x,n=o.y,g=o.width,t=o.height);var r=null;null!==(o=e.getAttribute("clip-path"))&&(r=a.svg.getElementById(o.split("#")[1].slice(0,-1))),null===r?(o="CLIP"+yt++,r=a.Ud("clipPath",{id:o}),b=a.Ud("rect",{x:b,y:n,width:g,height:t}),this instanceof Eh&&(n=this.transform.copy().Uj(),b.setAttribute("transform","matrix("+n.m11+", "+n.m12+", "+n.m21+", "+n.m22+", "+n.dx+", "+n.dy+")")),r.appendChild(b),a.svg.appendChild(r),e.setAttributeNS(null,"clip-path","url(#"+o+")")):((a=r.firstElementChild).setAttribute("x",b.toString()),a.setAttribute("y",n.toString()),a.setAttribute("width",g.toString()),a.setAttribute("height",t.toString()))}else e.removeAttributeNS(null,"clip-path"),ea(a,e)},e.hh=function(){},e.lv=function(){this.Uc=!0},e.jk=function(a,b,t){if(this.Uc)return this.lv(),this.Uc=!1;if(null===(b=this.svg))return!1;if(!this.visible)return b.remove(),!1;if("g"!==b.nodeName&&t||"g"===b.nodeName&&!t)return!1;var e=this.transform,n=this instanceof Eh&&$h(this);if(!(this instanceof Eh&&n))if(this instanceof xu){var o=this.at;a.rb.ha=[e.m11,e.m12,e.m21,e.m22,e.dx,e.dy],null!==o&&Fa(a,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]),t?b.lastElementChild.setAttributeNS(null,"transform",Oa(a)):b.setAttributeNS(null,"transform",Oa(a))}else if(!t||this instanceof Eh)b.setAttributeNS(null,"transform","matrix("+e.m11+", "+e.m12+", "+e.m21+", "+e.m22+", "+e.dx+", "+e.dy+")");else if(this instanceof Ll){o=b.getElementsByTagName("path");for(var g=0;g<o.length;g++)o[g].setAttributeNS(null,"transform","matrix("+e.m11+", "+e.m12+", "+e.m21+", "+e.m22+", "+e.dx+", "+e.dy+")")}else(b.lastElementChild||b).setAttributeNS(null,"transform","matrix("+e.m11+", "+e.m12+", "+e.m21+", "+e.m22+", "+e.dx+", "+e.dy+")");return 1===(o=this.Dd()?this.opacity*a.globalAlpha:this.opacity)?b.removeAttribute("opacity"):b.setAttributeNS(null,"opacity",o.toString()),a.rb.ha=[1,0,0,1,0,0],null===this.areaBackground&&void 0===b.gd||(o=b.gd,null===this.areaBackground?(b.gd.remove(),b.gd=void 0):(g=e.copy().Uj(),a.rb.ha=[g.m11,g.m12,g.m21,g.m22,g.dx,g.dy],_s(this,a,this.naturalBounds,this.actualBounds),a.rb.ha=[1,0,0,1,0,0],b.gd?(null!==(g=b.gd.getAttribute("filter"))&&a.ad.setAttribute("filter",g),b.gd.replaceWith(a.ad)):b.prepend(a.ad),b.gd=a.ad),o&&Ga(a,o)),null===this.background&&void 0===b.Ma||(o=b.Ma,null===this.background?(Ga(a,b.Ma),b.Ma.remove(),b.Ma=void 0):((n||t&&!(this instanceof Eh))&&(a.rb.ha=[e.m11,e.m12,e.m21,e.m22,e.dx,e.dy]),$s(this,a,this.naturalBounds,this.actualBounds),b.Ma?(Ga(a,b.Ma),null!==(t=b.Ma.getAttribute("filter"))&&a.ad.setAttribute("filter",t),b.Ma.replaceWith(a.ad)):b.prepend(a.ad),b.Ma=a.ad),o&&Ga(a,o)),this.Zo(a,this.panel,this.actualBounds,b),!0},e.mk=function(a){if(null!==this.background||null!==this.areaBackground)return!0;var b=0!=(256&this.l);return a.clipInsteadOfFill&&(b=!1),!!b},e.rg=function(a){if(a instanceof Eh)t:{if(this!==a&&null!==a)for(var b=this.panel;null!==b;){if(b===a){a=!0;break t}b=b.panel}a=!1}else a=!1;return a},e.Ed=function(){if(!this.visible)return!1;var a=this.panel;return null===a||a.Ed()},e.If=function(){for(var a=this instanceof Eh?this:this.panel;null!==a&&a.isEnabled;)a=a.panel;return null===a},e.mo=function(a,b,t,e,n){if(1!==this.Ca&&a.scale(this.Ca),0!==this.Lb){var o=St.alloc();o.yi(b,t,e,n,fe),a.rotate(this.Lb,o.x,o.y),St.free(o)}},e.v=function(a){if(!pa(this)){void 0===a&&(a=!1),ga(this,!0),ya(this,!0);var b=this.panel;null===b||a||b.v()}},e.Tj=function(){pa(this)||(ga(this,!0),ya(this,!0))},e.Tk=function(){0!=(2048&this.l)==!1&&(fa(this,!0),da(this,!0))},e.Wu=function(){da(this,!0)},e.N=function(){var a=this.part;null!==a&&a.N()},e.Fj=function(){this.svg=null},e.wi=function(a){this.Me=a,null!==this.svg&&this.svg.remove()},e.Av=function(){},e.zv=function(a){return this.pa=a,ra(this),!0},e.lm=function(a,b){this.pa.x===a&&this.pa.y===b||(this.pa.h(a,b),this.Tk())},e.jq=function(){return 0},e.bind=function(a,b,t,e){var n=null;return(n="string"==typeof a?new tp(a,b,t,e):a).xd=this,null!==(a=this.ih())&&sl(a)&&T("Cannot add a Binding to a template that has already been copied: "+n),null===this.localBindings&&(this.localBindings=new ot),this.localBindings.add(n),this},e.set=function(a){return Object.assign(this,a),this},e.Du=function(a){return wa(this,a),this},e.apply=function(a){return a(this),this},e.mm=function(a){return pr(this,a),this},e.pz=function(){return this.ih()},e.ih=function(){for(var a=this instanceof Eh?this:this.panel;null!==a;){if(null!==a.allBindings)return a;a=a.panel}return null},e.Jv=function(a){return a.xd=this,null===this.animationTriggers&&(this.animationTriggers=new Mt),this.animationTriggers.add(a.propertyName,a),this},v.Object.defineProperties(qs.prototype,{bindingId:{get:function(){return null!==this.A?this.A.yp:-1},set:function(a){this.bindingId!==a&&(null===this.A&&(this.A=new dl),this.A.yp=a)}},localBindings:{get:function(){return null!==this.A?this.A.te:null},set:function(a){this.localBindings!==a&&(null===this.A&&(this.A=new dl),this.A.te=a)}},srcBindings:{get:function(){return null!==this.A?this.A.vm:null},set:function(a){this.srcBindings!==a&&(null===this.A&&(this.A=new dl),this.A.vm=a)}},shadowVisible:{get:function(){return null!==this.A?this.A.Ci:null},set:function(a){var b=this.shadowVisible;b!==a&&(Ks(this),this.A.Ci=a,this.Uc=!0,this.N(),this.g("shadowVisible",b,a))}},enabledChanged:{get:function(){return null!==this.A?this.A.Ib:null},set:function(a){var b=this.enabledChanged;b!==a&&(Ks(this),this.A.Ib=a,this.g("enabledChanged",b,a))}},segmentOrientation:{get:function(){return null!==this.Ua?this.Ua.qr:af},set:function(a){var b=this.segmentOrientation;b!==a&&(null===this.Ua&&(this.Ua=new Pa),this.Ua.qr=a,this.v(),this.g("segmentOrientation",b,a),a===af&&(this.angle=0))}},segmentIndex:{get:function(){return null!==this.Ua?this.Ua.u:-1/0},set:function(a){a=Math.round(a);var b=this.segmentIndex;b!==a&&(null===this.Ua&&(this.Ua=new Pa),this.Ua.u=a,this.v(),this.g("segmentIndex",b,a))}},segmentFraction:{get:function(){return null!==this.Ua?this.Ua.o:0},set:function(a){isNaN(a)||0>a?a=0:1<a&&(a=1);var b=this.segmentFraction;b!==a&&(null===this.Ua&&(this.Ua=new Pa),this.Ua.o=a,this.v(),this.g("segmentFraction",b,a))}},segmentOffset:{get:function(){return null!==this.Ua?this.Ua.F:ct},set:function(a){var b=this.segmentOffset;b.D(a)||(a=a.J(),null===this.Ua&&(this.Ua=new Pa),this.Ua.F=a,this.v(),this.g("segmentOffset",b,a))}},stretch:{get:function(){return null!==this.A?this.A.hg:Ts},set:function(a){var b=this.stretch;b!==a&&(Ks(this),this.A.hg=a,this.v(),this.g("stretch",b,a))}},name:{get:function(){return null!==this.A?this.A.xa:""},set:function(a){var b=this.name;b!==a&&(Ks(this),this.A.xa=a,null!==this.part&&(this.part.Rh=null),this.g("name",b,a))}},opacity:{get:function(){return this.pb},set:function(a){var b=this.pb;b!==a&&((0>a||1<a)&&A(a,"0 <= value <= 1",qs,"opacity"),this.pb=a,this.g("opacity",b,a),a=this.diagram,b=this.part,null!==a&&null!==b&&a.N(Uu(b,b.actualBounds)))}},filter:{get:function(){return this.an},set:function(a){var b=this.an;b!==a&&(this.an=a,this.Uc=!0,this.g("filter",b,a),a=this.diagram,b=this.part,null!==a&&null!==b&&a.N(Uu(b,b.actualBounds)))}},visible:{get:function(){return 0!=(1&this.l)},set:function(a){var b=0!=(1&this.l);b!==a&&(this.l^=1,this.g("visible",b,a),null!==(b=this.panel)?b.v():this.Dd()&&this.$b(a),this.N(),xa(this))}},pickable:{get:function(){return 0!=(2&this.l)},set:function(a){var b=0!=(2&this.l);b!==a&&(this.l^=2,this.g("pickable",b,a))}},fromLinkableDuplicates:{get:function(){return 0!=(4&this.l)},set:function(a){var b=0!=(4&this.l);b!==a&&(this.l^=4,this.g("fromLinkableDuplicates",b,a))}},fromLinkableSelfNode:{get:function(){return 0!=(8&this.l)},set:function(a){var b=0!=(8&this.l);b!==a&&(this.l^=8,this.g("fromLinkableSelfNode",b,a))}},toLinkableDuplicates:{get:function(){return 0!=(16&this.l)},set:function(a){var b=0!=(16&this.l);b!==a&&(this.l^=16,this.g("toLinkableDuplicates",b,a))}},toLinkableSelfNode:{get:function(){return 0!=(32&this.l)},set:function(a){var b=0!=(32&this.l);b!==a&&(this.l^=32,this.g("toLinkableSelfNode",b,a))}},isPanelMain:{get:function(){return 0!=(64&this.l)},set:function(a){var b=0!=(64&this.l);b!==a&&(this.l^=64,this.v(),this.g("isPanelMain",b,a))}},isActionable:{get:function(){return 0!=(128&this.l)},set:function(a){var b=0!=(128&this.l);b!==a&&(this.l^=128,this.g("isActionable",b,a))}},areaBackground:{get:function(){return null!==this.A?this.A.gd:null},set:function(a){var b=this.areaBackground;b!==a&&(null!==a&&sh(a,"GraphObject.areaBackground"),a instanceof Ha&&a.freeze(),Ks(this),this.A.gd=a,this.N(),this.g("areaBackground",b,a))}},background:{get:function(){return this.Ma},set:function(a){var b=this.Ma;b!==a&&(null!==a&&sh(a,"GraphObject.background"),a instanceof Ha&&a.freeze(),this.Ma=a,this.N(),this.g("background",b,a))}},part:{get:function(){if(this.Dd())return this;if(null!==this.Ng)return this.Ng;var a;for(a=this.panel;a;){if(a instanceof zu)return this.Ng=a;a=a.panel}return null}},svg:{get:function(){return this.V},set:function(a){this.V=a}},panel:{get:function(){return this.Me}},layer:{get:function(){var a=this.part;return null!==a?a.layer:null}},diagram:{get:function(){var a=this.part;return null!==a?a.diagram:null}},position:{get:function(){return this.pa},set:function(a){var b=a.x,t=a.y,e=this.pa,n=e.x;e=e.y,(n===b||isNaN(n)&&isNaN(b))&&(e===t||isNaN(e)&&isNaN(t))?this.Av():(a=a.copy(),this.zv(a,n,e)&&this.g("position",new St(n,e),a))}},actualBounds:{get:function(){return this.Jb}},scale:{get:function(){return this.Ca},set:function(a){var b=this.Ca;b!==a&&(0>=a&&T("GraphObject.scale for "+this+" must be greater than zero, not: "+a),this.Ca=a,this.v(),this.g("scale",b,a))}},angle:{get:function(){return this.Lb},set:function(a){var b=this.Lb;b!==a&&(0>(a%=360)&&(a+=360),b!==a&&(this.Lb=a,xa(this),this.v(),this.g("angle",b,a)))}},desiredSize:{get:function(){return this.jd},set:function(a){var b=a.width,t=a.height,e=this.jd,n=e.width,o=e.height;(n===b||isNaN(n)&&isNaN(b))&&(o===t||isNaN(o)&&isNaN(t))||(this.jd=a=a.J(),this.v(),this instanceof Ll&&this.rc(),this.g("desiredSize",e,a),ua(this)&&(null!==(a=this.part)&&(Hs(this,a,"width"),Hs(this,a,"height"))))}},width:{get:function(){return this.jd.width},set:function(a){var b=this.jd.width;b===a||isNaN(b)&&isNaN(a)||(b=this.jd,this.jd=a=new Vt(a,this.jd.height).freeze(),this.v(),this instanceof Ll&&this.rc(),this.g("desiredSize",b,a),ua(this)&&(null!==(a=this.part)&&Hs(this,a,"width")))}},height:{get:function(){return this.jd.height},set:function(a){var b=this.jd.height;b===a||isNaN(b)&&isNaN(a)||(b=this.jd,this.jd=a=new Vt(this.jd.width,a).freeze(),this.v(),this instanceof Ll&&this.rc(),this.g("desiredSize",b,a),ua(this)&&(null!==(a=this.part)&&Hs(this,a,"height")))}},minSize:{get:function(){return null!==this.A?this.A.u:Ft},set:function(a){var b=this.minSize;b.D(a)||(a=a.copy(),isNaN(a.width)&&(a.width=0),isNaN(a.height)&&(a.height=0),a.freeze(),Ks(this),this.A.u=a,this.v(),this.g("minSize",b,a))}},maxSize:{get:function(){return null!==this.A?this.A.o:zt},set:function(a){var b=this.maxSize;b.D(a)||(a=a.copy(),isNaN(a.width)&&(a.width=1/0),isNaN(a.height)&&(a.height=1/0),a.freeze(),Ks(this),this.A.o=a,this.v(),this.g("maxSize",b,a))}},measuredBounds:{get:function(){return this.uc}},naturalBounds:{get:function(){return this.ec}},margin:{get:function(){return this.Kg},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.Kg;b.D(a)||(this.Kg=a=a.J(),this.v(),this.g("margin",b,a))}},transform:{get:function(){return 0!=(2048&this.l)==!0&&oa(this),this.Bb}},oe:{get:function(){return 0!=(4096&this.l)==!0&&oa(this),this.wh}},animationTriggers:{get:function(){return null!==this.A?this.A.hb:null},set:function(a){this.animationTriggers!==a&&(Ks(this),this.A.hb=a)}},reshapingBehavior:{get:function(){return null!==this.A?this.A.Pf:Ss},set:function(a){this.reshapingBehavior!==a&&(Ks(this),this.A.Pf=a)}},alignment:{get:function(){return this.Kb},set:function(a){var b=this.Kb;b.D(a)||(a.Mc()&&!a.Yb()&&T("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+a),this.Kb=a=a.J(),ra(this),this.g("alignment",b,a))}},column:{get:function(){return this.Ag},set:function(a){a=Math.round(a);var b=this.Ag;b!==a&&(0>a&&A(a,">= 0",qs,"column"),this.Ag=a,this.v(),this.g("column",b,a),null!==this.svg&&this.svg.remove())}},columnSpan:{get:function(){return null!==this.A?this.A.ob:1},set:function(a){a=Math.round(a);var b=this.columnSpan;b!==a&&(1>a&&A(a,">= 1",qs,"columnSpan"),Ks(this),this.A.ob=a,this.v(),this.g("columnSpan",b,a))}},row:{get:function(){return this.ho},set:function(a){a=Math.round(a);var b=this.ho;b!==a&&(0>a&&A(a,">= 0",qs,"row"),this.ho=a,this.v(),this.g("row",b,a),null!==this.svg&&this.svg.remove())}},rowSpan:{get:function(){return null!==this.A?this.A.Bi:1},set:function(a){a=Math.round(a);var b=this.rowSpan;b!==a&&(1>a&&A(a,">= 1",qs,"rowSpan"),Ks(this),this.A.Bi=a,this.v(),this.g("rowSpan",b,a))}},spanAllocation:{get:function(){return null!==this.A?this.A.Di:null},set:function(a){var b=this.spanAllocation;b!==a&&(Ks(this),this.A.Di=a,this.v(),this.g("spanAllocation",b,a))}},alignmentFocus:{get:function(){return this.rk},set:function(a){var b=this.rk;b.D(a)||(this.rk=a=a.J(),this.v(),this.g("alignmentFocus",b,a))}},portId:{get:function(){return this.Xn},set:function(a){var b=this.Xn;if(b!==a){var t=this.part;null===t||t instanceof uc||T("Cannot set portID on a Link: "+a),null!==b&&null!==t&&xc(t,this),this.Xn=a,null!==a&&null!==t&&(t.Te=!0,em(t,this)),this.g("portId",b,a)}}},toSpot:{get:function(){return null!==this.ba?this.ba.yj:ae},set:function(a){var b=this.toSpot;b.D(a)||(a=a.J(),this.Xc(),this.ba.yj=a,this.g("toSpot",b,a),va(this))}},toEndSegmentLength:{get:function(){return null!==this.ba?this.ba.wj:10},set:function(a){var b=this.toEndSegmentLength;b!==a&&(0>a&&A(a,">= 0",qs,"toEndSegmentLength"),this.Xc(),this.ba.wj=a,this.g("toEndSegmentLength",b,a),va(this))}},toShortLength:{get:function(){return null!==this.ba?this.ba.xj:0},set:function(a){var b=this.toShortLength;b!==a&&(this.Xc(),this.ba.xj=a,this.g("toShortLength",b,a),va(this))}},toLinkable:{get:function(){return null!==this.ba?this.ba.Sr:null},set:function(a){var b=this.toLinkable;b!==a&&(this.Xc(),this.ba.Sr=a,this.g("toLinkable",b,a))}},toMaxLinks:{get:function(){return null!==this.ba?this.ba.Tr:1/0},set:function(a){var b=this.toMaxLinks;b!==a&&(0>a&&A(a,">= 0",qs,"toMaxLinks"),this.Xc(),this.ba.Tr=a,this.g("toMaxLinks",b,a))}},fromSpot:{get:function(){return null!==this.ba?this.ba.Xi:ae},set:function(a){var b=this.fromSpot;b.D(a)||(a=a.J(),this.Xc(),this.ba.Xi=a,this.g("fromSpot",b,a),va(this))}},fromEndSegmentLength:{get:function(){return null!==this.ba?this.ba.Vi:10},set:function(a){var b=this.fromEndSegmentLength;b!==a&&(0>a&&A(a,">= 0",qs,"fromEndSegmentLength"),this.Xc(),this.ba.Vi=a,this.g("fromEndSegmentLength",b,a),va(this))}},fromShortLength:{get:function(){return null!==this.ba?this.ba.Wi:0},set:function(a){var b=this.fromShortLength;b!==a&&(this.Xc(),this.ba.Wi=a,this.g("fromShortLength",b,a),va(this))}},fromLinkable:{get:function(){return null!==this.ba?this.ba.gq:null},set:function(a){var b=this.fromLinkable;b!==a&&(this.Xc(),this.ba.gq=a,this.g("fromLinkable",b,a))}},fromMaxLinks:{get:function(){return null!==this.ba?this.ba.hq:1/0},set:function(a){var b=this.fromMaxLinks;b!==a&&(0>a&&A(a,">= 0",qs,"fromMaxLinks"),this.Xc(),this.ba.hq=a,this.g("fromMaxLinks",b,a))}},cursor:{get:function(){return null!==this.A?this.A.j:""},set:function(a){var b=this.cursor;b!==a&&(Ks(this),this.A.j=a,this.g("cursor",b,a))}},click:{get:function(){return null!==this.A?this.A.zh:null},set:function(a){var b=this.click;b!==a&&(Ks(this),this.A.zh=a,this.g("click",b,a))}},doubleClick:{get:function(){return null!==this.A?this.A.Fh:null},set:function(a){var b=this.doubleClick;b!==a&&(Ks(this),this.A.Fh=a,this.g("doubleClick",b,a))}},contextClick:{get:function(){return null!==this.A?this.A.Bh:null},set:function(a){var b=this.contextClick;b!==a&&(Ks(this),this.A.Bh=a,this.g("contextClick",b,a))}},mouseEnter:{get:function(){return null!==this.A?this.A.Mh:null},set:function(a){var b=this.mouseEnter;b!==a&&(Ks(this),this.A.Mh=a,this.g("mouseEnter",b,a))}},mouseLeave:{get:function(){return null!==this.A?this.A.Ph:null},set:function(a){var b=this.mouseLeave;b!==a&&(Ks(this),this.A.Ph=a,this.g("mouseLeave",b,a))}},mouseOver:{get:function(){return null!==this.A?this.A.Qh:null},set:function(a){var b=this.mouseOver;b!==a&&(Ks(this),this.A.Qh=a,this.g("mouseOver",b,a))}},mouseHover:{get:function(){return null!==this.A?this.A.Oh:null},set:function(a){var b=this.mouseHover;b!==a&&(Ks(this),this.A.Oh=a,this.g("mouseHover",b,a))}},mouseHold:{get:function(){return null!==this.A?this.A.Nh:null},set:function(a){var b=this.mouseHold;b!==a&&(Ks(this),this.A.Nh=a,this.g("mouseHold",b,a))}},mouseDragEnter:{get:function(){return null!==this.A?this.A.Of:null},set:function(a){var b=this.mouseDragEnter;b!==a&&(Ks(this),this.A.Of=a,this.g("mouseDragEnter",b,a))}},mouseDragLeave:{get:function(){return null!==this.A?this.A.Xd:null},set:function(a){var b=this.mouseDragLeave;b!==a&&(Ks(this),this.A.Xd=a,this.g("mouseDragLeave",b,a))}},mouseDrop:{get:function(){return null!==this.A?this.A.Lh:null},set:function(a){var b=this.mouseDrop;b!==a&&(Ks(this),this.A.Lh=a,this.g("mouseDrop",b,a))}},actionDown:{get:function(){return null!==this.A?this.A.V:null},set:function(a){var b=this.actionDown;b!==a&&(Ks(this),this.A.V=a,this.g("actionDown",b,a))}},actionMove:{get:function(){return null!==this.A?this.A.ia:null},set:function(a){var b=this.actionMove;b!==a&&(Ks(this),this.A.ia=a,this.g("actionMove",b,a))}},actionUp:{get:function(){return null!==this.A?this.A.Ha:null},set:function(a){var b=this.actionUp;b!==a&&(Ks(this),this.A.Ha=a,this.g("actionUp",b,a))}},actionCancel:{get:function(){return null!==this.A?this.A.F:null},set:function(a){var b=this.actionCancel;b!==a&&(Ks(this),this.A.F=a,this.g("actionCancel",b,a))}},toolTip:{get:function(){return null!==this.A?this.A.$h:null},set:function(a){var b=this.toolTip;b!==a&&(Ks(this),this.A.$h=a,this.g("toolTip",b,a))}},contextMenu:{get:function(){return null!==this.A?this.A.Ch:null},set:function(a){var b=this.contextMenu;b!==a&&(Ks(this),this.A.Ch=a,this.g("contextMenu",b,a))}}}),qs.prototype.trigger=qs.prototype.Jv,qs.prototype.findBindingPanel=qs.prototype.ih,qs.prototype.findTemplateBinder=qs.prototype.pz,qs.prototype.setProperties=qs.prototype.mm,qs.prototype.apply=qs.prototype.apply,qs.prototype.attach=qs.prototype.Du,qs.prototype.set=qs.prototype.set,qs.prototype.isEnabledObject=qs.prototype.If,qs.prototype.isVisibleObject=qs.prototype.Ed,qs.prototype.isContainedBy=qs.prototype.rg,qs.prototype.getNearestIntersectionPoint=qs.prototype.qs,qs.prototype.getLocalPoint=qs.prototype.ps,qs.prototype.getDocumentScale=qs.prototype.Df,qs.prototype.getDocumentAngle=qs.prototype.li,qs.prototype.getDocumentBounds=qs.prototype.mi,qs.prototype.getDocumentPoint=qs.prototype.ga,qs.prototype.intersectsRect=qs.prototype.Yc,qs.prototype.containedInRect=qs.prototype.fh,qs.prototype.containsRect=qs.prototype.Re,qs.prototype.containsPoint=qs.prototype.ca,qs.prototype.raiseChanged=qs.prototype.g,qs.prototype.raiseChangedEvent=qs.prototype.cb,qs.prototype.addCopyProperty=qs.prototype.Vw;var Sa=null;function dl(){this.oc=!1,this.xa="",this.yp=-1,this.nb=this.vm=this.te=null,this.j="",this.hb=this.Di=this.Ib=this.Ch=this.$h=this.F=this.Ha=this.ia=this.V=this.Lh=this.Xd=this.Of=this.Nh=this.Oh=this.Qh=this.Ph=this.Mh=this.Bh=this.Fh=this.zh=null,this.u=Ft,this.o=zt,this.hg=Ts,this.ob=this.Bi=1,this.Pf=Ss,this.Pc=this.Ci=this.gd=null,this.Oc="category"}function Pa(){this.u=-1/0,this.o=0,this.F=ct,this.qr=af,this.j=this.V="None"}function Na(){this.yj=this.Xi=Fe,this.xj=this.Wi=this.wj=this.Vi=NaN,this.Sr=this.gq=null,this.Tr=this.hq=1/0}function Ca(){this.ha=[1,0,0,1,0,0]}function Ta(a){this.type=a,this.r2=this.y2=this.x2=this.r1=this.y1=this.x1=0,this.gx=[],this.pattern=null}function La(a,b,t){this.ownerDocument=a=void 0===b?M.document:b,this.cA="http://www.w3.org/2000/svg",void 0!==a&&(this.Oa=this.Ud("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.style.display="block",this.style.letterSpacing="normal",this.style.wordSpacing="normal",this.Oa.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),this.Oa.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")),this.gs=null,this.context=new Aa(this,t)}function Aa(a,b){this.Gv=a,this.svg=a.Oa,this.stack=[],this.nh=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetY=this.shadowOffsetX=0,this.Hl=!1,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.Vg=this.Ar=this.zr=0,this.yd=this.ad=null,this.path=[],this.Xl={},this.Bt=!1,this.Yg=null,this.uj=0,this.rb=new Ca,this.j=Va(this),this.Mj=Va(this,"gojs-diagram"),this.Gl=this.ti=null;var t=yt++,e=this.Ud("clipPath",{id:"mainClip"+t});e.appendChild(this.Ud("rect",{x:0,y:0,width:a.width,height:a.height})),this.ww=e,this.svg.appendChild(this.j),this.j.appendChild(this.Mj),this.svg.appendChild(e),this.j.setAttributeNS(null,"clip-path","url(#mainClip"+t+")"),this.eA={},this.isTemporary=!!b,this.filter="",this.ak=null}function ja(a,b,t,e,n,o,g){void 0===a.Mj?Ea(a,b,t,e,n,o,g):a.Mj.setAttribute("transform","matrix("+b+", "+t+", "+e+", "+n+", "+o+", "+g+")")}function Fa(a,b,t,e,n,o,g,r,h){e=r/e,n=h/n,0===o&&0===g||a.rb.translate(o,g),1===e&&1===n||a.rb.scale(e,n),0===b&&0===t||a.rb.translate(-b,-t)}function Oa(a){return"matrix("+(a=a.rb.ha)[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function Ba(a,b,t,e){"fill"===b?Da(a,t):"stroke"===b&&za(a,t),null!==e&&(a=e.ha,t.transform="matrix("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")")}function Da(a,b){a.fillStyle instanceof Ta?b.fill=Ra(a,a.fillStyle,!0):/^rgba\(/.test(a.fillStyle)?(a=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.fillStyle),b.fill="rgb("+a[1]+","+a[2]+","+a[3]+")",b["fill-opacity"]=a[4]):b.fill=a.fillStyle}function Ia(a,b,t){t=t?"fill":"stroke",a.fillStyle instanceof Ta?b.setAttributeNS(null,"fill",Ra(a,a.fillStyle,!0)):/^rgba\(/.test(a.fillStyle)?(a=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.fillStyle),b.setAttributeNS(null,t,"rgb("+a[1]+","+a[2]+","+a[3]+")"),b.setAttributeNS(null,t+"-opacity",a[4])):b.setAttributeNS(null,t,a.fillStyle)}function za(a,b){if(a.strokeStyle instanceof Ta)b.stroke=Ra(a,a.strokeStyle,!1);else if(/^rgba\(/.test(a.strokeStyle)){var t=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(a.strokeStyle);b.stroke="rgb("+t[1]+","+t[2]+","+t[3]+")",b["stroke-opacity"]=t[4]}else b.stroke=a.strokeStyle;b["stroke-width"]=a.lineWidth,b["stroke-linecap"]=a.lineCap,b["stroke-linejoin"]=a.lineJoin,b["stroke-miterlimit"]=a.miterLimit,a.Bt&&(b["stroke-dasharray"]=a.Yg.toString(),b["stroke-dashoffset"]=a.uj)}function Ra(a,b,t){var e="";if(null!==(e=null!==a.Gl?a.Gl.getAttribute(t?"fill":"stroke"):null)&&-1!==e.indexOf("GRAD")?(e=e.split("#")[1].slice(0,-1),null!==(t=a.svg.getElementById(e))&&t.remove()):e="GRAD"+yt++,"linear"===b.type)t=a.Ud("linearGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,id:e,gradientUnits:"userSpaceOnUse"});else{if("radial"!==b.type)throw Error("invalid gradient");t=a.Ud("radialGradient",{x1:b.x1,x2:b.x2,y1:b.y1,y2:b.y2,r1:b.r1,r2:b.r2,id:e})}var n=b.gx;b=n.length;for(var o=[],g=0;g<b;g++){var r=n[g],h=r.color;r={offset:r.offset,"stop-color":h},/^rgba\(/.test(h)&&(h=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(h),r["stop-color"]="rgb("+h[1]+","+h[2]+","+h[3]+")",r["stop-opacity"]=h[4]),o.push(r)}for(o.sort((function(a,b){return a.offset>b.offset?1:-1})),n=0;n<b;n++)t.appendChild(a.Ud("stop",o[n]));return a.svg.appendChild(t),"url(#"+e+")"}function Ea(a,b,t,e,n,o,g){var r=new Ca;r.ha=[b,t,e,n,o,g],Ba(a,"g",b={},r),r=a.addElement("g",b),a.nh.push(r)}function Va(a,b){var t={};return b&&(t.class=b),b=a.addElement("g",t),a.nh.push(b),b}function ul(a){a.Hl=!1,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0}function Ya(a){a.Hl=!0,a.shadowOffsetX=a.zr,a.shadowOffsetY=a.Ar,a.shadowBlur=a.Vg}function Ga(a,b){null!==(b=b.getAttribute("fill"))&&(1!==(b=b.split("#")).length&&(null!==(b=a.svg.getElementById(b[1].slice(0,-1)))&&1===a.svg.innerHTML.match(new RegExp(b.id,"g")).length&&b.remove()))}function Xa(a,b,t,e){this.ownerDocument=b=void 0===b?M.document:b,this.gs=null,(b=b.createElement("canvas")).tabIndex=0,this.Oa=b,this.context=new Ua(b,t,e),b.H=a}function Ua(a,b,t){this.Z=a.getContext?a.getContext("2d",b):null,null===this.Z&&T("Browser does not support HTML Canvas Element"),this.bt=this.dt=this.ct="",this.Gm=!1,this.Vg=this.Ar=this.zr=0,this.Hl=!1,this.Dl=new Ze,this.isTemporary=!!t}qs.className="GraphObject",Sa=new Mt,ka("Button",(function(){function a(a,b){return null!==a.diagram.jc(a.documentPoint,(function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a}),(function(a){return a===b}))}var b=ba(Eh,Eh.Auto,{isActionable:!0,enabledChanged:function(a,b){if(a instanceof Eh){var t=a.fb("ButtonBorder");null!==t&&(t.fill=b?a._buttonFillNormal:a._buttonFillDisabled)}},cursor:"pointer",_buttonFillNormal:"#F5F5F5",_buttonStrokeNormal:"#BDBDBD",_buttonFillOver:"#E0E0E0",_buttonStrokeOver:"#9E9E9E",_buttonFillPressed:"#BDBDBD",_buttonStrokePressed:"#9E9E9E",_buttonFillDisabled:"#E5E5E5"},ba(Ll,{name:"ButtonBorder",figure:"RoundedRectangle",spot1:new qe(0,0,2.76142374915397,2.761423749153969),spot2:new qe(1,1,-2.76142374915397,-2.761423749153969),parameter1:2,parameter2:2,fill:"#F5F5F5",stroke:"#BDBDBD"}));return b.mouseEnter=function(a,b){if(b.If()&&b instanceof Eh&&(a=b.fb("ButtonBorder"))instanceof Ll){var t=b._buttonFillOver;b._buttonFillNormal=a.fill,a.fill=t,t=b._buttonStrokeOver,b._buttonStrokeNormal=a.stroke,a.stroke=t}},b.mouseLeave=function(a,b){b.If()&&b instanceof Eh&&((a=b.fb("ButtonBorder"))instanceof Ll&&(a.fill=b._buttonFillNormal,a.stroke=b._buttonStrokeNormal))},b.actionDown=function(a,b){if(b.If()&&b instanceof Eh&&null!==b._buttonFillPressed&&0===a.button){var t=b.fb("ButtonBorder");if(t instanceof Ll){var e=(a=a.diagram).skipsUndoManager;a.skipsUndoManager=!0;var g=b._buttonFillPressed;b._buttonFillOver=t.fill,t.fill=g,g=b._buttonStrokePressed,b._buttonStrokeOver=t.stroke,t.stroke=g,a.skipsUndoManager=e}}},b.actionUp=function(b,t){if(t.If()&&t instanceof Eh&&null!==t._buttonFillPressed&&0===b.button){var e=t.fb("ButtonBorder");if(e instanceof Ll){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionCancel=function(b,t){if(t.If()&&t instanceof Eh&&null!==t._buttonFillPressed){var e=t.fb("ButtonBorder");if(e instanceof Ll){var n=b.diagram,g=n.skipsUndoManager;n.skipsUndoManager=!0,a(b,t)?(e.fill=t._buttonFillOver,e.stroke=t._buttonStrokeOver):(e.fill=t._buttonFillNormal,e.stroke=t._buttonStrokeNormal),n.skipsUndoManager=g}}},b.actionMove=function(b,t){if(t.If()&&t instanceof Eh&&null!==t._buttonFillPressed){var e=b.diagram;if(0===e.firstInput.button&&(e.currentTool.standardMouseOver(),a(b,t)&&(b=t.fb("ButtonBorder"))instanceof Ll)){var n=e.skipsUndoManager;e.skipsUndoManager=!0;var g=t._buttonFillPressed;b.fill!==g&&(b.fill=g),g=t._buttonStrokePressed,b.stroke!==g&&(b.stroke=g),e.skipsUndoManager=n}}},b})),ka("TreeExpanderButton",(function(){var a=ba("Button",{_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine"},ba(Ll,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:Dt},new tp("figure","isTreeExpanded",(function(a,t){return t=t.panel,a?t._treeExpandedFigure:t._treeCollapsedFigure})).bp()),{visible:!1},new tp("visible","isTreeLeaf",(function(a){return!a})).bp());return a.click=function(a,t){if((t=t.part)instanceof hc&&(t=t.adornedPart),t instanceof uc){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isTreeExpanded){if(!b.canCollapseTree(t))return}else if(!b.canExpandTree(t))return;a.handled=!0,t.isTreeExpanded?b.collapseTree(t):b.expandTree(t)}}},a})),ka("SubGraphExpanderButton",(function(){var a=ba("Button",{_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"},ba(Ll,{name:"ButtonIcon",figure:"MinusLine",stroke:"#424242",strokeWidth:2,desiredSize:Dt},new tp("figure","isSubGraphExpanded",(function(a,t){return t=t.panel,a?t._subGraphExpandedFigure:t._subGraphCollapsedFigure})).bp()));return a.click=function(a,t){if((t=t.part)instanceof hc&&(t=t.adornedPart),t instanceof Cc){var b=t.diagram;if(null!==b){if(b=b.commandHandler,t.isSubGraphExpanded){if(!b.canCollapseSubGraph(t))return}else if(!b.canExpandSubGraph(t))return;a.handled=!0,t.isSubGraphExpanded?b.collapseSubGraph(t):b.expandSubGraph(t)}}},a})),ka("ToolTip",(function(){return ba(hc,Eh.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new St(0,3),shadowBlur:5},ba(Ll,{name:"Border",figure:"RoundedRectangle",parameter1:1,parameter2:1,fill:"#F5F5F5",stroke:"#F0F0F0",spot1:new qe(0,0,4,6),spot2:new qe(1,1,-4,-4)}))})),ka("ContextMenu",(function(){return ba(hc,Eh.Vertical,{background:"#F5F5F5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new St(0,3),shadowBlur:5},new tp("background","",(function(a){return null!==a.adornedPart&&null!==a.placeholder?null:"#F5F5F5"})))})),ka("ContextMenuButton",(function(){var a=ba("Button");a.stretch=Ns;var b=a.fb("ButtonBorder");return b instanceof Ll&&(b.figure="Rectangle",b.strokeWidth=0,b.spot1=new qe(0,0,2,3),b.spot2=new qe(1,1,-2,-2)),a})),ka("PanelExpanderButton",(function(a){var b=Ma(a,"COLLAPSIBLE"),t=ba("Button",{_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8",_buttonFillNormal:"rgba(0, 0, 0, 0)",_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null,_buttonFillPressed:"rgba(0, 0, 0, .4)",_buttonStrokePressed:null},ba(Ll,{name:"ButtonIcon",strokeWidth:2},new tp("geometryString","visible",(function(a){return a?t._buttonExpandedFigure:t._buttonCollapsedFigure})).bp(b)));return(a=t.fb("ButtonBorder"))instanceof Ll&&(a.stroke=null,a.fill="rgba(0, 0, 0, 0)"),t.click=function(a,t){var e=t.diagram;if(null!==e&&!e.isReadOnly){var n=t.ih();null===n&&(n=t.part),null!==n&&(null!==(t=n.fb(b))&&(a.handled=!0,e.Ea("Collapse/Expand Panel"),t.visible=!t.visible,e.eb("Collapse/Expand Panel")))}},t})),ka("CheckBoxButton",(function(a){var b=Ma(a);return(a=ba("Button",{desiredSize:new Vt(14,14)},ba(Ll,{name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:Ms,geometryStretch:Ps,visible:!1},""!==b?new tp("visible",b).Kx():[]))).click=function(a,t){if(t instanceof Eh){var e=a.diagram;if(!(null===e||e.isReadOnly||""!==b&&e.model.isReadOnly)){a.handled=!0;var n=t.fb("ButtonIcon");e.Ea("checkbox"),n.visible=!n.visible,"function"==typeof t._doClick&&t._doClick(a,t),e.eb("checkbox")}}},a})),ka("CheckBox",(function(a){a=ba("CheckBoxButton",a=Ma(a),{name:"Button",isActionable:!1,margin:new oe(0,1,0,0)});var b=ba(Eh,"Horizontal",a,{isActionable:!0,cursor:a.cursor,margin:new oe(1),_buttonFillNormal:a._buttonFillNormal,_buttonStrokeNormal:a._buttonStrokeNormal,_buttonFillOver:a._buttonFillOver,_buttonStrokeOver:a._buttonStrokeOver,_buttonFillPressed:a._buttonFillPressed,_buttonStrokePressed:a._buttonStrokePressed,_buttonFillDisabled:a._buttonFillDisabled,mouseEnter:a.mouseEnter,mouseLeave:a.mouseLeave,actionDown:a.actionDown,actionUp:a.actionUp,actionCancel:a.actionCancel,actionMove:a.actionMove,click:a.click,_buttonClick:a.click});return a.mouseEnter=null,a.mouseLeave=null,a.actionDown=null,a.actionUp=null,a.actionCancel=null,a.actionMove=null,a.click=null,b})),qs.None=Ss=new W(qs,"None",0),qs.Default=Ts=new W(qs,"Default",0),qs.Vertical=Cs=new W(qs,"Vertical",4),qs.Horizontal=Ns=new W(qs,"Horizontal",5),qs.Fill=Ms=new W(qs,"Fill",3),qs.Uniform=Ps=new W(qs,"Uniform",1),qs.UniformToFill=Ls=new W(qs,"UniformToFill",2),qs.FlipVertical=As=new W(qs,"FlipVertical",1),qs.FlipHorizontal=js=new W(qs,"FlipHorizontal",2),qs.FlipBoth=Fs=new W(qs,"FlipBoth",3),qs.make=ba,qs.getBuilders=function(){var b,a=new Mt;for(b in Sa)if(b!==b.toLowerCase()){var t=Sa.I(b);"function"==typeof t&&a.add(b,t)}return a.freeze(),a},qs.defineBuilder=ka,qs.build=function(a,b,t){for(var e=[],n=2;n<arguments.length;++n)e[n-2]=arguments[n];if("function"==typeof(n=Sa.I(a))&&(e=n([a].concat(e)))instanceof qs)return b&&e.set(b),e;T('GraphObject.build invoked object builder "'+a+'", but it did not return an Object')},qs.takeBuilderArgument=Ma,dl.prototype.copy=function(){var a=new dl;return a.xa=this.xa,a.yp=this.yp,a.te=this.te,a.nb=this.nb,a.j=this.j,a.zh=this.zh,a.Fh=this.Fh,a.Bh=this.Bh,a.Mh=this.Mh,a.Ph=this.Ph,a.Qh=this.Qh,a.Oh=this.Oh,a.Nh=this.Nh,a.Of=this.Of,a.Xd=this.Xd,a.Lh=this.Lh,a.V=this.V,a.ia=this.ia,a.Ha=this.Ha,a.F=this.F,a.$h=this.$h,a.Ch=this.Ch,a.Ib=this.Ib,a.Di=this.Di,a.hb=this.hb,a.u=this.u.J(),a.o=this.o.J(),a.hg=this.hg,a.Bi=this.Bi,a.ob=this.ob,a.Pf=this.Pf,a.gd=this.gd,a.Ci=this.Ci,a.Pc=this.Pc,a.Oc=this.Oc,a},Pa.prototype.copy=function(){var a=new Pa;return a.u=this.u,a.o=this.o,a.F=this.F.J(),a.qr=this.qr,a.V=this.V,a.j=this.j,a},Pa.className="LinkElementSettings",Na.prototype.copy=function(){var a=new Na;return a.Xi=this.Xi.J(),a.yj=this.yj.J(),a.Vi=this.Vi,a.wj=this.wj,a.Wi=this.Wi,a.xj=this.xj,a.gq=this.gq,a.Sr=this.Sr,a.hq=this.hq,a.Tr=this.Tr,a},Na.className="LinkSettings",Ca.prototype.copy=function(){var a=new Ca;return a.ha[0]=this.ha[0],a.ha[1]=this.ha[1],a.ha[2]=this.ha[2],a.ha[3]=this.ha[3],a.ha[4]=this.ha[4],a.ha[5]=this.ha[5],a},Ca.prototype.translate=function(a,b){this.ha[4]+=this.ha[0]*a+this.ha[2]*b,this.ha[5]+=this.ha[1]*a+this.ha[3]*b},Ca.prototype.scale=function(a,b){this.ha[0]*=a,this.ha[1]*=a,this.ha[2]*=b,this.ha[3]*=b},Ca.prototype.rotate=function(a,b,t){if(360<=a?a-=360:0>a&&(a+=360),0!==a){if(this.translate(b,t),90===a){a=0;var e=1}else 180===a?(a=-1,e=0):270===a?(a=0,e=-1):(e=a*Math.PI/180,a=Math.cos(e),e=Math.sin(e));var n=this.ha[1]*a+this.ha[3]*e,o=this.ha[0]*-e+this.ha[2]*a,g=this.ha[1]*-e+this.ha[3]*a;this.ha[0]=this.ha[0]*a+this.ha[2]*e,this.ha[1]=n,this.ha[2]=o,this.ha[3]=g,this.translate(-b,-t)}},Ca.className="STransform",Ta.prototype.addColorStop=function(a,b){this.gx.push({offset:a,color:b})},Ta.className="SGradient",La.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.width=a,this.height=b,this.style.width=t+"px",this.style.height=e+"px",this.Oa.setAttributeNS(null,"width",t+"px"),this.Oa.setAttributeNS(null,"height",e+"px"),this.Oa.setAttributeNS(null,"viewBox","0 0 "+t+" "+e),this.context.ww.firstElementChild.setAttributeNS(null,"width",t+"px"),this.context.ww.firstElementChild.setAttributeNS(null,"height",e+"px"),!0)},La.prototype.Ud=function(a,b,t){if(a=this.ownerDocument.createElementNS(this.cA,a),F(b))for(var e in b)a.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,b[e]);return void 0!==t&&(a.textContent=t),a},La.prototype.getBoundingClientRect=function(){return this.Oa.getBoundingClientRect()},La.prototype.focus=function(){this.Oa.focus()},La.prototype.mx=function(){this.ownerDocument=null},v.Object.defineProperties(La.prototype,{width:{get:function(){return this.Oa.width.baseVal.value},set:function(a){this.Oa.setAttribute("width",a+"px")}},height:{get:function(){return this.Oa.height.baseVal.value},set:function(a){this.Oa.setAttribute("height",a+"px")}},style:{get:function(){return this.Oa.style}}}),La.className="SVGSurface",(e=Aa.prototype).arc=function(a,b,t,e,n,o,g,r){var h=2*Math.PI,l=h-1e-6,c=t*Math.cos(e),f=t*Math.sin(e),p=a+c,q=b+f,d=o?0:1;e=o?e-n:n-e,(1e-6<Math.abs(g-p)||1e-6<Math.abs(r-q))&&this.path.push(["L",p,+q]),0>e&&(e=e%h+h),e>l?(this.path.push(["A",t,t,0,1,d,a-c,b-f]),this.path.push(["A",t,t,0,1,d,p,q])):1e-6<e&&this.path.push(["A",t,t,0,+(e>=Math.PI),d,a+t*Math.cos(n),b+t*Math.sin(n)])},e.beginPath=function(){this.path=[],this.Xl={stroke:"none",fill:"none"}},e.Se=function(a){this.addPath(this.path,this.rb,a||0)},e.bezierCurveTo=function(a,b,t,e,n,o){this.path.push(["C",a,b,t,e,n,o])},e.clearRect=function(){},e.clip=function(){this.Xl.clipPath=!0},e.closePath=function(){this.path.push(["z"])},e.createLinearGradient=function(a,b,t,e){var n=new Ta("linear");return n.x1=a,n.y1=b,n.x2=t,n.y2=e,n},e.createPattern=function(a){var b="";a instanceof HTMLCanvasElement&&(b=a.toDataURL()),a instanceof HTMLImageElement&&(b=a.getAttribute("src"));var t=this.eA;if(t[b])return"url(#"+t[b]+")";var e="PATTERN"+yt++,n={x:0,y:0,width:a.width,height:a.height,href:b};return(a=this.Ud("pattern",{width:a.width,height:a.height,id:e,patternUnits:"userSpaceOnUse"})).appendChild(this.Ud(ys,n)),this.svg.appendChild(a),t[b]=e,"url(#"+e+")"},e.createRadialGradient=function(a,b,t,e,n,o){var g=new Ta("radial");return g.x1=a,g.y1=b,g.r1=t,g.x2=e,g.y2=n,g.r2=o,g},e.drawImage=function(a,b,t,e,n,o,g,r,h){var l="";a instanceof HTMLCanvasElement&&(l=a.toDataURL()),a instanceof HTMLImageElement&&(l=a.getAttribute("src"));var c=a instanceof HTMLImageElement?a.naturalWidth:a.width;a=a instanceof HTMLImageElement?a.naturalHeight:a.height,void 0===e&&(o=b,g=t,r=e=c,h=n=a),Fa(this,b,t,e=e||0,n=n||0,o||0,g||0,r=r||0,h=h||0),o={x:0,y:0,width:c||e,height:a||n,href:l},$e.$(e,r)&&$e.$(n,h)?-1===l.toLowerCase().indexOf(".svg")&&-1===l.toLowerCase().indexOf("data:image/svg")&&(o.preserveAspectRatio="xMidYMid slice"):o.preserveAspectRatio="none",0===b&&0===t&&e===c&&n===a||(e+=b,n+=t,o["clip-path"]="path('M "+b+","+t+" L "+e+" "+t+" L "+e+" "+n+" L "+b+" "+n+" z')"),Ba(this,ys,o,this.rb),this.addElement(ys,o)},e.fill=function(a){a&&(this.Xl["fill-rule"]="evenodd"),Da(this,this.Xl)},e.ng=function(a,b){this.clipInsteadOfFill?this.clip():this.fill(b)},e.fillRect=function(a,b,t,e){Ba(this,"fill",a={x:(a=[a,b,t,e])[0],y:a[1],width:a[2],height:a[3]},this.rb),this.addElement("rect",a)},e.ox=function(a,b,t,e){Ba(this,"fill",a={x:a,y:b,width:t,height:e},this.rb),Da(this,a),this.svg.prepend(this.Ud("rect",a))},e.fillText=function(a,b,t){a=[a,b,t],"left"===(b=this.textAlign)?b="start":"right"===b?b="end":"center"===b&&(b="middle"),Ba(this,"fill",b={x:a[1],y:a[2],style:"font: "+this.font,"text-anchor":b},this.rb),this.addElement("text",b,a[0])},e.lineTo=function(a,b){this.path.push(["L",a,b])},e.moveTo=function(a,b){this.path.push(["M",a,b])},e.quadraticCurveTo=function(a,b,t,e){this.path.push(["Q",a,b,t,e])},e.rect=function(a,b,t,e){this.path.push(["M",a,b],["L",a+t,b],["L",a+t,b+e],["L",a,b+e],["z"])},e.restore=function(){this.rb=this.stack.pop(),this.path=this.stack.pop();var a=this.stack.pop();this.fillStyle=a.fillStyle,this.font=a.font,this.globalAlpha=a.globalAlpha,this.lineCap=a.lineCap,this.lineDashOffset=a.lineDashOffset,this.lineJoin=a.lineJoin,this.lineWidth=a.lineWidth,this.miterLimit=a.miterLimit,this.shadowBlur=a.shadowBlur,this.shadowColor=a.shadowColor,this.shadowOffsetX=a.shadowOffsetX,this.shadowOffsetY=a.shadowOffsetY,this.strokeStyle=a.strokeStyle,this.textAlign=a.textAlign,this.ak=a.ak},e.save=function(){this.stack.push({fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign,ak:this.ak});for(var a=[],b=0;b<this.path.length;b++)a.push(this.path[b]);this.stack.push(a),this.stack.push(this.rb.copy())},e.setTransform=function(a,b,t,e,n,o){1===a&&0===b&&0===t&&1===e&&0===n&&0===o||Ea(this,a,b,t,e,n,o)},e.scale=function(a,b){this.rb.scale(a,b)},e.translate=function(a,b){this.rb.translate(a,b)},e.transform=function(){},e.yc=function(){},e.stroke=function(){za(this,this.Xl)},e.ik=function(){this.clipInsteadOfFill||this.stroke()},e.Ud=function(a,b,t){return this.Gv.Ud(a,b,t)},e.addElement=function(a,b,t){return a=this.Ud(a,b,t),null!==this.yd?this.yd.appendChild(a):this.yd=a,this.ad=a},e.addPath=function(a,b,t){for(var e=[],n=0;n<a.length;n++){var o=B(a[n]),g=[o.shift()];if("A"===g[0])g.push(o.shift()+","+o.shift(),o.shift(),o.shift()+","+o.shift(),o.shift()+","+o.shift());else for(;o.length;)g.push(o.shift()+","+o.shift());e.push(g.join(" "))}if(e=e.join(" "),(a=this.Xl).clipPath)0<this.nh.length&&this.nh[this.nh.length-1].setAttributeNS(null,"clip-path",'path("'+e+'")');else if(a.d=e,Ba(this,"",a,b),null!==this.Gl)if("g"!==(b=this.Gl).nodeName)for(var r in a)"transform"!==r&&b.setAttributeNS(null,r,a[r]);else for(var h in r=b.getElementsByTagName("path"),a)"transform"!==h&&r[t].setAttributeNS(null,h,a[h]);else this.addElement("path",a)},e.Ev=function(a,b,t){this.zr=a,this.Ar=b,this.Vg=t},e.hs=function(a,b){this.Bt=!0,this.Yg=a,this.uj=b},e.es=function(){this.Bt=!1},e.Vc=function(){},e.Wx=function(){},Aa.prototype.rotate=function(a){this.rb.rotate(57.2958*a,0,0)},Aa.prototype.getImageData=function(){return null},Aa.prototype.measureText=function(){return null},Aa.prototype.Gs=function(a){null!==a.svg&&a.svg.parentNode===this.Mj&&a.svg.remove()},Aa.className="SVGContext",zo.prototype.Bs=function(a){this.pj.contains("SVG")||this.$r("SVG",new La(this,M.document));var b=new La(this,M.document,!0);void 0===a&&(a=new _);var t=this;return Wr(this,(function(a,e){return a=null!==(a=Jr(t,a,"SVG",b))?a.svg:null,"function"==typeof e?(e(a),null):a}),a)},zo.prototype.makeSvg=zo.prototype.Bs,zo.prototype.av=function(a){return this.Bs(a)},zo.prototype.makeSVG=zo.prototype.av,Xa.prototype.resize=function(a,b,t,e){return(this.width!==a||this.height!==b)&&(this.width=a,this.height=b,this.style.width=t+"px",this.style.height=e+"px",!0)},Xa.prototype.toDataURL=function(a,b){return this.Oa.toDataURL(a,b)},Xa.prototype.getBoundingClientRect=function(){return this.Oa.getBoundingClientRect()},Xa.prototype.focus=function(){this.Oa.focus()},Xa.prototype.mx=function(){this.ownerDocument=this.Oa.H=null},v.Object.defineProperties(Xa.prototype,{width:{get:function(){return this.Oa.width},set:function(a){this.Oa.width=a}},height:{get:function(){return this.Oa.height},set:function(a){this.Oa.height=a}},style:{get:function(){return this.Oa.style}}}),Xa.className="CanvasSurface",(e=Ua.prototype).Wx=function(a){this.Z.imageSmoothingEnabled=a},e.arc=function(a,b,t,e,n,o){this.Z.arc(a,b,t,e,n,o)},e.beginPath=function(){this.Z.beginPath()},e.Se=function(){},e.bezierCurveTo=function(a,b,t,e,n,o){this.Z.bezierCurveTo(a,b,t,e,n,o)},e.clearRect=function(a,b,t,e){this.yc(),this.Z.clearRect(a,b,t,e)},e.clip=function(){this.Z.clip()},e.closePath=function(){this.Z.closePath()},e.createLinearGradient=function(a,b,t,e){return this.Z.createLinearGradient(a,b,t,e)},e.createPattern=function(a,b){return this.Z.createPattern(a,b)},e.createRadialGradient=function(a,b,t,e,n,o){return this.Z.createRadialGradient(a,b,t,e,n,o)},e.drawImage=function(a,b,t,e,n,o,g,r,h){void 0===e?this.Z.drawImage(a,b,t):this.Z.drawImage(a,b,t,e,n,o,g,r,h)},e.fill=function(a){this.Z.fill(a?"evenodd":"nonzero")},e.fillRect=function(a,b,t,e){this.Z.fillRect(a,b,t,e)},e.ox=function(a,b,t,e){this.Z.fillRect(a,b,t,e)},e.fillText=function(a,b,t){this.Z.fillText(a,b,t)},e.getImageData=function(a,b,t,e){return this.Z.getImageData(a,b,t,e)},e.lineTo=function(a,b){this.Z.lineTo(a,b)},e.measureText=function(a){return this.Z.measureText(a)},e.moveTo=function(a,b){this.Z.moveTo(a,b)},e.quadraticCurveTo=function(a,b,t,e){this.Z.quadraticCurveTo(a,b,t,e)},e.rect=function(a,b,t,e){this.Z.rect(a,b,t,e)},e.restore=function(){this.Z.restore()},e.save=function(){this.yc(),this.Z.save()},Ua.prototype.rotate=function(a){this.Dl.rotate(57.2958*a,0,0)},(e=Ua.prototype).setTransform=function(a,b,t,e,n,o){this.Dl.setTransform(a,b,t,e,n,o)},e.scale=function(a,b){this.Dl.scale(a,b)},e.translate=function(a,b){this.Dl.translate(a,b)},e.stroke=function(){this.Z.stroke()},e.transform=function(a,b,t,e,n,o){if(1!==a||0!==b||0!==t||1!==e||0!==n||0!==o){var g=this.Dl,r=g.m11*a+g.m21*b;a=g.m12*a+g.m22*b,b=g.m11*t+g.m21*e,t=g.m12*t+g.m22*e,g.dx=g.m11*n+g.m21*o+g.dx,g.dy=g.m12*n+g.m22*o+g.dy,g.m11=r,g.m12=a,g.m21=b,g.m22=t}},e.yc=function(){var a=this.Dl;this.Z.setTransform(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy)},e.ng=function(a,b){if(a instanceof Ha&&a.type===uh){var t=a.xk;(a=a.et)>t?(this.scale(t/a,1),this.translate((a-t)/2,0)):t>a&&(this.scale(1,a/t),this.translate(0,(t-a)/2)),this.Gm?this.clip():this.fill(b),a>t?(this.translate(-(a-t)/2,0),this.scale(1/(t/a),1)):t>a&&(this.translate(0,-(t-a)/2),this.scale(1,1/(a/t)))}else this.Gm?this.clip():this.fill(b)},e.ik=function(){this.Gm||this.stroke()},e.Ev=function(a,b,t){this.zr=a,this.Ar=b,this.Vg=t},e.hs=function(a,b){var t=this.Z;void 0!==t.setLineDash&&(t.setLineDash(a),t.lineDashOffset=b)},e.es=function(){var a=this.Z;void 0!==a.setLineDash&&(a.setLineDash(qa),a.lineDashOffset=0)},e.Vc=function(a){a&&(this.ct=""),this.bt=this.dt=""},e.Gs=function(){},v.Object.defineProperties(Ua.prototype,{fillStyle:{get:function(){return this.Z.fillStyle},set:function(a){this.bt!==a&&(this.bt=this.Z.fillStyle=a)}},font:{get:function(){return this.Z.font},set:function(a){this.ct!==a&&(this.ct=this.Z.font=a)}},globalAlpha:{get:function(){return this.Z.globalAlpha},set:function(a){this.Z.globalAlpha=a}},lineCap:{get:function(){return this.Z.lineCap},set:function(a){this.Z.lineCap=a}},lineDashOffset:{get:function(){return this.Z.lineDashOffset},set:function(a){this.Z.lineDashOffset=a}},lineJoin:{get:function(){return this.Z.lineJoin},set:function(a){this.Z.lineJoin=a}},lineWidth:{get:function(){return this.Z.lineWidth},set:function(a){this.Z.lineWidth=a}},miterLimit:{get:function(){return this.Z.miterLimit},set:function(a){this.Z.miterLimit=a}},shadowBlur:{get:function(){return this.Z.shadowBlur},set:function(a){this.Z.shadowBlur=a}},shadowColor:{get:function(){return this.Z.shadowColor},set:function(a){this.Z.shadowColor=a}},shadowOffsetX:{get:function(){return this.Z.shadowOffsetX},set:function(a){this.Z.shadowOffsetX=a}},shadowOffsetY:{get:function(){return this.Z.shadowOffsetY},set:function(a){this.Z.shadowOffsetY=a}},strokeStyle:{get:function(){return this.Z.strokeStyle},set:function(a){this.dt!==a&&(this.dt=this.Z.strokeStyle=a)}},textAlign:{get:function(){return this.Z.textAlign},set:function(a){this.Z.textAlign=a}},imageSmoothingEnabled:{get:function(){return this.Z.imageSmoothingEnabled},set:function(a){this.Z.imageSmoothingEnabled=a}},filter:{get:function(){return this.Z.filter},set:function(a){this.Z.filter=""===a?"none":a}},clipInsteadOfFill:{get:function(){return this.Gm},set:function(a){this.Gm=a}}});var qa=Object.freeze([]);function Ka(){this.F=this.o=this.u=this.j=0}function Ha(a,b){kh||(ah(),kh=!0),ht(this),this._isFrozen=!1,void 0===a?(this.na=hh,this.wk="black"):"string"==typeof a?(this.na=hh,this.wk=a):(this.na=a,this.wk="black"),(a=this.na)===lh?(this.Qd=le,this.Kk=ge):this.Kk=this.Qd=a===uh?fe:ae,this.Fr=0,this.Wp=NaN,this.xe=this.br=this.we=null,this.et=this.xk=0,b&&Object.assign(this,b)}function Wa(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?fh:t,Qa(a),$a(b,t)}function Ja(a,b,t){return b=void 0===b||"number"!=typeof b?.2:b,t=void 0===t?fh:t,Qa(a),$a(-b,t)}function Za(a,b,t){Qa(a),a=vh.j;var e=vh.u,n=vh.o,o=vh.F;return Qa(b),void 0===t&&(t=.5),"rgba("+Math.round((vh.j-a)*t+a)+", "+Math.round((vh.u-e)*t+e)+", "+Math.round((vh.o-n)*t+n)+", "+Math.round((vh.F-o)*t+o)+")"}function _a(a){return!!a&&(a instanceof Ha?a.Gx():(Qa(a),128>(299*vh.j+587*vh.u+114*vh.o)/1e3))}function $a(a,b){switch(b){case fh:b=100*ih(vh.j);var t=100*ih(vh.u),e=100*ih(vh.o);return bh.j=.4124564*b+.3575761*t+.1804375*e,bh.u=.2126729*b+.7151522*t+.072175*e,bh.o=.0193339*b+.119192*t+.9503041*e,bh.F=vh.F,b=oh(bh.j/mh[0]),t=oh(bh.u/mh[1]),e=oh(bh.o/mh[2]),wh.j=116*t-16,wh.u=500*(b-t),wh.o=200*(t-e),wh.F=bh.F,wh.j=Math.min(100,Math.max(0,wh.j+100*a)),b=(a=(wh.j+16)/116)-wh.o/200,bh.j=mh[0]*rh(wh.u/500+a),bh.u=mh[1]*(wh.j>gh*ph?Math.pow(a,3):wh.j/gh),bh.o=mh[2]*rh(b),bh.F=wh.F,a=-.969266*bh.j+1.8760108*bh.u+.041556*bh.o,b=.0556434*bh.j+-.2040259*bh.u+1.0572252*bh.o,vh.j=255*nh((3.2404542*bh.j+-1.5371385*bh.u+-.4985314*bh.o)/100),vh.u=255*nh(a/100),vh.o=255*nh(b/100),vh.F=bh.F,vh.j=Math.round(vh.j),255<vh.j?vh.j=255:0>vh.j&&(vh.j=0),vh.u=Math.round(vh.u),255<vh.u?vh.u=255:0>vh.u&&(vh.u=0),vh.o=Math.round(vh.o),255<vh.o?vh.o=255:0>vh.o&&(vh.o=0),"rgba("+vh.j+", "+vh.u+", "+vh.o+", "+vh.F+")";case dh:return eh(),xh.o=Math.min(100,Math.max(0,xh.o+100*a)),"hsla("+xh.j+", "+xh.u+"%, "+xh.o+"%, "+xh.F+")";default:T("Unknown color space: "+b)}}function Qa(a){kh||(ah(),kh=!0);var b=yh;if(null!==b){b.clearRect(0,0,1,1),b.fillStyle="#000000";var t=b.fillStyle;b.fillStyle=a,b.fillStyle!==t?(b.fillRect(0,0,1,1),a=b.getImageData(0,0,1,1).data,vh.j=a[0],vh.u=a[1],vh.o=a[2],vh.F=a[3]/255):(b.fillStyle="#FFFFFF",b.fillStyle=a,vh.j=0,vh.u=0,vh.o=0,vh.F=1)}}function eh(){var a=vh.j/255,b=vh.u/255,t=vh.o/255,e=Math.max(a,b,t),n=Math.min(a,b,t),o=e-n;if(n=(e+n)/2,0===o)var g=a=0;else{switch(e){case a:g=(b-t)/o%6;break;case b:g=(t-a)/o+2;break;case t:g=(a-b)/o+4}0>(g*=60)&&(g+=360),a=o/(1-Math.abs(2*n-1))}xh.j=Math.round(g),xh.u=Math.round(100*a),xh.o=Math.round(100*n),xh.F=vh.F}function ih(a){return.04045>=(a/=255)?a/12.92:Math.pow((a+.055)/1.055,2.4)}function nh(a){return.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055}function oh(a){return a>ph?Math.pow(a,1/3):(gh*a+16)/116}function rh(a){var b=a*a*a;return b>ph?b:(116*a-16)/gh}function sh(a,b){"string"!=typeof a&&(a instanceof Ha||T("Value for "+b+" must be a color string or a Brush, not "+a))}function ah(){yh=$r?new Xa(null,void 0,{willReadFrequently:!0}).context:null}Ua.className="CanvasSurfaceContext",Ka.className="ColorNumbers",Ha.prototype.copy=function(){var a=new Ha;return a.na=this.na,a.wk=this.wk,a.Qd=this.Qd.J(),a.Kk=this.Kk.J(),a.Fr=this.Fr,a.Wp=this.Wp,null!==this.we&&(a.we=this.we.copy()),a.br=this.br,a},(e=Ha.prototype).freeze=function(){return this._isFrozen=!0,null!==this.we&&this.we.freeze(),this},e.ka=function(){return Object.isFrozen(this)&&T("cannot thaw constant: "+this),this._isFrozen=!1,null!==this.we&&this.we.ka(),this},e.qb=function(a){a.classType===Ha&&(this.type=a)},e.toString=function(){var a="Brush(";if(this.type===hh)a+=this.color;else if(a=this.type===lh?a+"Linear ":this.type===uh?a+"Radial ":this.type===ch?a+"Pattern ":a+"(unknown) ",a+=this.start+" "+this.end,null!==this.colorStops)for(var b=this.colorStops.iterator;b.next();)a+=" "+b.key+":"+b.value;return a+")"},e.addColorStop=function(a,b){return this._isFrozen&&L(this),("number"!=typeof a||!isFinite(a)||1<a||0>a)&&A(a,"0 <= loc <= 1",Ha,"addColorStop:loc"),null===this.we&&(this.we=new Mt),this.we.add(a,b),this.na===hh&&(this.type=lh),this.xe=null,this},e.Vz=function(a,b){if(this._isFrozen&&L(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?fh:b,this.type===hh)Qa(this.color),this.color=$a(a,b);else if((this.type===lh||this.type===uh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Qa(t.value),this.addColorStop(t.key,$a(a,b));return this},e.Wy=function(a,b){if(this._isFrozen&&L(this),a=void 0===a||"number"!=typeof a?.2:a,b=void 0===b?fh:b,this.type===hh)Qa(this.color),this.color=$a(-a,b);else if((this.type===lh||this.type===uh)&&null!==this.colorStops)for(var t=this.colorStops.iterator;t.next();)Qa(t.value),this.addColorStop(t.key,$a(-a,b));return this},e.Gx=function(){if(this.type===hh)return _a(this.color);if((this.type===lh||this.type===uh)&&null!==this.colorStops){var a=this.colorStops;if(this.type===uh)return _a(a.first().value);if(null!==a.get(.5))return _a(a.get(.5));if(2===a.count)return _a(Za((a=a.Fa())[0].value,a[1].value));for(var b=a.iterator,t=-1,e=-1,n=1,o=1;b.next();){var g=b.key,r=Math.abs(.5-b.key);n>o&&r<n?(t=g,n=r):o>=n&&r<o&&(e=g,o=r)}return t>e&&(o=t,t=e,e=o,o=n),n=e-t,_a(Za(a.get(t),a.get(e),1-o/n))}return!1},v.Object.defineProperties(Ha.prototype,{type:{get:function(){return this.na},set:function(a){this._isFrozen&&L(this,a),this.na=a,this.start.Mc()&&(a===lh?this.start=le:a===uh&&(this.start=fe)),this.end.Mc()&&(a===lh?this.end=ge:a===uh&&(this.end=fe)),this.xe=null}},color:{get:function(){return this.wk},set:function(a){this._isFrozen&&L(this,a),this.wk=a,this.xe=null}},start:{get:function(){return this.Qd},set:function(a){this._isFrozen&&L(this,a),this.Qd=a.J(),this.xe=null}},end:{get:function(){return this.Kk},set:function(a){this._isFrozen&&L(this,a),this.Kk=a.J(),this.xe=null}},startRadius:{get:function(){return this.Fr},set:function(a){this._isFrozen&&L(this,a),0>a&&A(a,">= zero",Ha,"startRadius"),this.Fr=a,this.xe=null}},endRadius:{get:function(){return this.Wp},set:function(a){this._isFrozen&&L(this,a),0>a&&A(a,">= zero",Ha,"endRadius"),this.Wp=a,this.xe=null}},colorStops:{get:function(){return this.we},set:function(a){this._isFrozen&&L(this,a),this.we=a,this.xe=null}},pattern:{get:function(){return this.br},set:function(a){this._isFrozen&&L(this,a),this.br=a,this.xe=null}}}),Ha.prototype.isDark=Ha.prototype.Gx,Ha.prototype.darkenBy=Ha.prototype.Wy,Ha.prototype.lightenBy=Ha.prototype.Vz,Ha.prototype.addColorStop=Ha.prototype.addColorStop;var hh,lh,uh,ch,fh,dh,ph=216/24389,gh=24389/27,mh=[95.047,100,108.883],yh=null,vh=new Ka,xh=new Ka,bh=new Ka,wh=new Ka,kh=!1;function Mh(){this.xa="Base"}function Sh(){this.xa="Base"}function Ph(){this.xa="Base"}function Nh(){this.xa="Base"}function Ch(){this.xa="Base"}function Th(a,b,t){var e=null;if(a instanceof Eh&&""!==a.$e&&((e=a.fb(a.$e))===a&&(e=null)),null!==e)for(t&&a.arrange(0,0,b.width,b.height),b.assign(e.actualBounds),e=e.panel;e!==a;)e.transform.op(b),e=e.panel}function Lh(){this.xa="Base"}function Ah(){this.xa="Base",this.name="Table"}function jh(){this.xa="Base"}function Fh(){this.xa="Base"}function Oh(){this.xa="Base"}function Bh(){this.xa="Base"}function Dh(a,b,t,e){if(0>b)return a%b===t;if(a%b!==t)return!1;b=e.length;for(var n=0;n<b;n++)if(a%e[n]===t)return!1;return!0}function Ih(){this.xa="Base"}function zh(a,b,t,e){if(!1!==pa(e)){var n=e.strokeWidth;0===n&&a instanceof hc&&a.type===Eh.Link&&a.adornedObject instanceof Ll&&(n=a.adornedObject.strokeWidth),n*=e.Ca,a instanceof Oc&&null!==a.ua?(a=a.geometry.bounds,e.Ge(a.x-n/2,a.y-n/2,a.width+n,a.height+n)):a instanceof hc&&null!==a.adornedPart.ua?(a=a.adornedPart.ua.bounds,e.Ge(a.x-n/2,a.y-n/2,a.width+n,a.height+n)):e.Ge(-n/2,-n/2,b+n,t+n),(n=e.desiredSize).w()||null===e.ua?e.ec.h(0,0,n.width,n.height):e.ec.assign(e.ua.bounds),ga(e,!1)}}function Rh(){this.xa="Base"}function Eh(a,b){if(qs.call(this),this.na=null,void 0===a)this.na=Eh.Position;else if("string"==typeof a){var t=bl.I(a);null!==t&&(this.na=t)}else a instanceof Mh?this.na=a:a&&(this.na=Eh.Position,b=a);null===this.na&&T("Panel type not specified or PanelLayout not loaded: "+a),this.l=4194304|this.l|(this.na===Eh.Grid?1048576:0),this.O=new ot,this.zb=Ge,this.Sm=Fe,this.Uf=Ts,this.$g=null,this.$e="",this.jg=new Ut(NaN,NaN,NaN,NaN),this.T=this.F=null,this.wo=Ps,this.hn=It,this.jn=ct,this.ub=this.ra=null,this.yn=NaN,this.ge=this.Hh=null,b&&Object.assign(this,b)}function Vh(a,b){b.lineCap="butt";var t=0<a.rowCount?a.rowDefs:null,e=0<a.columnCount?a.colDefs:null;null!==t&&Gh(a,b,!0,t,!0),null!==e&&Gh(a,b,!1,e,!0),null!==t&&Yh(a,b,!0,t),null!==e&&Yh(a,b,!1,e),null!==t&&Gh(a,b,!0,t,!1),null!==e&&Gh(a,b,!1,e,!1)}function Yh(a,b,t,e){for(var n=e.length,o=a.actualBounds,g=a.naturalBounds,r=!0,h=0;h<n;h++){var l=e[h];if(void 0!==l&&0!==l.actual)if(r)r=!1;else{if(t){if(l.position>g.height)continue}else if(l.position>g.width)continue;var c=l.separatorStrokeWidth;isNaN(c)&&(c=t?a.defaultRowSeparatorStrokeWidth:a.defaultColumnSeparatorStrokeWidth);var f=l.separatorStroke;if(null===f&&(f=t?a.defaultRowSeparatorStroke:a.defaultColumnSeparatorStroke),0!==c&&null!==f){na(a,b,f,!1,!1,g,o),f=!1;var p=l.separatorDashArray;null===p&&(p=t?a.defaultRowSeparatorDashArray:a.defaultColumnSeparatorDashArray),null!==p&&(f=!0,b.hs(p,0)),b.beginPath(),p=l.position+c,t?p>g.height&&(c-=p-g.height):p>g.width&&(c-=p-g.width),l=l.position+c/2,b.lineWidth=c,c=a.zb,t?(l+=c.top,p=g.width-c.right,b.moveTo(c.left,l),b.lineTo(p,l)):(l+=c.left,p=g.height-c.bottom,b.moveTo(l,c.top),b.lineTo(l,p)),b.stroke(),b.Se(),f&&b.es()}}}}function Gh(a,b,t,e,n){for(var o=e.length,g=a.actualBounds,r=a.naturalBounds,h=Xh(a,!0),l=Xh(a,!1),c=0;c<o;c++){var f=e[c];if(void 0!==f&&null!==f.background&&f.coversSeparators!==n&&0!==f.actual){var p=t?g.height:g.width;if(!(f.position>p)){var q=f.Wc(),d=f.separatorStrokeWidth;isNaN(d)&&(d=t?a.defaultRowSeparatorStrokeWidth:a.defaultColumnSeparatorStrokeWidth);var u=f.separatorStroke;null===u&&(u=t?a.defaultRowSeparatorStroke:a.defaultColumnSeparatorStroke),null!==u&&f.index!==(t?h:l)||(d=0),q-=d,(d=f.position+d)+(q+=f.actual)>p&&(q=p-d),0>=q||(p=a.zb,na(a,b,f.background,!0,!1,r,g),t?b.fillRect(p.left,d+p.top,g.width-(p.left+p.right),q):b.fillRect(d+p.left,p.top,q,g.height-(p.top+p.bottom)))}}}}function Xh(a,b){for(var t=b?a.rowCount:a.columnCount,e=0;e<t;e++){var n=b?a.rowDefs[e]:a.colDefs[e];if(void 0!==n)return n.index}return 0}function Uh(a){return"LineV"===a||"BarV"===a}function qh(a){return null!==a.part?a.part.locationObject:null}function Kh(a,b){Hh(a,a,b)}function Hh(a,b,t){t(b);for(var e=(b=b.O.s).length,n=0;n<e;n++){var o=b[n];o instanceof Eh&&Hh(a,o,t)}}function Wh(a,b){Jh(a,a,b)}function Jh(a,b,t){if(t(b),b instanceof Eh)for(var e=(b=b.O.s).length,n=0;n<e;n++)Jh(a,b[n],t)}function Zh(a,b,t){if(t(b))return b;if(b instanceof Eh)for(var e=(b=b.O.s).length,n=0;n<e;n++){var o=Zh(a,b[n],t);if(null!==o)return o}return null}function _h(a){for(var b=(a=a.O.s).length,t=0,e=0;e<b;e++){var n=a[e];n instanceof Eh?t=Math.max(t,_h(n)):n instanceof Ll&&(t=Math.max(t,n.ig/2*n.strokeMiterLimit*n.Df()))}return t}function $h(a){return a.type===Eh.TableRow||a.type===Eh.TableColumn}function Qh(a,b,t,e){for(var n=a.O.s,o=n.length;o--;){var g=n[o];if(g.visible){var r=g.actualBounds,h=a.naturalBounds;r.x>h.width||r.y>h.height||0>r.x+r.width||0>r.y+r.height||(g instanceof Eh&&Qh(g,b,t,e),null!==b&&(g=b(g)),null===g||null!==t&&!t(g)||e.add(g))}}}function tl(a){var b=null;return a instanceof Ll&&((b=a.spot1)===Fe&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot1)),null===b&&(b=he),b}function el(a){var b=null;return a instanceof Ll&&((b=a.spot2)===Fe&&(b=null),null!==(a=a.geometry)&&null===b&&(b=a.spot2)),null===b&&(b=me),b}function il(a,b){a.l=b?16777216|a.l:-16777217&a.l}function nl(a,b,t){var e=a.rowDefs;if(!(0>b)){if(e[b]=t instanceof Ml?t:void 0,!t)for(b=e.length-1;0<=b&&void 0===e[b--];)e.length--;a.v()}}function rl(a,b,t){var e=a.colDefs;if(!(0>b)){if(e[b]=t instanceof Ml?t:void 0,!t)for(b=e.length-1;0<=b&&void 0===e[b--];)e.length--;a.v()}}function sl(a){return null!==(a=a.allBindings)&&a._isFrozen}function al(a){var b=a.allBindings;if(null===b)null!==a.data&&T("Template cannot have .data be non-null: "+a),a.allBindings=b=new ot;else if(b._isFrozen)return;var t=new ot;il(a,!1),a.pm(a,(function(a,e){e.th();var n=e.localBindings;if(null!==n)for(ca(e,!1),n=n.iterator;n.next();){var o=n.value;o.mode===op&&ca(e,!0);var g=o.sourceName;null!==g&&("/"===g&&il(a,!0),null!==(g=ep(o,a,e))&&(t.add(g),null===g.srcBindings&&(g.srcBindings=new ot),g.srcBindings.add(o))),b.add(o)}if(e instanceof Eh&&e.type===Eh.Table){if(0<e.rowCount)for(n=(a=e.rowDefs).length,o=0;o<n;o++)if(void 0!==(g=a[o])&&null!==g.be)for(var r=g.be.iterator;r.next();){var h=r.value;h.xd=g,h.so=2,h.vl=g.index,b.add(h)}if(0<e.columnCount)for(a=(e=e.colDefs).length,n=0;n<a;n++)if(void 0!==(o=e[n])&&null!==o.be)for(g=o.be.iterator;g.next();)(r=g.value).xd=o,r.so=1,r.vl=o.index,b.add(r)}}));for(var e=t.iterator;e.next();){var n=e.value;if(null!==n.srcBindings){ca(n,!0);for(var o=n.srcBindings.iterator;o.next();){var g=o.value;null===n.localBindings&&(n.localBindings=new ot),n.localBindings.add(g)}}n.srcBindings=null}for(e=b.iterator;e.next();)if(null!==(o=(n=e.value).xd)){n.xd=null;var r=n.targetProperty,h=r.indexOf(".");0<h&&o instanceof Eh&&(g=r.substring(0,h),r=r.substr(h+1),null!==(h=o.fb(g))?(o=h,n.targetProperty=r):j('Warning: unable to find GraphObject named "'+g+'" for Binding: '+n.toString())),o instanceof Ml?(g=ut(o.panel),n.Ai=void 0===g?-1:g,o.panel.bindingId=n.Ai):o instanceof qs?(g=ut(o),n.Ai=void 0===g?-1:g,o.bindingId=n.Ai):T("Unknown type of binding target: "+o)}b.freeze(),a instanceof zu&&a.Zc()&&a.Va()}function hl(a){if(a.type===Eh.Spot||a.type===Eh.Auto)return Math.min(a.O.length,1);if(a.type===Eh.Link){for(var b=(a=a.O).length,t=0;t<b;t++){var e=a.M(t);if(!(e instanceof Ll&&e.isPanelMain))break}return t}return a.type===Eh.Table&&0<a.O.length&&((a=a.O.M(0)).isPanelMain&&a instanceof Eh&&$h(a))?1:0}function ll(a,b){var t=hl(a);if(null===b||0===b.length)for(;a.O.length>t;)a.qc(a.O.length-1,!1);else if(a.O.length<=t){t=b.length;for(var e=0;e<t;e++)cl(a,b[e],e,!0)}else{e=t;for(var n=0;n<b.length;n++,e++){var o=b[n],g=e<a.O.length?a.O.M(e):null;if(g instanceof Eh){if(g.data!==o){var r=pl(a,g.data),h=pl(a,o),l=h!==r;l||(r=gl(a,r),l=gl(a,h)!==r),l?(a.qc(e,!1),cl(a,o,n,!1)):g.data=o}}else cl(a,o,n,!1)}for(;e<a.O.length;)a.qc(e,!1);a.$g=null,fl(a,t,0),pa(a)||a.v(),a.graduatedIntervals=null,a.If()||ml(a,a,!1),null!==(b=a.part)&&(b.Rh=null,b.ag=NaN,a.Te&&b instanceof uc&&(b.Te=!0),b.Te&&b instanceof uc&&(b.wc=null))}}function cl(a,b,t,e){if(!(null==b||0>t)){var n=pl(a,b);if(null!==(n=gl(a,n))){if(al(n),0!=(16777216&(n=n.copy()).l)){var o=a.ih();null!==o&&il(o,!0)}"object"==typeof b&&(null===a.ge&&(a.ge=new Mt),a.ge.add(b,n)),o=t+hl(a),a.Hb(o,n),e&&(n.ub=b,fl(a,o,t),n.ub=null),n.data=b}}}function fl(a,b,t){for(a=a.O;b<a.length;){var e=a.M(b);if(e instanceof Eh){var n=b,o=t;e.type===Eh.TableRow?e.row=n:e.type===Eh.TableColumn&&(e.column=n),e.itemIndex=o}b++,t++}}function pl(a,b){if(null===b)return"";if("function"==typeof(a=a.itemCategoryProperty))a=a(b);else{if("string"!=typeof a||"object"!=typeof b)return"";if(""===a)return"";a=Zd(b,a)}return void 0===a?"":"string"==typeof a?a:void T("Panel.getCategoryForItemData found a non-string category for "+b+": "+a)}function gl(a,b){var t=a.itemTemplateMap,e=null;return null!==t&&(e=t.I(b)),null===e&&(null!==t&&(e=t.I("")),null===e&&(vl||(vl=!0,j('No item template Panel found for category "'+b+'" on '+a),j("  Using default item template."),a=new Eh,(b=new Yl).bind(new tp("text","",V)),a.add(b),xl=a),e=xl)),e}function ml(a,b,t){var e=b.enabledChanged;if(null!==e&&e(b,t),b instanceof Eh){e=(b=b.O.s).length;for(var n=0;n<e;n++){var o=b[n];t&&o instanceof Eh&&!o.isEnabled||ml(a,o,t)}}}function yl(a,b){b.name=a,bl.add(a,b)}Ha.className="Brush",Ha.Solid=hh=new W(Ha,"Solid",0),Ha.Linear=lh=new W(Ha,"Linear",1),Ha.Radial=uh=new W(Ha,"Radial",2),Ha.Pattern=ch=new W(Ha,"Pattern",4),Ha.Lab=fh=new W(Ha,"Lab",5),Ha.HSL=dh=new W(Ha,"HSL",6),Ha.randomColor=function(a,b){void 0===a&&(a=128),void 0===b&&(b=Math.max(a,255));var t=Math.abs(b-a);b=Math.floor(a+Math.random()*t).toString(16);var e=Math.floor(a+Math.random()*t).toString(16);return a=Math.floor(a+Math.random()*t).toString(16),2>b.length&&(b="0"+b),2>e.length&&(e="0"+e),2>a.length&&(a="0"+a),"#"+b+e+a},Ha.isValidColor=function(a){if("black"===a)return!0;if(""===a)return!1;kh||(ah(),kh=!0);var b=yh;if(null===b)return!0;b.fillStyle="#000000";var t=b.fillStyle;return b.fillStyle=a,b.fillStyle!==t||(b.fillStyle="#FFFFFF",t=b.fillStyle,b.fillStyle=a,b.fillStyle!==t)},Ha.lighten=function(a){return Wa(a)},Ha.lightenBy=Wa,Ha.darken=function(a){return Ja(a)},Ha.darkenBy=Ja,Ha.mix=Za,Ha.isDark=_a,Mh.prototype.measure=function(){},Mh.prototype.Yz=function(a,b,t,e,n){a.measure(b,t,e,n)},Mh.prototype.arrange=function(){},Mh.prototype.Ly=function(a,b,t,e,n,o){a.arrange(b,t,e,n,o)},Mh.prototype.iA=function(a){a.Tj()},Mh.prototype.hc=function(){},v.Object.defineProperties(Mh.prototype,{name:{get:function(){return this.xa},set:function(a){this.xa=a}},classType:{get:function(){return Eh}}}),Mh.prototype.remeasureObject=Mh.prototype.iA,Mh.prototype.arrangeElement=Mh.prototype.Ly,Mh.prototype.measureElement=Mh.prototype.Yz,Mh.className="PanelLayout",y(Sh,Mh),Sh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;a=qh(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===a){var c=l.margin,f=c.right+c.left;c=c.top+c.bottom,l.measure(b,t,o,g);var p=l.measuredBounds;f=Math.max(p.width+f,0),c=Math.max(p.height+c,0),p=l.position.x;var q=l.position.y;isFinite(p)||(p=0),isFinite(q)||(q=0),l instanceof Ll&&l.isGeometryPositioned&&(p-=l=l.strokeWidth/2,q-=l),$t(n,p,q,f,c)}}},Sh.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding;for(a=t.x-n.left,t=t.y-n.top,n=0;n<e;n++){var o=b[n],g=o.measuredBounds,r=o.margin,h=o.position.x,l=o.position.y;if(h=isNaN(h)?-a:h-a,l=isNaN(l)?-t:l-t,o instanceof Ll&&o.isGeometryPositioned){var c=o.strokeWidth/2;h-=c,l-=c}o.visible&&o.arrange(h+r.left,l+r.top,g.width,g.height)}},y(Ph,Mh),Ph.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length;b=z(),o=qh(a);for(var h=0;h<r;h++){var l=e[h];if(l.visible||l===o){var c=sa(l,!1);if(c!==Ss&&c!==Ns)b.push(l);else{l.measure(1/0,t,0,g),c=l.margin,l=l.measuredBounds;var f=Math.max(l.height+c.top+c.bottom,0);n.width+=Math.max(l.width+c.right+c.left,0),n.height=Math.max(n.height,f)}}}for(e=b.length,a.desiredSize.height?t=Math.min(a.desiredSize.height,a.maxSize.height):0!==n.height&&(t=Math.min(n.height,a.maxSize.height)),a=0;a<e;a++)((h=b[a]).visible||h===o)&&(r=(c=h.margin).right+c.left,c=c.top+c.bottom,h.measure(1/0,t,0,g),h=h.measuredBounds,c=Math.max(h.height+c,0),n.width+=Math.max(h.width+r,0),n.height=Math.max(n.height,c));R(b)},Ph.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.top,g=a.isOpposite,r=g?t.width:n.left,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,q=p.top+p.bottom,d=o+n.bottom,u=f.height,m=sa(c,!1);(isNaN(c.desiredSize.height)&&m===Ms||m===Cs)&&(u=Math.max(t.height-q-d,0)),q=u+q+d,(d=c.alignment).Yb()&&(d=a.defaultAlignment),d.sb()||(d=fe),g&&(r-=f.width+p.left+p.right),c.arrange(r+d.offsetX+p.left,l+d.offsetY+p.top+(t.height*d.y-q*d.y),f.width,u),g||(r+=f.width+p.left+p.right)}}},y(Nh,Mh),Nh.prototype.measure=function(a,b,t,e,n,o){var g=e.length;t=z();for(var r=qh(a),h=0;h<g;h++){var l=e[h];if(l.visible||l===r){var c=sa(l,!1);if(c!==Ss&&c!==Cs)t.push(l);else{var f=l.margin;c=f.right+f.left,f=f.top+f.bottom,l.measure(b,1/0,o,0),l=l.measuredBounds,qt(n,Math.max(n.width,Math.max(l.width+c,0)),n.height+Math.max(l.height+f,0))}}}if(0!==(e=t.length)){for(a.desiredSize.width?b=Math.min(a.desiredSize.width,a.maxSize.width):0!==n.width&&(b=Math.min(n.width,a.maxSize.width)),a=0;a<e;a++)((h=t[a]).visible||h===r)&&(g=(l=h.margin).right+l.left,l=l.top+l.bottom,h.measure(b,1/0,o,0),h=h.measuredBounds,l=Math.max(h.height+l,0),n.width=Math.max(n.width,Math.max(h.width+g,0)),n.height+=l);R(t)}},Nh.prototype.arrange=function(a,b,t){for(var e=b.length,n=a.padding,o=n.left,g=a.isOpposite,r=g?t.height:n.top,h=0;h<e;h++){var l=o,c=b[h];if(c.visible){var f=c.measuredBounds,p=c.margin,q=p.left+p.right,d=o+n.right,u=f.width,m=sa(c,!1);(isNaN(c.desiredSize.width)&&m===Ms||m===Ns)&&(u=Math.max(t.width-q-d,0)),q=u+q+d,(d=c.alignment).Yb()&&(d=a.defaultAlignment),d.sb()||(d=fe),g&&(r-=f.height+p.bottom+p.top),c.arrange(l+d.offsetX+p.left+(t.width*d.x-q*d.x),r+d.offsetY+p.top,u,f.height),g||(r+=f.height+p.bottom+p.top)}}},y(Ch,Mh),Ch.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.Qb(),l=h.margin,c=l.right+l.left,f=l.top+l.bottom;h.measure(b,t,o,g);var p=h.measuredBounds;o=p.width,g=p.height;var q=Math.max(o+c,0),d=Math.max(g+f,0),u=a.isClipping,m=Ut.allocAt(-l.left,-l.top,q,d),y=Ut.allocAt(0,0,o,g);Th(h,y,!0),o=y.width,g=y.height;for(var v=!0,x=qh(a),w=0;w<r;w++){var k=e[w];p=b;var M=t;if(k!==h&&(k.visible||k===x)){var S=(l=k.margin).left,P=l.top;switch(q=l.right+l.left,d=l.top+l.bottom,l=sa(k,!1)){case Ms:p=o,M=g,P=S=d=q=0;break;case Ns:p=o,S=q=0;break;case Cs:M=g,P=d=0}k.measure(p,M,0,0),p=k.measuredBounds,q=Math.max(p.width+q,0),d=Math.max(p.height+d,0),(l=k.alignment).Yb()&&(l=a.defaultAlignment),l.sb()||(l=fe);var N=k.alignmentFocus;if(N.Yb()&&(N=fe),M=null,k instanceof Eh&&""!==k.$e&&((M=k.fb(k.$e))===k&&(M=null)),S=y.x-S,P=y.y-P,null!==M){for(k.arrange(0,0,p.width,p.height),p=M.actualBounds,p=St.allocAt(p.x+(N.x*p.width-N.offsetX),p.y+(N.y*p.height-N.offsetY)),M=M.panel;M!==k;)M.transform.Ga(p),M=M.panel;S+=l.x*o+l.offsetX-p.x,P+=l.y*g+l.offsetY-p.y,St.free(p)}else S+=l.x*o+l.offsetX-(N.x*p.width+N.offsetX),P+=l.y*g+l.offsetY-(N.y*p.height+N.offsetY);v?(v=!1,n.h(S,P,q,d)):$t(n,S,P,q,d)}}switch(v?n.assign(m):u?n.Uu(y.x,y.y,y.width,y.height):$t(n,m.x,m.y,m.width,m.height),Ut.free(m),Ut.free(y),(l=h.stretch)===Ts&&(l=sa(h,!1)),l){case Ss:return;case Ms:if(!isFinite(b)&&!isFinite(t))return;break;case Ns:if(!isFinite(b))return;break;case Cs:if(!isFinite(t))return}for(o=(p=h.measuredBounds).width,g=p.height,q=Math.max(o+c,0),d=Math.max(g+f,0),l=h.margin,Th(h,y=Ut.allocAt(-l.left,-l.top,q,d),!0),o=y.width,g=y.height,b=0;b<r;b++)(t=e[b])===h||!t.visible&&t!==x||(q=(l=t.margin).right+l.left,d=l.top+l.bottom,p=t.measuredBounds,q=Math.max(p.width+q,0),d=Math.max(p.height+d,0),(c=t.alignment).Yb()&&(c=a.defaultAlignment),c.sb()||(c=fe),(t=t.alignmentFocus).Yb()&&(t=fe),v?(v=!1,n.h(c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,q,d)):$t(n,c.x*o+c.offsetX-(t.x*p.width+t.offsetX)-l.left,c.y*g+c.offsetY-(t.y*p.height+t.offsetY)-l.top,q,d));v?n.assign(m):u?n.Uu(y.x,y.y,y.width,y.height):$t(n,m.x,m.y,m.width,m.height),Ut.free(y)},Ch.prototype.arrange=function(a,b,t){var e=b.length,n=a.Qb(),o=n.measuredBounds,g=o.width,r=o.height,h=a.padding;o=h.left,h=h.top;var l=o-t.x,c=h-t.y;for(n.arrange(l,c,g,r),Th(n,g=Ut.allocAt(0,0,g,r),!1),r=0;r<e;r++){var f=b[r];if(f!==n){var p=(l=f.measuredBounds).width,q=l.height;(c=f.alignment).Yb()&&(c=a.defaultAlignment),c.sb()||(c=fe);var d=f.alignmentFocus;if(d.Yb()&&(d=fe),l=null,f instanceof Eh&&""!==f.$e&&((l=f.fb(f.$e))===f&&(l=null)),null!==l){var u=l.actualBounds;for(d=St.allocAt(u.x+(d.x*u.width-d.offsetX),u.y+(d.y*u.height-d.offsetY)),l=l.panel;l!==f;)l.transform.Ga(d),l=l.panel;l=c.x*g.width+c.offsetX-d.x,c=c.y*g.height+c.offsetY-d.y,St.free(d)}else l=c.x*g.width+c.offsetX-(d.x*p+d.offsetX),c=c.y*g.height+c.offsetY-(d.y*q+d.offsetY);l+=g.x-t.x,c+=g.y-t.y,f.visible&&f.arrange(o+l,h+c,p,q)}}Ut.free(g)},y(Lh,Mh),Lh.prototype.measure=function(a,b,t,e,n,o,g){var r=e.length,h=a.Qb(),l=h.margin,c=b,f=t,p=l.right+l.left,q=l.top+l.bottom;h.measure(b,t,o,g),l=h.measuredBounds;var d=0,u=null;h instanceof Ll&&(d=(u=h).strokeWidth*u.scale);var m=Math.max(l.width+p,0);l=Math.max(l.height+q,0);var y=tl(h),v=y.x*m+y.offsetX;y=y.y*l+y.offsetY;var x=el(h),w=x.x*m+x.offsetX;for(x=x.y*l+x.offsetY,isFinite(b)&&(c=Math.max(Math.abs(v-w)-d,0)),isFinite(t)&&(f=Math.max(Math.abs(y-x)-d,0)),(d=Vt.alloc()).h(0,0),a=qh(a),x=0;x<r;x++)(y=e[x])===h||!y.visible&&y!==a||(m=(l=y.margin).right+l.left,v=l.top+l.bottom,y.measure(c,f,0,0),l=y.measuredBounds,m=Math.max(l.width+m,0),l=Math.max(l.height+v,0),d.h(Math.max(m,d.width),Math.max(l,d.height)));if(1===r)n.width=m,n.height=l,Vt.free(d);else{switch(y=tl(h),r=e=0,(x=el(h)).x!==y.x&&x.y!==y.y&&(e=d.width/Math.abs(x.x-y.x),r=d.height/Math.abs(x.y-y.y)),Vt.free(d),d=0,null!==u&&(d=u.strokeWidth*u.scale,Fl(u)===Ps&&(e=r=Math.max(e,r))),e+=Math.abs(y.offsetX)+Math.abs(x.offsetX)+d,r+=Math.abs(y.offsetY)+Math.abs(x.offsetY)+d,(u=h.stretch)===Ts&&(u=sa(h,!1)),u){case Ss:g=o=0;break;case Ms:isFinite(b)&&(e=b),isFinite(t)&&(r=t);break;case Ns:isFinite(b)&&(e=b),g=0;break;case Cs:o=0,isFinite(t)&&(r=t)}h.Tj(),h.measure(e,r,o,g),n.width=h.measuredBounds.width+p,n.height=h.measuredBounds.height+q}},Lh.prototype.arrange=function(a,b){var t=b.length,e=a.Qb(),n=e.measuredBounds,o=Ut.alloc();o.h(0,0,1,1);var g=e.margin,r=g.left;g=g.top;var h=a.padding,l=h.left;h=h.top,e.arrange(l+r,h+g,n.width,n.height);var c=tl(e),f=el(e),p=c.y*n.height+c.offsetY,q=f.x*n.width+f.offsetX;for(f=f.y*n.height+f.offsetY,o.x=c.x*n.width+c.offsetX,o.y=p,$t(o,q,f,0,0),o.x+=r+l,o.y+=g+h,n=0;n<t;n++)(r=b[n])!==e&&(l=r.measuredBounds,g=r.margin,h=Math.max(l.width+g.right+g.left,0),c=Math.max(l.height+g.top+g.bottom,0),(p=r.alignment).Yb()&&(p=a.defaultAlignment),p.sb()||(p=fe),h=o.width*p.x+p.offsetX-h*p.x+g.left+o.x,g=o.height*p.y+p.offsetY-c*p.y+g.top+o.y,r.visible&&(Qt(o.x,o.y,o.width,o.height,h,g,l.width,l.height)?r.arrange(h,g,l.width,l.height):r.arrange(h,g,l.width,l.height,new Ut(o.x,o.y,o.width,o.height))));Ut.free(o)},y(Ah,Mh),Ah.prototype.measure=function(a,b,t,e,n){for(var o=e.length,g=z(),r=z(),h=0;h<o;h++){var l=e[h],c=l instanceof Eh?l:null;if(null!==c&&$h(c)&&l.visible){r.push(c);for(var f=c.O.s,p=f.length,q=0;q<p;q++){var d=f[q];c.type===Eh.TableRow?d.row=l.row:c.type===Eh.TableColumn&&(d.column=l.column),g.push(d)}}else g.push(l)}0===(o=g.length)&&(a.Gb(0),a.Fb(0));for(var u=[],m=0;m<o;m++){var y=g[m];y.visible&&(ga(y,!0),ya(y,!0),u[y.row]||(u[y.row]=[]),u[y.row][y.column]||(u[y.row][y.column]=[]),u[y.row][y.column].push(y))}R(g);var v=z(),x=z(),w=z(),k={count:0},M={count:0},S=b,P=t,N=a.rowDefs,C=a.colDefs,T=null;o=N.length;for(var L=0;L<o;L++)void 0!==(T=N[L])&&(T.actual=0);o=C.length;for(var A=0;A<o;A++)void 0!==(T=C[A])&&(T.actual=0);for(var j=u.length,F=0,O=0;O<j;O++)u[O]&&(F=Math.max(F,u[O].length));var B=Math.min(a.topIndex,j-1),D=Math.min(a.leftIndex,F-1),I=0;j=u.length;for(var E=qh(a),V=0;V<j;V++)if(u[V]){F=u[V].length;var Y=a.Gb(V);Y.actual=0;for(var G=Y.pc=0;G<F;G++)if(u[V][G]){var X=a.Fb(G);void 0===v[G]&&(X.actual=0,X.pc=0,v[G]=!0);for(var U=u[V][G],K=U.length,H=0;H<K;H++){var W=U[H];if(W.visible||W===E){var J=1<W.rowSpan||1<W.columnSpan;J&&(V<B||G<D||x.push(W));var Z=W.margin,_=Z.right+Z.left,$=Z.top+Z.bottom,Q=aa(W,Y,X,!1),tt=W.desiredSize,et=!isNaN(tt.height),it=!isNaN(tt.width)&&et;if(J||Q===Ss||it||V<B||G<D||(void 0!==k[G]||Q!==Ms&&Q!==Ns||(k[G]=-1,k.count++),void 0!==M[V]||Q!==Ms&&Q!==Cs||(M[V]=-1,M.count++),w.push(W)),W.measure(1/0,1/0,0,0),!(V<B||G<D)){var nt=W.measuredBounds,ot=Math.max(nt.width+_,0),st=Math.max(nt.height+$,0);if(1===W.rowSpan&&(Q===Ss||Q===Ns)){var at=(T=a.Gb(V)).Wc();(I=Math.max(st-T.actual,0))+at>P&&(I=Math.max(P-at,0));var ht=0===T.oa;T.pc=T.pc+I,T.actual=T.oa+I,P=Math.max(P-(I+(ht?at:0)),0)}if(1===W.columnSpan&&(Q===Ss||Q===Cs)){var lt=(T=a.Fb(G)).Wc();(I=Math.max(ot-T.actual,0))+lt>S&&(I=Math.max(S-lt,0));var ut=0===T.oa;T.pc=T.pc+I,T.actual=T.oa+I,S=Math.max(S-(I+(ut?lt:0)),0)}J&&W.Tj()}}}}}R(v);var ct=0,ft=0;o=a.columnCount;for(var pt=0;pt<o;pt++){var gt=C[pt];void 0!==gt&&(ct+=isNaN(gt.Hc)?gt.pc:gt.Hc,0!==gt.pc&&(ct+=gt.Wc()))}o=a.rowCount;for(var mt=0;mt<o;mt++){var yt=N[mt];void 0!==yt&&(ft+=isNaN(yt.Hc)?yt.pc:yt.Hc,0!==yt.pc&&(ft+=yt.Wc()))}S=Math.max(b-ct,0);var vt=P=Math.max(t-ft,0),xt=S;o=w.length;for(var bt=0;bt<o;bt++){var wt=w[bt],kt=a.Gb(wt.row),Mt=a.Fb(wt.column),St=wt.measuredBounds,td=wt.margin,Pt=td.right+td.left,Nt=td.top+td.bottom;k[wt.column]=0===Mt.pc&&void 0!==k[wt.column]?Math.max(St.width+Pt,k[wt.column]):null,M[wt.row]=0===kt.pc&&void 0!==M[wt.row]?Math.max(St.height+Nt,M[wt.row]):null}var Ct,Tt=0,Lt=0;for(Ct in M)"count"!==Ct&&(Tt+=M[Ct]);for(Ct in k)"count"!==Ct&&(Lt+=k[Ct]);for(var At=Vt.alloc(),jt=0;jt<o;jt++){var Ft=w[jt];if(Ft.visible||Ft===E){var Ot=a.Gb(Ft.row),Bt=a.Fb(Ft.column),Dt=0;isFinite(Bt.width)?Dt=Bt.width:(Dt=isFinite(S)&&null!==k[Ft.column]?0===Lt?Bt.actual+S:k[Ft.column]/Lt*xt:null!==k[Ft.column]?S:Bt.actual||S,Dt=Math.max(0,Dt-Bt.Wc()));var It=0;switch(isFinite(Ot.height)?It=Ot.height:(It=isFinite(P)&&null!==M[Ft.row]?0===Tt?Ot.actual+P:M[Ft.row]/Tt*vt:null!==M[Ft.row]?P:Ot.actual||P,It=Math.max(0,It-Ot.Wc())),At.h(Math.max(Bt.minimum,Math.min(Dt,Bt.maximum)),Math.max(Ot.minimum,Math.min(It,Ot.maximum))),Q=aa(Ft,Ot,Bt,!1)){case Ns:At.height=Math.max(At.height,Ot.actual+P);break;case Cs:At.width=Math.max(At.width,Bt.actual+S)}var zt=Ft.margin,Rt=zt.right+zt.left,Et=zt.top+zt.bottom;Ft.Tj(),Ft.measure(At.width,At.height,Bt.minimum,Ot.minimum);var Yt=Ft.measuredBounds,Gt=Math.max(Yt.width+Rt,0),Xt=Math.max(Yt.height+Et,0);isFinite(S)&&(Gt=Math.min(Gt,At.width)),isFinite(P)&&(Xt=Math.min(Xt,At.height));var Ut=0;Ut=Ot.actual,Ot.actual=Math.max(Ot.actual,Xt),Ot.pc=Math.max(Ot.pc,Xt),I=Ot.actual-Ut,P=Math.max(P-I,0),null===M[Ft.row]&&(vt=Math.max(vt-I,0)),Ut=Bt.actual,Bt.actual=Math.max(Bt.actual,Gt),Bt.pc=Math.max(Bt.pc,Gt),I=Bt.actual-Ut,S=Math.max(S-I,0),null===k[Ft.column]&&(xt=Math.max(xt-I,0))}}R(w);var qt=Vt.alloc(),Kt=z(),Ht=z();if(0!==(o=x.length))for(var Wt=0;Wt<j;Wt++)if(u[Wt]){F=u[Wt].length;var Jt=a.Gb(Wt);Kt[Wt]=Jt.actual;for(var Zt=0;Zt<F;Zt++)if(u[Wt][Zt]){var _t=a.Fb(Zt);Ht[Zt]=_t.actual}}for(var $t=0;$t<o;$t++){var Qt=x[$t];if(Qt.visible||Qt===E){var te=a.Gb(Qt.row),ee=a.Fb(Qt.column);switch(At.h(Math.max(ee.minimum,Math.min(b,ee.maximum)),Math.max(te.minimum,Math.min(t,te.maximum))),Q=aa(Qt,te,ee,!1)){case Ms:0!==Ht[ee.index]&&(At.width=Math.min(At.width,Ht[ee.index])),0!==Kt[te.index]&&(At.height=Math.min(At.height,Kt[te.index]));break;case Ns:0!==Ht[ee.index]&&(At.width=Math.min(At.width,Ht[ee.index]));break;case Cs:0!==Kt[te.index]&&(At.height=Math.min(At.height,Kt[te.index]))}isFinite(ee.width)&&(At.width=ee.width),isFinite(te.height)&&(At.height=te.height),qt.h(0,0);for(var ie=ee.minimum,ne=te.minimum,oe=1;oe<Qt.rowSpan&&!(Qt.row+oe>=a.rowCount);oe++)T=a.Gb(Qt.row+oe),I=0,I=Q===Ms||Q===Cs?Math.max(T.minimum,0===Kt[Qt.row+oe]?T.maximum:Math.min(Kt[Qt.row+oe],T.maximum)):Math.max(T.minimum,isNaN(T.Hc)?T.maximum:Math.min(T.Hc,T.maximum)),qt.height+=I,ne+=T.minimum;for(var re=1;re<Qt.columnSpan&&!(Qt.column+re>=a.columnCount);re++)T=a.Fb(Qt.column+re),I=0,I=Q===Ms||Q===Ns?Math.max(T.minimum,0===Ht[Qt.column+re]?T.maximum:Math.min(Ht[Qt.column+re],T.maximum)):Math.max(T.minimum,isNaN(T.Hc)?T.maximum:Math.min(T.Hc,T.maximum)),qt.width+=I,ie+=T.minimum;At.width+=qt.width,At.height+=qt.height;var se=Qt.margin,ae=se.right+se.left,he=se.top+se.bottom;Qt.measure(At.width,At.height,ie,ne);for(var le=Qt.measuredBounds,ue=Math.max(le.width+ae,0),ce=Math.max(le.height+he,0),fe=0,de=0;de<Qt.rowSpan&&!(Qt.row+de>=a.rowCount);de++)fe+=(T=a.Gb(Qt.row+de)).total||0;if(fe<ce){var pe=ce-fe,ge=ce-fe;if(null!==Qt.spanAllocation)for(var me=Qt.spanAllocation,ye=0;ye<Qt.rowSpan&&!(0>=pe)&&!(Qt.row+ye>=a.rowCount);ye++){var ve=(T=a.Gb(Qt.row+ye)).oa||0,xe=me(Qt,T,ge);T.actual=Math.min(T.maximum,ve+xe),T.oa!==ve&&(pe-=T.oa-ve)}for(;0<pe;){var be=T.oa||0;if(isNaN(T.height)&&T.maximum>be&&(T.actual=Math.min(T.maximum,be+pe),T.oa!==be&&(pe-=T.oa-be)),0===T.index)break;T=a.Gb(T.index-1)}}for(var we=0,ke=0;ke<Qt.columnSpan&&!(Qt.column+ke>=a.columnCount);ke++)we+=(T=a.Fb(Qt.column+ke)).total||0;if(we<ue){var Me=ue-we,Se=ue-we;if(null!==Qt.spanAllocation)for(var Pe=Qt.spanAllocation,Ne=0;Ne<Qt.columnSpan&&!(0>=Me)&&!(Qt.column+Ne>=a.columnCount);Ne++){var Ce=(T=a.Fb(Qt.column+Ne)).oa||0,Te=Pe(Qt,T,Se);T.actual=Math.min(T.maximum,Ce+Te),T.oa!==Ce&&(Me-=T.oa-Ce)}for(;0<Me;){var Le=T.oa||0;if(isNaN(T.width)&&T.maximum>Le&&(T.actual=Math.min(T.maximum,Le+Me),T.oa!==Le&&(Me-=T.oa-Le)),0===T.index)break;T=a.Fb(T.index-1)}}}}R(x),Vt.free(qt),Vt.free(At),void 0!==Kt&&R(Kt),void 0!==Ht&&R(Ht);var Ae=0,je=0,Fe=a.desiredSize,Oe=a.maxSize;Q=sa(a,!0);var Be=ft=ct=0,De=0;o=a.columnCount;for(var Ie=0;Ie<o;Ie++)void 0!==C[Ie]&&(T=a.Fb(Ie),isFinite(T.width)?(Be+=T.width,Be+=T.Wc()):Pl(T)===Cl?(Be+=T.oa,Be+=T.Wc()):0!==T.oa&&(ct+=T.oa,ct+=T.Wc()));Ae=isFinite(Fe.width)?Math.min(Fe.width,Oe.width):Q!==Ss&&isFinite(b)?b:ct,Ae=Math.max(Ae,a.minSize.width),Ae=Math.max(Ae-Be,0);for(var ze=0===ct?1:Math.max(Ae/ct,1),Re=0;Re<o;Re++)void 0!==C[Re]&&(T=a.Fb(Re),isFinite(T.width)||Pl(T)===Cl||(T.actual=T.oa*ze),T.position=n.width,0!==T.oa&&(n.width+=T.oa,n.width+=T.Wc()));o=a.rowCount;for(var Ee=0;Ee<o;Ee++)void 0!==N[Ee]&&(T=a.Gb(Ee),isFinite(T.height)?(De+=T.height,De+=T.Wc()):Pl(T)===Cl?(De+=T.oa,De+=T.Wc()):0!==T.oa&&(ft+=T.oa,ft+=T.Wc()));je=isFinite(Fe.height)?Math.min(Fe.height,Oe.height):Q!==Ss&&isFinite(t)?t:ft,je=Math.max(je,a.minSize.height),je=Math.max(je-De,0);for(var Ve=0===ft?1:Math.max(je/ft,1),Ye=0;Ye<o;Ye++)void 0!==N[Ye]&&(T=a.Gb(Ye),isFinite(T.height)||Pl(T)===Cl||(T.actual=T.oa*Ve),T.position=n.height,0!==T.oa&&(n.height+=T.oa,n.height+=T.Wc()));o=r.length;for(var Ge=0;Ge<o;Ge++){var Xe=r[Ge],Ue=0,qe=0;Xe.type===Eh.TableRow?(Ue=n.width,qe=(T=a.Gb(Xe.row)).actual):(Ue=(T=a.Fb(Xe.column)).actual,qe=n.height),Xe.measuredBounds.h(0,0,Ue,qe),ga(Xe,!1)}R(r),a.inRowsCols=u},Ah.prototype.arrange=function(a,b,t){var e=b.length,n=a.padding,o=n.left;n=n.top;var g=a.inRowsCols;if(null!==g){for(var r,h,l=g.length,c=0,f=0;f<l;f++)g[f]&&(c=Math.max(c,g[f].length));h=a.rowDefs,r=a.colDefs;var p=f=0,q=Math.min(a.topIndex,l-1);if(0<h.length){for(;q!==l&&(void 0===h[q]||0===h[q].oa);)q++;f=-h[q=Math.max(Math.min(q,l-1),0)].position}var d=Math.min(a.leftIndex,c-1);if(0<r.length){for(;d!==c&&(void 0===r[d]||0===r[d].oa);)d++;p=-r[d=Math.max(Math.min(d,c-1),0)].position}for(var u=0,m=0;u!==l&&void 0===h[u];)u++;for(;m!==l&&void 0===r[m];)m++;c=a.part,a.Gb(u),a.Fb(m);for(var y=0;y<b.length;y++){var v=b[y];if(v instanceof Eh&&v.visible&&$h(v)){if(v.type===Eh.TableRow){r=a.Gb(v.row);var x=a.Fb(m)}else r=a.Gb(u),x=a.Fb(v.column);h=r.position+f+n,0!==r.oa&&(h+=r.Ho(Math.max(u,q))),r=x.position+p+o,0!==x.oa&&(r+=x.Ho(Math.max(m,d))),x=v.measuredBounds,v.Tk(),v.actualBounds.ka();var w=v.actualBounds,k=Ut.allocAt(w.x,w.y,w.width,w.height);w.x=v.type===Eh.TableRow?o:r,w.y=v.type===Eh.TableColumn?n:h,w.width=x.width,w.height=x.height,v.actualBounds.freeze(),ya(v,!1),Wt(k,w)||null===c||(c.oh(),v.On(c)),Ut.free(k)}}for(y=Vt.alloc(),v=0;v<l;v++)if(g[v])for(c=g[v].length,h=(x=a.Gb(v)).position+f+n,0!==x.oa&&(h+=x.Ho(Math.max(u,q))),w=0;w<c;w++)if(g[v][w]){r=(k=a.Fb(w)).position+p+o,0!==k.oa&&(r+=k.Ho(Math.max(m,d)));for(var M=g[v][w],S=M.length,P=0;P<S;P++){var N=M[P],C=N.measuredBounds;y.h(0,0);for(var T=1;T<N.rowSpan&&!(v+T>=a.rowCount);T++){var L=a.Gb(v+T);0!==L.oa&&(y.height+=L.total)}for(T=1;T<N.columnSpan&&!(w+T>=a.columnCount);T++)0!==(L=a.Fb(w+T)).oa&&(y.width+=L.total);var A=k.oa+y.width,j=x.oa+y.height;T=r,L=h;var F=A,O=j,B=r,D=h,I=A,z=j;r+A>t.width&&(I=Math.max(t.width-r,0)),h+j>t.height&&(z=Math.max(t.height-h,0));var R=N.alignment;if(R.Yb()){(R=a.defaultAlignment).sb()||(R=fe);var E=R.x,V=R.y,Y=R.offsetX;R=R.offsetY;var G=k.alignment,X=x.alignment;G.sb()&&(E=G.x,Y=G.offsetX),X.sb()&&(V=X.y,R=X.offsetY)}else E=R.x,V=R.y,Y=R.offsetX,R=R.offsetY;(isNaN(E)||isNaN(V))&&(V=E=.5,R=Y=0),G=C.width,X=C.height;var U=N.margin,K=U.left+U.right,H=U.top+U.bottom,W=aa(N,x,k,!1);!isNaN(N.desiredSize.width)||W!==Ms&&W!==Ns||(G=Math.max(A-K,0)),!isNaN(N.desiredSize.height)||W!==Ms&&W!==Cs||(X=Math.max(j-H,0)),A=N.maxSize,j=N.minSize,G=Math.min(A.width,G),X=Math.min(A.height,X),G=Math.max(j.width,G),A=(X=Math.max(j.height,X))+H,T+=F*E-(G+K)*E+Y+U.left,L+=O*V-A*V+R+U.top,N.visible&&(Qt(B,D,I,z,T,L,C.width,C.height)?N.arrange(T,L,G,X):N.arrange(T,L,G,X,new Ut(B,D,I,z)))}}for(Vt.free(y),a=0;a<e;a++)null!==(o=(t=b[a])instanceof Eh?t:null)&&$h(o)&&(o=t.actualBounds,t.naturalBounds.ka(),t.naturalBounds.h(0,0,o.width,o.height),t.naturalBounds.freeze())}},y(jh,Mh),jh.prototype.measure=function(){},jh.prototype.arrange=function(){},y(Fh,Mh),Fh.prototype.measure=function(){},Fh.prototype.arrange=function(){},y(Oh,Mh),Oh.prototype.measure=function(a,b,t,e,n,o,g){1<e.length&&T("Viewbox Panel cannot contain more than one GraphObject."),(e=e[0]).Ca=1,e.Tj(),e.measure(1/0,1/0,o,g);var r=e.measuredBounds,h=e.margin,l=h.right+h.left;if(h=h.top+h.bottom,isFinite(b)||isFinite(t)){var c=e.scale,f=r.width;r=r.height;var p=Math.max(b-l,0),q=Math.max(t-h,0),d=1;a.viewboxStretch===Ps?0!==f&&0!==r&&(d=Math.min(p/f,q/r)):0!==f&&0!==r&&(d=Math.max(p/f,q/r)),0===d&&(d=1e-4),e.Ca*=d,c!==e.scale&&(ga(e,!0),e.measure(1/0,1/0,o,g))}r=e.measuredBounds,n.width=isFinite(b)?b:Math.max(r.width+l,0),n.height=isFinite(t)?t:Math.max(r.height+h,0)},Oh.prototype.arrange=function(a,b,t){var e=(b=b[0]).measuredBounds,n=b.margin,o=Math.max(e.width+(n.right+n.left),0);n=Math.max(e.height+(n.top+n.bottom),0);var g=b.alignment;g.Yb()&&(g=a.defaultAlignment),g.sb()||(g=fe),b.arrange(t.width*g.x-o*g.x+g.offsetX,t.height*g.y-n*g.y+g.offsetY,e.width,e.height)},y(Bh,Mh),Bh.prototype.measure=function(){},Bh.prototype.arrange=function(){},Bh.prototype.hc=function(a,b,t){0>=(t=a.Df()*t.scale)&&(t=1);var e=a.gridCellSize,n=e.width;e=e.height;var o=a.naturalBounds,g=a.actualBounds,r=o.width,h=o.height,l=Math.ceil(r/n),c=Math.ceil(h/e),f=a.gridOrigin,p=f.x;f=f.y,b.save(),b.beginPath(),b.rect(0,0,r,h),b.clip(),b.Se();for(var q=[],d=a.O.s,u=d.length,m=0;m<u;m++){var y=d[m],v=[];if(q.push(v),y.visible){var x=y.interval;if(!(0>x)){y=Uh(y.figure);for(var w=0;w<u;w++)if(w!==m){var k=d[w];k.visible&&Uh(k.figure)===y&&((k=k.interval)>x&&v.push(k))}}}}for(u=(d=a.O.s).length,m=0;m<u;m++){var M=d[m];if(M.visible&&(v=M.interval||1,!(2>n*(y=Math.abs(v))*t))){if(x=M.segmentIndex,isFinite(x)&&!isNaN(x)||(x=0),0>x&&(x=y-Math.min(-x,y)),x=Math.round(x%y),w=1,1!==(y=M.opacity)){if(0===y)continue;w=b.globalAlpha,b.globalAlpha=w*y}k=q[m];var S=!1,P=M.strokeDashArray;if(null!==P&&(S=!0,b.hs(P,M.strokeDashOffset)),"LineV"===M.figure&&null!==M.stroke&&0<M.strokeWidth){for(b.lineWidth=M.strokeWidth,na(a,b,M.stroke,!1,!1,o,g),b.beginPath(),P=M=Math.floor((p-n)/n);P<=M+l;P++){var N=P*n+p;0<=N&&N<=r&&Dh(P,v,x,k)&&(b.moveTo(N,0),b.lineTo(N,h))}b.stroke(),b.Se()}else if("LineH"===M.figure&&null!==M.stroke&&0<M.strokeWidth){for(b.lineWidth=M.strokeWidth,na(a,b,M.stroke,!1,!1,o,g),b.beginPath(),P=M=Math.floor((f-e)/e);P<=M+c;P++)0<=(N=P*e+f)&&N<=h&&Dh(P,v,x,k)&&(b.moveTo(0,N),b.lineTo(r,N));b.stroke(),b.Se()}else if("BarV"===M.figure&&null!==M.fill)for(na(a,b,M.fill,!0,!1,o,g),M=M.width,isNaN(M)&&(M=n),N=P=Math.floor((p-n)/n);N<=P+l;N++){var C=N*n+p;0<=C+M&&C<=r&&Dh(N,v,x,k)&&b.fillRect(C,0,M,h)}else if("BarH"===M.figure&&null!==M.fill)for(na(a,b,M.fill,!0,!1,o,g),M=M.height,isNaN(M)&&(M=e),N=P=Math.floor((f-e)/e);N<=P+c;N++)0<=(C=N*e+f)+M&&C<=h&&Dh(N,v,x,k)&&b.fillRect(0,C,r,M);S&&b.es(),1!==y&&(b.globalAlpha=w)}}b.restore(),b.Vc(!1)},y(Ih,Mh),Ih.prototype.measure=function(a,b,t,e,n){var o=e.length;if(a instanceof hc||a instanceof Oc){var g=null,r=null;if(a instanceof Oc&&(g=a),a instanceof hc&&(g=(r=a).adornedPart,null===a.j&&(a.j=[])),g instanceof Oc){var h=g;if(0===o)qt(a.naturalBounds,0,0),a.measuredBounds.h(0,0,0,0);else{var l=a instanceof hc?null:g.path;b=g.routeBounds,(t=a.jg).h(0,0,b.width,b.height);var c=h.points,f=g.pointsCount;null!==r?r.Tl(!1):null!==g&&g.Tl(!1),r=b.width;var p=b.height,q=a.j;if(q.length=0,null!==l){zh(a,r,p,l);var d=l.measuredBounds;t.ed(d),q.push(d)}d=Ze.alloc();for(var u=St.alloc(),m=St.alloc(),y=0;y<o;y++){var v=e[y];if(v!==l)if(v.isPanelMain&&v instanceof Ll){zh(a,r,p,v);var x=v.measuredBounds;t.ed(x),q.push(x)}else if(2>f)v.measure(1/0,1/0,0,0),x=v.measuredBounds,t.ed(x),q.push(x);else{var w=v.segmentIndex,k=v.segmentFraction,M=v.alignmentFocus;M.Mc()&&(M=fe);var S=v.segmentOrientation,P=v.segmentOffset;if(isNaN(w)){var N=h.ua;x=z(),N.Qu(k,x);var C=St.allocAt(x[0],x[1]);if(C.add(h.i(0)),N.type===Qe.j?C.offset(-N.startX,-N.startY):null!==(N=N.figures.first())&&C.offset(-N.startX,-N.startY),N=x[2],S!==af){var T=h.computeAngle(v,S,N);v.Lb=T}T=C.x-b.x;var L=C.y-b.y;St.free(C),R(x)}else if(w<-f||w>=f)x=St.alloc(),h.vg(),h.computeMidPoint(x),N=h.midAngle,S!==af&&(T=h.computeAngle(v,S,N),v.Lb=T),T=x.x-b.x,L=x.y-b.y,St.free(x);else{if(T=0,0<=w?(L=c.M(w),x=w<f-1?c.M(w+1):L):(T=f+w,L=c.M(T),x=0<T?c.M(T-1):L),L.Xa(x)){0<=w?(N=0<w?c.M(w-1):L,T=w<f-2?c.M(w+2):x):(N=T<f-1?c.M(T+1):L,T=1<T?c.M(T-2):x),C=N.Bf(L);var A=x.Bf(T);N=C>A+10?0<=w?N.ab(L):L.ab(N):A>C+10?0<=w?x.ab(T):T.ab(x):0<=w?N.ab(T):T.ab(N)}else N=0<=w?L.ab(x):x.ab(L);S!==af&&(T=h.computeAngle(v,S,N),v.Lb=T),T=L.x+(x.x-L.x)*k-b.x,L=L.y+(x.y-L.y)*k-b.y}v.measure(1/0,1/0,0,0),x=v.measuredBounds,C=v.naturalBounds;var j=0;v instanceof Ll&&(j=v.strokeWidth),A=C.width+j;var F=C.height+j;d.reset(),d.translate(-x.x,-x.y),d.scale(v.scale,v.scale),d.rotate(S===af?v.angle:N,A/2,F/2),S!==gf&&S!==xf||d.rotate(90,A/2,F/2),S!==mf&&S!==bf||d.rotate(-90,A/2,F/2),S===wf&&(45<N&&135>N||225<N&&315>N)&&d.rotate(-N,A/2,F/2),C=new Ut(0,0,A,F),u.xi(C,M),d.Ga(u),M=-u.x+j/2*v.scale,v=-u.y+j/2*v.scale,m.assign(P),j=isNaN(P.x);var O=isNaN(P.y);if(j||O){A=A/2+3,F=F/2+3;var B=45<=N&&135>=N,D=225<=N&&315>=N;S===af&&(B||D)?(m.x=O?A:P.y,m.y=j?F:P.x,B?0<=w||isNaN(w)&&.5>k||!j||(m.y=-F):D&&((0<=w||isNaN(w)&&.5>k)&&j&&(m.y=-F),O&&(m.x=-A))):(j&&(m.x=0<=w||isNaN(w)&&.5>k?A:-A),O&&(m.y=-F),m.rotate(N))}else m.rotate(N);T+=m.x,L+=m.y,C.set(x),C.h(T+M,L+v,x.width,x.height),q.push(C),t.ed(C)}}if(null!==g)for(e=g.labelNodes;e.next();)e.value.measure(1/0,1/0);a.jg=t,a.position.h(b.x+t.x,b.y+t.y),qt(n,t.width||0,t.height||0),Ze.free(d),St.free(u),St.free(m)}}}},Ih.prototype.arrange=function(a,b){var t=b.length;if(a instanceof hc||a instanceof Oc){var e=a,n=null;a instanceof hc&&(e=(n=a).adornedPart);var o=a instanceof hc?null:e.path,g=a.j;if(0!==g.length){var r=0;if(null!==o&&r<g.length){var h=g[r];r++,o.arrange(h.x-a.jg.x,h.y-a.jg.y,h.width,h.height)}for(h=0;h<t;h++){var l=b[h];if(l!==o&&r<g.length){var c=g[r];r++,l.arrange(c.x-a.jg.x,c.y-a.jg.y,c.width,c.height)}}}if(2<=(t=(b=e.points).count)&&a instanceof Oc)for(o=a.labelNodes;o.next();){var f=a;r=(g=o.value).segmentIndex,h=g.segmentFraction;var p=g.alignmentFocus;if(l=g.segmentOrientation,c=g.segmentOffset,isNaN(r)){var q=f.ua,d=z();q.Qu(h,d);var u=St.allocAt(d[0],d[1]);u.add(f.i(0)),q.type===Qe.j||(q=q.figures.first()),u.offset(-q.startX,-q.startY),q=d[2],l!==af&&(f=f.computeAngle(g,l,q),g.angle=f),f=u.x;var m=u.y;St.free(u),R(d)}else if(r<-t||r>=t)m=d=St.alloc(),(q=f).vg(),q.computeMidPoint(m),q=f.midAngle,l!==af&&(f=f.computeAngle(g,l,q),g.angle=f),f=d.x,m=d.y,St.free(d);else{if(u=0,0<=r?(d=b.s[r],m=r<t-1?b.s[r+1]:d):(u=t+r,d=b.s[u],m=0<u?b.s[u-1]:d),d.Xa(m)){0<=r?(q=0<r?b.s[r-1]:d,u=r<t-2?b.s[r+2]:m):(q=u<t-1?b.s[u+1]:d,u=1<u?b.s[u-2]:m);var y=q.Bf(d),v=m.Bf(u);q=y>v+10?0<=r?q.ab(d):d.ab(q):v>y+10?0<=r?m.ab(u):u.ab(m):0<=r?q.ab(u):u.ab(q)}else q=0<=r?d.ab(m):m.ab(d);l!==af&&(f=f.computeAngle(g,l,q),g.angle=f),f=d.x+(m.x-d.x)*h,m=d.y+(m.y-d.y)*h}if(p.xs())g.location=new St(f,m);else{p.Mc()&&(p=fe),(d=Ze.alloc()).reset(),d.scale(g.scale,g.scale),d.rotate(g.angle,0,0);var x=g.naturalBounds;u=Ut.allocAt(0,0,x.width,x.height),(y=St.alloc()).xi(u,p),d.Ga(y),p=-y.x,v=-y.y;var w=x.width,k=x.height;(x=St.alloc()).assign(c);var M=isNaN(c.x),S=isNaN(c.y);if(M||S){w=w/2+3,k=k/2+3;var P=45<=q&&135>=q,N=225<=q&&315>=q;l===af&&(P||N)?(x.x=S?w:c.y,x.y=M?k:c.x,P?0<=r||isNaN(r)&&.5>h||!M||(x.y=-k):N&&((0<=r||isNaN(r)&&.5>h)&&M&&(x.y=-k),S&&(x.x=-w))):(M&&(x.x=0<=r||isNaN(r)&&.5>h?w:-w),S&&(x.y=-k),x.rotate(q))}else x.rotate(q);f+=x.x,m+=x.y,d.op(u),p+=u.x,v+=u.y,r=St.allocAt(f+p,m+v),g.move(r),St.free(r),St.free(x),St.free(y),Ut.free(u),Ze.free(d)}}null!==n?n.Tl(!1):e.Tl(!1),e=Xu(a),a.location.h(a.position.x+e.x,a.position.y+e.y),St.free(e)}},y(Rh,Mh),Rh.prototype.measure=function(a,b,t,e,n,o,g){var r=a.Qb();a.graduatedBounds=[];var h=r.margin,l=h.right+h.left,c=h.top+h.bottom;r.measure(b,t,o,g);var f=r.measuredBounds,p=new Ut(-h.left,-h.top,Math.max(f.width+l,0),Math.max(f.height+c,0));a.graduatedBounds.push(p),n.assign(p);for(var q=r.geometry,d=r.strokeWidth,u=q.flattenedSegments,m=q.flattenedLengths,y=q.flattenedTotalLength,v=u.length,x=0,w=0,k=z(),M=0;M<v;M++){var S=u[M],P=[];w=x=0;for(var N=S.length,C=0;C<N;C+=2){var T=S[C],L=S[C+1];if(0!==C){var A=180*Math.atan2(L-w,T-x)/Math.PI;0>A&&(A+=360),P.push(A)}x=T,w=L}k.push(P)}if(null===a.graduatedIntervals){for(var j=[],F=a.O.s,O=F.length,B=0;B<O;B++){var D=F[B],I=[];if(j.push(I),D.visible){var E=D.interval;if(!(0>E))for(var V=0;V<O;V++)if(V!==B){var Y=F[V];if(Y.visible&&D.constructor===Y.constructor){var G=Y.interval;G>E&&I.push(G)}}}}a.graduatedIntervals=j}var X=a.graduatedIntervals,U=a.O.s,K=U.length,H=0,W=0,J=y;a.graduatedMarks=[];for(var Z,_=0;_<K;_++){var $=U[_];if(Z=[],$.visible&&$!==r){var Q=Math.abs($.interval),tt=a.graduatedTickUnit;if(!(2>tt*Q*y/a.graduatedRange&&null===$.graduatedSkip)){var et=m[0][0],it=0,nt=0;W=y*$.graduatedStart-1e-4,J=y*$.graduatedEnd+1e-4;var ot=tt*Q,st=a.graduatedTickBase;if(st<a.graduatedMin){var at=(a.graduatedMin-st)/ot;st+=(at=0==at%1?at:Math.floor(at+1))*ot}else st>a.graduatedMin+ot&&(st-=Math.floor((st-a.graduatedMin)/ot)*ot);for(var ht=X[_],lt=st,ut=1e-6*a.graduatedMax,ct=1;st<=a.graduatedMax+ut;ct++){t:{for(var ft=ht.length,pt=0;pt<ft;pt++){var gt=(st-a.graduatedTickBase)%(ht[pt]*a.graduatedTickUnit),mt=1e-6*a.graduatedTickUnit;if(gt<mt&&gt>-mt){var yt=!1;break t}}yt=!0}if(yt&&(st>a.graduatedMax&&(st=a.graduatedMax),null===$.graduatedSkip||$ instanceof Yl&&!$.graduatedSkip(st,$)||$ instanceof Ll&&!$.graduatedSkip(st,$))&&((H=(st-a.graduatedMin)*y/a.graduatedRange)>y&&(H=y),W<=H&&H<=J)){for(var vt=k[it][nt],xt=m[it][nt];it<m.length;){for(;H>et&&nt<m[it].length-1;)nt++,vt=k[it][nt],et+=xt=m[it][nt];if(H<=et)break;nt=0,vt=k[++it][nt],et+=xt=m[it][nt]}var bt=u[it],wt=bt[2*nt],kt=bt[2*nt+1],Mt=(H-(et-xt))/xt,Pt=new St(wt+(bt[2*nt+2]-wt)*Mt+d/2-q.bounds.x,kt+(bt[2*nt+3]-kt)*Mt+d/2-q.bounds.y);Pt.scale(r.scale,r.scale);t:{var td=vt,Nt=k[it];if(!(.5005>Mt&&.4995<Mt)){var Ct=td;if(.5>Mt?0<nt?Ct=Nt[nt-1]:$e.$(bt[0],bt[bt.length-2])&&$e.$(bt[1],bt[bt.length-1])&&(Ct=Nt[Nt.length-1]):.5<Mt&&(nt+1<Nt.length?Ct=Nt[nt+1]:$e.$(bt[0],bt[bt.length-2])&&$e.$(bt[1],bt[bt.length-1])&&(Ct=Nt[0])),td!==Ct){var Tt=Math.abs(td-Ct);if(180<Tt&&(td<Ct?td+=360:Ct+=360,Tt=Math.abs(td-Ct)),5e-4>Mt||.9995<Mt){vt=(td+Ct)/2%360;break t}if(10>Tt){var Lt=1-Math.abs(.5-Mt);vt=(td*Lt+Ct*(1-Lt))%360;break t}}}vt=td}if($ instanceof Yl){var At="";null!==$.graduatedFunction?At=null!=(At=$.graduatedFunction(st,$))?At.toString():"":At=(+st.toFixed(2)).toString(),""!==At&&Z.push({Zl:Pt,angle:vt,text:At})}else Z.push({Zl:Pt,angle:vt})}st=lt+ct*ot}}}a.graduatedMarks.push(Z)}R(k);var jt=a.graduatedMarks;if(null!==jt)for(var Ft=e.length,Ot=0;Ot<Ft;Ot++){var Bt=e[Ot],Dt=jt[Ot];if(Bt.visible&&Bt!==r&&0!==Dt.length){if(Bt instanceof Ll){var It=a,zt=n,Rt=Bt.alignmentFocus;Rt.Mc()&&(Rt=le);var Et=Bt.angle;Bt.Lb=0,Bt.measure(1/0,1/0,0,0),Bt.Lb=Et;var Vt=Bt.measuredBounds,Yt=Vt.width,Gt=Vt.height,Xt=Ut.allocAt(0,0,Yt,Gt),qt=St.alloc();qt.xi(Xt,Rt),Ut.free(Xt);for(var Kt=-qt.x,Ht=-qt.y,Wt=new Ut,Jt=Dt.length,Zt=0;Zt<Jt;Zt++)for(var _t=Dt[Zt],Qt=_t.Zl.x,te=_t.Zl.y,ee=_t.angle,ie=0;4>ie;ie++){switch(ie){case 0:qt.h(Kt,Ht);break;case 1:qt.h(Kt+Yt,Ht);break;case 2:qt.h(Kt,Ht+Gt);break;case 3:qt.h(Kt+Yt,Ht+Gt)}qt.rotate(ee+Bt.angle),qt.offset(Qt,te),0===Zt&&0===ie?Wt.h(qt.x,qt.y,0,0):Wt.Ye(qt),qt.offset(-Qt,-te),qt.rotate(-ee-Bt.angle)}St.free(qt),null!==It.graduatedBounds&&It.graduatedBounds.push(Wt),$t(zt,Wt.x,Wt.y,Wt.width,Wt.height)}else if(Bt instanceof Yl){var ne=a,oe=n;null===ne.temporaryTextBlock&&(ne.temporaryTextBlock=new Yl);var re=ne.temporaryTextBlock;Xl(re,Bt);var se=Bt.alignmentFocus;se.Mc()&&(se=le);for(var ae=Bt.segmentOrientation,he=Bt.segmentOffset,ue=new Ut,ce=0,fe=0,de=0,pe=0,ge=0,me=Dt.length,ye=0;ye<me;ye++){var ve=Dt[ye];ce=ve.Zl.x,fe=ve.Zl.y,de=ve.angle,ge=pe=Bt.angle,ae!==af&&(ge=ae===pf||ae===vf?de+Bt.angle:de,pe=Oc.computeAngle(ae,ge)),re.Lb=pe,re.text=ve.text||"",re.measure(1/0,1/0,0,0);var xe=re.measuredBounds,be=re.naturalBounds,we=be.width,ke=be.height,Me=Ze.alloc();Me.reset(),Me.translate(-xe.x,-xe.y),Me.scale(re.scale,re.scale),Me.rotate(ge,we/2,ke/2),ae!==gf&&ae!==xf||Me.rotate(90,we/2,ke/2),ae!==mf&&ae!==bf||Me.rotate(-90,we/2,ke/2),ae===wf&&(45<de&&135>de||225<de&&315>de)&&Me.rotate(-de,we/2,ke/2);var Se=Ut.allocAt(0,0,we,ke),Pe=St.alloc();Pe.xi(Se,se),Me.Ga(Pe);var Ne=-Pe.x,Ce=-Pe.y,Te=St.alloc();Te.assign(he),isNaN(Te.x)&&(Te.x=we/2+3),isNaN(Te.y)&&(Te.y=-(ke/2+3)),Te.rotate(de);var Le=new Ut(ce+=Te.x+Ne,fe+=Te.y+Ce,xe.width,xe.height),Ae=new Ut(xe.x,xe.y,xe.width,xe.height),je=new Ut(be.x,be.y,be.width,be.height);ve.Sz=pe,ve.lineCount=re.lineCount,ve.lines=[re.Db,re.Ih,re.df,re.Le,re.Qc,re.Rb,re.ze],ve.actualBounds=Le,ve.measuredBounds=Ae,ve.naturalBounds=je,0===ye?ue.assign(Le):ue.ed(Le),St.free(Te),St.free(Pe),Ut.free(Se),Ze.free(Me)}null!==ne.graduatedBounds&&ne.graduatedBounds.push(ue),$t(oe,ue.x,ue.y,ue.width,ue.height)}ga(Bt,!1)}}},Rh.prototype.arrange=function(a,b,t){if(null!==a.graduatedBounds){var e=a.Qb(),n=a.graduatedMarks;if(null!==n){var o=a.graduatedBounds,g=0,r=o[g];g++,null!==e&&e.arrange(r.x-t.x,r.y-t.y,r.width,r.height);for(var h=b.length,l=0;l<h;l++){var c=b[l];r=n[l],c.visible&&c!==e&&0!==r.length&&(r=o[g],g++,c.arrange(r.x-t.x,r.y-t.y,r.width,r.height))}a.graduatedBounds=null}}},Rh.prototype.hc=function(a,b,t){var e=t.$i;t.$i=!0;var n=a.naturalBounds,o=n.width,g=n.height;n=b instanceof Aa,b.save(),b.beginPath(),b.rect(-1,-1,o+1,g+1),b.clip(),b.Se(),(o=a.Qb()).hc(b,t),0>=(g=a.Df()*t.scale)&&(g=1);for(var r=o.actualBounds,h=a.O.s,l=a.graduatedMarks,c=h.length,f=0;f<c;f++){var p=h[f],q=l[f],d=q.length;if(p.visible&&p!==o&&0!==q.length)if(p instanceof Ll){if(!(2>a.graduatedTickUnit*p.interval*o.geometry.flattenedTotalLength/a.graduatedRange*g&&null===p.graduatedSkip)){var u=p.measuredBounds,m=p.strokeWidth*p.scale,y=p.alignmentFocus;y.Mc()&&(y=le);for(var v=0;v<d;v++){var x=q[v].Zl,w=q[v].angle,k=y,M=p.Bb;M.reset(),M.translate(x.x+r.x,x.y+r.y),M.rotate(w+p.angle,0,0),M.translate(-u.width*k.x+k.offsetX+m/2,-u.height*k.y+k.offsetY+m/2),M.scale(p.scale,p.scale),fa(p,!1),p.wh.set(p.Bb),p.Jk=p.scale,da(p,!1),p.hc(b,t),n&&(a.svg.appendChild(p.svg),p.svg=null),p.Bb.reset()}}}else if(p instanceof Yl)for(null===a.temporaryTextBlock&&(a.temporaryTextBlock=new Yl),Xl(u=a.temporaryTextBlock,p),m=0;m<d;m++)(y=q[m]).actualBounds&&y.measuredBounds&&y.naturalBounds&&(u.fc=y.text||"",u.Lb=y.Sz||0,u.Gc=y.lineCount||0,void 0!==(v=y.lines)&&(u.Db=v[0],u.Ih=v[1],u.df=v[2],u.Le=v[3],u.Qc=v[4],u.Rb=v[5],u.ze=v[6]),y.naturalBounds&&(u.ec=y.naturalBounds),y.actualBounds&&(v=y.actualBounds,u.arrange(v.x,v.y,v.width,v.height)),v=y.actualBounds,u.arrange(v.x,v.y,v.width,v.height),x=y.measuredBounds,y=y.naturalBounds,(w=u.Bb).reset(),w.translate(v.x+r.x,v.y+r.y),w.translate(-x.x,-x.y),u.mo(w,y.x,y.y,y.width,y.height),fa(u,!1),u.wh.set(u.Bb),u.Jk=u.scale,da(u,!1),u.Ng=p.part,u.Me=p.panel,u.hc(b,t),u.Me=null,u.Ng=null,n&&(a.svg.appendChild(u.svg),u.svg=null))}t.$i=e,b.restore(),b.Vc(!0)},y(Eh,qs),Eh.prototype.cloneProtected=function(a){qs.prototype.cloneProtected.call(this,a),a.na=this.na,a.zb=this.zb.J(),a.Sm=this.Sm.J(),a.Uf=this.Uf,a.$e=this.$e,a.jg.assign(this.jg),null!==this.T&&(a.T=this.T.copy(a)),a.wo=this.wo,a.hn=this.hn.J(),a.jn=this.jn.J(),null!==this.ra&&(a.ra=this.ra.copy()),a.ub=this.ub,a.yn=this.yn,a.Hh=this.Hh},Eh.prototype.Af=function(a){qs.prototype.Af.call(this,a),a.O=this.O;for(var b=a.O.s,t=b.length,e=0;e<t;e++)b[e].Me=a;a.$g=null},Eh.prototype.copy=function(){var a=qs.prototype.copy.call(this);if(null!==a){for(var b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e].copy();n.wi(a),n.Ng=null;var o=a.O,g=o.count;if(o.Hb(g,n),null!==(o=a.part)){o.Rh=null,null!==n.portId&&o instanceof uc&&(o.Te=!0);var r=a.diagram;null!==r&&r.undoManager.isUndoingRedoing||o.cb(Mi,"elements",a,null,n,null,g)}}return a}return null},(e=Eh.prototype).toString=function(){return"Panel("+this.type.name+")#"+ut(this)},e.On=function(a){qs.prototype.On.call(this,a);for(var b=this.O.s,t=b.length,e=0;e<t;e++)b[e].On(a)},e.hh=function(a,b){if(this.na===Eh.Grid)a.yc(),this.na.hc(this,a,b);else if(this.na===Eh.Graduated)a.yc(),this.na.hc(this,a,b);else{if(this.na===Eh.Table)if(a.yc(),a instanceof Aa){var t=a.yd;a.yd=Va(a,"gojs-ts"),Vh(this,a),a.nh.pop(),a.yd=t}else Vh(this,a);(t=this.isClipping&&this.na===Eh.Spot)&&a.save();for(var e=this.Qb(),n=this.O.s,o=n.length,g=0;g<o;g++){var r=n[g];t&&r===e&&(a.clipInsteadOfFill=!0),r.hc(a,b),t&&r===e&&(a.clipInsteadOfFill=!1)}t&&(a.restore(),a.Vc(!0))}},e.lv=function(){for(var a=this.O.s,b=a.length,t=0;t<b;t++)a[t].lv();this.Uc=!0},e.jk=function(a,b,t){if(!qs.prototype.jk.call(this,a,b,t))return!1;if(this.type===Eh.Table)null!==(t=0!==(t=this.svg.getElementsByClassName("gojs-ts")).length?t[0]:null)&&(t.innerHTML=""),a.yd=t,Vh(this,a),a.yd=null;else if(this.na===Eh.Grid||this.na===Eh.Graduated)return this.svg.innerHTML="",this.svg.remove(),!1;for(var e=(t=this.O.s).length,n=0;n<e;n++)t[n].hc(a,b);return!0},e.mk=function(){return!0},e.Zo=function(a,b,t,e){if(!this.isClipping)if(this.Dd()&&null!==a.ak){a=a.ak,b=this.O.s;for(var n=0,o=0,g=0;g<b.length;g++)if(b[g].Ed()){var r=b[g].actualBounds;n=0===g?r.x:Math.min(r.x,n),o=0===g?r.y:Math.min(r.y,o)}e.setAttributeNS(null,"clip-path","path('M "+(a.x-t.x-n)+","+(a.y-t.y-o)+" l "+a.width+" 0 l 0 "+a.height+" l -"+a.width+" 0 z')")}else qs.prototype.Zo.call(this,a,b,t,e)},e.Rj=function(a,b,t,e,n){var o=this.se(),g=this.transform,r=1/(g.m11*g.m22-g.m12*g.m21),h=g.m22*r,l=-g.m12*r,c=-g.m21*r,f=g.m11*r,p=r*(g.m21*g.dy-g.m22*g.dx),q=r*(g.m12*g.dx-g.m11*g.dy);if(null!==this.areaBackground)return g=this.actualBounds,$e.Ff(g.left,g.top,g.right,g.bottom,a,b,t,e,n);if(null!==this.background)return o=a*h+b*c+p,r=a*l+b*f+q,a=t*h+e*c+p,h=t*l+e*f+q,n.h(0,0),t=this.naturalBounds,o=$e.Ff(0,0,t.width,t.height,o,r,a,h,n),n.transform(g),o;o||(h=1,c=l=0,f=1,q=p=0),r=a*h+b*c+p,a=a*l+b*f+q,h=t*h+e*c+p,t=t*l+e*f+q,n.h(h,t),e=(h-r)*(h-r)+(t-a)*(t-a),l=!1,q=(f=this.O.s).length,c=St.alloc(),p=null,b=1/0;var d=null,u=this.isClipping&&this.na===Eh.Spot;u&&(d=St.alloc(),(l=(p=this.Qb()).Rj(r,a,h,t,d))&&(b=(r-d.x)*(r-d.x)+(a-d.y)*(a-d.y)));for(var m=0;m<q;m++){var y=f[m];y.visible&&y!==p&&y.Rj(r,a,h,t,c)&&(l=!0,(y=(r-c.x)*(r-c.x)+(a-c.y)*(a-c.y))<e&&(e=y,n.set(c)))}return u&&(b>e&&n.set(d),St.free(d)),St.free(c),o&&n.transform(g),l},e.Fj=function(){for(var a=this.O.s,b=a.length,t=0;t<b;t++)a[t].Fj();qs.prototype.Fj.call(this)},e.v=function(a){if(!pa(this)){qs.prototype.v.call(this,a),a=null,this.na!==Eh.Auto&&this.na!==Eh.Link||(a=this.Qb());for(var b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e];if((n===a||n.isPanelMain)&&n.v(!0),!n.desiredSize.w()){var o=sa(n,!1);(n instanceof Fc||n instanceof Eh||n instanceof Yl||o!==Ss)&&n.v(!0)}}}},e.Tj=function(){if(!pa(this)){ga(this,!0),ya(this,!0);for(var a=this.O.s,b=a.length,t=0;t<b;t++)a[t].Tj()}},e.Tk=function(){if(0!=(2048&this.l)==!1){fa(this,!0),da(this,!0);for(var a=this.O.s,b=a.length,t=0;t<b;t++)a[t].Wu()}},e.Wu=function(){da(this,!0);for(var a=this.O.s,b=a.length,t=0;t<b;t++)a[t].Wu()},e.Vl=function(a,b,t,e){var n=this.jg;n.h(0,0,0,0);var o=this.desiredSize,g=this.minSize;void 0===t&&(t=g.width,e=g.height),t=Math.max(t,g.width),e=Math.max(e,g.height);var r=this.maxSize;isNaN(o.width)||(a=Math.min(o.width,r.width)),isNaN(o.height)||(b=Math.min(o.height,r.height)),a=Math.max(t,a),b=Math.max(e,b);var h=this.zb;a=Math.max(a-h.left-h.right,0),b=Math.max(b-h.top-h.bottom,0);var l=this.O.s;0!==l.length&&this.na.measure(this,a,b,l,n,t,e),a=n.width+h.left+h.right,h=n.height+h.top+h.bottom,isFinite(o.width)&&(a=o.width),isFinite(o.height)&&(h=o.height),a=Math.min(r.width,a),h=Math.min(r.height,h),a=Math.max(g.width,a),h=Math.max(g.height,h),qt(n,a=Math.max(t,a),h=Math.max(e,h)),qt(this.naturalBounds,a,h),this.Ge(0,0,a,h)},e.Qb=function(){if(null===this.$g){var a=this.O.s,b=a.length;if(0===b)return null;for(var t=0;t<b;t++){var e=a[t];if(!0===e.isPanelMain)return this.$g=e}this.$g=a[0]}return this.$g},e.eh=function(a,b,t,e){var n=this.O.s;if(this.actualBounds.h(a,b,t,e),0!==n.length){if(!this.desiredSize.w()){a=sa(this,!0);var o=this.measuredBounds;b=o.width,o=o.height;var g=this.Kg,r=g.left+g.right;switch(g=g.top+g.bottom,b===t&&o===e&&(a=Ss),a){case Ss:(b>t||o>e)&&(this.v(),this.measure(b>t?t:b,o>e?e:o,0,0));break;case Ms:this.v(!0),this.measure(t+r,e+g,0,0);break;case Ns:this.v(!0),this.measure(t+r,o+g,0,0);break;case Cs:this.v(!0),this.measure(b+r,e+g,0,0)}}this.na.arrange(this,n,this.jg)}},e.gh=function(a){var b=this.naturalBounds,t=qh(this);if(Qt(0,0,b.width,b.height,a.x,a.y)){for(var e=(b=this.O.s).length,n=St.allocAt(0,0);e--;){var o=b[e];if((o.visible||o===t)&&(Tt(n.set(a),o.transform),o.ca(n)))return St.free(n),!0}return St.free(n),null!==this.Ma||null!==this.areaBackground}return!1},e.js=function(a){if(this.bindingId===a)return this;for(var b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e].js(a);if(null!==n)return n}return null},e.pm=function(a,b){if(b(this,a),a instanceof Eh)for(var t=(a=a.O.s).length,e=0;e<t;e++)this.pm(a[e],b)},e.Ml=function(a){return Zh(this,this,a)},e.fb=function(a){if(this.name===a)return this;var b=this.O.s,t=b.length;null===this.Hh&&null===this.itemTemplateMap||(t=hl(this));for(var e=0;e<t;e++){var n=b[e];if(n instanceof Eh){var o=n.fb(a);if(null!==o)return o}if(n.name===a)return n}return null},e.se=function(){return!(this.type===Eh.TableRow||this.type===Eh.TableColumn)},e.jc=function(a,b,t){if(!1===this.pickable)return null;if(void 0===b&&(b=null),void 0===t&&(t=null),ma(this))return null;var e=this.naturalBounds,n=1/this.Df(),o=this.se(),g=o?a:Tt(St.allocAt(a.x,a.y),this.transform),r=this.diagram,h=10,l=5;if(null!==r&&(l=(h=r.Pl("extraTouchArea"))/2),Qt(-l*n,-l*n,e.width+h*n,e.height+h*n,g.x,g.y)){if(!this.isAtomic){var c=(n=this.O.s).length;if(r=St.alloc(),l=(h=this.isClipping&&this.na===Eh.Spot)?this.Qb():null,h&&(l.se()?Tt(r.set(a),l.transform):r.set(a),!l.ca(r)))return St.free(r),o||St.free(g),null;for(var f=qh(this);c--;){var p=n[c];if((p.visible||p===f)&&(p.se()?Tt(r.set(a),p.transform):r.set(a),!h||p!==l)){var q=null;if(p instanceof Eh?q=p.jc(r,b,t):!0===p.pickable&&p.ca(r)&&(q=p),null!==q&&(null!==b&&(q=b(q)),null!==q&&(null===t||t(q))))return St.free(r),o||St.free(g),q}}St.free(r)}return null===this.background&&null===this.areaBackground?(o||St.free(g),null):(a=Qt(0,0,e.width,e.height,g.x,g.y)?this:null,o||St.free(g),a)}return o||St.free(g),null},e.ji=function(a,b,t,e){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var n=this.naturalBounds,o=this.se(),g=o?a:Tt(St.allocAt(a.x,a.y),this.transform);if(n=Qt(0,0,n.width,n.height,g.x,g.y),$h(this)||n){if(!this.isAtomic){for(var r=this.O.s,h=r.length,l=St.alloc(),c=qh(this);h--;){var f=r[h];if(f.visible||f===c){f.se()?Tt(l.set(a),f.transform):l.set(a);var p=f;(null!==(f=f instanceof Eh?f:null)?f.ji(l,b,t,e):p.ca(l))&&!1!==p.pickable&&(null!==b&&(p=b(p)),null===p||null!==t&&!t(p)||e.add(p))}}St.free(l)}return o||St.free(g),n&&(null!==this.background||null!==this.areaBackground)}return o||St.free(g),!1},e.Cf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=Ze.alloc()).reset(),g.multiply(this.transform),this.fh(a,g))return Qh(this,b,t,n),void 0===o&&Ze.free(g),!0;if(this.Yc(a,g)){if(!this.isAtomic)for(var r=qh(this),h=this.O.s,l=h.length;l--;){var c=h[l];if(c.visible||c===r){var f=c.actualBounds,p=this.naturalBounds;f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height||(f=c,c=c instanceof Eh?c:null,(p=Ze.alloc()).set(g),(null!==c?c.Cf(a,b,t,e,n,p):Ws(f,a,e,p))&&(null!==b&&(f=b(f)),null===f||null!==t&&!t(f)||n.add(f)),Ze.free(p))}}return void 0===o&&Ze.free(g),e}return void 0===o&&Ze.free(g),!1},e.og=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===t&&(t=null),void 0===e&&(e=null);var g=this.naturalBounds,r=this.se(),h=r?a:Tt(St.allocAt(a.x,a.y),this.transform),l=r?b:Tt(St.allocAt(b.x,b.y),this.transform),c=h.Bf(l),f=0<h.x&&h.x<g.width&&0<h.y&&h.y<g.height||Lt(h.x,h.y,0,0,0,g.height)<=c||Lt(h.x,h.y,0,g.height,g.width,g.height)<=c||Lt(h.x,h.y,g.width,g.height,g.width,0)<=c||Lt(h.x,h.y,g.width,0,0,0)<=c;if(g=h.zd(0,0)<=c&&h.zd(0,g.height)<=c&&h.zd(g.width,0)<=c&&h.zd(g.width,g.height)<=c,r||(St.free(h),St.free(l)),f){if(!this.isAtomic){h=St.alloc(),l=St.alloc(),c=qh(this);for(var p=this.O.s,q=p.length;q--;){var d=p[q];if(d.visible||d===c){var u=d.actualBounds,m=this.naturalBounds;r&&(u.x>m.width||u.y>m.height||0>u.x+u.width||0>u.y+u.height)||(d.se()?(u=d.transform,Tt(h.set(a),u),Tt(l.set(b),u)):(h.set(a),l.set(b)),u=d,(null!==(d=d instanceof Eh?d:null)?d.og(h,l,t,e,n,o):u.tx(h,l,n))&&(null!==t&&(u=t(u)),null===u||null!==e&&!e(u)||o.add(u)))}}St.free(h),St.free(l)}return n?f:g}return!1},e.add=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];for(t=0;t<b.length;t++)this.Hb(this.O.count,b[t]);return this},e.M=function(a){return this.O.M(a)},e.Hb=function(a,b){b instanceof zu&&T("Cannot add a Part to a Panel: "+b+"; use a Panel instead"),(this===b||this.rg(b))&&(this===b&&T("Cannot make a Panel contain itself: "+this.toString()),T("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+b.toString()));var t=b.panel;if(null!==t&&t!==this&&T("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+b.toString()+", already contained by "+t.toString()+", cannot be shared by this Panel: "+this.toString()),this.na!==Eh.Grid||b instanceof Ll||T("Can only add Shapes to a Grid Panel, not: "+b),this.na!==Eh.Graduated||b instanceof Ll||b instanceof Yl||T("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+b),b.wi(this),b.Ng=null,null!==this.itemArray){var e=b.data;null!==e&&"object"==typeof e&&(null===this.ge&&(this.ge=new Mt),this.ge.add(e,b))}var n=this.O;if(e=-1,t===this){for(var o=-1,g=this.O.s,r=g.length,h=0;h<r;h++)if(g[h]===b){o=h;break}if(-1!==o){if(o===a||o+1>=n.count&&a>=n.count)return;n.mb(o),e=o}else T("element "+b.toString()+" has panel "+t.toString()+" but is not contained by it.")}(0>a||a>n.count)&&(a=n.count),n.Hb(a,b),(0===a||b.isPanelMain)&&(this.$g=null),pa(this)||this.v(),b.v(!1),(null!==b.portId||b instanceof Eh&&!0===b.Te)&&(this.Te=!0),this.graduatedIntervals=null,this.If()||ml(this,b,!1),null!==(t=this.part)&&(t.Rh=null,t.ag=NaN,this.Te&&t instanceof uc&&(t.Te=!0),t.Te&&t instanceof uc&&(t.wc=null),null!==(n=this.diagram)&&n.undoManager.isUndoingRedoing||(-1!==e&&t.cb(Si,"elements",this,b,null,e,null),t.cb(Mi,"elements",this,null,b,null,a)))},e.remove=function(a){for(var b=this.O.s,t=b.length,e=-1,n=0;n<t;n++)if(b[n]===a){e=n;break}-1!==e&&this.qc(e,!0)},e.mb=function(a){0<=a&&this.qc(a,!0)},e.qc=function(a,b){var t=this.O,e=t.M(a);if(e.Ng=null,e.wi(null),null!==this.ge){var n=e.data;"object"==typeof n&&this.ge.remove(n)}t.mb(a),ga(this,!1),this.v(),this.$g===e&&(this.$g=null),this.graduatedIntervals=null;var o=this.part;null!==o&&(o.Rh=null,o.ag=NaN,o.Xb(),o instanceof uc&&(e instanceof Eh?e.pm(e,(function(a,t){xc(o,t,b)})):xc(o,e,b)),null!==(t=this.diagram)&&t.undoManager.isUndoingRedoing||o.cb(Si,"elements",this,e,null,a,null))},e.Gb=function(a){0>a&&A(a,">= 0",Eh,"getRowDefinition:idx"),a=Math.round(a);var b=this.rowDefs;if(void 0===b[a]){var t=new Ml;t.wi(this),t.isRow=!0,t.index=a,b[a]=t,this.cb(Mi,"rowdefs",this,null,t,null,a)}return b[a]},e.oA=function(a){if(0>a&&A(a,">= 0",Eh,"removeRowDefinition:idx"),0!==this.rowCount){a=Math.round(a);var b=this.rowDefs,t=b[a];if(t){b[a]=void 0;for(var e=b.length-1;0<=e&&void 0===b[e--];)b.length--;this.cb(Si,"rowdefs",this,t,null,a,null),this.v()}}},e.Fb=function(a){0>a&&A(a,">= 0",Eh,"getColumnDefinition:idx"),a=Math.round(a);var b=this.colDefs;if(void 0===b[a]){var t=new Ml;t.wi(this),t.isRow=!1,t.index=a,b[a]=t,this.cb(Mi,"coldefs",this,null,t,null,a)}return b[a]},e.jA=function(a){if(0>a&&A(a,">= 0",Eh,"removeColumnDefinition:idx"),0!==this.columnCount){a=Math.round(a);var b=this.colDefs,t=b[a];if(t){b[a]=void 0;for(var e=b.length-1;0<=e&&void 0===b[e--];)b.length--;this.cb(Si,"coldefs",this,t,null,a,null),this.v()}}},e.Gy=function(a){var b=null;return a.isRow?b=this.Gb(a.index):a.isRow||(b=this.Fb(a.index)),b&&Sl(b,a),this},e.Hy=function(a,b){return(a=this.Gb(a))&&Sl(a,new Ml(b)),this},e.By=function(a,b){return(a=this.Fb(a))&&Sl(a,new Ml(b)),this},e.nz=function(a){if(0>a||this.type!==Eh.Table||0===this.rowCount)return-1;for(var b=0,t=this.rowDefs,e=t.length,n=this.topIndex;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},e.fz=function(a){if(0>a||this.type!==Eh.Table||0===this.columnCount)return-1;for(var b=0,t=this.colDefs,e=t.length,n=this.leftIndex;n<e;n++){var o=t[n];if(void 0!==o&&a<(b+=o.total))break}return n},e.Fz=function(a,b){if(void 0===b&&(b=new St(NaN,NaN)),this.type!==Eh.Graduated)return b.h(NaN,NaN),b;a=Math.min(Math.max(a,this.graduatedMin),this.graduatedMax);var t=this.Qb();return t.geometry.Pu((a-this.graduatedMin)/this.graduatedRange,b),t.transform.Ga(b)},e.Gz=function(a){if(this.type!==Eh.Graduated)return NaN;var b=this.Qb();return b.transform.Cd(a),b.geometry.xx(a)*this.graduatedRange+this.graduatedMin},e.Uy=function(a){void 0===a&&(a=!1);var b=this.copy();return Wh(b,(function(a){a instanceof Eh&&(a.allBindings=null,a.ub=null);var b=a.localBindings;null!==b&&(a.localBindings=null,b.each((function(b){a.bind(b.copy())}))),null!==(b=a.animationTriggers)&&(a.animationTriggers=null,b.each((function(b){a.Jv(b.value.copy())})))})),a&&al(b),b},e.La=function(a){var b=this.allBindings;if(null!==b)for(void 0===a&&(a=""),b=b.iterator;b.next();){var t=b.value,e=t.sourceProperty;if((""===a||""===e||e===a)&&(e=t.targetProperty,null!==t.converter||""!==e)){e=this.data;var n=t.sourceName;if(null!==n){if(""===n)e=this;else if("/"===n)e=this;else if("."===n)e=this;else if(".."===n)e=this;else if(null===(e=this.fb(n)))continue}else if(t.isToModel){if(null===(e=this.diagram))continue;e=e.model.modelData}var o=this,g=t.Ai;if(-1!==g){if(null===(o=this.js(g)))continue}else null!==t.xd&&(o=t.xd);if("/"===n?e=o.part:"."===n?e=o:".."===n&&(e=o.panel),0!==(n=t.so)){if(!(o instanceof Eh))continue;1===n?o=o.Fb(t.vl):2===n&&(o=o.Gb(t.vl))}void 0!==o&&t.Mv(o,e)}}},e.sx=function(a){return null==a||null===this.ge?null:this.ge.I(a)},e.mv=function(){for(var a=hl(this);this.O.length>a;)this.qc(this.O.length-1,!1);ll(this,this.itemArray)},v.Object.defineProperties(Eh.prototype,{type:{get:function(){return this.na},set:function(a){var b=this.na;b!==a&&(this.na=a,this.isAtomic=this.na===Eh.Grid,this.v(),this.g("type",b,a))}},elements:{get:function(){return this.O.iterator}},naturalBounds:{get:function(){return this.ec}},padding:{get:function(){return this.zb},set:function(a){"number"==typeof a?(0>a&&A(a,">= 0",Eh,"padding"),a=new oe(a)):(0>a.left&&A(a.left,">= 0",Eh,"padding:value.left"),0>a.right&&A(a.right,">= 0",Eh,"padding:value.right"),0>a.top&&A(a.top,">= 0",Eh,"padding:value.top"),0>a.bottom&&A(a.bottom,">= 0",Eh,"padding:value.bottom"));var b=this.zb;b.D(a)||(this.zb=a=a.J(),this.v(),this.g("padding",b,a))}},defaultAlignment:{get:function(){return this.Sm},set:function(a){var b=this.Sm;b.D(a)||(this.Sm=a=a.J(),this.v(),this.g("defaultAlignment",b,a))}},defaultStretch:{get:function(){return this.Uf},set:function(a){var b=this.Uf;b!==a&&(this.Uf=a,this.v(),this.g("defaultStretch",b,a))}},defaultSeparatorPadding:{get:function(){return null!==this.T?this.T.Pp:Ge},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.defaultSeparatorPadding;b.D(a)||(a=a.J(),null===this.T&&(this.T=new kl),this.T.Pp=a,this.v(),this.g("defaultSeparatorPadding",b,a))}},defaultRowSeparatorStroke:{get:function(){return null!==this.T?this.T.ia:null},set:function(a){var b=this.defaultRowSeparatorStroke;b!==a&&(null===a||"string"==typeof a||a instanceof Ha)&&(a instanceof Ha&&a.freeze(),null===this.T&&(this.T=new kl),this.T.ia=a,this.N(),this.g("defaultRowSeparatorStroke",b,a))}},defaultRowSeparatorStrokeWidth:{get:function(){return null!==this.T?this.T.Ha:1},set:function(a){var b=this.defaultRowSeparatorStrokeWidth;b!==a&&isFinite(a)&&0<=a&&(null===this.T&&(this.T=new kl),this.T.Ha=a,this.v(),this.g("defaultRowSeparatorStrokeWidth",b,a))}},defaultRowSeparatorDashArray:{get:function(){return null!==this.T?this.T.V:null},set:function(a){var b=this.defaultRowSeparatorDashArray;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||T("defaultRowSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}null===this.T&&(this.T=new kl),this.T.V=a,this.N(),this.g("defaultRowSeparatorDashArray",b,a)}}},defaultColumnSeparatorStroke:{get:function(){return null!==this.T?this.T.u:null},set:function(a){var b=this.defaultColumnSeparatorStroke;b!==a&&(null===a||"string"==typeof a||a instanceof Ha)&&(a instanceof Ha&&a.freeze(),null===this.T&&(this.T=new kl),this.T.u=a,this.N(),this.g("defaultColumnSeparatorStroke",b,a))}},defaultColumnSeparatorStrokeWidth:{get:function(){return null!==this.T?this.T.F:1},set:function(a){var b=this.defaultColumnSeparatorStrokeWidth;b!==a&&isFinite(a)&&0<=a&&(null===this.T&&(this.T=new kl),this.T.F=a,this.v(),this.g("defaultColumnSeparatorStrokeWidth",b,a))}},defaultColumnSeparatorDashArray:{get:function(){return null!==this.T?this.T.o:null},set:function(a){var b=this.defaultColumnSeparatorDashArray;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||T("defaultColumnSeparatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}null===this.T&&(this.T=new kl),this.T.o=a,this.N(),this.g("defaultColumnSeparatorDashArray",b,a)}}},inRowsCols:{get:function(){return null!==this.T?this.T.nb:null},set:function(a){null===this.T&&(this.T=new kl),this.T.nb=a}},viewboxStretch:{get:function(){return this.wo},set:function(a){var b=this.wo;b!==a&&(this.wo=a,this.v(),this.g("viewboxStretch",b,a))}},gridCellSize:{get:function(){return this.hn},set:function(a){var b=this.hn;if(!b.D(a)){a.w()&&0!==a.width&&0!==a.height||T("Invalid Panel.gridCellSize: "+a),this.hn=a.J();var t=this.diagram;null!==t&&this===t.grid&&Lr(t),this.N(),this.g("gridCellSize",b,a)}}},gridOrigin:{get:function(){return this.jn},set:function(a){var b=this.jn;if(!b.D(a)){a.w()||T("Invalid Panel.gridOrigin: "+a),this.jn=a.J();var t=this.diagram;null!==t&&this===t.grid&&Lr(t),this.N(),this.g("gridOrigin",b,a)}}},graduatedMin:{get:function(){return null!==this.ra?this.ra.kq:0},set:function(a){var b=this.graduatedMin;b!==a&&(null===this.ra&&(this.ra=new wl),this.ra.kq=a,this.v(),this.g("graduatedMin",b,a),ua(this)&&(null!==(a=this.part)&&Hs(this,a,"graduatedRange")))}},graduatedMax:{get:function(){return null!==this.ra?this.ra.F:100},set:function(a){var b=this.graduatedMax;b!==a&&(null===this.ra&&(this.ra=new wl),this.ra.F=a,this.v(),this.g("graduatedMax",b,a),ua(this)&&(null!==(a=this.part)&&Hs(this,a,"graduatedRange")))}},graduatedRange:{get:function(){return this.graduatedMax-this.graduatedMin}},graduatedTickUnit:{get:function(){return null!==this.ra?this.ra.ia:10},set:function(a){var b=this.graduatedTickUnit;b!==a&&0<a&&(null===this.ra&&(this.ra=new wl),this.ra.ia=a,this.v(),this.g("graduatedTickUnit",b,a))}},graduatedTickBase:{get:function(){return null!==this.ra?this.ra.V:0},set:function(a){var b=this.graduatedTickBase;b!==a&&(null===this.ra&&(this.ra=new wl),this.ra.V=a,this.v(),this.g("graduatedTickBase",b,a))}},graduatedMarks:{get:function(){return null!==this.ra?this.ra.u:null},set:function(a){null!==this.ra?this.ra.u=a:null!==a&&(this.ra=new wl,this.ra.u=a)}},graduatedBounds:{get:function(){return null!==this.ra?this.ra.j:null},set:function(a){null!==this.ra?this.ra.j=a:null!==a&&(this.ra=new wl,this.ra.j=a)}},graduatedIntervals:{get:function(){return null!==this.ra?this.ra.o:null},set:function(a){null!==this.ra?this.ra.o=a:null!==a&&(this.ra=new wl,this.ra.o=a)}},temporaryTextBlock:{get:function(){return null!==this.ra?this.ra.Zh:null},set:function(a){null!==this.ra?this.ra.Zh=a:null!==a&&(this.ra=new wl,this.ra.Zh=a)}},panelLayoutState:{get:function(){return this.F},set:function(a){this.F=a}},Te:{get:function(){return 0!=(8388608&this.l)},set:function(a){0!=(8388608&this.l)!==a&&(this.l^=8388608)}},rowDefs:{get:function(){return null===this.T&&(this.T=new kl),this.T.Pc}},rowCount:{get:function(){return null===this.T?0:this.rowDefs.length}},colDefs:{get:function(){return null===this.T&&(this.T=new kl),this.T.Oc}},columnCount:{get:function(){return null===this.T?0:this.colDefs.length}},rowSizing:{get:function(){return null!==this.T?this.T.ob:Tl},set:function(a){var b=this.rowSizing;b!==a&&(null===this.T&&(this.T=new kl),this.T.ob=a,this.v(),this.g("rowSizing",b,a))}},columnSizing:{get:function(){return null!==this.T?this.T.j:Tl},set:function(a){var b=this.columnSizing;b!==a&&(null===this.T&&(this.T=new kl),this.T.j=a,this.v(),this.g("columnSizing",b,a))}},topIndex:{get:function(){return null!==this.T?this.T.Ib:0},set:function(a){var b=this.topIndex;b!==a&&((!isFinite(a)||0>a)&&T("Panel.topIndex must be greater than zero and a real number, not: "+a),null===this.T&&(this.T=new kl),this.T.Ib=a,this.v(),this.g("topIndex",b,a))}},leftIndex:{get:function(){return null!==this.T?this.T.hb:0},set:function(a){var b=this.leftIndex;b!==a&&((!isFinite(a)||0>a)&&T("Panel.leftIndex must be greater than zero and a real number, not: "+a),null===this.T&&(this.T=new kl),this.T.hb=a,this.v(),this.g("leftIndex",b,a))}},data:{get:function(){return this.ub},set:function(a){var b=this.ub;if(b!==a){var t=this instanceof zu&&!(this instanceof hc);al(this),this.ub=a;var e=this.diagram;null!==e&&(t?(t=e.partManager,this instanceof Oc?(null!==b&&t.bf.remove(b),null!==a&&t.bf.add(a,this)):this instanceof zu&&(null!==b&&t.cf.remove(b),null!==a&&t.cf.add(a,this))):null!==(t=this.panel)&&null!==t.ge&&(null!==b&&t.ge.remove(b),null!==a&&t.ge.add(a,this))),this.g("data",b,a),null!==e&&e.undoManager.isUndoingRedoing||null!==a&&this.La()}}},itemIndex:{get:function(){return this.yn},set:function(a){var b=this.yn;b!==a&&(this.yn=a,this.g("itemIndex",b,a))}},allBindings:{get:function(){return null!==this.A?this.A.nb:null},set:function(a){this.localBindings!==a&&(null===this.A&&(this.A=new dl),this.A.nb=a)}},itemArray:{get:function(){return this.Hh},set:function(a){var b=this.Hh;if(b!==a||null!==a&&function(a,b){for(var t=(a=a.O.s).length,e=b.length,n=0,o=null;n<t&&!((o=a[n])instanceof Eh&&null!==o.data);)o=a[++n];if(t-n!==e)return!0;if(null===o)return 0<e;for(var g=0;n<t&&g<e;){if(!((o=a[n])instanceof Eh)||o.data!==b[g])return!0;n++,g++}return!1}(this,a)){var t=this.diagram;b!==a&&(null!==t&&null!==b&&xd(t.partManager,this,t),this.Hh=a,null!==t&&null!==a&&vd(t.partManager,this)),this.g("itemArray",b,a),null!==t&&t.undoManager.isUndoingRedoing||ll(this,a)}}},itemTemplate:{get:function(){return null===this.itemTemplateMap?null:this.itemTemplateMap.I("")},set:function(a){if(null===this.itemTemplateMap){if(null===a)return;this.itemTemplateMap=new Mt}var b=this.itemTemplateMap.I("");b!==a&&((a instanceof zu||a.isPanelMain)&&T("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+a),this.itemTemplateMap.add("",a),this.g("itemTemplate",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.mv())}},itemTemplateMap:{get:function(){return null!==this.A?this.A.Pc:null},set:function(a){var b=this.itemTemplateMap;if(b!==a){for(var t=a.iterator;t.next(););Ks(this),this.A.Pc=a,this.g("itemTemplateMap",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.mv()}}},itemCategoryProperty:{get:function(){return null!==this.A?this.A.Oc:"category"},set:function(a){var b=this.itemCategoryProperty;b!==a&&(Ks(this),this.A.Oc=a,this.g("itemCategoryProperty",b,a))}},isAtomic:{get:function(){return 0!=(1048576&this.l)},set:function(a){var b=0!=(1048576&this.l);b!==a&&(this.l^=1048576,this.g("isAtomic",b,a))}},isClipping:{get:function(){return 0!=(2097152&this.l)},set:function(a){var b=0!=(2097152&this.l);b!==a&&(this.l^=2097152,this instanceof Cc&&(this.tb=null),this.v(),this.g("isClipping",b,a))}},isOpposite:{get:function(){return 0!=(33554432&this.l)},set:function(a){var b=0!=(33554432&this.l);b!==a&&(this.l^=33554432,this.v(),this.g("isOpposite",b,a))}},isEnabled:{get:function(){return 0!=(4194304&this.l)},set:function(a){var b=0!=(4194304&this.l);if(b!==a){var t=null===this.panel||this.panel.If();this.l^=4194304,this.g("isEnabled",b,a),null!==(b=this.diagram)&&b.undoManager.isUndoingRedoing||t&&ml(this,this,a)}}},alignmentFocusName:{get:function(){return this.$e},set:function(a){var b=this.$e;b!==a&&(this.$e=a,this.v(),this.g("alignmentFocusName",b,a))}}}),v.Object.defineProperties(Eh,{Position:{get:function(){return bl.I("Position")}},Horizontal:{get:function(){return bl.I("Horizontal")}},Vertical:{get:function(){return bl.I("Vertical")}},Spot:{get:function(){return bl.I("Spot")}},Auto:{get:function(){return bl.I("Auto")}},Table:{get:function(){return bl.I("Table")}},Viewbox:{get:function(){return bl.I("Viewbox")}},TableRow:{get:function(){return bl.I("TableRow")}},TableColumn:{get:function(){return bl.I("TableColumn")}},Link:{get:function(){return bl.I("Link")}},Grid:{get:function(){return bl.I("Grid")}},Graduated:{get:function(){return bl.I("Graduated")}}}),Eh.prototype.rebuildItemElements=Eh.prototype.mv,Eh.prototype.findItemPanelForData=Eh.prototype.sx,Eh.prototype.updateTargetBindings=Eh.prototype.La,Eh.prototype.copyTemplate=Eh.prototype.Uy,Eh.prototype.graduatedValueForPoint=Eh.prototype.Gz,Eh.prototype.graduatedPointForValue=Eh.prototype.Fz,Eh.prototype.findColumnForLocalX=Eh.prototype.fz,Eh.prototype.findRowForLocalY=Eh.prototype.nz,Eh.prototype.addColumnDefinition=Eh.prototype.By,Eh.prototype.addRowDefinition=Eh.prototype.Hy,Eh.prototype.addRowColumnDefinition=Eh.prototype.Gy,Eh.prototype.removeColumnDefinition=Eh.prototype.jA,Eh.prototype.getColumnDefinition=Eh.prototype.Fb,Eh.prototype.removeRowDefinition=Eh.prototype.oA,Eh.prototype.getRowDefinition=Eh.prototype.Gb,Eh.prototype.removeAt=Eh.prototype.mb,Eh.prototype.remove=Eh.prototype.remove,Eh.prototype.insertAt=Eh.prototype.Hb,Eh.prototype.elt=Eh.prototype.M,Eh.prototype.add=Eh.prototype.add,Eh.prototype.findObject=Eh.prototype.fb,Eh.prototype.findInVisualTree=Eh.prototype.Ml,Eh.prototype.walkVisualTreeFrom=Eh.prototype.pm,Eh.prototype.findMainElement=Eh.prototype.Qb;var vl=!1,xl=null,bl=new Mt;function wl(){this.kq=0,this.F=100,this.ia=10,this.V=0,this.Zh=this.o=this.j=this.u=null}function kl(){this.Pc=[],this.Oc=[],this.j=this.ob=Tl,this.hb=this.Ib=0,this.Pp=Ge,this.Ha=1,this.V=this.ia=null,this.F=1,this.nb=this.o=this.u=null}function Ml(a){ht(this),this.Me=null,this.tq=!0,this.Za=0,this.Hc=NaN,this.jj=0,this.hj=1/0,this.Kb=Fe,this.pa=this.pc=this.oa=0,this.be=null,this.no=Nl,this.hg=Ts,this.ko=this.dg=null,this.lo=NaN,this.Ma=this.tj=null,this.Om=!1,a&&(Object.assign(this,a),void 0!==a.column?(this.isRow=!1,this.index=a.column):void 0!==a.row&&(this.isRow=!0,this.index=a.row))}function Sl(a,b){b.isRow?a.height=b.height:a.width=b.width,a.minimum=b.minimum,a.maximum=b.maximum,a.alignment=b.alignment,a.stretch=b.stretch,a.sizing=b.sizing,a.dg=null===b.separatorPadding?null:b.separatorPadding.J(),a.separatorStroke=b.separatorStroke,a.separatorStrokeWidth=b.separatorStrokeWidth,a.tj=null,b.separatorDashArray&&(a.tj=B(b.separatorDashArray)),a.background=b.background,a.coversSeparators=b.coversSeparators,a.be=b.be}function Pl(a){if(a.sizing===Nl){var b=a.Me;return a.isRow?b.rowSizing:b.columnSizing}return a.sizing}Eh.className="Panel",Eh.definePanelLayout=yl,yl("Position",new Sh),yl("Vertical",new Nh),yl("Auto",new Lh),yl("Link",new Ih),wl.prototype.copy=function(){var a=new wl;return a.kq=this.kq,a.F=this.F,a.ia=this.ia,a.V=this.V,a.u=this.u,a.j=this.j,a.o=this.o,a.Zh=this.Zh,a},wl.className="GradPanelSettings",kl.prototype.copy=function(a){for(var b=new kl,t=this.Pc,e=t.length,n=b.Pc,o=0;o<e;o++)if(void 0!==t[o]){var g=t[o].copy();g.wi(a),n[o]=g}for(e=(t=this.Oc).length,n=b.Oc,o=0;o<e;o++)void 0!==t[o]&&((g=t[o].copy()).wi(a),n[o]=g);return b.ob=this.ob,b.j=this.j,b.Ib=this.Ib,b.hb=this.hb,b.Pp=this.Pp.J(),b.Ha=this.Ha,b.ia=this.ia,b.V=this.V,b.F=this.F,b.u=this.u,b.o=this.o,b.nb=this.nb,b},kl.className="TablePanelSettings",Ml.prototype.copy=function(){var a=new Ml;return a.tq=this.tq,a.Za=this.Za,a.Hc=this.Hc,a.jj=this.jj,a.hj=this.hj,a.Kb=this.Kb,a.oa=this.oa,a.pc=this.pc,a.pa=this.pa,a.hg=this.hg,a.no=this.no,null===this.dg?a.dg=null:a.dg=this.dg.J(),a.ko=this.ko,a.lo=this.lo,a.tj=null,null!==this.tj&&(a.separatorDashArray=B(this.separatorDashArray)),a.Ma=this.Ma,a.Om=this.Om,a.be=this.be,a},(e=Ml.prototype).qb=function(a){a.classType===Ml&&(this.sizing=a)},e.toString=function(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+ut(this)},e.wi=function(a){this.Me=a},e.Ho=function(a){var b=0,t=this.Me;if(this.index!==a&&(null===(a=this.separatorStroke)&&null!==t&&(a=this.isRow?t.defaultRowSeparatorStroke:t.defaultColumnSeparatorStroke),null!==a&&(b=this.separatorStrokeWidth,isNaN(b)&&(b=null!==t?this.isRow?t.defaultRowSeparatorStrokeWidth:t.defaultColumnSeparatorStrokeWidth:0))),null===(a=this.dg)){if(null===t)return b;a=t.defaultSeparatorPadding}return b+(this.isRow?a.top:a.left)},e.Wc=function(){var a=0,b=this.Me,t=0,e=this.isRow;if(null!==b&&b.type===Eh.Table)for(var n=e?b.rowDefs.length:b.colDefs.length,o=0;o<n;o++){var g=e?b.rowDefs[o]:b.colDefs[o];if(void 0!==g&&0!==g.oa){t=g.index;break}}if(this.index!==t&&(null===(t=this.separatorStroke)&&null!==b&&(t=e?b.defaultRowSeparatorStroke:b.defaultColumnSeparatorStroke),null!==t&&(a=this.separatorStrokeWidth,isNaN(a)&&(a=null!==b?e?b.defaultRowSeparatorStrokeWidth:b.defaultColumnSeparatorStrokeWidth:0))),null===(e=this.dg)){if(null===b)return a;e=b.defaultSeparatorPadding}return a+(this.isRow?e.top+e.bottom:e.left+e.right)},e.Pb=function(a,b,t){var e=this.Me;if(null!==e&&(e.cb(ki,a,this,b,t,void 0,void 0),null!==this.be&&(null!==(b=e.diagram)&&!b.skipsModelSourceBindings&&(null!==(e=e.ih())&&null!==(b=e.data)))))for(t=this.be.iterator;t.next();)t.value.rp(this,b,a,e)},e.bind=function(a,b,t,e){var n=null;return(n="string"==typeof a?new tp(a,b,t,e):a).xd=this,null!==(a=this.panel)&&(null!==(b=a.ih())&&sl(b)&&T("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+n+" on "+a)),null===this.be&&(this.be=new ot),this.be.add(n),this},v.Object.defineProperties(Ml.prototype,{panel:{get:function(){return this.Me}},isRow:{get:function(){return this.tq},set:function(a){this.tq=a}},index:{get:function(){return this.Za},set:function(a){this.Za=a}},height:{get:function(){return this.Hc},set:function(a){var b=this.Hc;b!==a&&(0>a&&A(a,">= 0",Ml,"height"),this.Hc=a,this.actual=this.oa,null!==this.panel&&this.panel.v(),this.Pb("height",b,a))}},width:{get:function(){return this.Hc},set:function(a){var b=this.Hc;b!==a&&(0>a&&A(a,">= 0",Ml,"width"),this.Hc=a,this.actual=this.oa,null!==this.panel&&this.panel.v(),this.Pb("width",b,a))}},minimum:{get:function(){return this.jj},set:function(a){var b=this.jj;b!==a&&((0>a||!isFinite(a))&&A(a,">= 0",Ml,"minimum"),this.jj=a,this.actual=this.oa,null!==this.panel&&this.panel.v(),this.Pb("minimum",b,a))}},maximum:{get:function(){return this.hj},set:function(a){var b=this.hj;b!==a&&(0>a&&A(a,">= 0",Ml,"maximum"),this.hj=a,this.actual=this.oa,null!==this.panel&&this.panel.v(),this.Pb("maximum",b,a))}},alignment:{get:function(){return this.Kb},set:function(a){var b=this.Kb;b.D(a)||(this.Kb=a.J(),null!==this.panel&&this.panel.v(),this.Pb("alignment",b,a))}},stretch:{get:function(){return this.hg},set:function(a){var b=this.hg;b!==a&&(this.hg=a,null!==this.panel&&this.panel.v(),this.Pb("stretch",b,a))}},separatorPadding:{get:function(){return this.dg},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.dg;null!==a&&null!==b&&b.D(a)||(null!==a&&(a=a.J()),this.dg=a,null!==this.panel&&this.panel.v(),this.Pb("separatorPadding",b,a))}},separatorStroke:{get:function(){return this.ko},set:function(a){var b=this.ko;b!==a&&(null!==a&&sh(a,"RowColumnDefinition.separatorStroke"),a instanceof Ha&&a.freeze(),this.ko=a,null!==this.panel&&this.panel.v(),this.Pb("separatorStroke",b,a))}},separatorStrokeWidth:{get:function(){return this.lo},set:function(a){var b=this.lo;b!==a&&(this.lo=a,null!==this.panel&&this.panel.v(),this.Pb("separatorStrokeWidth",b,a))}},separatorDashArray:{get:function(){return this.tj},set:function(a){var b=this.tj;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];"number"==typeof o&&0<=o&&isFinite(o)||T("separatorDashArray value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.tj=a,null!==this.panel&&this.panel.N(),this.Pb("separatorDashArray",b,a)}}},background:{get:function(){return this.Ma},set:function(a){var b=this.Ma;b!==a&&(null!==a&&sh(a,"RowColumnDefinition.background"),a instanceof Ha&&a.freeze(),this.Ma=a,null!==this.panel&&this.panel.N(),this.Pb("background",b,a))}},coversSeparators:{get:function(){return this.Om},set:function(a){var b=this.Om;b!==a&&(this.Om=a,null!==this.panel&&this.panel.N(),this.Pb("coversSeparators",b,a))}},sizing:{get:function(){return this.no},set:function(a){var b=this.no;b!==a&&(this.no=a,null!==this.panel&&this.panel.v(),this.Pb("sizing",b,a))}},actual:{get:function(){return this.oa},set:function(a){this.oa=isNaN(this.Hc)?Math.max(Math.min(this.hj,a),this.jj):Math.max(Math.min(this.hj,this.Hc),this.jj)}},measured:{get:function(){return this.pc},set:function(a){this.pc=a}},total:{get:function(){return this.oa+this.Wc()}},position:{get:function(){return this.pa},set:function(a){this.pa=a}}}),Ml.prototype.computeEffectiveSpacing=Ml.prototype.Wc,Ml.prototype.computeEffectiveSpacingTop=Ml.prototype.Ho;var Nl=new W(Ml,"Default",0),Cl=new W(Ml,"None",1),Tl=new W(Ml,"ProportionalExtra",2);function Ll(a,b){qs.call(this),this.Rd=this.ua=null,this.$m="None",this.xc=this.Ui="black",this.ig=1,this.Na=this.Yg=null,this.Un=this.Tn=NaN,this.fa=null,"string"==typeof a?this.figure=a:a&&Object.assign(this,a),b&&Object.assign(this,b)}function Al(a){null===a.Na?a.Na=new Vl:a.Na.oc&&(a.Na=a.Na.copy())}function jl(a,b,t,e){var n=t.length;if(!(4>n)){var o=e.measuredBounds,g=Math.max(1,o.width);o=o.height;for(var r,h,l,p,q,c,f=t[0],d=t[1],u=0,m=z(),y=2;y<n;y+=2)0===(l=(r=t[y])-f)&&(l=.001),p=(f=(h=t[y+1])-d)/l,q=Math.atan2(f,l),c=Math.sqrt(l*l+f*f),m.push([l,q,p,c]),u+=c,f=r,d=h;f=t[0],d=t[1],l=e.measuredBounds.width,e instanceof Ll&&(l-=e.strokeWidth),1>l&&(l=1),n=t=l,h=0!==(r=g/2),l=(c=m[y=0])[0],q=c[1],p=c[2],c=c[3];for(var v=0;.1<=u;){if(0===v&&(h?(n=t,n-=r,u-=r,h=!1):n=t,0===n&&(n=1)),n>u)return void R(m);n>c?(v=n-c,n=c):v=0;var x=Math.sqrt(n*n/(1+p*p));if(0>l&&(x=-x),f+=x,d+=p*x,a.translate(f,d),a.rotate(q),a.translate(-g/2,-o/2),0===v&&e.hh(a,b),a.translate(g/2,o/2),a.rotate(-q),a.translate(-f,-d),u-=n,c-=n,0!==v){if(++y===m.length)return void R(m);l=(c=m[y])[0],q=c[1],p=c[2],c=c[3],n=v}}R(m)}}function Fl(a){var b=a.geometryStretch;return null!==a.Rd?b===Ts?Ms:b:b===Ts?El[a.figure].defaultStretch:b}function Ol(a,b,t,e,n){return(b=(a=t.x-a)*a+(b=t.y-b)*b)<e?(n.x=t.x,n.y=t.y,b):e}function Bl(a,b,t,e,n,o,g,r,h){if($e.$(a,t)&&$e.$(b,e)||$e.$(n,g)&&$e.$(o,r))return!1;var l=!1,c=(n-g)*(b-e)-(o-r)*(a-t);return 0!==c&&(h.x=((n*r-o*g)*(a-t)-(n-g)*(a*e-b*t))/c,h.y=((n*r-o*g)*(b-e)-(o-r)*(a*e-b*t))/c,(a>t?a-t:t-a)<(b>e?b-e:e-b)?(a=b<e?b:e,b=b<e?e:b,(h.y>a||$e.$(h.y,a))&&(h.y<b||$e.$(h.y,b))&&(l=!0)):(b=a<t?a:t,a=a<t?t:a,(h.x>b||$e.$(h.x,b))&&(h.x<a||$e.$(h.x,a))&&(l=!0)),l)}function Dl(a,b,t,e){if(!a.qs(b,t,e))return!1;a=b.x,b=b.y;var n=t.x,o=t.y;return t=e.x,e=e.y,a===n?(b<o?(a=b,b=o):a=o,e>=a&&e<=b):(a<n?(e=a,a=n):e=n,t>=e&&t<=a)}function Il(a){var b=a.diagram;null!==b&&b.undoManager.isUndoingRedoing||(a.segmentOrientation=pf,"None"!==a.toArrow?(a.segmentIndex=-1,a.alignmentFocus=Ee):"None"!==a.fromArrow&&(a.segmentIndex=0,a.alignmentFocus=new qe(1-Ee.x,Ee.y)))}function zl(a){var b=Rl[a];if(void 0===b){var t=a.toLowerCase();if("none"===t)return"None";if(void 0===(b=Rl[t])){var e,n=null;for(e in $e.tm)if(e.toLowerCase()===t){n=e;break}if(null!==n)return a=Qe.parse($e.tm[n],!1),Rl[n]=a,t!==n&&(Rl[t]=n),n}}return"string"==typeof b?b:b instanceof Qe?a:null}Ml.className="RowColumnDefinition",Ml.Default=Nl,Ml.None=Cl,Ml.ProportionalExtra=Tl,y(Ll,qs),Ll.prototype.cloneProtected=function(a){qs.prototype.cloneProtected.call(this,a),a.ua=this.ua,a.Rd=this.Rd,a.$m=this.$m,a.Ui=this.Ui,a.xc=this.xc,a.ig=this.ig,null!==this.Yg&&(a.Yg=B(this.Yg)),null!==this.Na&&(a.Na=this.Na.oc?this.Na:this.Na.copy()),a.Tn=this.Tn,a.Un=this.Un,null!==this.fa&&(a.fa=this.fa.copy())},(e=Ll.prototype).th=function(){qs.prototype.th.call(this),null!==this.Na&&(this.Na.oc=!0)},e.qb=function(a){a===Ss||a===Ps||a===Ls||a===Ts?this.geometryStretch=a:qs.prototype.qb.call(this,a)},e.toString=function(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+ut(this)},e.hh=function(a,b){var t=this.xc,e=this.Ui;if(null!==t||null!==e){var n=this.ua;if(null!==n){a.yc();var o=this.actualBounds,g=this.naturalBounds;null!==e&&na(this,a,e,!0,!1,g,o);var r=this.part,h=this.ig;if(null===t||0!==h||null===r||!this.isPanelMain&&r.Qb()!==this||(h=r.type===Eh.Link&&r instanceof hc&&"Selection"===r.category&&r.adornedObject instanceof Ll&&r.adornedPart.Qb()===r.adornedObject?r.adornedObject.strokeWidth:0),0===h&&(t=null),null!==t&&0!==h&&(na(this,a,t,!1,!1,g,o),a.lineWidth=h,a.lineJoin=this.strokeJoin,a.lineCap=this.strokeCap,a.miterLimit=this.strokeMiterLimit),o=!1,r&&b.Gf("drawShadows")&&(o=r.isShadowed),!1===a.Hl&&(o=!1),r=!0,null===t||null!==e&&"transparent"!==e||(r=!1),g=!1,null!==(h=this.strokeDashArray)&&(g=!0,a.hs(h,this.strokeDashOffset)),n.type===Qe.j)a.beginPath(),a.moveTo(n.startX,n.startY),a.lineTo(n.endX,n.endY),null!==t&&a.ik(),a.Se();else if(n.type===Qe.u){var l=n.startX;h=n.startY;var c=n.endX,f=n.endY;n=Math.min(l,c);var p=Math.min(h,f);l=Math.abs(c-l),h=Math.abs(f-h),a.beginPath(),a.rect(n,p,l,h),null!==e&&a.ng(e),null!==t&&(r&&o&&ul(a),a.ik(),r&&o&&Ya(a)),a.Se()}else if(n.type===Qe.F)l=n.startX,h=n.startY,c=n.endX,f=n.endY,n=Math.abs(c-l)/2,p=Math.abs(f-h)/2,l=Math.min(l,c)+n,h=Math.min(h,f)+p,a.beginPath(),a.moveTo(l,h-p),a.bezierCurveTo(l+$e.wg*n,h-p,l+n,h-$e.wg*p,l+n,h),a.bezierCurveTo(l+n,h+$e.wg*p,l+$e.wg*n,h+p,l,h+p),a.bezierCurveTo(l-$e.wg*n,h+p,l-n,h+$e.wg*p,l-n,h),a.bezierCurveTo(l-n,h-$e.wg*p,l-$e.wg*n,h-p,l,h-p),a.closePath(),null!==e&&a.ng(e),null!==t&&(r&&o&&ul(a),a.ik(),r&&o&&Ya(a)),a.Se();else if(n.type===Qe.o)for(h=(n=n.figures).length,p=0;p<h;p++){l=n.s[p],a.beginPath(),a.moveTo(l.startX,l.startY),f=(c=l.segments.s).length;for(var q=null,d=0;d<f;d++){var u=c[d];switch(u.type){case fi:a.moveTo(u.endX,u.endY);break;case di:a.lineTo(u.endX,u.endY);break;case pi:a.bezierCurveTo(u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY);break;case gi:a.quadraticCurveTo(u.point1X,u.point1Y,u.endX,u.endY);break;case mi:if(u.radiusX===u.radiusY){var m=Math.PI/180;a.arc(u.point1X,u.point1Y,u.radiusX,u.startAngle*m,(u.startAngle+u.sweepAngle)*m,0>u.sweepAngle,null!==q?q.endX:l.startX,null!==q?q.endY:l.startY)}else if(0===(m=(q=ui(u,l)).length))a.lineTo(u.centerX,u.centerY);else for(var y=0;y<m;y++){var v=q[y];0===y&&a.lineTo(v[0],v[1]),a.bezierCurveTo(v[2],v[3],v[4],v[5],v[6],v[7])}break;case yi:if(y=m=0,null!==q&&q.type===mi){if(0===(v=(q=ui(q,l)).length)){a.lineTo(u.endX,u.endY);break}null!==(q=q[v-1]||null)&&(m=q[6],y=q[7])}else m=null!==q?q.endX:l.startX,y=null!==q?q.endY:l.startY;if(0===(m=(q=ci(u,l,m,y)).length)){a.lineTo(u.endX,u.endY);break}for(y=0;y<m;y++)v=q[y],a.bezierCurveTo(v[2],v[3],v[4],v[5],v[6],v[7]);break;default:T("Segment not of valid type: "+u.type)}u.isClosed&&a.closePath(),q=u}c=l.isFilled,o?l.isShadowed?(!0===c&&"transparent"!==e&&null!==e&&a.ng(e,l.isEvenOdd),null!==t&&(c&&r&&ul(a),a.ik(),c&&r&&Ya(a))):(ul(a),c&&"transparent"!==e&&null!==e&&a.ng(e,l.isEvenOdd),null!==t&&a.ik(),Ya(a)):(c&&null!==e&&a.ng(e,l.isEvenOdd),null!==t&&a.ik()),a.Se(p)}if(g&&a.es(),null!==this.pathPattern){if((t=this.pathPattern).measure(1/0,1/0),e=t.measuredBounds,t.arrange(0,0,e.width,e.height),o=this.geometry,a.save(),a.beginPath(),e=z(),o.type===Qe.j)e.push(o.startX),e.push(o.startY),e.push(o.endX),e.push(o.endY),jl(a,b,e,t);else if(o.type===Qe.o)for(o=o.figures.iterator;o.next();){for(r=o.value,e.length=0,e.push(r.startX),e.push(r.startY),h=g=r.startX,p=n=r.startY,c=(l=r.segments.s).length,f=0;f<c;f++){switch((d=l[f]).type){case fi:jl(a,b,e,t),e.length=0,e.push(d.endX),e.push(d.endY),h=g=d.endX,p=n=d.endY;break;case di:e.push(d.endX),e.push(d.endY),g=d.endX,n=d.endY;break;case pi:$e.Qe(g,n,d.point1X,d.point1Y,d.point2X,d.point2Y,d.endX,d.endY,.5,e),g=d.endX,n=d.endY;break;case gi:$e.cp(g,n,d.point1X,d.point1Y,d.endX,d.endY,.5,e),g=d.endX,n=d.endY;break;case mi:if(0===(q=(u=ui(d,r)).length)){e.push(d.centerX),e.push(d.centerY),g=d.centerX,n=d.centerY;break}for(m=0;m<q;m++)y=u[m],$e.Qe(g,n,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],n=y[7];break;case yi:if(0===(q=(u=ci(d,r,g,n)).length)){e.push(d.endX),e.push(d.endY),g=d.endX,n=d.endY;break}for(m=0;m<q;m++)y=u[m],$e.Qe(g,n,y[2],y[3],y[4],y[5],y[6],y[7],.5,e),g=y[6],n=y[7];break;default:T("Segment not of valid type: "+d.type)}d.isClosed&&(e.push(h),e.push(p),jl(a,b,e,t))}jl(a,b,e,t)}else if(o.type===Qe.u)e.push(o.startX),e.push(o.startY),e.push(o.endX),e.push(o.startY),e.push(o.endX),e.push(o.endY),e.push(o.startX),e.push(o.endY),e.push(o.startX),e.push(o.startY),jl(a,b,e,t);else if(o.type===Qe.F){if((n=new ai).startX=o.endX,n.startY=(o.startY+o.endY)/2,(g=new hi(mi)).startAngle=0,g.sweepAngle=360,g.centerX=(o.startX+o.endX)/2,g.centerY=(o.startY+o.endY)/2,g.radiusX=Math.abs(o.startX-o.endX)/2,g.radiusY=Math.abs(o.startY-o.endY)/2,n.add(g),0===(r=(o=ui(g,n)).length))e.push(g.centerX),e.push(g.centerY);else for(g=n.startX,n=n.startY,h=0;h<r;h++)p=o[h],$e.Qe(g,n,p[2],p[3],p[4],p[5],p[6],p[7],.5,e),g=p[6],n=p[7];jl(a,b,e,t)}R(e),a.restore(),a.Vc(!1)}}}},e.jk=function(a,b,t){return!(!qs.prototype.jk.call(this,a,b,t)||null===this.xc&&null===this.Ui||null===this.ua||null!==this.pathPattern||this.geometry.figures.length!==this.svg.getElementsByTagName("path").length)&&(a.Gl=this.svg,this.hh(a,b),a.Gl=null,!0)},e.mk=function(a){return null!==this.geometry&&1<this.geometry.figures.length||null!==this.pathPattern||qs.prototype.mk.call(this,a)},e.Dv=function(a,b){if("g"!==a.nodeName)a.setAttributeNS(null,"filter",b);else{a=a.getElementsByTagName("path");for(var t=0;t<a.length;t++)a[t].setAttributeNS(null,"filter",b)}},e.ga=function(a,b){if(void 0===b&&(b=new St),a instanceof qe){a.Mc()&&T("getDocumentPoint Spot must be a real, specific Spot, not: "+a.toString());var t=this.naturalBounds,e=this.strokeWidth;b.h(a.x*(t.width+e)-e/2+t.x+a.offsetX,a.y*(t.height+e)-e/2+t.y+a.offsetY)}else b.set(a);return this.oe.Ga(b),b},e.mi=function(a){void 0===a&&(a=new Ut);var b=this.naturalBounds,t=this.oe;b=Ut.allocAt(b.x,b.y,b.width,b.height);var e=this.strokeWidth;return b.Bc(e/2,e/2),e=St.allocAt(b.x,b.y).transform(t),a.h(e.x,e.y,0,0),e.h(b.right,b.y).transform(t),$t(a,e.x,e.y,0,0),e.h(b.right,b.bottom).transform(t),$t(a,e.x,e.y,0,0),e.h(b.x,b.bottom).transform(t),$t(a,e.x,e.y,0,0),Ut.free(b),St.free(e),a},e.gh=function(a,b){var t=this.geometry;if(null===t||null===this.fill&&null===this.stroke)return!1;var e=t.bounds,n=this.strokeWidth/2;t.type!==Qe.j||b||(n+=2);var o=Ut.alloc();if(o.assign(e),o.Bc(n+2,n+2),!o.ca(a))return Ut.free(o),!1;if(e=n+1e-4,t.type===Qe.j)return null!==this.stroke&&(e=(t.endX-t.startX)*(a.x-t.startX)+(t.endY-t.startY)*(a.y-t.startY),!(0>(t.startX-t.endX)*(a.x-t.endX)+(t.startY-t.endY)*(a.y-t.endY)||0>e)&&(Ut.free(o),$e.Zb(t.startX,t.startY,t.endX,t.endY,n,a.x,a.y)));if(t.type===Qe.u){b=t.startX;var g=t.startY,r=t.endX;if(t=t.endY,o.x=Math.min(b,r),o.y=Math.min(g,t),o.width=Math.abs(r-b),o.height=Math.abs(t-g),null===this.fill){if(o.Bc(-e,-e),o.ca(a))return Ut.free(o),!1;o.Bc(e,e)}return null!==this.stroke&&o.Bc(n,n),a=o.ca(a),Ut.free(o),a}if(t.type===Qe.F){g=t.startX,n=t.startY,r=t.endX;var h=t.endY;if(t=Math.min(g,r),b=Math.min(n,h),g=Math.abs(r-g)/2,n=Math.abs(h-n)/2,t=a.x-(t+g),b=a.y-(b+n),null===this.fill){if(n-=e,0>=(g-=e)||0>=n||1>=t*t/(g*g)+b*b/(n*n))return Ut.free(o),!1;g+=e,n+=e}return null!==this.stroke&&(g+=e,n+=e),Ut.free(o),!(0>=g||0>=n)&&1>=t*t/(g*g)+b*b/(n*n)}if(t.type===Qe.o)return Ut.free(o),null===this.fill?oi(t,a.x,a.y,n):ii(t,a,n,1<this.strokeWidth,b);T("Unknown Geometry type: "+t.type)},e.Vl=function(a,b,t,e){var n=this.desiredSize,o=this.ig;if(a=Math.max(a,0),b=Math.max(b,0),null!==this.Rd)var g=this.geometry.bounds;else{var r=this.figure,h=El[r];if(void 0===h){var l=$e.Ze[r];"string"==typeof l&&(l=$e.Ze[l]),"function"==typeof l?(h=l(null,100,100),El[r]=h):T("Unsupported Figure: "+r)}g=h.bounds}r=g.width,h=g.height,l=g.width;var c=g.height;switch(sa(this,!0)){case Ss:e=t=0;break;case Ms:l=Math.max(a-o,0),c=Math.max(b-o,0);break;case Ns:l=Math.max(a-o,0),e=0;break;case Cs:t=0,c=Math.max(b-o,0)}isFinite(n.width)&&(l=n.width),isFinite(n.height)&&(c=n.height);var f=this.maxSize,p=this.minSize;switch(t=Math.max(t-o,p.width),e=Math.max(e-o,p.height),l=Math.min(f.width,l),c=Math.min(f.height,c),l=isFinite(l)?Math.max(t,l):Math.max(r,t),c=isFinite(c)?Math.max(e,c):Math.max(h,e),t=Fl(this)){case Ss:break;case Ms:r=l,h=c;break;case Ps:t=Math.min(l/r,c/h),isFinite(t)||(t=1),r*=t,h*=t;break;default:T(t+" is not a valid geometryStretch.")}null!==this.Rd?(0===r&&(r=.001),0===h&&(h=.001),e=r/(g=(t=null!==this.Rd?this.Rd:this.ua).bounds).width,g=h/g.height,isFinite(e)||(e=1),isFinite(g)||(g=1),this.ua=1===e&&1===g?t:t.copy().scale(e,g)):null!==this.ua&&$e.$(this.ua.Rk,a-o)&&$e.$(this.ua.Qk,b-o)||(this.ua=Ll.makeGeometry(this,r,h)),g=this.ua.bounds,1/0===a||1/0===b?this.Ge(g.x-o/2,g.y-o/2,0===a&&0===r?0:g.width+o,0===b&&0===h?0:g.height+o):this.Ge(-o/2,-o/2,l+o,c+o),n.w()?(l=n.width,c=n.height,l=Math.min(f.width,l),c=Math.min(f.height,c),l=Math.max(p.width,l),c=Math.max(p.height,c),this.ec.h(0,0,l,c)):this.ec.assign(g)},e.eh=function(a,b,t,e){Js(this,a,b,t,e)},e.qs=function(a,b,t){return this.Rj(a.x,a.y,b.x,b.y,t)},e.Rj=function(a,b,t,e,n){var o=this.transform,g=1/(o.m11*o.m22-o.m12*o.m21),r=o.m22*g,h=-o.m12*g,l=-o.m21*g,c=o.m11*g,f=g*(o.m21*o.dy-o.m22*o.dx),p=g*(o.m12*o.dx-o.m11*o.dy);o=a*r+b*l+f,g=a*h+b*c+p,r=t*r+e*l+f,h=t*h+e*c+p,f=this.ig/2,null===(l=this.ua)&&(this.measure(1/0,1/0),l=this.ua);var q=l.bounds;if(c=!1,l.type===Qe.j)if(1.5>=this.strokeWidth)c=$e.Ve(l.startX,l.startY,l.endX,l.endY,o,g,r,h,n);else{if(l.startX===l.endX?(e=f,c=0):(b=(l.endY-l.startY)/(l.endX-l.startX),e=(c=f/Math.sqrt(1+b*b))*b),b=z(),a=new St,$e.Ve(l.startX+e,l.startY+c,l.endX+e,l.endY+c,o,g,r,h,a)&&b.push(a),a=new St,$e.Ve(l.startX-e,l.startY-c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),a=new St,$e.Ve(l.startX+e,l.startY+c,l.startX-e,l.startY-c,o,g,r,h,a)&&b.push(a),a=new St,$e.Ve(l.endX+e,l.endY+c,l.endX-e,l.endY-c,o,g,r,h,a)&&b.push(a),0===(r=b.length))return R(b),!1;for(c=!0,h=1/0,e=0;e<r;e++)(t=((a=b[e]).x-o)*(a.x-o)+(a.y-g)*(a.y-g))<h&&(h=t,n.x=a.x,n.y=a.y);R(b)}else if(l.type===Qe.u)c=$e.Ff(q.x-f,q.y-f,q.x+q.width+f,q.y+q.height+f,o,g,r,h,n);else if(l.type===Qe.F){t:if(0===(b=Ut.allocAt(q.x,q.y,q.width,q.height).Bc(f,f)).width)c=$e.Ve(b.x,b.y,b.x,b.y+b.height,o,g,r,h,n);else if(0===b.height)c=$e.Ve(b.x,b.y,b.x+b.width,b.y,o,g,r,h,n);else{if(a=b.width/2,l=b.height/2,e=b.x+a,c=b.y+l,t=9999,o!==r&&(t=(g-h)/(o-r)),9999>Math.abs(t)){if(0>a*a*t*t+l*l-(h=g-c-t*(o-e))*h){n.x=NaN,n.y=NaN,c=!1;break t}r=(-a*a*t*h+a*l*(f=Math.sqrt(a*a*t*t+l*l-h*h)))/(l*l+a*a*t*t)+e,a=(-a*a*t*h-a*l*f)/(l*l+a*a*t*t)+e,l=t*(r-e)+h+c,h=t*(a-e)+h+c,Math.abs((o-r)*(o-r))+Math.abs((g-l)*(g-l))<Math.abs((o-a)*(o-a))+Math.abs((g-h)*(g-h))?(n.x=r,n.y=l):(n.x=a,n.y=h)}else{if(r=l*l,0>(r-=r/(a*a)*(h=o-e)*h)){n.x=NaN,n.y=NaN,c=!1;break t}r=c+(h=Math.sqrt(r)),h=c-h,Math.abs(r-g)<Math.abs(h-g)?(n.x=o,n.y=r):(n.x=o,n.y=h)}c=!0}Ut.free(b)}else if(l.type===Qe.o){p=St.alloc();var d=r-o,u=h-g,m=d*d+u*u,y=o,v=g;if(0<m&&q.contains(y,v)&&(p.x=y,p.y=v,this.ca(p)))for(0!==d&&.5>Math.abs(d)?(u*=.5/d,d=.5):0!==u&&.5>Math.abs(u)&&(d*=.5/u,u=.5),y-=d,v-=u;q.contains(y,v);)y-=d,v-=u;for(n.x=r,n.y=h,u=0;u<l.figures.count;u++)for(var x=l.figures.s[u],w=x.isFilled?y:o,k=x.isFilled?v:g,M=x.segments,S=q=x.startX,P=d=x.startY,N=0;N<M.count;N++){var C=M.s[N],L=C.type,A=C.endX,j=C.endY,F=!1;switch(L){case fi:S=A,P=j;break;case di:F=Bl(q,d,A,j,w,k,r,h,p);break;case pi:F=$e.Do(q,d,C.point1X,C.point1Y,C.point2X,C.point2Y,A,j,w,k,r,h,.6,p);break;case gi:F=$e.Do(q,d,q+2/3*(C.point1X-q),d+2/3*(C.point1Y-d),A+2/3*(C.point1X-A),j+2/3*(C.point1Y-j),A,j,w,k,r,h,.6,p);break;case mi:case yi:var O=(L=C.type===mi?ui(C,x):ci(C,x,q,d)).length;if(0===O){F=Bl(q,d,C.type===mi?C.centerX:C.endX,C.type===mi?C.centerY:C.endY,w,k,r,h,p);break}for(j=null,A=0;A<O;A++){if(j=L[A],0===A&&Bl(q,d,j[0],j[1],w,k,r,h,p)){var B=Ol(w,k,p,m,n);B<m&&(m=B,c=!0)}$e.Do(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],w,k,r,h,.6,p)&&((B=Ol(w,k,p,m,n))<m&&(m=B,c=!0))}A=j[6],j=j[7];break;default:T("Unknown Segment type: "+L)}q=A,d=j,F&&((F=Ol(w,k,p,m,n))<m&&(m=F,c=!0)),C.isClosed&&(Bl(q,d,A=S,j=P,w,k,r,h,p)&&((C=Ol(w,k,p,m,n))<m&&(m=C,c=!0)))}o=t-a,g=e-b,0!==(r=Math.sqrt(o*o+g*g))&&(o/=r,g/=r),n.x-=o*f,n.y-=g*f,St.free(p)}else T("Unknown Geometry type: "+l.type);return!!c&&(this.transform.Ga(n),!0)},e.fh=function(a,b){if(void 0===b)return a.Re(this.actualBounds);var t=this.ua;null===t&&(this.measure(1/0,1/0),t=this.ua),t=t.bounds;var e=this.strokeWidth/2,n=!1,o=St.alloc();return o.h(t.x-e,t.y-e),a.ca(b.Ga(o))&&(o.h(t.x-e,t.bottom+e),a.ca(b.Ga(o))&&(o.h(t.right+e,t.bottom+e),a.ca(b.Ga(o))&&(o.h(t.right+e,t.y-e),a.ca(b.Ga(o))&&(n=!0)))),St.free(o),n},e.Yc=function(a,b){if(this.fh(a,b)||void 0===b&&(b=this.transform,a.Re(this.actualBounds)))return!0;var t=Ze.alloc();t.set(b),t.Uj();var e=a.left,n=a.right,o=a.top;a=a.bottom;var g=St.alloc();if(g.h(e,o),t.Ga(g),this.gh(g,!0))return St.free(g),!0;if(g.h(n,o),t.Ga(g),this.gh(g,!0))return St.free(g),!0;if(g.h(e,a),t.Ga(g),this.gh(g,!0))return St.free(g),!0;if(g.h(n,a),t.Ga(g),this.gh(g,!0))return St.free(g),!0;var r=St.alloc(),h=St.alloc();return t.set(b),t.bv(this.transform),t.Uj(),r.x=n,r.y=o,r.transform(t),g.x=e,g.y=o,g.transform(t),b=!1,Dl(this,g,r,h)?b=!0:(g.x=n,g.y=a,g.transform(t),Dl(this,g,r,h)?b=!0:(r.x=e,r.y=a,r.transform(t),Dl(this,g,r,h)?b=!0:(g.x=e,g.y=o,g.transform(t),Dl(this,g,r,h)&&(b=!0)))),St.free(g),Ze.free(t),St.free(r),St.free(h),b},e.tx=function(a,b,t){function e(a,b){for(var t=a.length,e=0;e<t;e+=2)if(b.zd(a[e],a[e+1])>n)return!0;return!1}if(t&&null!==this.fill&&this.gh(a,!0))return!0;var n=a.Bf(b),o=n;if(1.5<this.strokeWidth&&(n=this.strokeWidth/2+Math.sqrt(n),n*=n),null===(b=this.ua)&&(this.measure(1/0,1/0),null===(b=this.ua)))return!1;if(!t){var g=b.bounds,r=g.x,h=g.y,l=g.x+g.width;if(g=g.y+g.height,At(a.x,a.y,r,h)<=n&&At(a.x,a.y,l,h)<=n&&At(a.x,a.y,r,g)<=n&&At(a.x,a.y,l,g)<=n)return!0}if(r=b.startX,h=b.startY,l=b.endX,g=b.endY,b.type===Qe.j){if(t=(r-l)*(a.x-l)+(h-g)*(a.y-g),Lt(a.x,a.y,r,h,l,g)<=(0<=(l-r)*(a.x-r)+(g-h)*(a.y-h)&&0<=t?n:o))return!0}else{if(b.type===Qe.u)return b=!1,t&&(b=Lt(a.x,a.y,r,h,r,g)<=n||Lt(a.x,a.y,r,h,l,h)<=n||Lt(a.x,a.y,l,h,l,g)<=n||Lt(a.x,a.y,r,g,l,g)<=n),b;if(b.type===Qe.F){b=a.x-(r+l)/2,o=a.y-(h+g)/2;var c=Math.abs(l-r)/2,f=Math.abs(g-h)/2;if(0===c||0===f)return Lt(a.x,a.y,r,h,l,g)<=n;if(!t)return!(At(b,o,-c,0)>=n||At(b,o,0,-f)>=n||At(b,o,0,f)>=n||At(b,o,c,0)>=n);if((a=$e.$y(c,f,b,o))*a<=n)return!0}else if(b.type===Qe.o){if(o=(l=b.bounds).x,r=l.y,h=l.x+l.width,l=l.y+l.height,a.x>h&&a.x<o&&a.y>l&&a.y<r&&Lt(a.x,a.y,o,r,o,l)>n&&Lt(a.x,a.y,o,r,h,r)>n&&Lt(a.x,a.y,h,l,o,l)>n&&Lt(a.x,a.y,h,l,h,r)>n)return!1;if(o=Math.sqrt(n),!t){for(t=b.figures,b=0;b<t.count;b++){if(g=(o=t.s[b]).startX,c=o.startY,a.zd(g,c)>n)return!1;for(h=(r=o.segments.s).length,l=0;l<h;l++)switch(f=r[l],f.type){case fi:case di:if(g=f.endX,c=f.endY,a.zd(g,c)>n)return!1;break;case pi:var p=z();if($e.Qe(g,c,f.point1X,f.point1Y,f.point2X,f.point2Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.zd(g,c)>n)return!1;break;case gi:if(p=z(),$e.cp(g,c,f.point1X,f.point1Y,f.endX,f.endY,.8,p),g=e(p,a),R(p),g)return!1;if(g=f.endX,c=f.endY,a.zd(g,c)>n)return!1;break;case mi:case yi:var q=(p=f.type===mi?ui(f,o):ci(f,o,g,c)).length;if(0===q){if(g=f.type===mi?f.centerX:f.endX,c=f.type===mi?f.centerY:f.endY,a.zd(g,c)>n)return!1;break}f=null;for(var d=z(),u=0;u<q;u++)if(f=p[u],d.length=0,$e.Qe(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],.8,d),e(d,a))return R(d),!1;R(d),null!==f&&(g=f[6],c=f[7]);break;default:T("Unknown Segment type: "+f.type)}}return!0}if(null===this.fill?oi(b,a.x,a.y,o):ii(b,a,o,!0,!1))return!0}}return!1},e.rc=function(){this.ua=null},e.jq=function(){return this.ig},Ll.makeGeometry=function(a,b,t){if("None"!==a.toArrow)var e=Rl[a.toArrow];else"None"!==a.fromArrow?e=Rl[a.fromArrow]:("string"==typeof(e=$e.Ze[a.figure])&&(e=$e.Ze[e]),void 0===e&&T("Unknown Shape.figure: "+a.figure),(e=e(a,b,t)).Rk=b,e.Qk=t);if(null===e){var n=$e.Ze.Rectangle;"function"==typeof n&&(e=n(a,b,t))}return e},v.Object.defineProperties(Ll.prototype,{geometry:{get:function(){return null!==this.ua?this.ua:this.Rd},set:function(a){var b=this.ua,t=this.Rd;if(b!==a){this.Rd=this.ua=null!==a?a.freeze():null;var e=this.part;null!==e&&(e.ag=NaN),this.v(),this.g("geometry",b||t,a),ua(this)&&(null!==(a=this.part)&&Hs(this,a,"geometryString"))}}},geometryString:{get:function(){return null===this.geometry?"":this.geometry.toString()},set:function(a){var b=(a=Qe.parse(a)).normalize();this.geometry=a,this.position=a=St.allocAt(-b.x,-b.y),St.free(a)}},isGeometryPositioned:{get:function(){return 0!=(1048576&this.l)},set:function(a){var b=0!=(1048576&this.l);b!==a&&(this.l^=1048576,this.v(),this.g("isGeometryPositioned",b,a))}},fill:{get:function(){return this.Ui},set:function(a){var b=this.Ui;b!==a&&(null!==a&&sh(a,"Shape.fill"),a instanceof Ha&&a.freeze(),this.Ui=a,this.N(),this.g("fill",b,a))}},stroke:{get:function(){return this.xc},set:function(a){var b=this.xc;b!==a&&(null!==a&&sh(a,"Shape.stroke"),a instanceof Ha&&a.freeze(),this.xc=a,this.N(),this.g("stroke",b,a))}},strokeWidth:{get:function(){return this.ig},set:function(a){var b=this.ig;if(b!==a)if(0<=a){this.ig=a,this.v();var t=this.part;null!==t&&(t.ag=NaN),this.g("strokeWidth",b,a)}else A(a,"value >= 0",Ll,"strokeWidth:value")}},strokeCap:{get:function(){return null!==this.Na?this.Na.Gr:"butt"},set:function(a){var b=this.strokeCap;b!==a&&("string"!=typeof a||"butt"!==a&&"round"!==a&&"square"!==a?A(a,'"butt", "round", or "square"',Ll,"strokeCap"):(Al(this),this.Na.Gr=a,this.N(),this.g("strokeCap",b,a)))}},strokeJoin:{get:function(){return null!==this.Na?this.Na.Hr:"miter"},set:function(a){var b=this.strokeJoin;b!==a&&("string"!=typeof a||"miter"!==a&&"bevel"!==a&&"round"!==a?A(a,'"miter", "bevel", or "round"',Ll,"strokeJoin"):(Al(this),this.Na.Hr=a,this.N(),this.g("strokeJoin",b,a)))}},strokeMiterLimit:{get:function(){return null!==this.Na?this.Na.Ir:10},set:function(a){var b=this.strokeMiterLimit;if(b!==a&&1<=a){Al(this),this.Na.Ir=a,this.N();var t=this.part;null!==t&&(t.ag=NaN),this.g("strokeMiterLimit",b,a)}}},strokeDashArray:{get:function(){return this.Yg},set:function(a){var b=this.Yg;if(b!==a){if(null!==a){for(var t=a.length,e=0,n=0;n<t;n++){var o=a[n];0<=o&&isFinite(o)||T("strokeDashArray:value "+o+" at index "+n+" must be a positive number or zero."),e+=o}if(0===e){if(null===b)return;a=null}}this.Yg=a,this.N(),this.g("strokeDashArray",b,a)}}},strokeDashOffset:{get:function(){return null!==this.Na?this.Na.uj:0},set:function(a){var b=this.strokeDashOffset;b!==a&&0<=a&&(Al(this),this.Na.uj=a,this.N(),this.g("strokeDashOffset",b,a))}},figure:{get:function(){return this.$m},set:function(a){var b=this.$m;if(b!==a){var t=$e.Ze[a];"function"==typeof t?t=a:(t=$e.Ze[a.toLowerCase()])||T("Unknown Shape.figure: "+a),b!==t&&(null!==(a=this.part)&&(a.ag=NaN),this.$m=t,this.Rd=null,this.rc(),this.v(),this.g("figure",b,t))}}},toArrow:{get:function(){return null!==this.Ua?this.Ua.V:"None"},set:function(a){var b=this.toArrow;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=zl(a);null===t?T("Unknown Shape.toArrow: "+a):b!==t&&(null===this.Ua&&(this.Ua=new Pa),this.Ua.V=t,this.Rd=null,this.rc(),this.v(),Il(this),this.g("toArrow",b,t))}}},fromArrow:{get:function(){return null!==this.Ua?this.Ua.j:"None"},set:function(a){var b=this.fromArrow;if(!0===a?a="Standard":!1===a&&(a=""),b!==a){var t=zl(a);null===t?T("Unknown Shape.fromArrow: "+a):b!==t&&(null===this.Ua&&(this.Ua=new Pa),this.Ua.j=t,this.Rd=null,this.rc(),this.v(),Il(this),this.g("fromArrow",b,t))}}},spot1:{get:function(){return null!==this.Na?this.Na.fg:Fe},set:function(a){var b=this.spot1;b.D(a)||(a=a.J(),Al(this),this.Na.fg=a,this.v(),this.g("spot1",b,a))}},spot2:{get:function(){return null!==this.Na?this.Na.gg:Fe},set:function(a){var b=this.spot2;b.D(a)||(a=a.J(),Al(this),this.Na.gg=a,this.v(),this.g("spot2",b,a))}},parameter1:{get:function(){return this.Tn},set:function(a){var b=this.Tn;b!==a&&(this.Tn=a,this.rc(),this.v(),this.g("parameter1",b,a))}},parameter2:{get:function(){return this.Un},set:function(a){var b=this.Un;b!==a&&(this.Un=a,this.rc(),this.v(),this.g("parameter2",b,a))}},naturalBounds:{get:function(){return this.ec}},pathPattern:{get:function(){return null!==this.Na?this.Na.ar:null},set:function(a){var b=this.pathPattern;b!==a&&(Al(this),this.Na.ar=a,this.N(),this.g("pathPattern",b,a))}},geometryStretch:{get:function(){return null!==this.Na?this.Na.iq:Ts},set:function(a){var b=this.geometryStretch;b!==a&&(Al(this),this.Na.iq=a,this.v(),this.g("geometryStretch",b,a))}},interval:{get:function(){return null!==this.fa?this.fa.Sk:1},set:function(a){var b=this.interval;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){null===this.fa&&(this.fa=new vu),this.fa.Sk=a;var t=this.diagram;null!==t&&this.panel===t.grid&&Lr(t),this.v(),null!==(t=this.panel)&&(t.graduatedIntervals=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return null!==this.fa?this.fa.u:0},set:function(a){var b=this.graduatedStart;b!==a&&(0>a?a=0:1<a&&(a=1),null===this.fa&&(this.fa=new vu),this.fa.u=a,this.v(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return null!==this.fa?this.fa.j:1},set:function(a){var b=this.graduatedEnd;b!==a&&(0>a?a=0:1<a&&(a=1),null===this.fa&&(this.fa=new vu),this.fa.j=a,this.v(),this.g("graduatedEnd",b,a))}},graduatedSkip:{get:function(){return null!==this.fa?this.fa.o:null},set:function(a){var b=this.graduatedSkip;b!==a&&(null===this.fa&&(this.fa=new vu),this.fa.o=a,this.v(),this.g("graduatedSkip",b,a))}}}),Ll.prototype.intersectsRect=Ll.prototype.Yc,Ll.prototype.containedInRect=Ll.prototype.fh,Ll.prototype.getNearestIntersectionPoint=Ll.prototype.qs,Ll.prototype.getDocumentBounds=Ll.prototype.mi,Ll.prototype.getDocumentPoint=Ll.prototype.ga;var Rl=new _,El=new _;function Vl(){this.oc=!1,this.Gr="butt",this.Hr="miter",this.Ir=10,this.uj=0,this.ar=null,this.iq=Ts,this.gg=this.fg=Fe}function Yl(a,b){return qs.call(this),mu||(gu=$r?new Xa(null).context:null,mu=!0),this.l|=2097152,this.fc="",this.xc="black",this.Ae="13px sans-serif",this.Kq=this.Db=this.Gc=0,this.da=this.fa=this.Fm=null,this.Ih=0,this.df=null,this.Le=0,this.ze=this.Rb=this.Qc=null,"string"==typeof a?this.text=a:a&&Object.assign(this,a),b&&Object.assign(this,b),this}function Gl(a){null===a.da?a.da=new yu:a.da.oc&&(a.da=a.da.copy())}function Xl(a,b){a.l=6144|b.l,a.pb=b.opacity,a.Ma=b.background,a.areaBackground=b.areaBackground,a.jd=b.desiredSize.J(),a.minSize=b.minSize.J(),a.maxSize=b.maxSize.J(),null!==b.Mb?a.Mb=b.Mb.copy():a.Mb=null,a.Ca=b.scale,a.Lb=b.angle,a.stretch=b.stretch,a.Kg=b.margin.J(),a.Kb=b.alignment.J(),a.rk=b.alignmentFocus.J(),a.segmentFraction=b.segmentFraction,a.segmentOffset=b.segmentOffset.J(),a.segmentOrientation=b.segmentOrientation,null!==b.tb&&(a.tb=b.tb.copy()),a.shadowVisible=b.shadowVisible,a.fc=b.fc,a.xc=b.xc,a.Ae=b.Ae,null!==a.fa&&(a.fa=b.fa.copy()),null!==b.da&&(a.da=b.da.oc?b.da:b.da.copy()),a.Ih=b.Ih}function Ul(a,b,t){null===a.ze?(a.ze=b,a.Db=t):(null!==a.Rb&&null!==a.Qc||(a.Rb=[],a.Qc=[],a.Rb.push(a.ze),a.Qc.push(a.Db)),a.Rb.push(b),a.Qc.push(t),a.Rb.length>a.maxLines&&(a.l|=16777216))}function ql(a,b,t,e){var n=a.formatting===su;n&&(b=b.trim());var o=0,g=a.Ae,r=a.spacingAbove+a.spacingBelow;r=Math.max(0,Wl(a)+r);var h=a.overflow===ru?Jl(g):0;if(a.Gc>=a.maxLines)null!==e&&e.h(0,r);else if(g=b,a.wrap===tu){a.Le=1;var l=Hl(b);if(0===h||l<=t)a.Db=Math.max(a.Db,l),Ul(a,b,a.Db),null!==e&&e.h(l,r);else{for(l=Hl((o=Kl(a,g))+(b=Kl(a,g=g.substr(o.length))));0<b.length&&l<=t;)l=(o+=b)+(b=Kl(a,g=g.substr(b.length))),n&&(l=l.trim()),l=Hl(l);for(n&&(b=b.trim()),o+=b,t=Math.max(1,t-h);Hl(o)>t&&1<o.length;)o=o.substr(0,o.length-1);a.l|=16777216;var c=Hl(o+=du);a.Db=c,Ul(a,o,c),null!==e&&e.h(c,r)}}else{for(h=0,0===g.length&&(h=1,Ul(a,g,0));0<g.length;){for(b=Kl(a,g),g=g.substr(b.length);Hl(b)>t;){var f=1;for(l=Hl(b.substr(0,f)),c=0;l<=t;)f++,c=l,l=Hl(b.substr(0,f));if(1===f){var p=l;o=Math.max(o,l)}else p=c,o=Math.max(o,c);if(1>--f&&(f=1),Ul(a,b.substr(0,f),p),h++,b=b.substr(f),a.Gc+h>a.maxLines)break}for(l=Hl(b+(c=Kl(a,g)));0<c.length&&l<=t;)l=(b+=c)+(c=Kl(a,g=g.substr(c.length))),n&&(l=l.trim()),l=Hl(l);if(n&&(b=b.trim()),""!==b&&(""===b[b.length-1]&&(b=b.substring(0,b.length-1)+""),0===c.length?(f=l,o=Math.max(o,l)):(f=c=Hl(b),o=Math.max(o,c)),Ul(a,b,f),h++,a.Gc+h>a.maxLines))break}a.Le=Math.min(a.maxLines,h),a.Db=Math.max(a.Db,o),null!==e&&e.h(a.Db,r*a.Le)}}function Kl(a,b){if(a.wrap===nu)return b.substr(0,1);for(var t=b.length,e=0,n=hu;e<t&&!n.test(b.charAt(e));)e++;for(a.formatting===au&&(t=Math.min(t,e+1));e<t&&n.test(b.charAt(e));)e++;return e>=b.length?b:b.substr(0,e)}function Hl(a){return null===gu?8*a.length:gu.measureText(a).width}function Wl(a){if(null!==a.df)return a.df;var b=a.Ae;if(null===gu){var t=16;return a.df=t}return void 0!==lu[b]&&5e3>uu?t=lu[b]:(t=1.3*gu.measureText("M").width,lu[b]=t,uu++),a.df=t}function Jl(a){if(null===gu)return 6;if(void 0!==cu[a]&&5e3>fu)var b=cu[a];else b=gu.measureText(du).width,cu[a]=b,fu++;return b}function Zl(a,b){var t=a.fc.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e=a.spacingAbove+a.spacingBelow;if(e=Math.max(0,Wl(a)+e),0===t.length)return a.Db=0,a.Gc=1,e;if(!a.isMultiline){var n=t.indexOf("\n",0);0<=n&&(t=t.substr(0,n))}n=0;for(var g,o=a.Gc=0,r=!1;!r;){if(-1===(g=t.indexOf("\n",o))&&(g=t.length,r=!0),o<=g){if(o=t.substr(o,g-o),a.wrap!==tu){a.Le=0;var h=Vt.alloc();ql(a,o,b,h),n+=h.height,Vt.free(h),a.Gc+=a.Le}else ql(a,o,b,null),n+=e,a.Gc++;a.Gc===a.maxLines&&(r=!0)}o=g+1}return a.Kq=n}Ll.className="Shape",Ll.getFigureGenerators=function(){var b,a=new Mt;for(b in $e.Ze)b!==b.toLowerCase()&&a.add(b,$e.Ze[b]);return a.freeze(),a},Ll.defineFigureGenerator=function(a,b){var t=a.toLowerCase(),e=$e.Ze;e[a]=b,e[t]=a},Ll.getArrowheadGeometries=function(){var a=new Mt;for(e in $e.tm)if(void 0===Rl[e]){var b=Qe.parse($e.tm[e],!1);Rl[e]=b,(b=e.toLowerCase())!==e&&(Rl[b]=e)}for(var t in Rl)if(t!==t.toLowerCase()){var e=Rl[t];e instanceof Qe&&a.add(t,e)}return a.freeze(),a},Ll.defineArrowheadGeometry=function(a,b){var t=null;t="string"==typeof b?Qe.parse(b,!1):b,"none"!==(b=a.toLowerCase())&&a!==b||T("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+a);var e=Rl;e[a]=t,e[b]=a},Vl.prototype.copy=function(){var a=new Vl;return a.Gr=this.Gr,a.Hr=this.Hr,a.Ir=this.Ir,a.uj=this.uj,a.ar=this.ar,a.iq=this.iq,a.fg=this.fg.J(),a.gg=this.gg.J(),a},y(Yl,qs),Yl.prototype.cloneProtected=function(a){qs.prototype.cloneProtected.call(this,a),a.fc=this.fc,a.xc=this.xc,a.Ae=this.Ae,a.Gc=this.Gc,a.Db=this.Db,a.Kq=this.Kq,a.Fm=this.Fm,null!==this.fa&&(a.fa=this.fa.copy()),null!==this.da&&(a.da=this.da.oc?this.da:this.da.copy()),a.Ih=this.Ih,a.df=this.df,a.Le=this.Le,a.Qc=this.Qc,a.Rb=this.Rb,a.ze=this.ze},(e=Yl.prototype).th=function(){qs.prototype.th.call(this),null!==this.da&&(this.da.oc=!0)},e.qb=function(a){a.classType===Yl?this.wrap=a:qs.prototype.qb.call(this,a)},e.toString=function(){return 22<this.fc.length?'TextBlock("'+this.fc.substring(0,20)+'"...)':'TextBlock("'+this.fc+'")'},e.v=function(){qs.prototype.v.call(this)},e.hh=function(a,b){if(null!==this.xc&&0!==this.fc.length&&null!==this.Ae){var t=this.naturalBounds,e=this.actualBounds,n=t.width,o=t.height,g=Wl(this),r=a.textAlign=this.textAlign,h=b.sn;"start"===r?r=h?"right":"left":"end"===r&&(r=h?"left":"right"),h=this.isUnderline;var l=this.isStrikethrough;na(this,a,this.xc,!0,!1,t,e),(h||l)&&na(this,a,this.xc,!1,!1,t,e),e=0,t=!1;var c=this.oe,f=c.dx-(g*c.m21+c.dx);c=c.dy-(g*c.m22+c.dy);var p=b.scale;switch(8>(f*f+c*c)*p*p&&(t=!0),b.ib!==a&&(t=!1),b.ib instanceof Aa&&(t=!1),!1===b.Gf("textGreeking")&&(t=!1),b=this.spacingAbove,f=this.spacingBelow,this.flip){case js:a.translate(n,0),a.scale(-1,1);break;case As:a.translate(0,o),a.scale(1,-1);break;case Fs:a.translate(n,o),a.scale(-1,-1)}if(a.yc(),o>(p=(b+g+f)*(c=this.Gc))&&(e=(e=this.verticalAlignment).y*o-e.y*p+e.offsetY),1===c&&null!==this.ze)(f=this.Db)>n&&(f=n),this.Nj(this.ze,a,0,e+b,n,g,f,t,r,h,l);else if(null!==this.Qc&&null!==this.Rb)for(p=0;p<c;p++){var q=this.Qc[p];q>n&&(q=n),e+=b,this.Nj(this.Rb[p],a,0,e,n,g,q,t,r,h,l),e+=g+f}switch(this.flip){case js:a.scale(-1,1),a.translate(-n,0);break;case As:a.scale(1,-1),a.translate(0,-o);break;case Fs:a.scale(-1,-1),a.translate(-n,-o)}}},e.Nj=function(a,b,t,e,n,o,g,r,h,l,c){var f=0;if(r)"left"===h?f=0:"right"===h?f=n-g:"center"===h&&(f=(n-g)/2),b.fillRect(t+f,e+.25*o,g,1);else{if("left"===h?f=0:"right"===h?f=n:"center"===h&&(f=n/2),n=null!==$l?$l(this,o):.75*o,b.fillText(a,t+f,e+n),0===(a=o/20|0)&&(a=1),"right"===h?f-=g:"center"===h&&(f-=g/2),l){h=t+f,l=e+(r=null!==Ql?Ql(this,o):.8*o),n=t+f+g,r=e+r;var p=a;b.beginPath(),b.lineWidth=p,b.moveTo(h,l),b.lineTo(n,r),b.stroke(),b.Se(),b instanceof Aa&&b.ad.classList.add("gojs-td")}c&&(c=e+o-o/2.2|0,0!=a%2&&(c+=.5),e=t+f,o=c,t=t+f+g,g=c,f=a,b.beginPath(),b.lineWidth=f,b.moveTo(e,o),b.lineTo(t,g),b.stroke(),b.Se(),b instanceof Aa&&b.ad.classList.add("gojs-td"))}},e.jk=function(a,b,t){if(!qs.prototype.jk.call(this,a,b,t))return!1;if(na(this,a,this.xc,!0,!1,this.naturalBounds,this.actualBounds),t){if(0===this.svg.getElementsByTagName("text").length)return!0;for(b=this.svg.getElementsByClassName("gojs-td"),t=0;t<b.length;t++)Ia(a,b[t],!1)}else(b=this.svg).innerHTML=this.text,Ia(a,b,!0);return!0},e.mk=function(a){return!!(1<this.lineCount||this.isUnderline||this.isStrikethrough)||qs.prototype.mk.call(this,a)},e.Dv=function(a,b){if("g"!==a.nodeName)a.setAttributeNS(null,"filter",b);else{a=a.getElementsByTagName("text");for(var t=0;t<a.length;t++)a[t].setAttributeNS(null,"filter",b)}},e.Vl=function(a,b,t,e){var n=this.Gc;this.Ih=a,this.l&=-16777217;var g,o=this.Ae;if(null!==gu&&pu!==o&&(pu=gu.font=o),this.Db=this.Le=0,this.ze=this.Rb=this.Qc=this.df=null,isNaN(this.desiredSize.width)){if(0===(o=this.fc.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length)o=8;else if(this.isMultiline){for(var r=g=0,h=!1;!h;){var l=o.indexOf("\n",r);-1===l&&(l=o.length,h=!0),r=o.substr(r,l-r),this.formatting===su&&(r=r.trim()),g=Math.max(g,Hl(r)),r=l+1}o=g}else 0<=(g=o.indexOf("\n",0))&&(o=o.substr(0,g)),o=Hl(o);o=Math.min(o,a/this.scale)}else o=this.desiredSize.width;if(null!==this.panel&&(o=Math.min(o,this.panel.maxSize.width)),g=Zl(this,o),h=g=isNaN(this.desiredSize.height)?Math.min(g,b/this.scale):this.desiredSize.height,0!==this.Db&&null!==this.Qc&&null!==this.Rb&&this.overflow===ru&&(b=this.Ae,b=this.overflow===ru?Jl(b):0,l=this.spacingAbove+this.spacingBelow,l=Math.max(0,Wl(this)+l),!((h=Math.min(this.maxLines-1,Math.max(Math.floor(h/l+.01)-1,0)))+1>=this.Rb.length))){for(this.l|=16777216,l=this.Rb[h],b=Math.max(1,a-b);Hl(l)>b&&1<l.length;)l=l.substr(0,l.length-1);b=Hl(l+=du),this.Rb[h]=l,this.Rb=this.Rb.slice(0,h+1),this.Qc[h]=b,this.Qc=this.Qc.slice(0,h+1),this.Le=this.Rb.length,this.Db=Math.max(this.Db,b),this.Gc=this.Le,1===this.Gc&&(this.ze=this.Rb[0])}(this.wrap===eu||isNaN(this.desiredSize.width))&&(o=isNaN(a)?this.Db:Math.min(a,this.Db)),o=Math.max(t,o),g=Math.max(e,g),qt(this.ec,o,g),this.Ge(0,0,o,g),null!==this.svg&&n!==this.Gc&&(this.Uc=!0)},e.eh=function(a,b,t,e){Js(this,a,b,t,e)},v.Object.defineProperties(Yl.prototype,{font:{get:function(){return this.Ae},set:function(a){var b=this.Ae;b!==a&&(this.Ae=a,this.df=null,this.v(),this.g("font",b,a))}},text:{get:function(){return this.fc},set:function(a){var b=this.fc;b!==(a=null!=a?a.toString():"")&&(this.fc=a,this.v(),this.g("text",b,a),this.Uc=!0)}},textAlign:{get:function(){return null!==this.da?this.da.Nr:"start"},set:function(a){var b=this.textAlign;b===a||"start"!==a&&"end"!==a&&"left"!==a&&"right"!==a&&"center"!==a||(Gl(this),this.da.Nr=a,this.N(),this.g("textAlign",b,a))}},flip:{get:function(){return null!==this.da?this.da.Xf:Ss},set:function(a){var b=this.flip;b!==a&&(Gl(this),this.da.Xf=a,this.N(),this.g("flip",b,a))}},verticalAlignment:{get:function(){return null!==this.da?this.da.Xr:De},set:function(a){var b=this.verticalAlignment;b.D(a)||(a=a.J(),Gl(this),this.da.Xr=a,ra(this),this.g("verticalAlignment",b,a))}},naturalBounds:{get:function(){if(!this.ec.w()){var a=Vt.alloc();ql(this,this.fc,999999,a);var b=a.width;Vt.free(a),a=Zl(this,b);var t=this.desiredSize;isNaN(t.width)||(b=t.width),isNaN(t.height)||(a=t.height),qt(this.ec,b,a)}return this.ec}},isMultiline:{get:function(){return 0!=(2097152&this.l)},set:function(a){var b=0!=(2097152&this.l);b!==a&&(this.l^=2097152,this.v(),this.g("isMultiline",b,a))}},isUnderline:{get:function(){return 0!=(4194304&this.l)},set:function(a){var b=0!=(4194304&this.l);b!==a&&(this.l^=4194304,this.Uc=!0,this.N(),this.g("isUnderline",b,a))}},isStrikethrough:{get:function(){return 0!=(8388608&this.l)},set:function(a){var b=0!=(8388608&this.l);b!==a&&(this.l^=8388608,this.Uc=!0,this.N(),this.g("isStrikethrough",b,a))}},wrap:{get:function(){return null!==this.da?this.da.Zr:iu},set:function(a){var b=this.wrap;b!==a&&(Gl(this),this.da.Zr=a,this.v(),this.g("wrap",b,a))}},overflow:{get:function(){return null!==this.da?this.da.Zq:ou},set:function(a){var b=this.overflow;b!==a&&(Gl(this),this.da.Zq=a,this.v(),this.g("overflow",b,a))}},isOverflowed:{get:function(){return 0!=(16777216&this.l)}},stroke:{get:function(){return this.xc},set:function(a){var b=this.xc;b!==a&&(null!==a&&sh(a,"TextBlock.stroke"),a instanceof Ha&&a.freeze(),this.xc=a,this.N(),this.g("stroke",b,a))}},lineCount:{get:function(){return this.Gc}},lineHeight:{get:function(){return Wl(this)}},editable:{get:function(){return 0!=(1048576&this.l)},set:function(a){var b=0!=(1048576&this.l);b!==a&&(this.l^=1048576,this.g("editable",b,a))}},textEditor:{get:function(){return null!==this.da?this.da.Pr:null},set:function(a){var b=this.textEditor;b!==a&&(Gl(this),this.da.Pr=a,this.g("textEditor",b,a))}},errorFunction:{get:function(){return null!==this.da?this.da.Hd:null},set:function(a){var b=this.errorFunction;b!==a&&(Gl(this),this.da.Hd=a,this.g("errorFunction",b,a))}},interval:{get:function(){return null!==this.fa?this.fa.Sk:1},set:function(a){var b=this.interval;if(b!==(a=Math.round(a))&&0!==a&&isFinite(a)){null===this.fa&&(this.fa=new vu),this.fa.Sk=a,this.v();var t=this.panel;null!==t&&(t.graduatedIntervals=null),this.g("interval",b,a)}}},graduatedStart:{get:function(){return null!==this.fa?this.fa.u:0},set:function(a){var b=this.graduatedStart;b!==a&&(0>a?a=0:1<a&&(a=1),null===this.fa&&(this.fa=new vu),this.fa.u=a,this.v(),this.g("graduatedStart",b,a))}},graduatedEnd:{get:function(){return null!==this.fa?this.fa.j:1},set:function(a){var b=this.graduatedEnd;b!==a&&(0>a?a=0:1<a&&(a=1),null===this.fa&&(this.fa=new vu),this.fa.j=a,this.v(),this.g("graduatedEnd",b,a))}},graduatedFunction:{get:function(){return null!==this.fa?this.fa.F:null},set:function(a){var b=this.graduatedFunction;b!==a&&(null===this.fa&&(this.fa=new vu),this.fa.F=a,this.v(),this.g("graduatedFunction",b,a))}},graduatedSkip:{get:function(){return null!==this.fa?this.fa.o:null},set:function(a){var b=this.graduatedSkip;b!==a&&(null===this.fa&&(this.fa=new vu),this.fa.o=a,this.v(),this.g("graduatedSkip",b,a))}},textValidation:{get:function(){return null!==this.da?this.da.vj:null},set:function(a){var b=this.textValidation;b!==a&&(Gl(this),this.da.vj=a,this.g("textValidation",b,a))}},textEdited:{get:function(){return null!==this.da?this.da.Or:null},set:function(a){var b=this.textEdited;b!==a&&(Gl(this),this.da.Or=a,this.g("textEdited",b,a))}},spacingAbove:{get:function(){return null!==this.da?this.da.Cr:0},set:function(a){var b=this.spacingAbove;b!==a&&(Gl(this),this.da.Cr=a,this.v(),this.g("spacingAbove",b,a))}},spacingBelow:{get:function(){return null!==this.da?this.da.Dr:0},set:function(a){var b=this.spacingBelow;b!==a&&(Gl(this),this.da.Dr=a,this.v(),this.g("spacingBelow",b,a))}},formatting:{get:function(){return null!==this.da?this.da.fq:su},set:function(a){var b=this.formatting;b!==a&&(Gl(this),this.da.fq=a,this.v(),this.g("formatting",b,a))}},maxLines:{get:function(){return null!==this.da?this.da.Iq:1/0},set:function(a){var b=this.maxLines;b!==a&&(0>=(a=Math.floor(a))&&A(a,"> 0",Yl,"maxLines"),Gl(this),this.da.Iq=a,this.v(),this.g("maxLines",b,a))}},metrics:{get:function(){return{arrSize:null!==this.Qc?this.Qc:[this.Db],arrText:null!==this.Rb?this.Rb:[this.ze],maxLineWidth:this.Db,fontHeight:this.df}}},choices:{get:function(){return this.Fm},set:function(a){var b=this.Fm;b!==a&&(this.Fm=a,this.g("choices",b,a))}}});var _l,$l=null,Ql=null,tu=new W(Yl,"None",0),eu=new W(Yl,"WrapFit",1),iu=new W(Yl,"WrapDesiredSize",2),nu=new W(Yl,"WrapBreakAll",3),ou=new W(Yl,"OverflowClip",0),ru=new W(Yl,"OverflowEllipsis",1),su=new W(Yl,"FormatTrim",0),au=new W(Yl,"FormatNone",0),hu=/[ \u200b\u00ad]/,lu=new _,uu=0,cu=new _,fu=0,du="...",pu="",gu=null,mu=!1;function yu(){this.oc=!1,this.Hd=null,this.Xf=Ss,this.fq=su,this.Iq=1/0,this.Zq=ou,this.Dr=this.Cr=0,this.Nr="start",this.vj=this.Pr=this.Or=null,this.Xr=De,this.Zr=iu}function vu(){this.Sk=1,this.u=0,this.j=1,this.o=this.F=null}function xu(a,b){qs.call(this),this.Eg=null,this.po="",this.Xg=ie,this.Mk=Ms,this.Zg=this.Hd=null,this.Lk=fe,this.Xf=Ss,this.ul=null,this.pn=!1,this.dn=!0,this.$k=!1,this.at=this.ql=null,"string"==typeof a?this.source=a:a&&Object.assign(this,a),b&&Object.assign(this,b)}function bu(a){void 0===a&&(a=""),""!==a?_l[a]&&(delete _l[a],ku--):(_l=new _,ku=0)}function wu(a,b){b.qy||(b.Eq=function(t){b.rq=!0,b.kn=!1;var e=b.Bg.copy();if(null!=e){for(e=e.iterator;e.next();){var n=e.value;n.N();var o=b.getAttribute("src")||"",g=n.Og.I(o);if(null!==g)for(var r=g.length,h=0;h<r;h++)o=g[h],n.Wn.add(o),o.Uc=!0,n.ac(),b.gn&&(void 0===b.du&&(b.du=t),null!==o.Zg&&o.Zg(o,t))}b.Bg.clear()}a.desiredSize.w()||(ga(a,!1),a.v())},b.Xp=function(a){b.kn=a;var t=b.Bg.copy();if(null!=t){for(t=t.iterator;t.next();){var e=t.value,n=b.getAttribute("src")||"",g=e.Og.I(n);if(null!==g){e=g.length,n=z();for(var o=0;o<e;o++)n.push(g[o]);if(b.gn)for(o=0;o<e;o++)null!==(g=n[o]).Hd&&g.Hd(g,a);R(n)}}b.Bg.clear()}},b.addEventListener("load",b.Eq),b.addEventListener("error",b.Xp),b.qy=!0)}Yl.className="TextBlock",yu.prototype.copy=function(){var a=new yu;return a.Hd=this.Hd,a.Xf=this.Xf,a.fq=this.fq,a.Iq=this.Iq,a.Zq=this.Zq,a.Cr=this.Cr,a.Dr=this.Dr,a.Nr=this.Nr,a.Or=this.Or,a.Pr=this.Pr,a.vj=this.vj,a.Xr=this.Xr,a.Zr=this.Zr,a},Yl.getEllipsis=function(){return du},Yl.setEllipsis=function(a){du=a,cu=new _,fu=0},Yl.getBaseline=function(){return $l},Yl.setBaseline=function(a){$l=a},Yl.getUnderline=function(){return Ql},Yl.setUnderline=function(a){Ql=a},Yl.isValidFont=function(a){if(mu||(gu=$r?new Xa(null).context:null,mu=!0),null===gu)return!0;var b=gu.font;if(a===b||"10px sans-serif"===a)return!0;gu.font="10px sans-serif",gu.font=a;var t=gu.font;if("10px sans-serif"!==t)return gu.font=b,!0;gu.font="19px serif";var e=gu.font;return gu.font=a,t=gu.font,gu.font=b,t!==e},Yl.FormatNone=au,Yl.FormatTrim=su,Yl.None=tu,Yl.OverflowClip=ou,Yl.OverflowEllipsis=ru,Yl.WrapBreakAll=nu,Yl.WrapDesiredSize=iu,Yl.WrapFit=eu,vu.prototype.copy=function(){var a=new vu;return a.Sk=this.Sk,a.u=this.u,a.j=this.j,a.F=this.F,a.o=this.o,a},vu.className="GradElementSettings",y(xu,qs),xu.prototype.cloneProtected=function(a){qs.prototype.cloneProtected.call(this,a),a.po=this.po,a.element=this.Eg,a.Xg=this.Xg.J(),a.Mk=this.Mk,a.Xf=this.Xf,a.Hd=this.Hd,a.Zg=this.Zg,a.Lk=this.Lk.J(),a.dn=this.dn,a.ql=this.ql},xu.prototype.qb=function(a){a===Ss||a===Ps||a===Ls?this.imageStretch=a:qs.prototype.qb.call(this,a)},xu.prototype.toString=function(){return"Picture("+this.source+")#"+ut(this)},xu.prototype.hA=function(){if(""!==this.source){bu(this.source);var a=this.source;this.source="",this.source=a}},xu.prototype.redraw=function(){this.N(),this.Uc=!0},xu.prototype.hh=function(a,b){var t=this.Eg;if(null!==t){var e=t.getAttribute("src");if(!(t instanceof HTMLImageElement&&(null===e||""===e)||t.kn instanceof Event&&a instanceof Ua)){var n=a instanceof Aa;e=this.naturalBounds;var o=0,g=0,r=this.pn,h=r?+t.width:t.naturalWidth;if(r=r?+t.height:t.naturalHeight,void 0===h&&t.videoWidth&&(h=t.videoWidth),void 0===r&&t.videoHeight&&(r=t.videoHeight),h=h||e.width,r=r||e.height,0!==h&&0!==r){var l=h,c=r;this.sourceRect.w()&&(o=this.Xg.x,g=this.Xg.y,h=this.Xg.width,r=this.Xg.height);var f=h,p=r,q=this.Mk,d=this.Lk;switch(q){case Ss:if(this.sourceRect.w())break;f>=e.width&&(o=o+d.offsetX+(f*d.x-e.width*d.x)),p>=e.height&&(g=g+d.offsetY+(p*d.y-e.height*d.y)),h=Math.min(e.width,f),r=Math.min(e.height,p);break;case Ms:f=e.width,p=e.height;break;case Ps:case Ls:q===Ps?(f*=q=Math.min(e.height/p,e.width/f),p*=q):q===Ls&&(p*=q=Math.max(e.height/p,e.width/f),(f*=q)>=e.width&&(o=(o+d.offsetX+(f*d.x-e.width*d.x)/f)*h),p>=e.height&&(g=(g+d.offsetY+(p*d.y-e.height*d.y)/p)*r),h*=1/(f/e.width),r*=1/(p/e.height),f=e.width,p=e.height)}var u=f*(q=this.Df()*b.scale)*p*q,m=h*r/u,y=t.__goCache;q=null;var v=Mu;if(!n){if(t.rq&&void 0!==y&&4<u&&m>v*v)for(null===y.gi&&(Pu(y,4,l,c,t),Pu(y,16,l,c,t)),l=(n=y.gi).length,c=0;c<l&&n[c].ratio*n[c].ratio<m;c++)q=n[c];if(!b.Wm){if(null===this.ul)if(null===this.Eg)this.ul=!1;else{n=new Xa(null).context;try{n.drawImage(this.Eg,0,0)}catch(t){this.dn=!1}try{n.getImageData(0,0,1,1).data[3]&&(this.ul=!1),this.ul=!1}catch(t){this.ul=!0}}if(this.ul)return}}switch(n=f<e.width?d.offsetX+(e.width*d.x-f*d.x):0,d=p<e.height?d.offsetY+(e.height*d.y-p*d.y):0,this.flip){case js:a.translate(Math.min(e.width,f),0),a.scale(-1,1);break;case As:a.translate(0,Math.min(e.height,p)),a.scale(1,-1);break;case Fs:a.translate(Math.min(e.width,f),Math.min(e.height,p)),a.scale(-1,-1)}if(a.yc(),b.Gf("pictureRatioOptimization")&&!b.$i&&void 0!==y&&null!==q&&1!==q.ratio){a.save(),b=q.ratio;try{a.drawImage(q.source,o/b,g/b,Math.min(q.source.width,h/b),Math.min(q.source.height,r/b),n,d,Math.min(e.width,f),Math.min(e.height,p)),a instanceof Aa&&(this.at=[o/b,g/b,Math.min(q.source.width,h/b),Math.min(q.source.height,r/b),n,d,Math.min(e.width,f),Math.min(e.height,p)])}catch(t){this.dn=!1}a.restore()}else try{a.drawImage(t,o,g,h,r,n,d,Math.min(e.width,f),Math.min(e.height,p)),a instanceof Aa&&(this.at=[o,g,h,r,n,d,Math.min(e.width,f),Math.min(e.height,p)])}catch(t){this.dn=!1}switch(this.flip){case js:a.scale(-1,1),a.translate(-Math.min(e.width,f),0);break;case As:a.scale(1,-1),a.translate(0,-Math.min(e.height,p));break;case Fs:a.scale(-1,-1),a.translate(-Math.min(e.width,f),-Math.min(e.height,p))}}}}},xu.prototype.Vl=function(a,b,t,e){var n=this.desiredSize,o=sa(this,!0),g=this.Eg,r=this.pn,h=0,l=0;(r||!this.$k&&g&&g.complete)&&(this.$k=!0),null===g?(isFinite(n.width)||(a=0),isFinite(n.height)||(b=0)):(h=r?+g.width:g.naturalWidth,l=r?+g.height:g.naturalHeight),isFinite(n.width)||o===Ms||o===Ns?(isFinite(a)||(this.sourceRect.w()?a=this.sourceRect.width:null!==g&&(a=h)),t=0):null!==g&&!1!==this.$k&&(a=this.sourceRect.w()?this.sourceRect.width:h),isFinite(n.height)||o===Ms||o===Cs?(isFinite(b)||(this.sourceRect.w()?b=this.sourceRect.height:null!==g&&(b=l)),e=0):null!==g&&!1!==this.$k&&(b=this.sourceRect.w()?this.sourceRect.height:l),isFinite(n.width)&&(a=n.width),isFinite(n.height)&&(b=n.height),n=this.maxSize,o=this.minSize,t=Math.max(t||0,o.width),e=Math.max(e||0,o.height),a=Math.min(n.width,a),b=Math.min(n.height,b),a=Math.max(t,a),b=Math.max(e,b),null===g||g.complete||(isFinite(a)||(a=0),isFinite(b)||(b=0)),qt(this.ec,a,b),this.Ge(0,0,a,b)},xu.prototype.eh=function(a,b,t,e){Js(this,a,b,t,e)},v.Object.defineProperties(xu.prototype,{element:{get:function(){return this.Eg},set:function(a){var b=this.Eg;if(this.Uc=!0,b!==a){this.pn=a instanceof HTMLCanvasElement;var t=a instanceof HTMLImageElement;null===a||t||a instanceof HTMLVideoElement||this.pn||T("Picture.element must be an instance of Image, Canvas, or Video, not: "+a);var e=this.diagram;null!==e&&Or(e,this),this.Eg=a,null!==a&&t&&void 0===a.Bg&&(a.Bg=new at),null!==e&&t&&Fr(e,this),null!==a&&(this.pn||!0===a.complete?(a.gn&&(a.kn instanceof Event&&null!==this.Hd?this.Hd(this,a.kn):!0===a.rq&&!a.kn&&null!==this.Zg&&a.du&&this.Zg(this,a.du)),a.rq=!0,this.desiredSize.w()||(ga(this,!1),this.v())):t&&wu(this,a)),this.g("element",b,a),this.N()}}},source:{get:function(){return this.po},set:function(a){var b=this.po;if(b!==a){this.Uc=!0,this.po=a;var t=_l;if($r){var e=null;if(void 0!==t[a])e=t[a];else if(""!==a){30<ku&&(bu(),t=_l),(e=C("img")).gn=!0,wu(this,e);var n=this.ql;null!==n&&(e.crossOrigin=n(this)),e.src=a,t[a]=e,ku++}this.element=e,null!==e&&void 0===e.__goCache&&(e.__goCache=new Su),this.v(),this.N()}this.g("source",b,a)}}},sourceCrossOrigin:{get:function(){return this.ql},set:function(a){if(this.ql!==a&&(this.ql=a,null!==this.element)){var b=this.element.getAttribute("src");null===a&&"string"==typeof b?this.element.crossOrigin=null:null!==a&&(this.element.crossOrigin=a(this)),this.element.src=b}}},sourceRect:{get:function(){return this.Xg},set:function(a){var b=this.Xg;b.D(a)||(this.Xg=a=a.J(),this.N(),this.g("sourceRect",b,a))}},imageStretch:{get:function(){return this.Mk},set:function(a){var b=this.Mk;b!==a&&(this.Mk=a,this.N(),this.g("imageStretch",b,a))}},flip:{get:function(){return this.Xf},set:function(a){var b=this.Xf;b!==a&&(this.Xf=a,this.N(),this.g("flip",b,a))}},imageAlignment:{get:function(){return this.Lk},set:function(a){var b=this.Lk;b.D(a)||(this.Lk=a=a.J(),this.N(),this.g("imageAlignment",b,a))}},errorFunction:{get:function(){return this.Hd},set:function(a){var b=this.Hd;b!==a&&(this.Hd=a,this.g("errorFunction",b,a))}},successFunction:{get:function(){return this.Zg},set:function(a){var b=this.Zg;b!==a&&(this.Zg=a,this.g("successFunction",b,a))}},naturalBounds:{get:function(){return this.ec}}}),xu.prototype.redraw=xu.prototype.redraw,xu.prototype.reloadSource=xu.prototype.hA;var ku=0,Mu=4;function Su(){this.gi=null}function Pu(a,b,t,e,n){null===a.gi&&(a.gi=[]);var o=new Xa(null),g=o.context,r=1/b;o.width=t/b,o.height=e/b,0!==o.width&&0!==o.height&&(b=new Nu(o.Oa,b),t=1,0<a.gi.length&&(n=(t=a.gi[a.gi.length-1]).source,t=t.ratio),g.setTransform(r*t,0,0,r*t,0,0),g.yc(),g.drawImage(n,0,0),a.gi.push(b))}function Nu(a,b){this.source=a,this.ratio=b}function Cu(){this.ns=new Qe,this.nc=null}function Tu(a,b,t,e,n,o){a.nc=new ai,a.nc.startX=b,a.nc.startY=t,a.nc.isFilled=e,a.nc.isEvenOdd=o||!1,a.ns.figures.add(a.nc),void 0!==n&&(a.nc.isShadowed=n)}function Lu(a){var b=a.nc.segments.length;0<b&&a.nc.segments.M(b-1).close()}function Au(a,b,t,e,n,o,g){var r;void 0===r&&(r=!1);var h=new hi(pi);h.point1X=b,h.point1Y=t,h.point2X=e,h.point2Y=n,h.endX=o,h.endY=g,r&&h.close(),a.nc.segments.add(h)}function ju(a,b,t,e,n){var o;void 0===o&&(o=!1);var g=new hi(gi);g.point1X=b,g.point1Y=t,g.endX=e,g.endY=n,o&&g.close(),a.nc.segments.add(g)}function Fu(a,b,t,e,n,o,g,r){var h;void 0===h&&(h=!1),b=new hi(yi,g,r,b,t,e,n,o),h&&b.close(),a.nc.segments.add(b)}function Ou(a){var b=Bu;return null!==b?(Bu=null,b.reset(a),b):((b=new Cu).reset(a),b)}xu.className="Picture",_l=new _,xu.clearCache=bu,Su.className="PictureCacheArray",Nu.className="PictureCacheInstance",Cu.prototype.reset=function(a){null!==a?(a.ka(),this.ns=a,a.figures.clear()):this.ns=new Qe,this.nc=null},Cu.prototype.moveTo=function(a,b,t){void 0===t&&(t=!1);var e=new hi(fi);e.endX=a,e.endY=b,t&&e.close(),this.nc.segments.add(e)},Cu.prototype.lineTo=function(a,b,t){void 0===t&&(t=!1);var e=new hi(di);e.endX=a,e.endY=b,t&&e.close(),this.nc.segments.add(e)},Cu.prototype.arcTo=function(a,b,t,e,n,o,g){void 0===o&&(o=0),void 0===g&&(g=!1);var r=new hi(mi);r.startAngle=a,r.sweepAngle=b,r.centerX=t,r.centerY=e,r.radiusX=n,r.radiusY=0!==o?o:n,g&&r.close(),this.nc.segments.add(r)};var Bu=null;function Du(a,b){var t=a.toLowerCase(),e=$e.Ze;e[a]=b,e[t]=a}function Iu(){this.oc=!1,this.sr=this.Jp=this.yq=null,this.ur="",this.er=this.nq=this.tr=null,this.gr="",this.fr=Rt,this.hr=null,this.ir="",this.kr=Fe,this.Fq="",this.Gq=he,this.Oq=ft,this.Jq=pt,this.Tp=null,this.Bq=127,this.yr=gt,this.xr="gray",this.Vg=4}function zu(a,b){void 0===a||a instanceof Mh||"string"==typeof a?Eh.call(this,a):(Eh.call(this),a&&(b=a)),this.G=2408959,this.Tf="",this.P=null,this.Jg="",this.Qf=this.Ug=null,this.fc="",this.Ah=this.Ig=null,this.ke=new St(NaN,NaN).freeze(),this.nf=null,this.zo=NaN,this.vw=-1,this.py=new Ut,this.Rh=null,this.ag=NaN,b&&Object.assign(this,b)}function Ru(a){null===a.P?a.P=new Iu:a.P.oc&&(a.P=a.P.copy())}function Eu(a){0!=(16384&a.G)!=!1&&(a.updateAdornments(),a.G&=-16385)}function Vu(a){if(!1===_u(a)){$u(a,!0),a.Tk();var b=a.diagram;null!==b&&(b.De.add(a),b.ac())}}function Yu(a){if(a.G|=2097152,!1!==_u(a)){var b=a.position,t=a.location;t.w()&&b.w()||Ku(a,b,t),t=a.Jb;var e=Ut.alloc().assign(t);t.ka(),t.x=b.x,t.y=b.y,t.freeze(),a.Wl(e,t),Ut.free(e),$u(a,!1)}}function Gu(a,b,t,e){void 0===e&&(e=new St),t=t.Mc()?fe:t;var n=b.naturalBounds;if(e.h(n.width*t.x+t.offsetX,n.height*t.y+t.offsetY),null===b||b===a)return e;for(b.transform.Ga(e),b=b.panel;null!==b&&b!==a;)b.transform.Ga(e),b=b.panel;return null!==a.Mb&&a.Mb.Ga(e),e.offset(-a.uc.x,-a.uc.y),e}function Xu(a){var b=St.alloc(),t=a.locationObject,e=t.naturalBounds,n=t instanceof Ll?t.strokeWidth:0;if(b.yi(0,0,e.width+n,e.height+n,a.locationSpot),t!==a)for(b.offset(-n/2,-n/2),t.transform.Ga(b),t=t.panel;null!==t&&t!==a;)t.transform.Ga(b),t=t.panel;return null!==a.Mb&&a.Mb.Ga(b),b.offset(-a.uc.x,-a.uc.y),b}function Uu(a,b){var t=a.py;isNaN(a.ag)&&(a.ag=_h(a));var e=a.ag,n=2*e;if(!a.isShadowed)return t.h(b.x-1-e,b.y-1-e,b.width+2+n,b.height+2+n),t;e=b.x,n=b.y;var o=b.width;b=b.height;var g=a.shadowBlur;return o+=g,b+=g,e-=g/2,n-=g/2,0<(a=a.shadowOffset).x?o+=a.x:(e+=a.x,o-=a.x),0<a.y?b+=a.y:(n+=a.y,b-=a.y),t.h(e-1,n-1,o+2,b+2),t}function qu(a,b,t,e,n){null===b||a instanceof hc||(b=b.animationManager).Ab&&ro(b,a,new St(e,n),t)}function Ku(a,b,t){var e=Xu(a),n=a.diagram,o=t.w(),g=b.w();o&&g?0!=(2097152&a.G)?Hu(a,b,t,n,e):Wu(a,b,t,n,e):o?Hu(a,b,t,n,e):g&&Wu(a,b,t,n,e),a.G|=2097152,St.free(e),a.Tk()}function Hu(a,b,t,e,n){var o=b.x,g=b.y;b.h(t.x-n.x,t.y-n.y),null!==e&&((e=(t=e.animationManager).defaultAnimation.isAnimating)||!t.Ab||a instanceof hc||ro(t,a,new St(o,g),b),e||b.x===o&&b.y===g||a.g("position",new St(o,g),b.copy()))}function Wu(a,b,t,e,n){var o=t.copy();t.h(b.x+n.x,b.y+n.y),t.D(o)||null===e||a.g("location",o,t.copy())}function Ju(a,b,t){Qu(a,!1),a instanceof uc&&Kr(t,a),a.layer.isTemporary||b||t.Ya(),b=a.Jb;var e=t.viewportBounds;e.w()?tc(a)?(_t(b,e)||a.Fd(!1),a.updateAdornments()):a.isVisible()&&b.Yc(e)?(a.Fd(!0),a.updateAdornments()):a.Xb():t.vd=!0}function Zu(a,b,t,e){b.constructor===a.constructor||ac||(ac=!0,j('Should not change the class of the Part when changing category from "'+t+'" to "'+e+'"'),j("  Old class: "+E(a.constructor)+", new class: "+E(b.constructor)+", part: "+a.toString())),a.Dj();var n=a.data;t=a.layerName;var o=a.isSelected,g=a.isHighlighted,r=!0,h=!0,l=!1;a instanceof uc&&(r=a.isTreeLeaf,h=a.isTreeExpanded,l=a.wasTreeExpanded),b.Af(a),b.cloneProtected(a),a.Tf=e,null!==a.svg&&(a.svg.remove(),a.svg=null,a.Uc=!0),a.v(),a.N(),e=!0,null!==(b=a.diagram)&&(e=b.skipsUndoManager,b.skipsUndoManager=!0),a.ub=n,a.G=o?4096|a.G:-4097&a.G,a.G=g?524288|a.G:-524289&a.G,a instanceof uc&&(a.U=r?4|a.U:-5&a.U,a.U=h?1|a.U:-2&a.U,a.U=l?2|a.U:-3&a.U),null!==n&&a.La(),(n=a.layerName)!==t&&(a.Jg=t,a.layerName=n),null!==b&&(b.skipsUndoManager=e),a.Zc()&&a.C(64)}function _u(a){return 0!=(32768&a.G)}function $u(a,b){a.G=b?32768|a.G:-32769&a.G}function Qu(a,b){a.G=b?65536|a.G:-65537&a.G}function tc(a){return 0!=(131072&a.G)}function ec(a,b){a.G=b?1048576|a.G:-1048577&a.G}function ic(a,b){var t=b.containingGroup;return null!==t?1+ic(a,t):b instanceof uc&&null!==(b=b.labeledLink)?ic(a,b):0}function nc(a,b){var t=b.containingGroup;return null!==t||b instanceof uc&&null!==(t=b.labeledLink)?nc(a,t):b}function oc(a,b,t){if(b===t||null===t)return!1;var e=b.containingGroup;return!(null===e||e!==t&&!oc(a,e,t))||b instanceof uc&&null!==(b=b.labeledLink)&&oc(a,b,t)}function rc(a){return!!a.isVisible()&&(null===(a=a.layer)||!a.isTemporary)}function sc(a,b,t,e,n,o){if(void 0===o&&(o=null),!(a.contains(b)||null!==o&&!o(b)||b instanceof hc))if(a.add(b),b instanceof uc){if(t&&b instanceof Cc)for(var g=b.memberParts;g.next();)sc(a,g.value,t,e,n,o);if(!1!==n)for(g=b.linksConnected;g.next();){var r=g.value;if(!a.contains(r)){var h=r.fromNode,l=r.toNode;h=null===h||a.contains(h),l=null===l||a.contains(l),(n?h&&l:h||l)&&sc(a,r,t,e,n,o)}}if(1<e)for(b=b.Ou();b.next();)sc(a,b.value,t,e-1,n,o)}else if(b instanceof Oc)for(b=b.labelNodes;b.next();)sc(a,b.value,t,e,n,o)}Cu.className="StreamGeometryContext",Du("Rectangle",(function(a,b,t){a="r"+b+","+t;var e=$e.Mf[a];return void 0!==e||((e=new Qe(Qe.u)).endX=b,e.endY=t,$e.Nf<$e.um&&($e.Mf[a]=e,$e.Nf++)),e})),Du("Square",(function(a,b,t){a="s"+b+","+t;var e=$e.Mf[a];return void 0!==e||((e=new Qe(Qe.u)).endX=b,e.endY=t,e.defaultStretch=Ps,$e.Nf<$e.um&&($e.Mf[a]=e,$e.Nf++)),e})),Du("RoundedRectangle",(function(a,b,t){a=a?a.parameter1:NaN,(isNaN(a)||0>a)&&(a=5),a=Math.min(a,b/3);var e="rr"+b+","+t+","+(a=Math.min(a,t/3)),n=$e.Mf[e];if(void 0!==n)return n;var o=a*$e.wg;return n=(new Qe).add(new ai(a,0,!0).add(new hi(di,b-a,0)).add(new hi(pi,b,a,b-o,0,b,o)).add(new hi(di,b,t-a)).add(new hi(pi,b-a,t,b,t-o,b-o,t)).add(new hi(di,a,t)).add(new hi(pi,0,t-a,o,t,0,t-o)).add(new hi(di,0,a)).add(new hi(pi,a,0,0,o,o,0).close())),1<o&&(n.spot1=new qe(0,0,o,o),n.spot2=new qe(1,1,-o,-o)),$e.Nf<$e.um&&($e.Mf[e]=n,$e.Nf++),n})),Du("Border","RoundedRectangle"),Du("Ellipse",(function(a,b,t){a="e"+b+","+t;var e=$e.Mf[a];return void 0!==e||((e=new Qe(Qe.F)).endX=b,e.endY=t,e.spot1=dd,e.spot2=Ye,$e.Nf<$e.um&&($e.Mf[a]=e,$e.Nf++)),e})),Du("Circle",(function(a,b,t){a="c"+b+","+t;var e=$e.Mf[a];return void 0!==e||((e=new Qe(Qe.F)).endX=b,e.endY=t,e.spot1=dd,e.spot2=Ye,e.defaultStretch=Ps,$e.Nf<$e.um&&($e.Mf[a]=e,$e.Nf++)),e})),Du("TriangleRight",(function(a,b,t){return(new Qe).add(new ai(0,0).add(new hi(di,b,.5*t)).add(new hi(di,0,t).close())).om(0,.25,.5,.75)})),Du("TriangleDown",(function(a,b,t){return(new Qe).add(new ai(0,0).add(new hi(di,b,0)).add(new hi(di,.5*b,t).close())).om(.25,0,.75,.5)})),Du("TriangleLeft",(function(a,b,t){return(new Qe).add(new ai(b,t).add(new hi(di,0,.5*t)).add(new hi(di,b,0).close())).om(.5,.25,1,.75)})),Du("TriangleUp",(function(a,b,t){return(new Qe).add(new ai(b,t).add(new hi(di,0,t)).add(new hi(di,.5*b,0).close())).om(.25,.5,.75,1)})),Du("Triangle","TriangleUp"),Du("Diamond",(function(a,b,t){return(new Qe).add(new ai(.5*b,0).add(new hi(di,0,.5*t)).add(new hi(di,.5*b,t)).add(new hi(di,b,.5*t).close())).om(.25,.25,.75,.75)})),Du("LineH",(function(a,b,t){return(a=new Qe(Qe.j)).startX=0,a.startY=t/2,a.endX=b,a.endY=t/2,a})),Du("LineV",(function(a,b,t){return(a=new Qe(Qe.j)).startX=b/2,a.startY=0,a.endX=b/2,a.endY=t,a})),Du("None","Rectangle"),Du("BarH","Rectangle"),Du("BarV","Rectangle"),Du("MinusLine","LineH"),Du("PlusLine",(function(a,b,t){return(new Qe).add(new ai(0,t/2,!1).add(new hi(di,b,t/2)).add(new hi(fi,b/2,0)).add(new hi(di,b/2,t)))})),Du("XLine",(function(a,b,t){return(new Qe).add(new ai(0,t,!1).add(new hi(di,b,0)).add(new hi(fi,0,0)).add(new hi(di,b,t)))})),Du("LineRight",(function(a,b,t){return(new Qe).add(new ai(.25*b,0,!1).add(new hi(di,.75*b,.5*t)).add(new hi(di,.25*b,t)))})),Du("LineDown",(function(a,b,t){return(new Qe).add(new ai(0,.25*t,!1).add(new hi(di,.5*b,.75*t)).add(new hi(di,b,.25*t)))})),Du("LineLeft",(function(a,b,t){return(new Qe).add(new ai(.75*b,0,!1).add(new hi(di,.25*b,.5*t)).add(new hi(di,.75*b,t)))})),Du("LineUp",(function(a,b,t){return(new Qe).add(new ai(0,.75*t,!1).add(new hi(di,.5*b,.25*t)).add(new hi(di,b,.75*t)))})),$e.tm={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"},Iu.prototype.copy=function(){var a=new Iu;return a.yq=this.yq,a.Jp=this.Jp,a.sr=this.sr,a.ur=this.ur,a.tr=this.tr,a.nq=this.nq,a.er=this.er,a.gr=this.gr,a.fr=this.fr.J(),a.hr=this.hr,a.ir=this.ir,a.kr=this.kr.J(),a.Fq=this.Fq,a.Gq=this.Gq.J(),a.Oq=this.Oq.J(),a.Jq=this.Jq.J(),a.Tp=this.Tp,a.Bq=this.Bq,a.yr=this.yr.J(),a.xr=this.xr,a.Vg=this.Vg,a},y(zu,Eh),zu.prototype.cloneProtected=function(a){Eh.prototype.cloneProtected.call(this,a),a.G=-4097&this.G|49152,a.Tf=this.Tf,null!==this.P&&(a.P=this.P.oc?this.P:this.P.copy()),a.Jg=this.Jg,a.Qf=null,a.fc=this.fc,a.ke.assign(this.ke),a.zo=this.zo},(e=zu.prototype).Af=function(a){Eh.prototype.Af.call(this,a),a.oh(),a.Ug=null,a.nf=null,a.Rh=null},e.toString=function(){var a=E(this.constructor)+"#"+ut(this);return null!==this.data&&(a+="("+V(this.data)+")"),a},e.th=function(){Eh.prototype.th.call(this),null!==this.P&&(this.P.oc=!0)},e.fk=function(a,b,t,e,n,o,g){var r=this.diagram;null!==r&&(a===Mi&&"elements"===b?n instanceof Eh?Kh(n,(function(a){vd(r.partManager,a),jr(r,a)})):Fr(r,n):a===Si&&"elements"===b&&(n instanceof Eh?Kh(n,(function(a){xd(r.partManager,a,r)})):Or(r,n)),r.cb(a,b,t,e,n,o,g))},e.La=function(a){if(Eh.prototype.La.call(this,a),null!==this.data){for(var b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e];n instanceof Eh&&Kh(n,(function(a){null!==a.data&&a.La()}))}for(b=this.adornments;b.next();)b.value.La(a)}},zu.prototype.updateRelationshipsFromData=function(){var a;null!==this.data&&(null===(a=this.diagram)||void 0===a||a.partManager.updateRelationshipsFromData(this))},zu.prototype.Oj=function(a){var b=this.Qf;return null===b?null:b.I(a)},zu.prototype.bh=function(a,b){if(null!==b){var t=null,e=this.Qf;if(null!==e&&(t=e.I(a)),t!==b){if(null!==t){var n=t.diagram;null!==n&&n.remove(t)}null===e&&(this.Qf=e=new Mt),b.Tf!==a&&(b.category=a),e.add(a,b),null!==(a=this.diagram)&&(a.add(b),null!==(a=b.adornedObject)&&(null!==(a=a.ih())&&(b.data=a.data)))}}},zu.prototype.Jf=function(a){var b=this.Qf;if(null!==b){var t=b.I(a);if(null!==t){var e=t.diagram;null!==e&&e.remove(t)}b.remove(a),0===b.count&&(this.Qf=null)}},zu.prototype.Dj=function(){var a=this.Qf;if(null!==a){var b=z();for(a=a.iterator;a.next();)b.push(a.key);a=b.length;for(var t=0;t<a;t++)this.Jf(b[t]);R(b)}},zu.prototype.updateAdornments=function(){var a=this.diagram;if(null!==a){for(var b=this.adornments;b.next();){var t=b.value;t.v(),t.placeholder&&t.placeholder.v()}t:{if(this.isSelected&&this.selectionAdorned&&(null!==(b=this.selectionObject)&&this.actualBounds.w()&&this.isVisible()&&b.Ed()&&b.actualBounds.w())){if(null===(t=this.Oj("Selection"))){if(null===(t=this.selectionAdornmentTemplate)&&(t=this.ph()?a.linkSelectionAdornmentTemplate:this instanceof Cc?a.groupSelectionAdornmentTemplate:a.nodeSelectionAdornmentTemplate),!(t instanceof hc))break t;al(t),null!==(t=t.copy())&&(this.ph()&&this.selectionObject===this.path&&(t.type=Eh.Link),t.adornedObject=b)}if(null!==t){t.type===Eh.Link&&t.v(),this.bh("Selection",t);break t}}this.Jf("Selection")}for(function(a,b){b.toolManager.mouseDownTools.each((function(b){b.isEnabled&&b.updateAdornments(a)})),b.toolManager.updateAdornments(a)}(this,a),b=this.adornments;b.next();)b.value.La()}},zu.prototype.Xb=function(){var a=this.diagram;null!==a&&(a.vd=!0,0!=(16384&this.G)!=!0&&(this.G|=16384))},zu.prototype.Ge=function(a,b,t,e){var n=this.uc;n.h(a,b,t,e),null===this.Mb&&(this.Mb=new Ze);var o=this.Mb;o.reset(),this.mo(o,a,b,t,e),this.Mb=o,o.vs()||o.op(n)},zu.prototype.mo=function(a,b,t,e,n){if(1!==this.Ca&&a.scale(this.Ca),0!==this.Lb){var o=fe;this.locationSpot.sb()&&(o=this.locationSpot);var g=St.alloc();if(this.locationObject!==this)for(t=(b=this.locationObject).naturalBounds,g.yi(t.x,t.y,t.width,t.height,o),null!==b.Mb&&b.Mb.Ga(g),g.offset(-b.measuredBounds.x,-b.measuredBounds.y),o=b.panel;null!==o&&o!==this;)null!==o.Mb&&o.Mb.Ga(g),g.offset(-o.measuredBounds.x,-o.measuredBounds.y),o=o.panel;else g.yi(b,t,e,n,o);a.rotate(this.Lb,g.x,g.y),St.free(g)}},zu.prototype.move=function(a,b){!0===b?this.location=a:this.position=a},zu.prototype.moveTo=function(a,b,t){a=St.allocAt(a,b),this.move(a,t),St.free(a)},zu.prototype.isVisible=function(){if(!this.visible)return!1;var a=this.layer;if(null!==a){if(!a.visible)return!1;if(null!==(a=a.diagram)&&a.animationManager.fv(this))return!0}return!!(null===(a=this.containingGroup)||a.isSubGraphExpanded&&a.isVisible())},zu.prototype.$b=function(a){var b=this.diagram;a?(this.C(4),this.Xb(),null!==b&&b.De.add(this)):(this.C(8),this.Dj()),this.oh(),null!==b&&(b.Ya(),b.N())},zu.prototype.fb=function(a){if(this.name===a)return this;var b=this.Rh;if(null===b&&(this.Rh=b=new Mt),null!==b.I(a))return b.I(a);var t=Eh.prototype.fb.call(this,a);return null!==t?(b.set(a,t),t):(b.set(a,null),null)},zu.prototype.mi=function(a){return void 0===a&&(a=new Ut),a.assign(this.actualBounds)},zu.prototype.Va=function(){this.measure(1/0,1/0),this.arrange()},zu.prototype.arrange=function(){if(!1===ma(this))Yu(this);else{ya(this,!1);var a=this.Jb,b=Ut.alloc();b.assign(a);var t=tc(this);this.eh(0,0,this.uc.width,this.uc.height);var e=this.position;Ku(this,e,this.location),a.ka(),a.x=e.x,a.y=e.y,a.freeze(),this.Wl(b,a),b.D(a)?this.Fd(t):!this.Zc()||$e.B(b.width,a.width)&&$e.B(b.height,a.height)||0<=this.vw&&this.C(16),Ut.free(b),$u(this,!1)}},(e=zu.prototype).Wl=function(a,b){var t=this.diagram;if(null!==t){var e=!1;if(!1===t.Zi&&a.w()){var n=Ut.alloc();n.assign(t.documentBounds),n.Fv(t.padding),a.x>n.x&&a.y>n.y&&a.right<n.right&&a.bottom<n.bottom&&b.x>n.x&&b.y>n.y&&b.right<n.right&&b.bottom<n.bottom&&(e=!0),Ut.free(n)}0!=(65536&this.G)!=!0&&a.D(b)||Ju(this,e,t),t.N(),!a.w()&&!b.w()||Wt(a,b)||(this instanceof uc&&!t.undoManager.isUndoingRedoing&&this.Bd(),this.oh())}},e.zv=function(a,b,t){if(this.ph()||!a.w())return!1;var e=this.diagram;return null!==e&&qu(this,e,a,b,t),this.pa=a,this.G&=-2097153,!this.ke.w()||null!==e&&!e.animationManager.isTicking&&e.undoManager.isUndoingRedoing||(e=this.ke,this.ke=new St(e.x+(a.x-b),e.y+(a.y-t)),this.g("location",e,this.ke.copy())),!1===_u(this)&&!1===ma(this)&&(Vu(this),Yu(this)),!0},e.lm=function(a,b,t){var e=this.ke,n=this.pa;if(t){if(e.x===a&&e.y===b)return;_u(this)||ma(this)?n.h(NaN,NaN):n.h(n.x+a-e.x,n.y+b-e.y),e.h(a,b)}else{if(n.x===a&&n.y===b)return;e.h(e.x+a-n.x,e.y+b-n.y),n.h(a,b)}Vu(this)},e.Av=function(){this.G&=-2097153,Vu(this)},e.si=function(){return!0},e.Zc=function(){return!0},e.ph=function(){return!1},e.Dd=function(){return!0},zu.prototype.canCopy=function(){if(!this.copyable)return!1;var a=this.layer;return null===a||!!a.allowCopy&&(null===(a=a.diagram)||!!a.allowCopy)},zu.prototype.canDelete=function(){if(!this.deletable)return!1;var a=this.layer;return null===a||!!a.allowDelete&&(null===(a=a.diagram)||!!a.allowDelete)},zu.prototype.canEdit=function(){if(!this.textEditable)return!1;var a=this.layer;return null===a||!!a.allowTextEdit&&(null===(a=a.diagram)||!!a.allowTextEdit)},zu.prototype.canGroup=function(){if(!this.groupable)return!1;var a=this.layer;return null===a||!!a.allowGroup&&(null===(a=a.diagram)||!!a.allowGroup)},zu.prototype.canMove=function(){if(!this.movable)return!1;var a=this.layer;return null===a||!!a.allowMove&&(null===(a=a.diagram)||!!a.allowMove)},zu.prototype.canReshape=function(){if(!this.reshapable)return!1;var a=this.layer;return null===a||!!a.allowReshape&&(null===(a=a.diagram)||!!a.allowReshape)},zu.prototype.canResize=function(){if(!this.resizable)return!1;var a=this.layer;return null===a||!!a.allowResize&&(null===(a=a.diagram)||!!a.allowResize)},zu.prototype.canRotate=function(){if(!this.rotatable)return!1;var a=this.layer;return null===a||!!a.allowRotate&&(null===(a=a.diagram)||!!a.allowRotate)},zu.prototype.canSelect=function(){if(!this.selectable)return!1;var a=this.layer;return null===a||!!a.allowSelect&&(null===(a=a.diagram)||!!a.allowSelect)},(e=zu.prototype).Fd=function(a){this.G=a?131072|this.G:-131073&this.G},e.oh=function(){var a=this.containingGroup;null!==a&&(a.v(),null!==a.placeholder&&a.placeholder.v(),a.Bd())},e.N=function(){var a=this.diagram;null!==a&&!ma(this)&&!_u(this)&&this.isVisible()&&this.Jb.w()&&a.N(Uu(this,this.Jb))},e.v=function(){Eh.prototype.v.call(this);var a=this.diagram;null!==a&&(a.De.add(this),this instanceof uc&&null!==this.labeledLink&&ra(this.labeledLink),a.ac(!0))},e.Uo=function(a){a||null!==(a=this.Ah)&&Tc(a,this)},e.Vo=function(a){a||null!==(a=this.Ah)&&Lc(a,this)},e.Kj=function(){var a=this.data;if(null!==a){var b=this.diagram;null!==b&&(null!==(b=b.model)&&b.bm(a))}},e.oz=function(){return ic(this,this)},e.sz=function(){return nc(this,this)},e.Td=function(a){return a instanceof Cc&&oc(this,this,a)},e.px=function(a){if(null===a)return null;if(this===a)return this.containingGroup;for(var b=this;null!==b;){if(b instanceof Cc&&ec(b,!0),b instanceof uc){var t=b.labeledLink;null!==t&&(b=t)}b=b.containingGroup}for(t=null,b=a;null!==b;){if(0!=(1048576&b.G)){t=b;break}b instanceof uc&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup}for(b=this;null!==b;)b instanceof Cc&&ec(b,!1),b instanceof uc&&(null!==(a=b.labeledLink)&&(b=a)),b=b.containingGroup;return t},zu.prototype.canLayout=function(){if(!this.isLayoutPositioned||!this.isVisible())return!1;var a=this.layer;return!(null!==a&&a.isTemporary||this instanceof uc&&this.isLinkLabel)},zu.prototype.C=function(a){if(void 0===a&&(a=16777215),this.isLayoutPositioned&&0!=(a&this.layoutConditions)){var b=this.layer;null!==b&&b.isTemporary||this instanceof uc&&this.isLinkLabel?b=!1:b=null===(b=this.diagram)||!b.undoManager.isUndoingRedoing}else b=!1;if(b)if(null!==(b=this.Ah)){var t=b.layout;null!==t?t.C():b.C(a)}else null!==(a=this.diagram)&&(null!==(a=a.layout)&&a.C())},v.Object.defineProperties(zu.prototype,{key:{get:function(){var a=this.diagram;if(null!==a)return a.model.wa(this.data)}},adornments:{get:function(){return null===this.Qf?tt:this.Qf.iteratorValues}},layer:{get:function(){return this.Ig}},diagram:{get:function(){var a=this.Ig;return null==a?null:a.diagram}},layerName:{get:function(){return this.Jg},set:function(a){var b=this.Jg;if(b!==a){var t=this.diagram;if((null===t||null!==t.Pj(a)&&!t.partManager.addsToTemporaryLayer)&&(this.Jg=a,null!==t&&t.Ya(),this.g("layerName",b,a),null!==(b=this.layer)&&b.name!==a&&(null!==(t=b.diagram)&&(null!==(a=t.Pj(a))&&a!==b)))){var e=b.qc(-1,this,!0);if(0<=e&&t.cb(Si,"parts",b,this,null,e,!0),e=a.oi(99999999,this,!0),b.visible!==a.visible&&this.$b(a.visible),0<=e&&t.cb(Mi,"parts",a,null,this,!0,e),null!==(e=this.layerChanged)){var n=t.aa;t.aa=!0,e(this,b,a),t.aa=n}}}}},layerChanged:{get:function(){return null!==this.P?this.P.yq:null},set:function(a){var b=this.layerChanged;b!==a&&(Ru(this),this.P.yq=a,this.g("layerChanged",b,a))}},zOrder:{get:function(){return this.zo},set:function(a){var b=this.zo;if(b!==a){this.zo=a;var t=this.layer;null!==t&&Io(t,-1,this),this.g("zOrder",b,a),null!==(a=this.diagram)&&a.N()}}},locationObject:{get:function(){if(null===this.nf){var a=this.locationObjectName;""!==a?(a=this.fb(a),this.nf=null!==a?a:this):this instanceof hc&&this.type!==Eh.Link&&null!==this.placeholder?this.nf=this.placeholder:this.nf=this}return this.nf.visible?this.nf:this}},minLocation:{get:function(){return null!==this.P?this.P.Oq:ft},set:function(a){var b=this.minLocation;b.D(a)||(a=a.J(),Ru(this),this.P.Oq=a,this.g("minLocation",b,a))}},maxLocation:{get:function(){return null!==this.P?this.P.Jq:pt},set:function(a){var b=this.maxLocation;b.D(a)||(a=a.J(),Ru(this),this.P.Jq=a,this.g("maxLocation",b,a))}},locationObjectName:{get:function(){return null!==this.P?this.P.Fq:""},set:function(a){var b=this.locationObjectName;b!==a&&(Ru(this),this.P.Fq=a,this.nf=null,this.v(),this.g("locationObjectName",b,a))}},locationSpot:{get:function(){return null!==this.P?this.P.Gq:he},set:function(a){var b=this.locationSpot;b.D(a)||(a=a.J(),Ru(this),this.P.Gq=a,this.v(),this.g("locationSpot",b,a))}},location:{get:function(){return this.ke},set:function(a){var b=a.x,t=a.y,e=this.ke;if(!(e.x===b||isNaN(e.x)&&isNaN(b))||!(e.y===t||isNaN(e.y)&&isNaN(t))){if(b=a=a.copy(),this.ph())b=!1;else{if(this.ke=b,this.G|=2097152,!1===ma(this)&&(Vu(this),(t=this.pa).w())){var n=this.diagram;if(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing){var o=t.copy();t.h(t.x+(b.x-e.x),t.y+(b.y-e.y)),qu(this,n,t,o.x,o.y),this.g("position",o,t.copy())}}b=!0}b&&this.g("location",e,a.copy())}}},category:{get:function(){return this.Tf},set:function(a){var b=this.Tf;if(b!==a){null!==this.svg&&(this.svg.remove(),this.Uc=!0);var t=this.diagram,e=this.data,n=null;if(null!==t&&null!==e&&!(this instanceof hc)){var o=t.model.undoManager;o.isEnabled&&!o.isUndoingRedoing&&(n=this.clone()).O.addAll(this.O)}this.Tf=a,this.g("category",b,a),null===t||null===e||this instanceof hc?this instanceof hc&&(null!==(n=this.adornedPart)&&(null!==(a=n.Qf)&&a.remove(b),n.bh(this.category,this))):(o=t.model).undoManager.isUndoingRedoing||(this.ph()?(t.partManager.setLinkCategoryForData(e,a),null!==(t=t.partManager.findLinkTemplateForCategory(a))&&(al(t),null!==(t=t.copy())&&Zu(this,t,b,a))):(null!==o&&o.im(e,a),null!==(t=gd(t.partManager,e,a))&&(al(t),null===(t=t.copy())||t instanceof Oc||(e=this.location.copy(),Zu(this,t,b,a),this.location.w()||(this.location=e)))),null!==n&&((b=this.clone()).O.addAll(this.O),this.g("self",n,b)))}}},self:{get:function(){return this},set:function(a){Zu(this,a,this.category,a.category)}},copyable:{get:function(){return 0!=(1&this.G)},set:function(a){var b=0!=(1&this.G);b!==a&&(this.G^=1,this.g("copyable",b,a))}},deletable:{get:function(){return 0!=(2&this.G)},set:function(a){var b=0!=(2&this.G);b!==a&&(this.G^=2,this.g("deletable",b,a))}},textEditable:{get:function(){return 0!=(4&this.G)},set:function(a){var b=0!=(4&this.G);b!==a&&(this.G^=4,this.g("textEditable",b,a),this.Xb())}},groupable:{get:function(){return 0!=(8&this.G)},set:function(a){var b=0!=(8&this.G);b!==a&&(this.G^=8,this.g("groupable",b,a))}},movable:{get:function(){return 0!=(16&this.G)},set:function(a){var b=0!=(16&this.G);b!==a&&(this.G^=16,this.g("movable",b,a))}},selectionAdorned:{get:function(){return 0!=(32&this.G)},set:function(a){var b=0!=(32&this.G);b!==a&&(this.G^=32,this.g("selectionAdorned",b,a),this.Xb())}},isInDocumentBounds:{get:function(){return 0!=(64&this.G)},set:function(a){var b=0!=(64&this.G);if(b!==a){this.G^=64;var t=this.diagram;null!==t&&t.Ya(),this.g("isInDocumentBounds",b,a)}}},isLayoutPositioned:{get:function(){return 0!=(128&this.G)},set:function(a){var b=0!=(128&this.G);b!==a&&(this.G^=128,this.g("isLayoutPositioned",b,a),this.C(a?4:8))}},selectable:{get:function(){return 0!=(256&this.G)},set:function(a){var b=0!=(256&this.G);b!==a&&(this.G^=256,this.g("selectable",b,a),this.Xb())}},reshapable:{get:function(){return 0!=(512&this.G)},set:function(a){var b=0!=(512&this.G);b!==a&&(this.G^=512,this.g("reshapable",b,a),this.Xb())}},resizable:{get:function(){return 0!=(1024&this.G)},set:function(a){var b=0!=(1024&this.G);b!==a&&(this.G^=1024,this.g("resizable",b,a),this.Xb())}},rotatable:{get:function(){return 0!=(2048&this.G)},set:function(a){var b=0!=(2048&this.G);b!==a&&(this.G^=2048,this.g("rotatable",b,a),this.Xb())}},isSelected:{get:function(){return 0!=(4096&this.G)},set:function(a){var b=0!=(4096&this.G);if(b!==a){var t=this.diagram;if(!a||this.canSelect()&&!(null!==t&&t.selection.count>=t.maxSelectionCount)){this.G^=4096;var e=!1;if(null!==t){e=t.skipsUndoManager,t.skipsUndoManager=!0;var n=t.selection;n.ka(),a?n.add(this):n.remove(this),n.freeze()}this.g("isSelected",b,a),this.Xb(),null!==(a=this.selectionChanged)&&a(this),null!==t&&(t.ac(),t.skipsUndoManager=e)}}}},isHighlighted:{get:function(){return 0!=(524288&this.G)},set:function(a){var b=0!=(524288&this.G);if(b!==a){this.G^=524288;var t=this.diagram;null!==t&&((t=t.highlighteds).ka(),a?t.add(this):t.remove(this),t.freeze()),this.g("isHighlighted",b,a),this.N(),null!==(a=this.highlightedChanged)&&a(this)}}},isShadowed:{get:function(){return 0!=(8192&this.G)},set:function(a){var b=0!=(8192&this.G);b!==a&&(this.G^=8192,this.Uc=!0,this.g("isShadowed",b,a),this.N())}},isAnimated:{get:function(){return 0!=(262144&this.G)},set:function(a){var b=0!=(262144&this.G);b!==a&&(this.G^=262144,this.g("isAnimated",b,a))}},highlightedChanged:{get:function(){return null!==this.P?this.P.nq:null},set:function(a){var b=this.highlightedChanged;b!==a&&(Ru(this),this.P.nq=a,this.g("highlightedChanged",b,a))}},selectionObjectName:{get:function(){return null!==this.P?this.P.ur:""},set:function(a){var b=this.selectionObjectName;b!==a&&(Ru(this),this.P.ur=a,this.Ug=null,this.g("selectionObjectName",b,a))}},selectionAdornmentTemplate:{get:function(){return null!==this.P?this.P.sr:null},set:function(a){var b=this.selectionAdornmentTemplate;b!==a&&(Ru(this),this.P.sr=a,this.g("selectionAdornmentTemplate",b,a))}},selectionObject:{get:function(){if(null===this.Ug){var a=this.selectionObjectName;null!==a&&""!==a?(a=this.fb(a),this.Ug=null!==a?a:this):this instanceof Oc?(a=this.path,this.Ug=null!==a?a:this):this.Ug=this}return this.Ug}},selectionChanged:{get:function(){return null!==this.P?this.P.tr:null},set:function(a){var b=this.selectionChanged;b!==a&&(Ru(this),this.P.tr=a,this.g("selectionChanged",b,a))}},resizeAdornmentTemplate:{get:function(){return null!==this.P?this.P.er:null},set:function(a){var b=this.resizeAdornmentTemplate;b!==a&&(Ru(this),this.P.er=a,this.g("resizeAdornmentTemplate",b,a))}},resizeObjectName:{get:function(){return null!==this.P?this.P.gr:""},set:function(a){var b=this.resizeObjectName;b!==a&&(Ru(this),this.P.gr=a,this.g("resizeObjectName",b,a))}},resizeObject:{get:function(){var a=this.resizeObjectName;return""!==a&&null!==(a=this.fb(a))?a:this}},resizeCellSize:{get:function(){return null!==this.P?this.P.fr:Rt},set:function(a){var b=this.resizeCellSize;b.D(a)||(a=a.J(),Ru(this),this.P.fr=a,this.g("resizeCellSize",b,a))}},rotateAdornmentTemplate:{get:function(){return null!==this.P?this.P.hr:null},set:function(a){var b=this.rotateAdornmentTemplate;b!==a&&(Ru(this),this.P.hr=a,this.g("rotateAdornmentTemplate",b,a))}},rotateObjectName:{get:function(){return null!==this.P?this.P.ir:""},set:function(a){var b=this.rotateObjectName;b!==a&&(Ru(this),this.P.ir=a,this.g("rotateObjectName",b,a))}},rotateObject:{get:function(){var a=this.rotateObjectName;return""!==a&&null!==(a=this.fb(a))?a:this}},rotationSpot:{get:function(){return null!==this.P?this.P.kr:Fe},set:function(a){var b=this.rotationSpot;b.D(a)||(a=a.J(),Ru(this),this.P.kr=a,this.g("rotationSpot",b,a))}},text:{get:function(){return this.fc},set:function(a){var b=this.fc;b!==a&&(this.fc=a,this.g("text",b,a))}},containingGroup:{get:function(){return this.Ah},set:function(a){if(this.Zc()){var b=this.Ah;if(b!==a){null===a||this!==a&&!a.Td(this)||(this===a&&T("Cannot make a Group a member of itself: "+this.toString()),T("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+a.toString())),this.C(2);var t=this.diagram;if(null!==b?Lc(b,this):this instanceof Cc&&null!==t&&t.ai.remove(this),this.Ah=a,null!==a?Tc(a,this):this instanceof Cc&&null!==t&&t.ai.add(this),this.C(1),null!==t&&t.aa){var e=this.data,n=t.model;if(null!==e&&n.Wj()){var o=n.wa(null!==a?a.data:null);n.lp(e,o)}}if(null!==(e=this.containingGroupChanged)&&(n=!0,null!==t&&(n=t.aa,t.aa=!0),e(this,b,a),null!==t&&(t.aa=n)),this instanceof Cc)for(sc(t=new at,this,!0,0,!0),t=t.iterator;t.next();)if((e=t.value)instanceof uc)for(e=e.linksConnected;e.next();)Bc(e.value);if(this instanceof uc){for(t=this.linksConnected;t.next();)Bc(t.value);null!==(t=this.labeledLink)&&Bc(t)}this.g("containingGroup",b,a),null!==a&&(null!==(b=a.layer)&&Io(b,-1,a))}}else T("cannot set the Part.containingGroup of a Link or Adornment")}},containingGroupChanged:{get:function(){return null!==this.P?this.P.Jp:null},set:function(a){var b=this.containingGroupChanged;b!==a&&(Ru(this),this.P.Jp=a,this.g("containingGroupChanged",b,a))}},isTopLevel:{get:function(){return!(null!==this.containingGroup||this instanceof uc&&null!==this.labeledLink)}},layoutConditions:{get:function(){return null!==this.P?this.P.Bq:127},set:function(a){var b=this.layoutConditions;b!==a&&(Ru(this),this.P.Bq=a,this.g("layoutConditions",b,a))}},dragComputation:{get:function(){return null!==this.P?this.P.Tp:null},set:function(a){var b=this.dragComputation;b!==a&&(Ru(this),this.P.Tp=a,this.g("dragComputation",b,a))}},shadowOffset:{get:function(){return null!==this.P?this.P.yr:gt},set:function(a){var b=this.shadowOffset;b.D(a)||(a=a.J(),Ru(this),this.P.yr=a,this.N(),this.g("shadowOffset",b,a))}},shadowColor:{get:function(){return null!==this.P?this.P.xr:"gray"},set:function(a){var b=this.shadowColor;b!==a&&(Ru(this),this.P.xr=a,this.N(),this.g("shadowColor",b,a))}},shadowBlur:{get:function(){return null!==this.P?this.P.Vg:4},set:function(a){var b=this.shadowBlur;b!==a&&(Ru(this),this.P.Vg=a,this.N(),this.g("shadowBlur",b,a))}}}),zu.prototype.invalidateLayout=zu.prototype.C,zu.prototype.findCommonContainingGroup=zu.prototype.px,zu.prototype.isMemberOf=zu.prototype.Td,zu.prototype.findTopLevelPart=zu.prototype.sz,zu.prototype.findSubGraphLevel=zu.prototype.oz,zu.prototype.ensureBounds=zu.prototype.Va,zu.prototype.getDocumentBounds=zu.prototype.mi,zu.prototype.findObject=zu.prototype.fb,zu.prototype.moveTo=zu.prototype.moveTo,zu.prototype.invalidateAdornments=zu.prototype.Xb,zu.prototype.clearAdornments=zu.prototype.Dj,zu.prototype.removeAdornment=zu.prototype.Jf,zu.prototype.addAdornment=zu.prototype.bh,zu.prototype.findAdornment=zu.prototype.Oj,zu.prototype.updateTargetBindings=zu.prototype.La;var ac=!1;function hc(a,b){void 0===a||a instanceof Mh||"string"==typeof a?zu.call(this,a):(zu.call(this),a&&(b=a)),this.G&=-257,this.Jg="Adornment",this.ue=null,this.Aw=0,this.Uw=!1,this.j=this.$a=null,b&&Object.assign(this,b)}function lc(){this.oc=!1,this.Ur=this.gj=this.Dq=this.Cq=null,this.xp=Xe,this.dr=Pc,this.Jr=this.ij=this.Mq=this.Lq=null}function uc(a,b){void 0===a||a instanceof Mh||"string"==typeof a?zu.call(this,a):(zu.call(this),a&&(b=a)),this.U=13,this.Ba=null,this.jb=new ot,this.wc=this.af=this.Xk=null,this.ci=!1,b&&Object.assign(this,b)}function cc(a){null===a.Ba?a.Ba=new lc:a.Ba.oc&&(a.Ba=a.Ba.copy())}function fc(a,b){null!==b&&(null===a.af&&(a.af=new at),a.af.add(b))}function dc(a,b,t,e){if(null===b||null===a.af)return null;for(var n=a.af.iterator;n.next();){var o=n.value;if(o.Cs===a&&o.cv===b&&o.Ox===t&&o.Px===e||o.Cs===b&&o.cv===a&&o.Ox===e&&o.Px===t)return o}return null}function ol(a,b){for(a=a.linksConnected;a.next();){var t=a.value;t.fromPort!==b&&t.toPort!==b||(pc(t.fromPort),pc(t.toPort),t.bb())}}function pc(a){if(null!==a){var b=a.Yn;null!==b&&b.Rl(),null===(b=(a=a.part).containingGroup)||a.isVisible()||pc(b.port)}}function gc(a,b,t,e){if(null!==b&&!t.has(b)){t.add(b);var n=!0,o=a.diagram;null!==o&&(n=o.isTreePathToChildren),b.linksConnected.each((function(o){o.isTreeLink?(n?o.fromNode===b:o.toNode===b)&&gc(a,n?o.toNode:o.fromNode,t,e):e.add(o)}))}}function rp(a,b,t){pc(t);var e=a.jb.contains(b);if(e||a.jb.add(b),!e||b.fromNode===b.toNode){var n=a.linkConnected;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.aa,g.aa=!0),n(a,b,t),null!==g&&(g.aa=o)}}!e&&b.isTreeLink&&(t=b.fromNode,b=b.toNode,null!==t&&null!==b&&t!==b&&(e=!0,null!==(a=a.diagram)&&(e=a.isTreePathToChildren),o=e?t:b,(n=e?b:t).ci||(n.ci=o),!o.isTreeLeaf||null!==a&&a.undoManager.isUndoingRedoing||(e?t===o&&(o.isTreeLeaf=!1):b===o&&(o.isTreeLeaf=!1))))}function mc(a,b,t){pc(t);var e=a.jb.remove(b),n=null;if(e||b.toNode===b.fromNode){var o=a.linkDisconnected;if(n=a.diagram,null!==o){var g=!0;null!==n&&(g=n.aa,n.aa=!0),o(a,b,t),null!==n&&(n.aa=g)}}e&&b.isTreeLink&&(t=!0,null!==n&&(t=n.isTreePathToChildren),a=t?b.toNode:b.fromNode,b=t?b.fromNode:b.toNode,null!==a&&(a.ci=!1),null===b||b.isTreeLeaf||(0===b.jb.count?(b.ci=null,null!==n&&n.undoManager.isUndoingRedoing||(b.isTreeLeaf=!0)):yc(b)))}function yc(a){if(a.ci=!1,0!==a.jb.count){var b=!0,t=a.diagram;if(null===t||!t.undoManager.isUndoingRedoing){for(null!==t&&(b=t.isTreePathToChildren),t=a.jb.iterator;t.next();){var e=t.value;if(e.isTreeLink)if(b){if(e.fromNode===a)return void(a.isTreeLeaf=!1)}else if(e.toNode===a)return void(a.isTreeLeaf=!1)}a.isTreeLeaf=!0}}}function vc(a){null===a.wc?a.wc=new Mt:a.wc.clear(),a.pm(a,(function(a,t){em(a,t)})),0===a.wc.count&&a.wc.add("",a)}function em(a,b){var t=b.portId;null!==t&&null!==a.wc&&a.wc.add(t,b)}function xc(a,b,t){var e=b.portId;if(null!==e&&(null!==a.wc&&a.wc.remove(e),null!==(b=a.diagram)&&t)){for(t=null,a=a.findLinksConnected(e);a.next();)e=a.value,null===t&&(t=z()),t.push(e);if(null!==t){for(a=0;a<t.length;a++)b.remove(t[a]);R(t)}}}function bc(a,b){return null===(b=b.pg())?0:1+bc(a,b)}function wc(a,b,t,e,n,o,g){if(1<e)for(var r=t?a.Lo():a.Sd();r.next();){var h=r.value;h.isTreeLink&&(null===(h=h.So(a))||h===a||b.contains(h)||(b.add(h),wc(h,b,t,e-1,n,o,g)))}else kc(a,b,t,n,o,g)}function kc(a,b,t,e,n,o){for(var g=n===a||a.isTreeExpanded,r=t?a.Lo():a.Sd(),h={};r.next();){var l=r.value;if(l.isTreeLink&&(null!==(l=l.So(a))&&l!==a)){var c=b.contains(l);if(c||b.add(l),g){var f=t?l.No():l.Oo();h.uv=a,f.all(function(a){return function(b){return b===a.uv||!b.isTreeExpanded}}(h))&&e.Aj(l,n),l.oh(),l.$b(!1)}l.isTreeExpanded&&(l.wasTreeExpanded=l.isTreeExpanded,c||kc(l,b,t,e,n,o))}h={uv:h.uv}}a.isTreeExpanded=!1}function Mc(a,b,t,e,n,o,g){for(var r=o!==a&&a.isTreeExpanded,h=t?a.Lo():a.Sd(),l={};h.next();){var c=h.value;if(c.isTreeLink&&(r||c.fd||c.bb(),null!==(c=c.So(a))&&c!==a&&!b.contains(c))){if(b.add(c),!r){c.$b(!0),c.oh();var f=t?c.No():c.Oo();l.vv=a,f.all(function(a){return function(b){return b===a.vv||!b.isTreeExpanded}}(l))&&n.Cj(c,o)}(2<e||c.wasTreeExpanded)&&(c.wasTreeExpanded=!1,Mc(c,b,t,e-1,n,o,g))}l={vv:l.vv}}a.isTreeExpanded=!0}zu.className="Part",zu.LayoutNone=0,zu.LayoutAdded=1,zu.LayoutRemoved=2,zu.LayoutShown=4,zu.LayoutHidden=8,zu.LayoutNodeSized=16,zu.LayoutGroupLayout=32,zu.LayoutNodeReplaced=64,zu.LayoutStandard=127,zu.LayoutAll=16777215,y(hc,zu),hc.prototype.toString=function(){var a=this.adornedPart;return"Adornment("+this.category+")"+(null!==a?a.toString():"")},hc.prototype.updateRelationshipsFromData=function(){},hc.prototype.Tl=function(a){var b=this.adornedObject,t=null==b?void 0:b.part;if(t instanceof Oc&&b instanceof Ll){b=t.path,t.Tl(a),a=b.geometry,b=(t=this.O.s).length;for(var e=0;e<b;e++){var n=t[e];n.isPanelMain&&n instanceof Ll&&(n.ua=a)}}},hc.prototype.si=function(){var a=this.ue;return null===a||(null===(a=a.part)||!ma(a))},hc.prototype.Zc=function(){return!1},hc.prototype.fk=function(a,b,t,e,n,o,g){if(a===Mi&&"elements"===b){if(n instanceof Fc)null===this.$a&&(this.$a=n);else if(n instanceof Eh){var r=n.Ml((function(a){return a instanceof Fc}));r instanceof Fc&&null===this.$a&&(this.$a=r)}}else a===Si&&"elements"===b&&null!==this.$a&&(e===this.$a||e instanceof Eh&&this.$a.rg(e))&&(this.$a=null);zu.prototype.fk.call(this,a,b,t,e,n,o,g)},hc.prototype.updateAdornments=function(){},hc.prototype.Kj=function(){},v.Object.defineProperties(hc.prototype,{placeholder:{get:function(){return this.$a}},adornedObject:{get:function(){return this.ue},set:function(a){var b=this.adornedPart,t=null;null!==a&&(t=a.part),null===b||null!==a&&b===t||b.Jf(this.category),this.ue=a,null!==t&&t.bh(this.category,this)}},adornedPart:{get:function(){var a=this.ue;return null!==a?a.part:null}},containingGroup:{get:function(){return null}}}),hc.className="Adornment",lc.prototype.copy=function(){var a=new lc;return a.Cq=this.Cq,a.Dq=this.Dq,a.gj=this.gj,a.Ur=this.Ur,a.xp=this.xp.J(),a.dr=this.dr,a.Lq=this.Lq,a.Mq=this.Mq,a.ij=this.ij,a.Jr=this.Jr,a},y(uc,zu),uc.prototype.cloneProtected=function(a){zu.prototype.cloneProtected.call(this,a),a.U=this.U,null!==this.Ba&&(a.Ba=this.Ba.oc?this.Ba:this.Ba.copy())},(e=uc.prototype).Af=function(a){zu.prototype.Af.call(this,a),a.Bd(),a.af=this.af,a.wc=null},e.th=function(){zu.prototype.th.call(this),null!==this.Ba&&(this.Ba.oc=!0)},e.Lz=function(a,b,t){null==b&&(b=""),null==t&&(t=""),null!==(a=dc(this,a,b,t))&&a.Rl()},e.fk=function(a,b,t,e,n,o,g){(a===Mi&&"elements"===b||a===Si&&"elements"===b)&&(this.wc=null),zu.prototype.fk.call(this,a,b,t,e,n,o,g)},e.Bd=function(a){for(var b=this.linksConnected;b.next();){var t=b.value;void 0!==a&&a.contains(t)||(pc(t.fromPort),pc(t.toPort),t.bb())}},e.si=function(){return!0},uc.prototype.getAvoidableRect=function(a){return a.set(this.actualBounds),a.Bo(this.avoidableMargin),a},uc.prototype.findVisibleNode=function(){for(var a=this;null!==a&&!a.isVisible();)a=a.containingGroup;return a},uc.prototype.isVisible=function(){if(!zu.prototype.isVisible.call(this))return!1;var a=!0,b=fs,t=this.diagram;if(null!==t&&(a=t.isTreePathToChildren,b=t.treeCollapsePolicy),b===fs){if(null!==(a=this.pg())&&!a.isTreeExpanded)return!1}else if(b===ds){if(0<(a=a?this.No():this.Oo()).count&&a.all((function(a){return!a.isTreeExpanded})))return!1}else if(b===ps&&(0<(a=a?this.No():this.Oo()).count&&a.any((function(a){return!a.isTreeExpanded}))))return!1;return null===(a=this.labeledLink)||a.isVisible()},uc.prototype.$b=function(a){zu.prototype.$b.call(this,a);for(var b=this.linksConnected;b.next();){var t=b.value;if(a&&null!==this.containingGroup){var e=t.So(this);null===e||e.Td(this.containingGroup)||t.bb()}t.$b(a)}},uc.prototype.qx=function(){var a=new at,b=new at;return gc(this,this,a,b),b.iterator},uc.prototype.findLinksConnected=function(a){if(void 0===a&&(a=null),null===a)return this.jb.iterator;var b=new it(this.jb),t=this;return b.predicate=function(b){return b.fromNode===t&&b.fromPortId===a||b.toNode===t&&b.toPortId===a},b},(e=uc.prototype).Lo=function(a){void 0===a&&(a=null);var b=new it(this.jb),t=this;return b.predicate=function(b){return b.fromNode===t&&(null===a||b.fromPortId===a)},b},e.Sd=function(a){void 0===a&&(a=null);var b=new it(this.jb),t=this;return b.predicate=function(b){return b.toNode===t&&(null===a||b.toPortId===a)},b},e.Mu=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.jb.iterator;e.next();){var n=e.value;n.fromNode===this?null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new at).add(t),b.add(n)):t=n):n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new at).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new et(t):tt},e.Oo=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.jb.iterator;e.next();){var n=e.value;n.fromNode!==this||null!==a&&n.fromPortId!==a||(n=n.toNode,null!==b?b.add(n):null!==t&&t!==n?((b=new at).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new et(t):tt},e.No=function(a){void 0===a&&(a=null);for(var b=null,t=null,e=this.jb.iterator;e.next();){var n=e.value;n.toNode!==this||null!==a&&n.toPortId!==a||(n=n.fromNode,null!==b?b.add(n):null!==t&&t!==n?((b=new at).add(t),b.add(n)):t=n)}return null!==b?b.iterator:null!==t?new et(t):tt},e.jz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new it(this.jb),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)||!(e.fromNode!==a||e.toNode!==n||null!==t&&e.fromPortId!==t||null!==b&&e.toPortId!==b)},e},e.kz=function(a,b,t){void 0===b&&(b=null),void 0===t&&(t=null);var e=new it(this.jb),n=this;return e.predicate=function(e){return!(e.fromNode!==n||e.toNode!==a||null!==b&&e.fromPortId!==b||null!==t&&e.toPortId!==t)},e},uc.prototype.updateRelationshipsFromData=function(){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)},(e=uc.prototype).Uo=function(a){zu.prototype.Uo.call(this,a),a||(yc(this),null!==(a=this.Xk)&&Dc(a,this))},e.Vo=function(a){zu.prototype.Vo.call(this,a),a||null!==(a=this.Xk)&&null!==a.wd&&(a.wd.remove(this),a.v())},e.Kj=function(){if(0<this.jb.count){var a=this.diagram;if(null!==a)for(var b=null===a.commandHandler||a.commandHandler.deletesConnectedLinks,t=this.jb.copy().iterator;t.next();){var e=t.value;b?a.remove(e):(e.fromNode===this&&(e.fromNode=null),e.toNode===this&&(e.toNode=null))}}this.labeledLink=null,zu.prototype.Kj.call(this)},e.ms=function(a){if(null===this.wc){if(""===a&&!1===this.Te)return this;vc(this)}var b=this.wc.I(a);return null!==b||""!==a&&null!==(b=this.wc.I(""))?b:this},e.Nz=function(a){if(null===a||a===this)return!1;var b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),t=this,b)for(;t!==a;){b=null;for(var e=t.jb.iterator;e.next();){var n=e.value;if(n.isTreeLink&&((b=n.fromNode)!==t&&b!==this))break}if(b===this||null===b||b===t)return!1;t=b}else for(;t!==a;){for(b=null,e=t.jb.iterator;e.next()&&(!(n=e.value).isTreeLink||((b=n.toNode)===t||b===this)););if(b===this||null===b||b===t)return!1;t=b}return!0},e.xz=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this,a)for(;;){a=null;for(var t=b.jb.iterator;t.next();){var e=t.value;if(e.isTreeLink&&((a=e.fromNode)!==b&&a!==this))break}if(a===this)return this;if(null===a||a===b)return b;b=a}else for(;;){for(a=null,t=b.jb.iterator;t.next()&&(!(e=t.value).isTreeLink||((a=e.toNode)===b||a===this)););if(a===this)return this;if(null===a||a===b)return b;b=a}},e.gz=function(a){if(null===a)return null;if(this===a)return this;for(var b=this;null!==b;)ec(b,!0),b=b.pg();var t=null;for(b=a;null!==b;){if(0!=(1048576&b.G)){t=b;break}b=b.pg()}for(b=this;null!==b;)ec(b,!1),b=b.pg();return t},e.kh=function(){var a=!0,b=this.diagram;if(null!==b&&(a=b.isTreePathToChildren),b=this.jb.iterator,a){for(;b.next();)if((a=b.value).isTreeLink&&a.fromNode!==this)return a}else for(;b.next();)if((a=b.value).isTreeLink&&a.toNode!==this)return a;return null},e.pg=function(){var a=this.ci;if(null===a)return null;if(a instanceof uc)return a;a=null===(a=this.diagram)||a.isTreePathToChildren;for(var b=this.jb.iterator;b.next();){var t=b.value;if(t.isTreeLink&&(t=a?t.fromNode:t.toNode)!==this)return this.ci=t}return this.ci=null},e.vz=function(){var b=new at;return function a(b,t){t.add(b);var e=b.kh();null!==e&&(t.add(e),null!==(b=b.pg())&&a(b,t))}(this,b),b},e.uz=function(){return bc(this,this)},e.Po=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren),b=new it(this.jb);var t=this;return b.predicate=a?function(a){return!(!a.isTreeLink||a.fromNode!==t)}:function(a){return!(!a.isTreeLink||a.toNode!==t)},b},e.Ou=function(){var a=!0,b=this.diagram;null!==b&&(a=b.isTreePathToChildren);var t=b=null,e=this.jb.iterator;if(a)for(;e.next();)(a=e.value).isTreeLink&&a.fromNode===this&&(a=a.toNode,null!==b?b.add(a):null!==t&&t!==a?((b=new ot).add(t),b.add(a)):t=a);else for(;e.next();)(a=e.value).isTreeLink&&a.toNode===this&&(a=a.fromNode,null!==b?b.add(a):null!==t&&t!==a?((b=new ot).add(t),b.add(a)):t=a);return null!==b?b.iterator:null!==t?new et(t):tt},e.wz=function(a){void 0===a&&(a=1/0);var b=new at;return sc(b,this,!1,a,!0),b},uc.prototype.collapseTree=function(a){void 0===a&&(a=1),1>a&&(a=1);var b=this.diagram;if(null!==b&&!b.Ue){b.Ue=!0;var t=new at;t.add(this),wc(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===fs),b.Ue=!1}},uc.prototype.expandTree=function(a){void 0===a&&(a=2),2>a&&(a=2);var b=this.diagram;if(null!==b&&!b.Ue){b.Ue=!0;var t=new at;t.add(this),Mc(this,t,b.isTreePathToChildren,a,b,this,b.treeCollapsePolicy===fs),b.Ue=!1}},v.Object.defineProperties(uc.prototype,{portSpreading:{get:function(){return null!==this.Ba?this.Ba.dr:Pc},set:function(a){var b=this.portSpreading;b!==a&&(cc(this),this.Ba.dr=a,this.g("portSpreading",b,a),null!==(a=this.diagram)&&a.undoManager.isUndoingRedoing||this.Bd())}},avoidable:{get:function(){return 0!=(8&this.U)},set:function(a){var b=0!=(8&this.U);if(b!==a){this.U^=8;var t=this.diagram;null!==t&&Kr(t,this),this.g("avoidable",b,a)}}},avoidableMargin:{get:function(){return null!==this.Ba?this.Ba.xp:Xe},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.avoidableMargin;if(!b.D(a)){a=a.J(),cc(this),this.Ba.xp=a;var t=this.diagram;null!==t&&Kr(t,this),this.g("avoidableMargin",b,a)}}},linksConnected:{get:function(){return this.jb.iterator}},linkConnected:{get:function(){return null!==this.Ba?this.Ba.Cq:null},set:function(a){var b=this.linkConnected;b!==a&&(cc(this),this.Ba.Cq=a,this.g("linkConnected",b,a))}},linkDisconnected:{get:function(){return null!==this.Ba?this.Ba.Dq:null},set:function(a){var b=this.linkDisconnected;b!==a&&(cc(this),this.Ba.Dq=a,this.g("linkDisconnected",b,a))}},linkValidation:{get:function(){return null!==this.Ba?this.Ba.gj:null},set:function(a){var b=this.linkValidation;b!==a&&(cc(this),this.Ba.gj=a,this.g("linkValidation",b,a))}},isLinkLabel:{get:function(){return null!==this.Xk}},labeledLink:{get:function(){return this.Xk},set:function(a){var b=this.Xk;if(b!==a){var t=this.diagram,e=this.data;if(null!==b){if(null!==b.wd&&(b.wd.remove(this),b.v()),null!==t&&null!==e&&!t.undoManager.isUndoingRedoing){var n=b.data,o=t.model;if(null!==n&&o.ri()){var g=o.wa(e);void 0!==g&&o.Qx(n,g)}}this.containingGroup=null}this.Xk=a,null!==a&&(Dc(a,this),null===t||null===e||t.undoManager.isUndoingRedoing||(n=a.data,t=t.model,null!==n&&t.ri()&&(void 0!==(e=t.wa(e))&&t.Au(n,e))),this.containingGroup=a.containingGroup),ra(this),this.g("labeledLink",b,a)}}},port:{get:function(){return this.ms("")}},ports:{get:function(){return null===this.wc&&vc(this),this.wc.iteratorValues}},isTreeExpanded:{get:function(){return 0!=(1&this.U)},set:function(a){var b=0!=(1&this.U);if(b!==a){this.U^=1;var t=this.diagram;if(this.g("isTreeExpanded",b,a),null!==(b=this.treeExpandedChanged)){var e=!0;null!==t&&(e=t.aa,t.aa=!0),b(this),null!==t&&(t.aa=e)}null!==t&&t.undoManager.isUndoingRedoing?this.$b(a):a?this.expandTree():this.collapseTree()}}},wasTreeExpanded:{get:function(){return 0!=(2&this.U)},set:function(a){var b=0!=(2&this.U);b!==a&&(this.U^=2,this.g("wasTreeExpanded",b,a))}},treeExpandedChanged:{get:function(){return null!==this.Ba?this.Ba.Ur:null},set:function(a){var b=this.treeExpandedChanged;b!==a&&(cc(this),this.Ba.Ur=a,this.g("treeExpandedChanged",b,a))}},isTreeLeaf:{get:function(){return 0!=(4&this.U)},set:function(a){var b=0!=(4&this.U);b!==a&&(this.U^=4,this.g("isTreeLeaf",b,a))}}}),uc.prototype.expandTree=uc.prototype.expandTree,uc.prototype.collapseTree=uc.prototype.collapseTree,uc.prototype.findTreeParts=uc.prototype.wz,uc.prototype.findTreeChildrenNodes=uc.prototype.Ou,uc.prototype.findTreeChildrenLinks=uc.prototype.Po,uc.prototype.findTreeLevel=uc.prototype.uz,uc.prototype.findTreeParentChain=uc.prototype.vz,uc.prototype.findTreeParentNode=uc.prototype.pg,uc.prototype.findTreeParentLink=uc.prototype.kh,uc.prototype.findCommonTreeParent=uc.prototype.gz,uc.prototype.findTreeRoot=uc.prototype.xz,uc.prototype.isInTreeOf=uc.prototype.Nz,uc.prototype.findPort=uc.prototype.ms,uc.prototype.findLinksTo=uc.prototype.kz,uc.prototype.findLinksBetween=uc.prototype.jz,uc.prototype.findNodesInto=uc.prototype.No,uc.prototype.findNodesOutOf=uc.prototype.Oo,uc.prototype.findNodesConnected=uc.prototype.Mu,uc.prototype.findLinksInto=uc.prototype.Sd,uc.prototype.findLinksOutOf=uc.prototype.Lo,uc.prototype.findExternalTreeLinksConnected=uc.prototype.qx,uc.prototype.invalidateConnectedLinks=uc.prototype.Bd,uc.prototype.invalidateLinkBundle=uc.prototype.Lz;var Sc=new W(uc,"SpreadingNone",10),Pc=new W(uc,"SpreadingEvenly",11),Nc=new W(uc,"SpreadingPacked",12);function Cc(a,b){void 0===a||a instanceof Mh||"string"==typeof a?uc.call(this,a):(uc.call(this),a&&(b=a)),this.U|=4608,this.Fn=new at,this.$a=null,this.Sc=new Uf,this.Sc.group=this,this.fl=new at,this.tb=this.Zp=null,b&&Object.assign(this,b)}function Tc(a,b){if(a.Fn.add(b)){b instanceof Cc&&a.fl.add(b);var t=a.memberAdded;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.aa,n.aa=!0),t(a,b),null!==n&&(n.aa=e)}a.isVisible()&&a.isSubGraphExpanded||b.$b(!1)}b instanceof Oc&&!a.computesBoundsIncludingLinks||(null===(b=a.$a)&&(b=a),b.v())}function Lc(a,b){if(a.Fn.remove(b)){b instanceof Cc&&a.fl.remove(b);var t=a.memberRemoved;if(null!==t){var e=!0,n=a.diagram;null!==n&&(e=n.aa,n.aa=!0),t(a,b),null!==n&&(n.aa=e)}a.isVisible()&&a.isSubGraphExpanded||b.$b(!0)}b instanceof Oc&&!a.computesBoundsIncludingLinks||(null===(b=a.$a)&&(b=a),b.v())}function Ac(a,b,t,e){for(var n=a.memberParts;n.next();){var o=n.value;if(o.$b(!1),o instanceof Cc&&o.isSubGraphExpanded&&(o.wasSubGraphExpanded=o.isSubGraphExpanded,Ac(o,b,t,e)),o instanceof uc)o.Bd(b),t.Aj(o,e);else if(o instanceof Oc)for(o=o.labelNodes;o.next();)o.value.Bd(b)}a.isSubGraphExpanded=!1}function jc(a,b,t,e){for(var n=a.memberParts;n.next();){var o=n.value;if(o.$b(!0),o instanceof Cc&&o.wasSubGraphExpanded&&(o.wasSubGraphExpanded=!1,jc(o,b,t,e)),o instanceof uc)o.Bd(b),t.Cj(o,e);else if(o instanceof Oc)for(o=o.labelNodes;o.next();)o.value.Bd(b)}a.isSubGraphExpanded=!0}function Fc(a){qs.call(this),this.zb=Ge,this.jo=new Ut(NaN,NaN,NaN,NaN),a&&Object.assign(this,a)}function Oc(a){zu.call(this,Eh.Link),this.Qa=8,this.ef=null,this.ff="",this.uf=this.fn=null,this.vf="",this.to=null,this.pk=af,this.Nm=0,this.Pm=af,this.Qm=NaN,this.qj=nf,this.oo=.5,this.wd=null,this.Ob=(new ot).freeze(),this.Tg=this.Mg=null,this.ll=new Ut,this.ua=new Qe,this.u=this.o=this.Sf=this.Wf=null,this.ru=new St,this.bq=this.Mw=this.Lw=null,this.ut=NaN,this.ba=null,this.j=[],a&&Object.assign(this,a)}function Bc(a){var b=a.fromNode,t=a.toNode,e=null;if(e=null!==b?null!==t?b.px(t):b.containingGroup:null!==t?t.containingGroup:null,b=e,(t=a.Ah)!==b){null!==t&&Lc(t,a),a.Ah=b,null!==b&&Tc(b,a);var n=a.containingGroupChanged;if(null!==n){var o=!0,g=a.diagram;null!==g&&(o=g.aa,g.aa=!0),n(a,t,b),null!==g&&(g.aa=o)}!a.fd||a.Lw!==t&&a.Mw!==t||a.bb()}if(a.isLabeledLink)for(a=a.labelNodes;a.next();)a.value.containingGroup=e}function Dc(a,b){null===a.wd&&(a.wd=new at),a.wd.add(b),a.v()}function Ic(a,b,t){if(0!==b||0!==t)if(0===a.pointsCount)a.defaultFromPoint&&a.defaultFromPoint.offset(b,t),a.defaultToPoint&&a.defaultToPoint.offset(b,t);else{for(var e=a.fd,n=new ot,o=a.Ob.iterator;o.next();){var g=o.value;n.add(new St(g.x+b,g.y+t).freeze())}n.freeze(),o=a.Ob,a.Ob=n,g=a.diagram,isNaN(b)||isNaN(t)||null!==g&&g.animationManager.Ab?a.v():(a.ke.h(a.ke.x+b,a.ke.y+t),a.pa.h(a.pa.x+b,a.pa.y+t),ra(a)),e?zc(a):(a.defaultFromPoint&&(a.defaultFromPoint=a.i(0)),a.defaultToPoint&&(a.defaultToPoint=a.i(a.pointsCount-1))),null!==g&&g.animationManager.Ab&&lo(g.animationManager,a,n),a.g("points",o,n)}}function zc(a){0===a.Ob.count?a.fd=!1:(a.fd=!0,a.bq=null,a.ut=NaN,a.defaultFromPoint=a.i(0),a.defaultToPoint=a.i(a.pointsCount-1),Zc(a,!1))}function Rc(a,b){return Math.abs(b.x-a.x)>Math.abs(b.y-a.y)?(b.x>=a.x?b.x=a.x+9e9:b.x=a.x-9e9,b.y=a.y):(b.y>=a.y?b.y=a.y+9e9:b.y=a.y-9e9,b.x=a.x),b}function Ec(a,b){var t=b.Yn;return null===t&&((t=new Vf).port=b,t.node=b.part,b.Yn=t),Gf(t,a)}function Vc(a){return a===ae||.5===a.x&&.5===a.y}function Yc(a){return.5===a.x&&.5===a.y?a:fe}function Gc(a){if(null===a.diagram||!a.isAvoiding||!Gr(a.diagram))return!1;var b=a.points.s,t=b.length;if(4>t)return!1;a=Xr(a.diagram,!0,a.containingGroup,null);for(var e=1;e<t-2;e++){var n=b[e],o=b[e+1];if(!a.Xj(Math.min(n.x,o.x),Math.min(n.y,o.y),Math.abs(n.x-o.x),Math.abs(n.y-o.y)))return!0}return!1}function Xc(a,b,t,e,n,o,g){var r=b.Go,h=b.Fo,l=Tf(b,t,e),c=t,f=e;for(0===n?c+=r:90===n?f+=h:180===n?c-=r:f-=h,n!==g&&l>If&&Tf(b,c,f)!==l-1&&(Tf(b,t-r,e)===l-1?(n=180,c=t-r,f=e):Tf(b,t+r,e)===l-1?(n=0,c=t+r,f=e):Tf(b,t,e-h)===l-1?(n=270,c=t,f=e-h):Tf(b,t,e+h)===l-1&&(n=90,c=t,f=e+h));l>If&&Tf(b,c,f)===l-1;)t=c,e=f,0===n?c+=r:90===n?f+=h:180===n?c-=r:f-=h,--l;o?l>If&&(180===n||0===n?t=Math.floor(t/r)*r+r/2:90!==n&&270!==n||(e=Math.floor(e/h)*h+h/2)):(t=Math.floor(t/r)*r+r/2,e=Math.floor(e/h)*h+h/2),l>If&&(o=n,g=t,c=e,0===n?(o=90,c+=h):90===n?(o=180,g-=r):180===n?(o=270,c-=h):270===n&&(o=0,g+=r),Tf(b,g,c)===l-1?Xc(a,b,g,c,o,!1,o):(g=t,c=e,0===n?(o=270,c-=h):90===n?(o=0,g+=r):180===n?(o=90,c+=h):270===n&&(o=180,g-=r),Tf(b,g,c)===l-1&&Xc(a,b,g,c,o,!1,o))),a.yf(t,e)}function Uc(a,b,t,e){return a=t-a,isNaN(a)||1/0===a||-1/0===a?NaN:(0>a&&(a=-a),b=e-b,isNaN(b)||1/0===b||-1/0===b?NaN:(0>b&&(b=-b),$e.$(a,0)?b:$e.$(b,0)?a:Math.sqrt(a*a+b*b)))}function qc(a,b,t,e){var n=a.pointsCount;if(2>n)return b;if(t){var o=a.i(1);if(t=o.x-e.x,o=o.y-e.y,0===(e=Uc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!0))>n&&(a=n),n=a*(o-b.y)/e,b.x+=a*(t-b.x)/e,b.y+=n}else{if(t=(o=a.i(n-2)).x-e.x,o=o.y-e.y,0===(e=Uc(b.x,b.y,t,o)))return b;n=2===n?.5*e:e,(a=a.computeShortLength(!1))>n&&(a=n),n=a*(b.y-o)/e,b.x-=a*(b.x-t)/e,b.y-=n}return b}function Kc(a,b,t,e){for(var n=a.pointsCount,o=b;$e.$(b.x,o.x)&&$e.$(b.y,o.y);){if(t>=n)return n-1;o=a.i(t++)}if(!$e.$(b.x,o.x)&&!$e.$(b.y,o.y))return t-1;for(var g=o;$e.$(b.x,o.x)&&$e.$(o.x,g.x)&&(!e||(b.y>=o.y?o.y>=g.y:o.y<=g.y))||$e.$(b.y,o.y)&&$e.$(o.y,g.y)&&(!e||(b.x>=o.x?o.x>=g.x:o.x<=g.x));){if(t>=n)return n-1;g=a.i(t++)}return t-2}function Hc(a,b,t,e,n,o,g){if(!g&&Jc(a)){var r=(g=a.computeJumpLength())/2,h=[],l=0;if(a.isVisible()&&(l=function(a,b,t,e){var n=a.diagram;if(null===n||b.D(t))return 0;for(n=n.layers;n.next();){var o=n.value;if(null!==o&&o.visible)for(var g=(o=o.Pa.s).length,r=0;r<g;r++){var h=o[r];if(h instanceof Oc){if(h===a)return 0<e.length&&e.sort((function(a,b){return a-b})),e.length;if(h.isVisible()&&Jc(h)){var l=h.routeBounds;l.w()&&a.routeBounds.Yc(l)&&!a.usesSamePort(h)&&(null!==(l=h.path)&&l.Ed()&&Wc(b,t,e,h))}}}}return 0<e.length&&e.sort((function(a,b){return a-b})),e.length}(a,n,o,h)),0<l)if($e.B(n.y,o.y))if(n.x<o.x)for(var c=0;c<l;){var f=Math.max(n.x,Math.min(h[c++]-r,o.x-g));b.lineTo(f+t,o.y+e);for(var p=f+t,q=Math.min(f+g,o.x);c<l&&(f=h[c])<q+g;)c++,q=Math.min(f+r,o.x);f=o.y-g+e,q+=t;var d=o.y+e;a.curve===lf?Tu(b,q,d,!1):Au(b,p,f,q,f,q,d)}else for(--l;0<=l;){for(c=Math.min(n.x,Math.max(h[l--]+r,o.x+g)),b.lineTo(c+t,o.y+e),p=c+t,f=Math.max(c-g,o.x);0<=l&&(c=h[l])>f-g;)l--,f=Math.max(c-r,o.x);c=o.y-g+e,f+=t,q=o.y+e,a.curve===lf?Tu(b,f,q,!1):Au(b,p,c,f,c,f,q)}else if($e.B(n.x,o.x))if(n.y<o.y)for(c=0;c<l;){for(f=Math.max(n.y,Math.min(h[c++]-r,o.y-g)),b.lineTo(o.x+t,f+e),p=f+e,f=Math.min(f+g,o.y);c<l&&(q=h[c])<f+g;)c++,f=Math.min(q+r,o.y);q=o.x-g+t,d=o.x+t,f+=e,a.curve===lf?Tu(b,d,f,!1):Au(b,q,p,q,f,d,f)}else for(--l;0<=l;){for(c=Math.min(n.y,Math.max(h[l--]+r,o.y+g)),b.lineTo(o.x+t,c+e),p=c+e,c=Math.max(c-g,o.y);0<=l&&(f=h[l])>c-g;)l--,c=Math.max(f-r,o.y);f=o.x-g+t,q=o.x+t,c+=e,a.curve===lf?Tu(b,q,c,!1):Au(b,f,p,f,c,q,c)}}b.lineTo(o.x+t,o.y+e)}function Wc(a,b,t,e){for(var n=$e.B(a.y,b.y),o=e.pointsCount,g=e.i(0),r=St.alloc(),h=1;h<o;h++){var l=e.i(h);if(h<o-1){var c=e.i(h+1);if(g.y===l.y&&l.y===c.y){if(l.x>g.x&&c.x>=l.x||l.x<g.x&&c.x<=l.x)continue}else if(g.x===l.x&&l.x===c.x&&(l.y>g.y&&c.y>=l.y||l.y<g.y&&c.y<=l.y))continue}t:{c=a.x;var f=a.y,p=b.x,q=b.y,d=g.x;g=g.y;var u=l.x,m=l.y;if($e.B(c,p)){if(!$e.B(f,q)&&$e.B(g,m)&&Math.min(f,q)<g&&Math.max(f,q)>g&&Math.min(d,u)<c&&Math.max(d,u)>c&&!$e.B(d,u)){r.x=c,r.y=g,c=!0;break t}}else if($e.B(f,q)&&$e.B(d,u)&&Math.min(c,p)<d&&Math.max(c,p)>d&&Math.min(g,m)<f&&Math.max(g,m)>f&&!$e.B(g,m)){r.x=d,r.y=f,c=!0;break t}r.x=0,r.y=0,c=!1}c&&(n?t.push(r.x):t.push(r.y)),g=l}St.free(r)}function Jc(a){return(a=a.curve)===uf||a===lf}function Zc(a,b){(b||Jc(a))&&(null===(b=a.diagram)||b.animationManager.isTicking||b.Eh.contains(a)||0===a.ll.width&&0===a.ll.height||b.Eh.add(a,a.ll.copy()))}function _c(a,b,t){if(null!==b&&b.kk&&b.fd&&Jc(b)){var e=b.routeBounds;e.w()&&(a.routeBounds.Yc(e)||t.Yc(e))&&(a.usesSamePort(b)||b.rc())}}function $c(a){var b=a.ef;if(null!==b){var t=a.uf;if(null!==t&&isNaN(a.curviness)){for(var e=a.ff,n=a.vf,o=a=null,g=b.jb.s,r=g.length,h=0;h<r;h++){var l=g[h];(l.ef===b&&l.ff===e&&l.uf===t&&l.vf===n||l.ef===t&&l.ff===n&&l.uf===b&&l.vf===e)&&(null===o?o=l:(null===a&&(a=[]).push(o),a.push(l)))}if(null!==a){for(null===(o=dc(b,t,e,n))&&(fc(b,o=new Pf(b,e,t,n)),fc(t,o)),o.links=a,b=0;b<a.length;b++)a[b].Sf=o;o.Rl()}}}}function Qc(a){var b=a.Sf;null!==b&&isNaN(a.curviness)&&(a.Sf=null,0<=(a=b.links.indexOf(a))&&(I(b.links,a),b.Rl()))}uc.className="Node",uc.SpreadingNone=Sc,uc.SpreadingEvenly=Pc,uc.SpreadingPacked=Nc,y(Cc,uc),Cc.prototype.cloneProtected=function(a){uc.prototype.cloneProtected.call(this,a),this.U=-32769&this.U;var b=a.Ml((function(a){return a instanceof Fc}));a.$a=b instanceof Fc?b:null,null!==this.Sc?(a.Sc=this.Sc.copy(),a.Sc.group=a):(null!==a.Sc&&(a.Sc.group=null),a.Sc=null),null!==this.tb&&(a.tb=this.tb.copy())},(e=Cc.prototype).Af=function(a){uc.prototype.Af.call(this,a);var b=a.Qj();for(a=a.memberParts;a.next();){var t=a.value;if(t.v(),t.C(8),t.Dj(),t instanceof uc)t.Bd(b);else if(t instanceof Oc)for(t=t.labelNodes;t.next();)t.value.Bd(b)}},e.fk=function(a,b,t,e,n,o,g){if(a===Mi&&"elements"===b){if(n instanceof Fc)null===this.$a?this.$a=n:this.$a!==n&&T("Cannot insert a second Placeholder into the visual tree of a Group.");else if(n instanceof Eh){var r=n.Ml((function(a){return a instanceof Fc}));r instanceof Fc&&(null===this.$a?this.$a=r:this.$a!==r&&T("Cannot insert a second Placeholder into the visual tree of a Group."))}}else a===Si&&"elements"===b&&null!==this.$a&&(e===this.$a||e instanceof Eh&&this.$a.rg(e))&&(this.$a=null);uc.prototype.fk.call(this,a,b,t,e,n,o,g)},e.Wl=function(a,b){uc.prototype.Wl.call(this,a,b),this.isClipping&&this.type!==Eh.Spot&&this.isSubGraphExpanded&&((a=this.resizeObject)instanceof Eh&&(a=a.Qb()),null===this.tb&&(this.tb=new Ut),a.mi(this.tb),a instanceof Ll&&this.tb.Bc(-a.strokeWidth,-a.strokeWidth))},e.eh=function(a,b,t,e){this.nf=this.$a,uc.prototype.eh.call(this,a,b,t,e)},e.Va=function(){var a=this;a.isSubGraphExpanded&&this.memberParts.each((function(b){!a.computesBoundsIncludingLinks&&b instanceof Oc||b.Va()})),uc.prototype.Va.call(this)},e.si=function(){if(!uc.prototype.si.call(this))return!1;for(var a=this.memberParts;a.next();){var b=a.value;if(b instanceof uc){if(b.isVisible()&&ma(b))return!1}else if(b instanceof Oc&&b.isVisible()&&ma(b)&&b.fromNode!==this&&b.toNode!==this)return!1}return!0},e.Kj=function(){if(0<this.Fn.count){var a=this.diagram;if(null!==a)for(var b=this.Fn.copy().iterator;b.next();)a.remove(b.value)}uc.prototype.Kj.call(this)},Cc.prototype.canAddMembers=function(a){var b=this.diagram;if(null===b)return!1;for(b=b.commandHandler,a=Us(a).iterator;a.next();)if(!b.isValidMember(this,a.value))return!1;return!0},Cc.prototype.addMembers=function(a,b){var t=this.diagram;if(null===t)return!1;t=t.commandHandler;var e=!0;for(a=Us(a).iterator;a.next();){var n=a.value;!b||t.isValidMember(this,n)?n.containingGroup=this:e=!1}return e},Cc.prototype.canUngroup=function(){if(!this.ungroupable)return!1;var a=this.layer;return!(null===a||!a.allowUngroup)&&!(null!==(a=a.diagram)&&!a.allowUngroup)},(e=Cc.prototype).Bd=function(a){var b=0!=(65536&this.U);if(uc.prototype.Bd.call(this,a),!b)for(0!=(65536&this.U)!=!0&&(this.U=65536^this.U),b=this.Lu();b.next();){var t=b.value;if(void 0===a||!a.contains(t)){var e=t.fromNode;null!==e&&e!==this&&e.Td(this)&&!e.isVisible()?(pc(t.fromPort),pc(t.toPort),t.bb()):null!==(e=t.toNode)&&e!==this&&e.Td(this)&&!e.isVisible()&&(pc(t.fromPort),pc(t.toPort),t.bb())}}},e.Lu=function(){var a=null!==this.diagram&&this.diagram.Pw;if(a&&null!==this.Zp)return this.Zp.iterator;var b=this.Qj();b.add(this);for(var t=new at,e=b.iterator;e.next();){var n=e.value;if(n instanceof uc)for(n=n.linksConnected;n.next();){var o=n.value;b.contains(o)||t.add(o)}}return a&&(this.Zp=t),t.iterator},e.iz=function(){var a=this.Qj();a.add(this);for(var b=new at,t=a.iterator;t.next();){var e=t.value;if(e instanceof uc)for(e=e.linksConnected;e.next();){var n=e.value,o=n.fromNode;null===o||a.contains(o)&&o!==this||b.add(o),null===(n=n.toNode)||a.contains(n)&&n!==this||b.add(n)}}return b.iterator},e.hz=function(){var b=new at;return function a(b,t){null!==b&&(t.add(b),a(b.containingGroup,t))}(this,b),b},e.Qj=function(){var a=new at;return sc(a,this,!0,0,!0),a.remove(this),a},e.$b=function(a){uc.prototype.$b.call(this,a);for(var b=this.memberParts;b.next();)b.value.$b(a)},Cc.prototype.collapseSubGraph=function(){var a=this.diagram;null===a||a.Ue||(a.Ue=!0,Ac(this,this.Qj(),a,this),a.Ue=!1)},Cc.prototype.expandSubGraph=function(){var a=this.diagram;null===a||a.Ue||(a.Ue=!0,jc(this,this.Qj(),a,this),a.Ue=!1)},Cc.prototype.move=function(a,b){void 0===b&&(b=!1);var t=b?this.location:this.position,e=t.x;t=t.y;var n=a.x,o=a.y;if(!(e===n||isNaN(e)&&isNaN(n))||!(t===o||isNaN(t)&&isNaN(o))){for(e=n-(isNaN(e)?0:e),t=o-(isNaN(t)?0:t),o=St.alloc(),uc.prototype.move.call(this,a,b),a=new at,b=this.Qj().iterator;b.next();)(n=b.value)instanceof Oc&&(n.suspendsRouting&&a.add(n),n.fd||n.fromNode!==this&&n.toNode!==this)&&(n.suspendsRouting=!0);for(b.reset();b.next();)if(!((n=b.value).ph()||n instanceof uc&&n.isLinkLabel)){var g=n.position,r=n.location;g.w()?(o.x=g.x+e,o.y=g.y+t,n.position=o):r.w()&&(o.x=r.x+e,o.y=r.y+t,n.location=o)}for(b.reset();b.next();)(n=b.value)instanceof Oc&&(n.suspendsRouting=a.contains(n),n.fd||n.fromNode!==this&&n.toNode!==this)&&(g=n.position,o.x=g.x+e,o.y=g.y+t,o.w()?n.move(o):n.bb());St.free(o)}},v.Object.defineProperties(Cc.prototype,{placeholder:{get:function(){return this.$a}},computesBoundsAfterDrag:{get:function(){return 0!=(2048&this.U)},set:function(a){var b=0!=(2048&this.U);b!==a&&(this.U^=2048,this.g("computesBoundsAfterDrag",b,a))}},computesBoundsIncludingLinks:{get:function(){return 0!=(4096&this.U)},set:function(a){var b=0!=(4096&this.U);b!==a&&(this.U^=4096,this.g("computesBoundsIncludingLinks",b,a))}},computesBoundsIncludingLocation:{get:function(){return 0!=(8192&this.U)},set:function(a){var b=0!=(8192&this.U);b!==a&&(this.U^=8192,this.g("computesBoundsIncludingLocation",b,a))}},handlesDragDropForMembers:{get:function(){return 0!=(16384&this.U)},set:function(a){var b=0!=(16384&this.U);b!==a&&(this.U^=16384,this.g("handlesDragDropForMembers",b,a))}},memberParts:{get:function(){return this.Fn.iterator}},layout:{get:function(){return this.Sc},set:function(a){var b=this.Sc;if(b!==a){null!==a&&null!==a.diagram&&a.diagram.layout===a&&T("A layout cannot be both the Diagram.layout and a Group.layout: "+a),null!==b&&(b.diagram=null,b.group=null),this.Sc=a;var t=this.diagram;null!==a&&(a.diagram=t,a.group=this),null!==t&&(t.xh=!0),this.g("layout",b,a),null!==t&&t.ac()}}},memberAdded:{get:function(){return null!==this.Ba?this.Ba.Lq:null},set:function(a){var b=this.memberAdded;b!==a&&(cc(this),this.Ba.Lq=a,this.g("memberAdded",b,a))}},memberRemoved:{get:function(){return null!==this.Ba?this.Ba.Mq:null},set:function(a){var b=this.memberRemoved;b!==a&&(cc(this),this.Ba.Mq=a,this.g("memberRemoved",b,a))}},memberValidation:{get:function(){return null!==this.Ba?this.Ba.ij:null},set:function(a){var b=this.memberValidation;b!==a&&(cc(this),this.Ba.ij=a,this.g("memberValidation",b,a))}},ungroupable:{get:function(){return 0!=(256&this.U)},set:function(a){var b=0!=(256&this.U);b!==a&&(this.U^=256,this.g("ungroupable",b,a))}},isSubGraphExpanded:{get:function(){return 0!=(512&this.U)},set:function(a){var b=0!=(512&this.U);if(b!==a){this.U^=512;var t=this.diagram;if(this.g("isSubGraphExpanded",b,a),null!==(b=this.subGraphExpandedChanged)){var e=!0;null!==t&&(e=t.aa,t.aa=!0),b(this),null!==t&&(t.aa=e)}null!==t&&t.undoManager.isUndoingRedoing?(null!==this.$a&&this.$a.v(),this.memberParts.each((function(a){a.updateAdornments()}))):a?this.expandSubGraph():this.collapseSubGraph()}}},wasSubGraphExpanded:{get:function(){return 0!=(1024&this.U)},set:function(a){var b=0!=(1024&this.U);b!==a&&(this.U^=1024,this.g("wasSubGraphExpanded",b,a))}},subGraphExpandedChanged:{get:function(){return null!==this.Ba?this.Ba.Jr:null},set:function(a){var b=this.subGraphExpandedChanged;b!==a&&(cc(this),this.Ba.Jr=a,this.g("subGraphExpandedChanged",b,a))}},rh:{get:function(){return 0!=(32768&this.U)},set:function(a){0!=(32768&this.U)!==a&&(this.U^=32768)}}}),Cc.prototype.expandSubGraph=Cc.prototype.expandSubGraph,Cc.prototype.collapseSubGraph=Cc.prototype.collapseSubGraph,Cc.prototype.findSubGraphParts=Cc.prototype.Qj,Cc.prototype.findContainingGroupChain=Cc.prototype.hz,Cc.prototype.findExternalNodesConnected=Cc.prototype.iz,Cc.prototype.findExternalLinksConnected=Cc.prototype.Lu,Cc.prototype.ensureBounds=Cc.prototype.Va,Cc.className="Group",y(Fc,qs),Fc.prototype.cloneProtected=function(a){qs.prototype.cloneProtected.call(this,a),a.zb=this.zb.J(),a.jo=this.jo.copy()},Fc.prototype.gh=function(a){if(null===this.background&&null===this.areaBackground)return!1;var b=this.naturalBounds;return Qt(0,0,b.width,b.height,a.x,a.y)},Fc.prototype.Vl=function(){var a=this.part;if(null!==a&&(a instanceof Cc||a instanceof hc)||T("Placeholder is not inside a Group or Adornment."),a instanceof Cc){var b=this.computeBorder(this.jo),t=this.minSize,e=this.ec;for(qt(e,(isFinite(t.width)?Math.max(t.width,b.width):b.width)||0,(isFinite(t.height)?Math.max(t.height,b.height):b.height)||0),this.Ge(0,0,e.width,e.height),e=a.memberParts,t=!1;e.next();)if(e.value.isVisible()){t=!0;break}e=a.diagram,!t||null===e||e.animationManager.Xu(a)||isNaN(b.x)||isNaN(b.y)||((t=St.alloc()).xi(b,a.locationSpot),t.D(a.location)||(a.location=t),St.free(t))}else{b=this.ec,e=(t=this.zb).left+t.right;var n=t.top+t.bottom,o=a.adornedObject;a.angle=o.li();var g=0;o instanceof Ll&&(g=o.strokeWidth);var r=o.Df(),h=o.naturalBounds,l=(h.width+g)*r;g=(h.height+g)*r,a.type!==Eh.Link&&(r=o.ga("Selection"===a.category?he:a.locationSpot,St.alloc()),a.location=r,St.free(r)),isNaN(l)||isNaN(g)?(a=o.ga(he,St.alloc()),(l=Ut.allocAt(a.x,a.y,0,0)).Ye(o.ga(me,a)),l.Ye(o.ga(ue,a)),l.Ye(o.ga(pe,a)),qt(b,l.width+e||0,l.height+n||0),this.Ge(-t.left,-t.top,b.width,b.height),St.free(a),Ut.free(l)):(qt(b,l+e||0,g+n||0),this.Ge(-t.left,-t.top,b.width,b.height))}},Fc.prototype.eh=function(a,b,t,e){this.actualBounds.h(a,b,t,e)},Fc.prototype.computeBorder=function(a){var b=this.part,t=b.diagram,e=null===t||!t.animationManager.isAnimating;if(null!==t&&b instanceof Cc&&!b.layer.isTemporary&&b.computesBoundsAfterDrag&&this.jo.w()){var n=t.toolManager.findTool("Dragging");if(n===t.currentTool&&null!==(t=n.computeBorder(b,this.jo,a)))return t}t=Ut.alloc(),n=this.computeMemberBounds(t);var o=this.zb;return b instanceof Cc&&!b.isSubGraphExpanded?a.h(n.x-o.left,n.y-o.top,0,0):a.h(n.x-o.left,n.y-o.top,Math.max(n.width+o.left+o.right,0),Math.max(n.height+o.top+o.bottom,0)),Ut.free(t),e&&b instanceof Cc&&b.computesBoundsIncludingLocation&&b.location.w()&&a.Ye(b.location),a},Fc.prototype.computeMemberBounds=function(a){if(!(this.part instanceof Cc))return a.h(0,0,0,0),a;for(var b=this.part,t=1/0,e=1/0,n=-1/0,o=-1/0,g=b.memberParts;g.next();){var r=g.value;if(r.isVisible()){if(r instanceof Oc){if(!b.computesBoundsIncludingLinks)continue;if(pa(r))continue;if(r.fromNode===b||r.toNode===b)continue}(r=r.actualBounds).left<t&&(t=r.left),r.top<e&&(e=r.top),r.right>n&&(n=r.right),r.bottom>o&&(o=r.bottom)}}return isFinite(t)&&isFinite(e)?a.h(t,e,n-t,o-e):(b=b.location,a.h(b.x,b.y,0,0)),a},v.Object.defineProperties(Fc.prototype,{padding:{get:function(){return this.zb},set:function(a){"number"==typeof a&&(a=new oe(a));var b=this.zb;b.D(a)||(this.zb=a=a.J(),this.g("padding",b,a),this.v())}}}),Fc.className="Placeholder",y(Oc,zu),Oc.prototype.cloneProtected=function(a){zu.prototype.cloneProtected.call(this,a),a.Qa=-113&this.Qa,a.ff=this.ff,a.fn=this.fn,a.vf=this.vf,a.to=this.to,a.pk=this.pk,a.Nm=this.Nm,a.Pm=this.Pm,a.Qm=this.Qm,a.qj=this.qj,a.oo=this.oo,null!==this.ba&&(a.ba=this.ba.copy())},(e=Oc.prototype).Af=function(a){zu.prototype.Af.call(this,a),this.ff=a.ff,this.vf=a.vf,a.Mg=null,a.bb(),a.Sf=this.Sf;var b=a.fromPort;null!==b&&pc(b),null!==(a=a.toPort)&&pc(a)},e.qb=function(a){a.classType===Oc?2==(2&a.value)?this.routing=a:a===hf||a===lf||a===uf?this.curve=a:a===cf||a===ff||a===df?this.adjusting=a:a!==nf&&a!==af&&T("Unknown Link enum value for a Link property: "+a):zu.prototype.qb.call(this,a)},e.Xc=function(){null===this.ba&&(this.ba=new Na)},e.si=function(){var a=this.fromNode;if(null!==a){var b=a.findVisibleNode();if(null!==b&&(a=b),ma(a)||_u(a))return!1}return null===(a=this.toNode)||(null!==(b=a.findVisibleNode())&&(a=b),!ma(a)&&!_u(a))},e.zv=function(){return!1},e.Av=function(){},e.Zc=function(){return!1},Oc.prototype.computeAngle=function(a,b,t){return Oc.computeAngle(b,t)},Oc.computeAngle=function(a,b){switch(a){default:case af:a=0;break;case pf:a=b;break;case gf:a=b+90;break;case mf:a=b-90;break;case yf:a=b+180;break;case vf:90<(a=$e.ap(b))&&270>a&&(a-=180);break;case xf:90<(a=$e.ap(b+90))&&270>a&&(a-=180);break;case bf:90<(a=$e.ap(b-90))&&270>a&&(a-=180);break;case wf:if(45<(a=$e.ap(b))&&135>a||225<a&&315>a)return 0;90<a&&270>a&&(a-=180)}return $e.ap(a)},(e=Oc.prototype).oh=function(){var a=this.containingGroup;null!==a&&this.fromNode!==a&&this.toNode!==a&&a.computesBoundsIncludingLinks&&zu.prototype.oh.call(this)},e.So=function(a){var b=this.fromNode;return a===b?this.toNode:b},e.Cz=function(a){var b=this.fromPort;return a===b?this.toPort:b},e.Uo=function(a){if(zu.prototype.Uo.call(this,a),Jc(this)&&this.Wo(this.actualBounds),!a){var b=null;null!==(a=this.ef)&&rp(a,this,b=this.fromPort);var t=this.uf;if(null!==t){var e=this.toPort;t===a&&e===b||rp(t,this,e)}$c(this)}},e.Vo=function(a){if(zu.prototype.Vo.call(this,a),Jc(this)&&this.Wo(this.actualBounds),!a){var b=null;null!==(a=this.ef)&&mc(a,this,b=this.fromPort);var t=this.uf;if(null!==t){var e=this.toPort;t===a&&e===b||mc(t,this,e)}Qc(this)}},e.Kj=function(){if(this.fd=!0,null!==this.wd){var a=this.diagram;if(null!==a)for(var b=this.wd.copy().iterator;b.next();)a.remove(b.value)}null!==this.data&&(null!==(a=this.diagram)&&a.partManager.removeDataForLink(this))},Oc.prototype.updateRelationshipsFromData=function(){if(null!==this.data){var a=this.diagram;null!==a&&a.partManager.updateRelationshipsFromData(this)}},Oc.prototype.move=function(a,b){var t=b?this.location:this.position,e=t.x;isNaN(e)&&(e=0);var n=t.y;for(isNaN(n)&&(n=0),e=a.x-e,n=a.y-n,!0===b?zu.prototype.move.call(this,a,!1):(a=St.allocAt(t.x+e,t.y+n),zu.prototype.move.call(this,a,!1),St.free(a)),Ic(this,e,n),a=this.labelNodes;a.next();)t=(b=a.value).position,b.moveTo(t.x+e,t.y+n)},Oc.prototype.canRelinkFrom=function(){if(!this.relinkableFrom)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},Oc.prototype.canRelinkTo=function(){if(!this.relinkableTo)return!1;var a=this.layer;return null===a||!!a.allowRelink&&!(null!==(a=a.diagram)&&!a.allowRelink)},Oc.prototype.computeMidPoint=function(a){var b=this.pointsCount;if(0===b)return a.assign(mt),a;if(1===b)return a.assign(this.i(0)),a;if(2===b){var t=this.i(0),e=this.i(1);return a.h((t.x+e.x)/2,(t.y+e.y)/2),a}if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===hf))return this.ua.Pu(.5,a),a.add(this.i(0)),t=this.ua.figures.first(),a.offset(-t.startX,-t.startY),a;if(this.computeCurve()===hf){if(3===b){t=this.i(0),e=this.i(1);var n=this.i(2);return $e.ax(t.x,t.y,e.x,e.y,e.x,e.y,n.x,n.y,a),a}if(t=3*((e=(b-1)/3|0)/2|0),1==e%2){e=this.i(t),n=this.i(t+1);var o=this.i(t+2);t=this.i(t+3),$e.ax(e.x,e.y,n.x,n.y,o.x,o.y,t.x,t.y,a)}else a.assign(this.i(t));return a}var g=this.flattenedLengths;for(t=this.flattenedTotalLength,n=o=e=0;e<t/2&&o<b&&!(e+(n=g[o])>t/2);)e+=n,o++;return b=this.i(o),o=this.i(o+1),1>Math.abs(b.x-o.x)?b.y>o.y?a.h(b.x,b.y-(t/2-e)):a.h(b.x,b.y+(t/2-e)):1>Math.abs(b.y-o.y)?b.x>o.x?a.h(b.x-(t/2-e),b.y):a.h(b.x+(t/2-e),b.y):(t=(t/2-e)/n,a.h(b.x+t*(o.x-b.x),b.y+t*(o.y-b.y))),a},Oc.prototype.computeMidAngle=function(){var a=this.pointsCount;if(2>a)return NaN;if(2===a)return this.i(0).ab(this.i(1));if(this.isOrthogonal&&(15<=this.computeCorner()||this.computeCurve()===hf))return this.ua.wx(.5);if(this.computeCurve()===hf&&4<=a){var b=(a-1)/3|0,t=3*(b/2|0);if(1==b%2){t=Math.floor(t),a=this.i(t),b=this.i(t+1);var e=this.i(t+2);return t=this.i(t+3),$e.My(a.x,a.y,b.x,b.y,e.x,e.y,t.x,t.y)}if(0<t&&t+1<a)return this.i(t-1).ab(this.i(t+1))}b=this.flattenedLengths,e=this.flattenedTotalLength;var n,o=0;for(t=0;o<e/2&&t<a&&!(o+(n=b[t])>e/2);)o+=n,t++;if(b=this.i(t),e=this.i(t+1),1>Math.abs(b.x-e.x)&&1>Math.abs(b.y-e.y)){if(0<t&&t+2<a)return this.i(t-1).ab(this.i(t+2))}else{if(1>Math.abs(b.x-e.x))return b.y>e.y?270:90;if(1>Math.abs(b.y-e.y))return b.x>e.x?180:0}return b.ab(e)},(e=Oc.prototype).i=function(a){return this.Ob.s[a]},e.dd=function(a,b){this.Ob.cd(a,b)},e.L=function(a,b,t){this.Ob.cd(a,new St(b,t))},e.Kz=function(a,b){this.Ob.Hb(a,b)},e.m=function(a,b,t){this.Ob.Hb(a,new St(b,t))},e.ne=function(a){this.Ob.add(a)},e.yf=function(a,b){this.Ob.add(new St(a,b))},e.pv=function(a){this.Ob.mb(a)},e.Ej=function(){this.Ob.clear()},e.uh=function(){null===this.Mg&&(this.Mg=this.Ob,this.Ob=this.Ob.copy())},e.zf=function(){if(null!==this.Mg){for(var a=this.Mg,b=this.Ob,t=1/0,e=1/0,n=a.s,o=n.length,g=0;g<o;g++){var r=n[g];t=Math.min(r.x,t),e=Math.min(r.y,e)}r=g=1/0;for(var h=b.s,l=h.length,c=0;c<l;c++){var f=h[c];g=Math.min(f.x,g),r=Math.min(f.y,r),f.freeze()}if(b.freeze(),l===o){for(o=0;o<l;o++)if(c=n[o],f=h[o],c.x-t!=f.x-g||c.y-e!=f.y-r){this.rc();break}}else this.rc();this.Mg=null,null!==(t=this.diagram)&&t.animationManager.Ab&&lo(t.animationManager,this,b),zc(this),this.g("points",a,b)}},e.rv=function(){null!==this.Mg&&(this.Ob=this.Mg,this.Mg=null)},e.bb=function(){if(!this.suspendsRouting){var a=this.diagram;if(a){if(a.zs.contains(this)||a.undoManager.isUndoingRedoing)return;if((a=a.animationManager).isTicking&&!a.isAnimating)return;null===this.Tg||a.isTicking||(this.Tg=null)}null!==(a=this.path)&&(this.fd=!1,this.v(),a.v())}},e.vg=function(){if(!this.fd&&!this.computingPoints){var a=!0;try{this.computingPoints=!0,this.uh(),a=this.computePoints()}catch(t){this.computingPoints=!1,this.rv()}finally{this.computingPoints=!1,a?this.zf():this.rv()}}},Oc.prototype.computePoints=function(){if(null===this.diagram)return!1;var a=this.fromNode,b=null;if(null===a?(tf||((tf=new uc).desiredSize=Ft,tf.Va()),this.defaultFromPoint&&(tf.location=this.defaultFromPoint,tf.Va(),b=a=tf)):b=this.fromPort,null!==b&&!a.isVisible()){var t=a.findVisibleNode();null!==t&&t!==a?(a=t,b=t.port):a=t}if(this.Lw=a,null===a||!a.location.w())return!1;for(;!(null===b||b.actualBounds.w()&&b.Ed());)b=b.panel;if(null===b)return!1;var e=this.toNode,n=null;if(null===e?(ef||((ef=new uc).desiredSize=Ft,ef.Va()),this.defaultToPoint&&(ef.location=this.defaultToPoint,ef.Va(),n=e=ef)):n=this.toPort,null===n||e.isVisible()||(null!==(t=e.findVisibleNode())&&t!==e?(e=t,n=t.port):e=t),this.Mw=e,null===e||!e.location.w())return!1;for(;!(null===n||n.actualBounds.w()&&n.Ed());)n=n.panel;if(null===n)return!1;var o=this.pointsCount,g=this.computeSpot(!0,b);t=this.computeSpot(!1,n);var r=Vc(g),h=Vc(t),l=b===n&&null!==b,c=this.isOrthogonal,f=this.curve===hf;this.Wf=!(!l||c)&&(f=!0);var p=this.computeAdjusting()===af||l;if(!c&&!l&&r&&h){if(r=!1,!p&&3<=o&&(p=this.getLinkPoint(a,b,g,!0,!1,e,n),h=this.getLinkPoint(e,n,t,!1,!1,a,b),r=this.adjustPoints(0,p,o-1,h))&&(p=this.getLinkPoint(a,b,g,!0,!1,e,n),h=this.getLinkPoint(e,n,t,!1,!1,a,b),this.adjustPoints(0,p,o-1,h)),!r)if(this.Ej(),f){o=this.getLinkPoint(a,b,g,!0,!1,e,n),r=(p=this.getLinkPoint(e,n,t,!1,!1,a,b)).x-o.x,h=p.y-o.y,l=this.computeCurviness(),f=c=0;var q=o.x+r/3,d=o.y+h/3,u=q,m=d;$e.B(h,0)?m=0<r?m-l:m+l:(c=-r/h,f=Math.sqrt(l*l/(c*c+1)),0>l&&(f=-f),m=c*((u=(0>h?-1:1)*f+q)-q)+d);var y=q=o.x+2*r/3,v=d=o.y+2*h/3;$e.B(h,0)?v=0<r?v-l:v+l:v=c*((y=(0>h?-1:1)*f+q)-q)+d,this.Ej(),this.ne(o),this.yf(u,m),this.yf(y,v),this.ne(p),this.dd(0,this.getLinkPoint(a,b,g,!0,!1,e,n)),this.dd(3,this.getLinkPoint(e,n,t,!1,!1,a,b))}else o=e,p=n,e=this.getLinkPoint(a,b,g,!0,!1,o,p),n=this.getLinkPoint(o,p,t,!1,!1,a,b),this.hasCurviness()?(p=n.x-e.x,t=n.y-e.y,g=this.computeCurviness(),o=a=e.x+p/2,r=b=e.y+t/2,$e.B(t,0)?r=0<p?r-g:r+g:(p=-p/t,o=Math.sqrt(g*g/(p*p+1)),0>g&&(o=-o),r=p*((o=(0>t?-1:1)*o+a)-a)+b),this.ne(e),this.yf(o,r),this.ne(n)):(this.ne(e),this.ne(n),r=Ut.alloc(),b.mi(r),h=r.ca(n),p.mi(r),l=r.ca(e),(h||l)&&(g=b.ga(Yc(g),new St),this.dd(0,this.getLinkPointFromPoint(a,b,g,n,!0,g)),t=p.ga(Yc(t),new St),this.dd(1,this.getLinkPointFromPoint(o,p,t,e,!1,t))),Ut.free(r))}else{f=this.isAvoiding,p&&(c&&f||l)&&this.Ej();var x=l?this.computeCurviness():0;f=this.getLinkPoint(a,b,g,!0,c,e,n),q=u=d=0,(c||!r||l)&&(m=this.computeEndSegmentLength(a,b,g,!0),q=this.getLinkDirection(a,b,f,g,!0,c,e,n),l&&(r||g.D(t)||!c&&1===g.x+t.x&&1===g.y+t.y)&&(q-=c?90:30,0>x&&(q-=180)),0>q?q+=360:360<=q&&(q-=360),l&&(m+=Math.abs(x)*(c?1:2)),0===q?d=m:90===q?u=m:180===q?d=-m:270===q?u=-m:(d=m*Math.cos(q*Math.PI/180),u=m*Math.sin(q*Math.PI/180)),g.Mc()&&l&&(m=b.ga(fe,St.alloc()),y=St.allocAt(m.x+1e3*d,m.y+1e3*u),this.getLinkPointFromPoint(a,b,m,y,!0,f),St.free(m),St.free(y))),m=this.getLinkPoint(e,n,t,!1,c,a,b);var w=v=y=0;if(c||!h||l){var k=this.computeEndSegmentLength(e,n,t,!1);w=this.getLinkDirection(e,n,m,t,!1,c,a,b),l&&(h||g.D(t)||!c&&1===g.x+t.x&&1===g.y+t.y)&&(w+=c?0:30,0>x&&(w+=180)),0>w?w+=360:360<=w&&(w-=360),l&&(k+=Math.abs(x)*(c?1:2)),0===w?y=k:90===w?v=k:180===w?y=-k:270===w?v=-k:(y=k*Math.cos(w*Math.PI/180),v=k*Math.sin(w*Math.PI/180)),t.Mc()&&l&&(t=n.ga(fe,St.alloc()),g=St.allocAt(t.x+1e3*y,t.y+1e3*v),this.getLinkPointFromPoint(e,n,t,g,!1,m),St.free(t),St.free(g))}t=f,(c||!r||l)&&(t=new St(f.x+d,f.y+u)),g=m,(c||!h||l)&&(g=new St(m.x+y,m.y+v)),!p&&!c&&r&&3<o&&this.adjustPoints(0,f,o-2,g)?this.dd(o-1,m):!p&&!c&&h&&3<o&&this.adjustPoints(1,t,o-1,m)?this.dd(0,f):!p&&(c?6<=o:4<o)&&this.adjustPoints(1,t,o-2,g)?(this.dd(0,f),this.dd(o-1,m)):(this.Ej(),this.ne(f),(c||!r||l)&&this.ne(t),c&&this.addOrthoPoints(t,q,g,w,a,e),(c||!h||l)&&this.ne(g),this.ne(m))}return!0},Oc.prototype.getLinkPointFromPoint=function(a,b,t,e,n,o){if(void 0===o&&(o=new St),null===a||null===b)return o.assign(t),o;if(a.isVisible()||null!==(n=a.findVisibleNode())&&n!==a&&(b=n.port),a=null,null===(n=b.panel)||n.se()||(n=n.panel),null===n){n=e.x,e=e.y;var g=t.x;t=t.y}else{n=1/((a=n.oe).m11*a.m22-a.m12*a.m21),g=a.m22*n;var r=-a.m12*n,h=-a.m21*n,l=a.m11*n,c=n*(a.m21*a.dy-a.m22*a.dx),f=n*(a.m12*a.dx-a.m11*a.dy);n=e.x*g+e.y*h+c,e=e.x*r+e.y*l+f,g=t.x*g+t.y*h+c,t=t.x*r+t.y*l+f}return b.Rj(n,e,g,t,o),null!==a&&o.transform(a),o},Oc.prototype.getLinkPoint=function(a,b,t,e,n,o,g,r){if(void 0===r&&(r=new St),t.sb()&&!Vc(t))return b.ga(t,r),r;if(t.$c()){var h=Ec(this,b);if(null!==h){if(r.assign(h.Yo),n&&this.routing===sf){var l=Ec(this,g);if(null!==l&&h.Fl<l.Fl){h=St.alloc(),l=St.alloc();var c=new Ut(b.ga(he,h),b.ga(me,l)),f=this.computeSpot(!e,g);a=this.getLinkPoint(o,g,f,!e,n,a,b,l),(t.Hf(ve)||t.Hf(xe))&&a.y>=c.y&&a.y<=c.y+c.height?r.y=a.y:(t.Hf(ye)||t.Hf(be))&&a.x>=c.x&&a.x<=c.x+c.width&&(r.x=a.x),St.free(h),St.free(l)}}return r}}return t=b.ga(Yc(t),St.alloc()),this.pointsCount>(n?6:2)?(g=e?this.i(1):this.i(this.pointsCount-2),n&&(g=Rc(t,g.copy()))):(h=this.computeSpot(!e,g),o=St.alloc(),g=g.ga(Yc(h),o),n&&(g=Rc(t,g)),St.free(o)),this.getLinkPointFromPoint(a,b,t,g,e,r),St.free(t),r},Oc.prototype.getLinkDirection=function(a,b,t,e,n,o,g,r){t:if(e.sb())var h=e.x>e.y?e.x>1-e.y?0:e.x<1-e.y?270:315:e.x<e.y?e.x>1-e.y?90:e.x<1-e.y?180:135:.5>e.x?225:.5<e.x?45:0;else{if(e.$c()&&null!==(h=Ec(this,b)))switch(h.Nc){case 1:h=270;break t;case 2:h=180;break t;default:case 4:h=0;break t;case 8:h=90;break t}h=b.ga(fe,St.alloc()),this.pointsCount>(o?6:2)?(r=n?this.i(1):this.i(this.pointsCount-2),r=o?Rc(h,r.copy()):t):(t=St.alloc(),r=r.ga(fe,t),St.free(t)),t=Math.abs(r.x-h.x)>Math.abs(r.y-h.y)?r.x>=h.x?0:180:r.y>=h.y?90:270,St.free(h),h=t}return g&&e.Mc()&&g.Td(a)&&(360<=(h+=180)&&(h-=360)),Vc(e)||0===(a=b.li())||(45<=a&&135>a?h+=90:135<=a&&225>a?h+=180:225<=a&&315>a&&(h+=270),360<=h&&(h-=360)),h},Oc.prototype.computeEndSegmentLength=function(a,b,t,e){return null!==b&&t.$c()&&null!==(a=Ec(this,b))?a.Ju:(a=e?this.fromEndSegmentLength:this.toEndSegmentLength,null!==b&&isNaN(a)&&(a=e?b.fromEndSegmentLength:b.toEndSegmentLength),isNaN(a)&&(a=10),a)},Oc.prototype.computeSpot=function(a,b){return void 0===b&&(b=null),a?null===(a=b||this.fromPort)?a=fe:((b=this.fromSpot).Yb()&&(b=a.fromSpot),a=b===Fe?ae:b):null===(a=b||this.toPort)?a=fe:((b=this.toSpot).Yb()&&(b=a.toSpot),a=b===Fe?ae:b),a},Oc.prototype.computeOtherPoint=function(a,b){return this.computeAdjusting()!==af&&4<this.pointsCount?this.computeMidPoint(new St):null!==(a=null!==(a=b.Yn)?Gf(a,this):null)?a.Yo:b.ga(fe)},Oc.prototype.computeShortLength=function(a){if(a){if(a=this.fromShortLength,isNaN(a)){var b=this.fromPort;null!==b&&(a=b.fromShortLength)}return isNaN(a)?0:a}return a=this.toShortLength,isNaN(a)&&(null!==(b=this.toPort)&&(a=b.toShortLength)),isNaN(a)?0:a},Oc.prototype.Cf=function(a,b,t,e,n,o){if(!1===this.pickable)return!1;void 0===b&&(b=null),void 0===t&&(t=null);var g=o;if(void 0===o&&(g=Ze.alloc()).reset(),g.multiply(this.transform),this.fh(a,g))return Qh(this,b,t,n),void 0===o&&Ze.free(g),!0;if(this.Yc(a,g)){var r=!1;if(!this.isAtomic)for(var h=this.O.s,l=h.length;l--;){var c=h[l];if(c.visible||c===this.locationObject){var f=c.actualBounds,p=this.naturalBounds;if(!(f.x>p.width||f.y>p.height||0>f.x+f.width||0>f.y+f.height)){if((f=Ze.alloc()).set(g),c instanceof Eh)r=c.Cf(a,b,t,e,n,f);else if(this.path===c){if(c instanceof Ll)if(r=a,p=e,!1===c.pickable)r=!1;else if(f.multiply(c.transform),p)t:{var q=r,d=f;if(c.fh(q,d))r=!0;else{if(void 0===d&&(d=c.transform,q.Re(c.actualBounds))){r=!0;break t}r=q.left,p=q.right;var u=q.top;q=q.bottom;var m=St.alloc(),y=St.alloc(),v=St.alloc(),x=Ze.alloc();x.set(d),x.bv(c.transform),x.Uj(),y.x=p,y.y=u,y.transform(x),m.x=r,m.y=u,m.transform(x),d=!1,Dl(c,m,y,v)?d=!0:(m.x=p,m.y=q,m.transform(x),Dl(c,m,y,v)?d=!0:(y.x=r,y.y=q,y.transform(x),Dl(c,m,y,v)?d=!0:(m.x=r,m.y=u,m.transform(x),Dl(c,m,y,v)&&(d=!0)))),Ze.free(x),St.free(m),St.free(y),St.free(v),r=d}}else r=c.fh(r,f)}else r=Ws(c,a,e,f);r&&(p=c,null!==b&&(p=b(c)),p&&(null===t||t(p))&&n.add(p)),Ze.free(f)}}}return void 0===o&&Ze.free(g),r||null!==this.background||null!==this.areaBackground}return void 0===o&&Ze.free(g),!1},Oc.prototype.computeCurve=function(){if(null===this.Wf){var a=this.fromPort,b=this.isOrthogonal;this.Wf=null!==a&&a===this.toPort&&!b}return this.Wf?hf:this.curve},Oc.prototype.computeCorner=function(){if(this.curve===hf)return 0;var a=this.corner;return(isNaN(a)||0>a)&&(a=10),a},Oc.prototype.findMidLabel=function(){for(var a=this.path,b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e];if(n!==a&&!n.isPanelMain&&(-1/0===n.segmentIndex||isNaN(n.segmentIndex)))return n}for(a=this.labelNodes;a.next();)if(-1/0===(b=a.value).segmentIndex||isNaN(b.segmentIndex))return b;return null},Oc.prototype.computeSpacing=function(){if(!this.isVisible())return 0;var a=Mf;a=Math.max(a,this.computeThickness());var b=this.fromPort,t=this.toPort;if(null!==b&&null!==t){var e=this.findMidLabel();if(null!==e){var n=e.naturalBounds,o=e.margin,g=isNaN(n.width)?30:n.width*e.scale+o.left+o.right;n=isNaN(n.height)?14:n.height*e.scale+o.top+o.bottom,(e=e.segmentOrientation)===pf||e===vf||e===yf?a=Math.max(a,n):e===mf||e===bf||e===gf||e===xf?a=Math.max(a,g):(b=b.ga(fe).ab(t.ga(fe))/180*Math.PI,a=Math.max(a,Math.abs(Math.sin(b)*g)+Math.abs(Math.cos(b)*n)+1)),this.curve===hf&&(a*=1.333)}}return a},Oc.prototype.arrangeBundledLinks=function(a,b){if(b)for(b=0;b<a.length;b++){var t=a[b];t.computeAdjusting()===af&&t.bb()}},Oc.prototype.computeCurviness=function(){var a=this.curviness;if(isNaN(a)){a=kf;var b=this.Sf;if(null!==b){for(var t=z(),e=0,n=b.links,o=0;o<n.length;o++){var g=n[o].computeSpacing();t.push(g),e+=g}for(e=-e/2,o=0;o<n.length;o++){if(n[o]===this){a=e+t[o]/2;break}e+=t[o]}b.Cs===this.fromNode&&(a=-a),R(t)}}return a},Oc.prototype.computeThickness=function(){if(!this.isVisible())return 0;var a=this.path;return null!==a?Math.max(a.strokeWidth,1):1},Oc.prototype.hasCurviness=function(){return!isNaN(this.curviness)||null!==this.Sf},Oc.prototype.adjustPoints=function(a,b,t,e){var n=this.computeAdjusting();if(this.isOrthogonal){if(n===ff)return!1;n===df&&(n=cf)}switch(n){case ff:var o=this.i(a),g=this.i(t);if(!o.Xa(b)||!g.Xa(e)){n=o.x,o=o.y;var r=g.x-n,h=g.y-o,l=Math.sqrt(r*r+h*h);if(!$e.$(l,0)){if($e.$(r,0))var c=0>h?-Math.PI/2:Math.PI/2;else c=Math.atan(h/Math.abs(r)),0>r&&(c=Math.PI-c);g=b.x;var f=b.y;r=e.x-g;var p=e.y-f;for(h=Math.sqrt(r*r+p*p),$e.$(r,0)?p=0>p?-Math.PI/2:Math.PI/2:(p=Math.atan(p/Math.abs(r)),0>r&&(p=Math.PI-p)),l=h/l,c=p-c,this.dd(a,b),a+=1;a<t;a++)r=(b=this.i(a)).x-n,h=b.y-o,b=Math.sqrt(r*r+h*h),$e.$(b,0)||($e.$(r,0)?h=0>h?-Math.PI/2:Math.PI/2:(h=Math.atan(h/Math.abs(r)),0>r&&(h=Math.PI-h)),r=h+c,b*=l,this.L(a,g+b*Math.cos(r),f+b*Math.sin(r)));this.dd(t,e)}}return!0;case df:if(o=this.i(a),f=this.i(t),!o.Xa(b)||!f.Xa(e)){n=o.x,o=o.y,l=((g=f.x)-n)*(g-n)+((f=f.y)-o)*(f-o),r=b.x,c=b.y,h=e.x,p=e.y;var q=1;if(0!=h-r){var d=(p-c)/(h-r);q=Math.sqrt(1+1/(d*d))}else d=9e9;for(this.dd(a,b),a+=1;a<t;a++){var u=(b=this.i(a)).x,m=b.y,y=.5;0!==l&&(y=((n-u)*(n-g)+(o-m)*(o-f))/l);var v=n+y*(g-n),x=o+y*(f-o);b=Math.sqrt((u-v)*(u-v)+(m-x)*(m-x)),m<d*(u-v)+x&&(b=-b),0<d&&(b=-b),u=r+y*(h-r),y=c+y*(p-c),0!==d?(b=u+b/q,this.L(a,b,y-(b-u)/d)):this.L(a,u,y+b)}this.dd(t,e)}return!0;case cf:return this.isOrthogonal&&(n=this.i(a),o=this.i(a+1),g=this.i(a+2),f=r=o.x,l=c=o.y,$e.B(n.y,o.y)?$e.B(o.x,g.x)?c=b.y:$e.B(o.y,g.y)&&(r=b.x):$e.B(n.x,o.x)&&($e.B(o.y,g.y)?r=b.x:$e.B(o.x,g.x)&&(c=b.y)),this.L(a+1,r,c),n=this.i(t),o=this.i(t-1),g=this.i(t-2),h=r=o.x,p=c=o.y,$e.B(n.y,o.y)?$e.B(o.x,g.x)?c=e.y:$e.B(o.y,g.y)&&(r=e.x):$e.B(n.x,o.x)&&($e.B(o.y,g.y)?r=e.x:$e.B(o.x,g.x)&&(c=e.y)),this.L(t-1,r,c),Gc(this))?(this.L(a+1,f,l),this.L(t-1,h,p),t=!1):(this.dd(a,b),this.dd(t,e),t=!0),t;default:return!1}},Oc.prototype.addOrthoPoints=function(a,b,t,e,n,o){0>b?b+=360:360<=b&&(b-=360),0>e?e+=360:360<=e&&(e-=360);var g=e;b=315<=b||45>b?0:45<=b&&135>b?90:135<=b&&225>b?180:270,e=315<=e||45>e?0:45<=e&&135>e?90:135<=e&&225>e?180:270;var r=n.actualBounds.copy(),h=o.actualBounds.copy();if(r.w()&&h.w()){r.Bc(Sf,Sf),h.Bc(Sf,Sf),r.Ye(a),h.Ye(t);var l=St.alloc(),c=St.alloc();0===b?t.x>a.x||270===e&&t.y<a.y&&h.right>a.x||90===e&&t.y>a.y&&h.right>a.x?(l.h(t.x,a.y),c.h(t.x,(a.y+t.y)/2),180===e?(l.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),c.x=l.x,c.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(l.x=a.x<h.left?this.computeMidOrthoPosition(a.x,a.y,h.left,t.y,!1):a.x<h.right&&(270===e&&a.y<h.top||90===e&&a.y>h.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):h.right,c.x=l.x,c.y=t.y):0===e&&a.x<h.left&&a.y>h.top&&a.y<h.bottom&&(l.x=a.x,l.y=a.y<t.y?Math.min(t.y,h.top):Math.max(t.y,h.bottom),c.y=l.y)):(l.h(a.x,t.y),c.h((a.x+t.x)/2,t.y),(180===e||90===e&&t.y<r.top||270===e&&t.y>r.bottom)&&(180===e&&(h.ca(a)||r.ca(t))?l.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(180===e||90===e)?l.y=this.computeMidOrthoPosition(a.x,r.top,t.x,Math.max(t.y,h.bottom),!0):t.y>a.y&&(180===e||270===e)&&(l.y=this.computeMidOrthoPosition(a.x,r.bottom,t.x,Math.min(t.y,h.top),!0)),c.x=t.x,c.y=l.y),l.y>r.top&&l.y<r.bottom&&(t.x>=r.left&&t.x<=a.x||a.x<=h.right&&a.x>=t.x?90!==e&&270!==e||(l.h(Math.max((a.x+t.x)/2,a.x),a.y),c.h(l.x,t.y)):(l.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,0===e?r.top:Math.min(r.top,h.top)):Math.max(t.y,0===e?r.bottom:Math.max(r.bottom,h.bottom)),c.x=t.x,c.y=l.y))):180===b?t.x<a.x||270===e&&t.y<a.y&&h.left<a.x||90===e&&t.y>a.y&&h.left<a.x?(l.h(t.x,a.y),c.h(t.x,(a.y+t.y)/2),0===e?(l.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1),c.x=l.x,c.y=t.y):270===e&&t.y<a.y||90===e&&t.y>a.y?(l.x=a.x>h.right?this.computeMidOrthoPosition(a.x,a.y,h.right,t.y,!1):a.x>h.left&&(270===e&&a.y<h.top||90===e&&a.y>h.bottom)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):h.left,c.x=l.x,c.y=t.y):180===e&&a.x>h.right&&a.y>h.top&&a.y<h.bottom&&(l.x=a.x,l.y=a.y<t.y?Math.min(t.y,h.top):Math.max(t.y,h.bottom),c.y=l.y)):(l.h(a.x,t.y),c.h((a.x+t.x)/2,t.y),(0===e||90===e&&t.y<r.top||270===e&&t.y>r.bottom)&&(0===e&&(h.ca(a)||r.ca(t))?l.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):t.y<a.y&&(0===e||90===e)?l.y=this.computeMidOrthoPosition(a.x,r.top,t.x,Math.max(t.y,h.bottom),!0):t.y>a.y&&(0===e||270===e)&&(l.y=this.computeMidOrthoPosition(a.x,r.bottom,t.x,Math.min(t.y,h.top),!0)),c.x=t.x,c.y=l.y),l.y>r.top&&l.y<r.bottom&&(t.x<=r.right&&t.x>=a.x||a.x>=h.left&&a.x<=t.x?90!==e&&270!==e||(l.h(Math.min((a.x+t.x)/2,a.x),a.y),c.h(l.x,t.y)):(l.y=270===e||(0===e||180===e)&&t.y<a.y?Math.min(t.y,180===e?r.top:Math.min(r.top,h.top)):Math.max(t.y,180===e?r.bottom:Math.max(r.bottom,h.bottom)),c.x=t.x,c.y=l.y))):90===b?t.y>a.y||180===e&&t.x<a.x&&h.bottom>a.y||0===e&&t.x>a.x&&h.bottom>a.y?(l.h(a.x,t.y),c.h((a.x+t.x)/2,t.y),270===e?(l.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),c.x=t.x,c.y=l.y):180===e&&t.x<a.x||0===e&&t.x>a.x?(l.y=a.y<h.top?this.computeMidOrthoPosition(a.x,a.y,t.x,h.top,!0):a.y<h.bottom&&(180===e&&a.x<h.left||0===e&&a.x>h.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):h.bottom,c.x=t.x,c.y=l.y):90===e&&a.y<h.top&&a.x>h.left&&a.x<h.right&&(l.x=a.x<t.x?Math.min(t.x,h.left):Math.max(t.x,h.right),l.y=a.y,c.x=l.x)):(l.h(t.x,a.y),c.h(t.x,(a.y+t.y)/2),(270===e||0===e&&t.x<r.left||180===e&&t.x>r.right)&&(270===e&&(h.ca(a)||r.ca(t))?l.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(270===e||0===e)?l.x=this.computeMidOrthoPosition(r.left,a.y,Math.max(t.x,h.right),t.y,!1):t.x>a.x&&(270===e||180===e)&&(l.x=this.computeMidOrthoPosition(r.right,a.y,Math.min(t.x,h.left),t.y,!1)),c.x=l.x,c.y=t.y),l.x>r.left&&l.x<r.right&&(t.y>=r.top&&t.y<=a.y||a.y<=h.bottom&&a.y>=t.y?0!==e&&180!==e||(l.h(a.x,Math.max((a.y+t.y)/2,a.y)),c.h(t.x,l.y)):(l.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,90===e?r.left:Math.min(r.left,h.left)):Math.max(t.x,90===e?r.right:Math.max(r.right,h.right)),c.x=l.x,c.y=t.y))):t.y<a.y||180===e&&t.x<a.x&&h.top<a.y||0===e&&t.x>a.x&&h.top<a.y?(l.h(a.x,t.y),c.h((a.x+t.x)/2,t.y),90===e?(l.y=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0),c.x=t.x,c.y=l.y):180===e&&t.x<a.x||0===e&&t.x>=a.x?(l.y=a.y>h.bottom?this.computeMidOrthoPosition(a.x,a.y,t.x,h.bottom,!0):a.y>h.top&&(180===e&&a.x<h.left||0===e&&a.x>h.right)?this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!0):h.top,c.x=t.x,c.y=l.y):270===e&&a.y>h.bottom&&a.x>h.left&&a.x<h.right&&(l.x=a.x<t.x?Math.min(t.x,h.left):Math.max(t.x,h.right),l.y=a.y,c.x=l.x)):(l.h(t.x,a.y),c.h(t.x,(a.y+t.y)/2),(90===e||0===e&&t.x<r.left||180===e&&t.x>r.right)&&(90===e&&(h.ca(a)||r.ca(t))?l.x=this.computeMidOrthoPosition(a.x,a.y,t.x,t.y,!1):t.x<a.x&&(90===e||0===e)?l.x=this.computeMidOrthoPosition(r.left,a.y,Math.max(t.x,h.right),t.y,!1):t.x>a.x&&(90===e||180===e)&&(l.x=this.computeMidOrthoPosition(r.right,a.y,Math.min(t.x,h.left),t.y,!1)),c.x=l.x,c.y=t.y),l.x>r.left&&l.x<r.right&&(t.y<=r.bottom&&t.y>=a.y||a.y>=h.top&&a.y<=t.y?0!==e&&180!==e||(l.h(a.x,Math.min((a.y+t.y)/2,a.y)),c.h(t.x,l.y)):(l.x=180===e||(90===e||270===e)&&t.x<a.x?Math.min(t.x,270===e?r.left:Math.min(r.left,h.left)):Math.max(t.x,270===e?r.right:Math.max(r.right,h.right)),c.x=l.x,c.y=t.y)));var f=t;if(this.isAvoiding){var p=this.diagram;if(null===p||n===o||this.layer.isTemporary||!Gr(p)||r.ca(f)&&!o.Td(n)||h.ca(a)&&!n.Td(o))b=!1;else{var q=Xr(p,!0,this.containingGroup,null);if(17!==this.segmentIndex&&q.Xj(Math.min(a.x,l.x),Math.min(a.y,l.y),Math.abs(a.x-l.x),Math.abs(a.y-l.y))&&q.Xj(Math.min(l.x,c.x),Math.min(l.y,c.y),Math.abs(l.x-c.x),Math.abs(l.y-c.y))&&q.Xj(Math.min(c.x,f.x),Math.min(c.y,f.y),Math.abs(c.x-f.x),Math.abs(c.y-f.y)))b=!1;else{n=a,o=f;var d=t=null;if(p.isVirtualized){(p=q.bounds.copy()).Bc(-q.Go,-q.Fo);var u=St.alloc();Cf(q,a.x,a.y)||($e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,a.x,a.y,l.x,l.y,u)?(t=a=u.copy(),b=u.ab(l)):$e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,l.x,l.y,c.x,c.y,u)?(t=a=u.copy(),b=u.ab(c)):$e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,c.x,c.y,f.x,f.y,u)&&(t=a=u.copy(),b=u.ab(f))),Cf(q,f.x,f.y)||($e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,f.x,f.y,c.x,c.y,u)?(d=f=u.copy(),e=c.ab(u)):$e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,c.x,c.y,l.x,l.y,u)?(d=f=u.copy(),e=l.ab(u)):$e.Ff(p.x,p.y,p.x+p.width,p.y+p.height,l.x,l.y,a.x,a.y,u)&&(d=f=u.copy(),e=a.ab(u))),St.free(u)}(r=r.copy().ed(h)).Bc(q.Go*q.Ns,q.Fo*q.Ns),Of(q,a,b,f,e,r,!0),h=Tf(q,f.x,f.y),!q.abort&&h>=zf&&(Lf(q),r.Bc(q.Go*q.Hx,q.Fo*q.Ix),Of(q,a,b,f,e,r,!1),h=Tf(q,f.x,f.y)),!q.abort&&h<zf&&Tf(q,f.x,f.y)!==Df?(Xc(this,q,f.x,f.y,e,!0,g),r=this.i(2),4>this.pointsCount?(0===b||180===b?(r.x=a.x,r.y=f.y):(r.x=f.x,r.y=a.y),this.L(2,r.x,r.y),this.m(3,r.x,r.y)):(g=this.i(3),0===b||180===b?$e.B(r.x,g.x)?(r=0===b?Math.max(r.x,a.x):Math.min(r.x,a.x),this.L(2,r,a.y),this.L(3,r,g.y)):$e.B(r.y,g.y)?(Math.abs(a.y-r.y)<=q.Fo/2&&(this.L(2,r.x,a.y),this.L(3,g.x,a.y)),this.m(2,r.x,a.y)):this.L(2,a.x,r.y):90!==b&&270!==b||($e.B(r.y,g.y)?(r=90===b?Math.max(r.y,a.y):Math.min(r.y,a.y),this.L(2,a.x,r),this.L(3,g.x,r)):$e.B(r.x,g.x)?(Math.abs(a.x-r.x)<=q.Go/2&&(this.L(2,a.x,r.y),this.L(3,a.x,g.y)),this.m(2,a.x,r.y)):this.L(2,r.x,a.y))),null!==t&&(a=this.i(1),g=this.i(2),a.x!==g.x&&a.y!==g.y?0===b||180===b?this.m(2,a.x,g.y):this.m(2,g.x,a.y):0===b||180===b?this.m(2,n.x,t.y):this.m(2,t.x,n.y)),null!==d&&(0===e||180===e?this.yf(o.x,d.y):this.yf(d.x,o.y)),b=!0):b=!1}}}else b=!1;b||(this.ne(l.copy()),this.ne(c.copy())),St.free(l),St.free(c)}},Oc.prototype.computeMidOrthoPosition=function(a,b,t,e,n){var o=0;return!this.hasCurviness()||this.computeSpot(!0,this.fromPort).$c()||this.computeSpot(!1,this.toPort).$c()||(o=this.computeCurviness()),n?(b+e)/2+o:(a+t)/2+o},Oc.prototype.ez=function(a){var b=a.x;a=a.y;for(var t=this.i(0),e=this.i(1),n=Lt(b,a,t.x,t.y,e.x,e.y),o=0,g=1;g<this.pointsCount-1;g++){t=this.i(g+1);var r=Lt(b,a,e.x,e.y,t.x,t.y);e=t,r<n&&(o=g,n=r)}return o},Oc.prototype.rc=function(){this.kk=!1,this.v()},Oc.prototype.Tl=function(a){if(!a){if(!1===this.fd)return;if(a=this.Qb(),this.kk&&(null===a||null!==a.geometry))return}if(2>this.pointsCount?this.kk=!0:this.ua=this.makeGeometry(),null!==(a=this.path)){a.ua=this.ua;for(var b=this.O.s,t=b.length,e=0;e<t;e++){var n=b[e];n!==a&&n.isPanelMain&&n instanceof Ll&&(n.ua=this.ua)}}},Oc.prototype.makeGeometry=function(){var a=this.ua,b=this.pointsCount,t=!1,e=this.diagram;null!==e&&Jc(this)&&e.Eh.contains(this)&&(0!==this.ll.width||0!==this.ll.height)&&(e.animationManager.isAnimating||e.currentTool!==e.toolManager)&&(t=!0);var n=this.i(0).copy(),o=n.copy();e=this.Ob.s;var g=this.computeCurve();if(g===hf&&3<=b&&!$e.$(this.smoothness,0))if(3===b){var r=this.i(1);e=Math.min(n.x,r.x);var h=Math.min(n.y,r.y);r=this.i(2),e=Math.min(e,r.x),h=Math.min(h,r.y)}else{if(this.isOrthogonal)for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);else for(e=3;e<b;e+=3)e+3>=b&&(e=b-1),h=this.i(e),o.x=Math.min(h.x,o.x),o.y=Math.min(h.y,o.y);e=o.x,h=o.y}else{for(h=0;h<b;h++)r=e[h],o.x=Math.min(r.x,o.x),o.y=Math.min(r.y,o.y);e=o.x,h=o.y}if(e-=this.ru.x,h-=this.ru.y,n.x-=e,n.y-=h,2!==b||Jc(this)){if(a.type=Qe.o,r=Ou(a),0!==this.computeShortLength(!0)&&(n=qc(this,n,!0,o)),Tu(r,n.x,n.y,!1),g===hf&&3<=b&&!$e.$(this.smoothness,0))if(3===b)b=(t=this.i(1)).x-e,t=t.y-h,(n=this.i(2).copy()).x-=e,n.y-=h,0!==this.computeShortLength(!1)&&(n=qc(this,n,!1,o)),Au(r,b,t,b,t,n.x,n.y);else if(this.isOrthogonal){b=St.allocAt(e,h),(t=St.alloc()).assign(this.i(1)),o=St.allocAt(e,h),n=St.allocAt(e,h),g=this.i(0);for(var l,c=this.smoothness/3,f=1;f<this.pointsCount-1;f++){var p=g,q=l=this.i(f),d=this.i(Kc(this,l,f,!1));if(!($e.$(p.x,q.x)&&$e.$(q.x,d.x)||$e.$(p.y,q.y)&&$e.$(q.y,d.y))){var u=c;isNaN(u)&&(u=this.smoothness/3);var m=p.x;p=p.y;var y=q.x;q=q.y;var v=d.x;d=d.y;var x=u*Uc(m,p,y,q);u*=Uc(y,q,v,d),$e.$(p,q)&&$e.$(y,v)&&(y>m?d>q?(o.x=y-x,o.y=q-x,n.x=y+u,n.y=q+u):(o.x=y-x,o.y=q+x,n.x=y+u,n.y=q-u):d>q?(o.x=y+x,o.y=q-x,n.x=y-u,n.y=q+u):(o.x=y+x,o.y=q+x,n.x=y-u,n.y=q-u)),$e.$(m,y)&&$e.$(q,d)&&(q>p?(v>y?(o.x=y-x,o.y=q-x,n.x=y+u):(o.x=y+x,o.y=q-x,n.x=y-u),n.y=q+u):(v>y?(o.x=y-x,o.y=q+x,n.x=y+u):(o.x=y+x,o.y=q+x,n.x=y-u),n.y=q-u)),($e.$(m,y)&&$e.$(y,v)||$e.$(p,q)&&$e.$(q,d))&&(m=.5*(m+v),p=.5*(p+d),o.x=m,o.y=p,n.x=m,n.y=p),(1===f||2===f&&$e.$(g.x,this.i(0).x)&&$e.$(g.y,this.i(0).y))&&(t.x=.5*(g.x+l.x),t.y=.5*(g.y+l.y)),Au(r,t.x-e,t.y-h,o.x-e,o.y-h,l.x-e,l.y-h),b.set(o),t.set(n),g=l}}l=g.x,g=g.y,c=this.i(this.pointsCount-1),0!==this.computeShortLength(!1)&&(c=qc(this,c.copy(),!1,ct)),l=.5*(l+c.x),g=.5*(g+c.y),Au(r,n.x-e,n.y-h,l-e,g-h,c.x-e,c.y-h),St.free(b),St.free(t),St.free(o),St.free(n)}else for(t=3;t<b;t+=3)o=this.i(t-2),t+3>=b&&(t=b-1),n=this.i(t-1),g=this.i(t),t===b-1&&0!==this.computeShortLength(!1)&&(g=qc(this,g.copy(),!1,ct)),Au(r,o.x-e,o.y-h,n.x-e,n.y-h,g.x-e,g.y-h);else{for((o=St.alloc()).assign(this.i(0)),(n=St.alloc()).assign(o),g=this.computeCorner(),f=1,l=0;f<b;){if(f=Kc(this,o,f,1<f),c=this.i(f),f>=b-1){if(o.D(c)){if(0===l)for(f=1;f<b;)n.assign(o),Hc(this,r,-e,-h,o,c=this.i(f++),t),o.assign(c)}else 0!==this.computeShortLength(!1)&&(c=qc(this,c.copy(),!1,ct)),Hc(this,r,-e,-h,o,c,t);break}if(l=Kc(this,c,f+1,f<b-3),f=-e,m=-h,p=c,y=this.i(l),u=t,$e.B(o.y,p.y)&&$e.B(p.x,y.x))if(d=Math.min(g,Math.abs(p.x-n.x)/2),d=x=Math.min(d,Math.abs(y.y-p.y)/2),$e.B(d,0))Hc(this,r,f,m,o,p,u),o.assign(p);else{var w=p.x,k=p.y;q=w,v=k,w=p.x>o.x?p.x-d:p.x+d,v=y.y>p.y?p.y+x:p.y-x,Hc(this,r,f,m,o,y=St.allocAt(w,k),u),St.free(y),ju(r,p.x+f,p.y+m,q+f,v+m),o.h(q,v)}else $e.B(o.x,p.x)&&$e.B(p.y,y.y)?(d=Math.min(g,Math.abs(p.y-n.y)/2),d=x=Math.min(d,Math.abs(y.x-p.x)/2),$e.B(x,0)?(Hc(this,r,f,m,o,p,u),o.assign(p)):(q=w=p.x,v=k=p.y,k=p.y>o.y?p.y-d:p.y+d,q=y.x>p.x?p.x+x:p.x-x,Hc(this,r,f,m,o,y=St.allocAt(w,k),u),St.free(y),ju(r,p.x+f,p.y+m,q+f,v+m),o.h(q,v))):(Hc(this,r,f,m,o,p,u),o.assign(p));n.assign(c),f=l}St.free(o)}Bu=r}else(r=this.i(1).copy()).x-=e,r.y-=h,0!==this.computeShortLength(!0)&&(n=qc(this,n,!0,o)),0!==this.computeShortLength(!1)&&(r=qc(this,r,!1,o)),a.type=Qe.j,a.startX=n.x,a.startY=n.y,a.endX=r.x,a.endY=r.y;return this.kk=!0,a},Oc.prototype.computeJumpLength=function(){return 10},Oc.prototype.Wo=function(a){var b=this.layer;if(null!==b&&b.visible&&!b.isTemporary){var t=b.diagram;if(null!==t&&!t.animationManager.isTicking){var e=!1;for(t=t.layers;t.next();){var n=t.value;if(n.visible)if(n===b){e=!0;for(var o=!1,g=(n=n.Pa.s).length,r=0;r<g;r++){var h=n[r];h instanceof Oc&&(h===this?o=!0:o&&_c(this,h,a))}}else if(e)for(n=(o=n.Pa.s).length,g=0;g<n;g++)(r=o[g])instanceof Oc&&_c(this,r,a)}}}},Oc.prototype.usesSamePort=function(a){var b=this.pointsCount,t=a.pointsCount;if(0<b&&0<t){var e=this.i(0),n=a.i(0);if(e.Xa(n))return!0;if(b=this.i(b-1),a=a.i(t-1),b.Xa(a)||e.Xa(a)||b.Xa(n))return!0}else if(this.fromNode===a.fromNode||this.toNode===a.toNode||this.fromNode===a.toNode||this.toNode===a.fromNode)return!0;return!1},Oc.prototype.isVisible=function(){if(!zu.prototype.isVisible.call(this))return!1;var a=this.containingGroup,b=!0,t=this.diagram;if(null!==t&&(b=t.isTreePathToChildren),null!==(t=this.fromNode)){if(this.isTreeLink&&b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(var e=t;null!==e;){if(e.labeledLink===this)return!0;e=e.containingGroup}if(null===(t=t.findVisibleNode())||t===a)return!1}if(null!==(t=this.toNode)){if(this.isTreeLink&&!b&&!t.isTreeExpanded)return!1;if(t===a)return!0;for(b=t;null!==b;){if(b.labeledLink===this)return!0;b=b.containingGroup}if(null===(b=t.findVisibleNode())||b===a)return!1}return!0},Oc.prototype.$b=function(a){if(zu.prototype.$b.call(this,a),a&&Zc(this,!1),null!==this.Sf&&this.Sf.Rl(),null!==this.wd)for(var b=this.wd.iterator;b.next();)b.value.$b(a)},Oc.prototype.computeAdjusting=function(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.defaultAnimation.isAnimating?cf:this.pk},Oc.prototype.ph=function(){return!0},v.Object.defineProperties(Oc.prototype,{fromNode:{get:function(){return this.ef},set:function(a){var b=this.ef;if(b!==a){var t=this.fromPort;null!==b&&(this.uf!==b&&mc(b,this,t),Qc(this),this.C(2)),this.ef=a,null!==a&&this.$b(a.isVisible()),this.Wf=null,this.bb();var e=this.diagram;null!==e&&e.aa&&e.partManager.setFromNodeForLink(this,a,b);var n=this.fromPort,o=this.fromPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.aa,e.aa=!0),o(this,t,n),null!==e&&(e.aa=g)}null!==a&&(this.uf!==a&&rp(a,this,n),$c(this),this.C(1)),this.g("fromNode",b,a),Bc(this)}}},fromPortId:{get:function(){return this.ff},set:function(a){var b=this.ff;if(b!==a){var t=this.fromPort;null!==t&&pc(t),Qc(this),this.ff=a;var e=this.fromPort;null!==e&&pc(e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.ri()&&g.xv(o,a)}t!==e&&(this.Wf=null,this.bb(),null!==(o=this.fromPortChanged)&&(g=!0,null!==n&&(g=n.aa,n.aa=!0),o(this,t,e),null!==n&&(n.aa=g))),$c(this),this.g("fromPortId",b,a)}}},fromPort:{get:function(){var a=this.ef;return null===a?null:a.ms(this.ff)}},fromPortChanged:{get:function(){return this.fn},set:function(a){var b=this.fn;b!==a&&(this.fn=a,this.g("fromPortChanged",b,a))}},toNode:{get:function(){return this.uf},set:function(a){var b=this.uf;if(b!==a){var t=this.toPort;null!==b&&(this.ef!==b&&mc(b,this,t),Qc(this),this.C(2)),this.uf=a,null!==a&&this.$b(a.isVisible()),this.Wf=null,this.bb();var e=this.diagram;null!==e&&e.aa&&e.partManager.setToNodeForLink(this,a,b);var n=this.toPort,o=this.toPortChanged;if(null!==o){var g=!0;null!==e&&(g=e.aa,e.aa=!0),o(this,t,n),null!==e&&(e.aa=g)}null!==a&&(this.ef!==a&&rp(a,this,n),$c(this),this.C(1)),this.g("toNode",b,a),Bc(this)}}},toPortId:{get:function(){return this.vf},set:function(a){var b=this.vf;if(b!==a){var t=this.toPort;null!==t&&pc(t),Qc(this),this.vf=a;var e=this.toPort;null!==e&&pc(e);var n=this.diagram;if(null!==n){var o=this.data,g=n.model;null!==o&&g.ri()&&g.Cv(o,a)}t!==e&&(this.Wf=null,this.bb(),null!==(o=this.toPortChanged)&&(g=!0,null!==n&&(g=n.aa,n.aa=!0),o(this,t,e),null!==n&&(n.aa=g))),$c(this),this.g("toPortId",b,a)}}},toPort:{get:function(){var a=this.uf;return null===a?null:a.ms(this.vf)}},toPortChanged:{get:function(){return this.to},set:function(a){var b=this.to;b!==a&&(this.to=a,this.g("toPortChanged",b,a))}},fromSpot:{get:function(){return null!==this.ba?this.ba.Xi:Fe},set:function(a){var b=this.fromSpot;b.D(a)||(a=a.J(),this.Xc(),this.ba.Xi=a,this.g("fromSpot",b,a),(b.$c()||a.$c())&&null!==this.fromNode&&pc(this.fromPort),this.bb())}},fromEndSegmentLength:{get:function(){return null!==this.ba?this.ba.Vi:NaN},set:function(a){var b=this.fromEndSegmentLength;b!==a&&(0>a&&A(a,">= 0",Oc,"fromEndSegmentLength"),this.Xc(),this.ba.Vi=a,this.g("fromEndSegmentLength",b,a),this.bb())}},fromShortLength:{get:function(){return null!==this.ba?this.ba.Wi:NaN},set:function(a){var b=this.fromShortLength;b!==a&&(this.Xc(),this.ba.Wi=a,this.rc(),this.g("fromShortLength",b,a))}},toSpot:{get:function(){return null!==this.ba?this.ba.yj:Fe},set:function(a){var b=this.toSpot;b.D(a)||(a=a.J(),this.Xc(),this.ba.yj=a,this.g("toSpot",b,a),(b.$c()||a.$c())&&null!==this.toNode&&pc(this.toPort),this.bb())}},toEndSegmentLength:{get:function(){return null!==this.ba?this.ba.wj:NaN},set:function(a){var b=this.toEndSegmentLength;b!==a&&(0>a&&A(a,">= 0",Oc,"toEndSegmentLength"),this.Xc(),this.ba.wj=a,this.g("toEndSegmentLength",b,a),this.bb())}},toShortLength:{get:function(){return null!==this.ba?this.ba.xj:NaN},set:function(a){var b=this.toShortLength;b!==a&&(this.Xc(),this.ba.xj=a,this.rc(),this.g("toShortLength",b,a))}},isLabeledLink:{get:function(){return null!==this.wd&&0<this.wd.count}},labelNodes:{get:function(){return null===this.wd?tt:this.wd.iterator}},relinkableFrom:{get:function(){return 0!=(1&this.Qa)},set:function(a){var b=0!=(1&this.Qa);b!==a&&(this.Qa^=1,this.g("relinkableFrom",b,a),this.Xb())}},relinkableTo:{get:function(){return 0!=(2&this.Qa)},set:function(a){var b=0!=(2&this.Qa);b!==a&&(this.Qa^=2,this.g("relinkableTo",b,a),this.Xb())}},resegmentable:{get:function(){return 0!=(4&this.Qa)},set:function(a){var b=0!=(4&this.Qa);b!==a&&(this.Qa^=4,this.g("resegmentable",b,a),this.Xb())}},isTreeLink:{get:function(){return 0!=(8&this.Qa)},set:function(a){var b=0!=(8&this.Qa);b!==a&&(this.Qa^=8,this.g("isTreeLink",b,a),null!==this.fromNode&&yc(this.fromNode),null!==this.toNode&&yc(this.toNode))}},path:{get:function(){var a=this.Qb();return a instanceof Ll?a:null}},routeBounds:{get:function(){this.vg();var a=this.ll,b=1/0,t=1/0,e=this.pointsCount;if(0===e)a.h(NaN,NaN,0,0);else{if(1===e)e=this.i(0),b=Math.min(e.x,b),t=Math.min(e.y,t),a.h(e.x,e.y,0,0);else if(2===e){e=this.i(0);var n=this.i(1);b=Math.min(e.x,n.x),t=Math.min(e.y,n.y),a.h(e.x,e.y,0,0),a.Ye(n)}else if(this.computeCurve()===hf&&3<=e&&!this.isOrthogonal)if(b=(n=this.i(0)).x,t=n.y,a.h(b,t,0,0),3===e){e=this.i(1),b=Math.min(e.x,b),t=Math.min(e.y,t);var o=this.i(2);b=Math.min(o.x,b),t=Math.min(o.y,t),$e.Cl(n.x,n.y,e.x,e.y,e.x,e.y,o.x,o.y,.5,a)}else for(o=3;o<e;o+=3){var g=this.i(o-2);o+3>=e&&(o=e-1);var r=this.i(o-1),h=this.i(o);$e.Cl(n.x,n.y,g.x,g.y,r.x,r.y,h.x,h.y,.5,a),b=Math.min(h.x,b),t=Math.min(h.y,t),n=h}else for(n=this.i(0),o=this.i(1),b=Math.min(n.x,o.x),t=Math.min(n.y,o.y),a.h(n.x,n.y,0,0),a.Ye(o),n=2;n<e;n++)o=this.i(n),b=Math.min(o.x,b),t=Math.min(o.y,t),a.Ye(o);this.ru.h(b-a.x,t-a.y)}return a}},midPoint:{get:function(){return this.vg(),this.computeMidPoint(new St)}},midAngle:{get:function(){return this.vg(),this.computeMidAngle()}},flattenedLengths:{get:function(){if(null===this.bq){this.fd||zc(this);for(var a=this.bq=[],b=this.pointsCount,t=0;t<b-1;t++){var e=this.i(t),n=this.i(t+1);$e.$(e.x,n.x)?0>(e=n.y-e.y)&&(e=-e):$e.$(e.y,n.y)?0>(e=n.x-e.x)&&(e=-e):e=Math.sqrt(e.Bf(n)),a.push(e)}}return this.bq}},flattenedTotalLength:{get:function(){var a=this.ut;if(isNaN(a)){for(var b=this.flattenedLengths,t=b.length,e=a=0;e<t;e++)a+=b[e];this.ut=a}return a}},points:{get:function(){return this.Ob},set:function(a){var b=this.Ob;if(b!==a){var t=null;if(Array.isArray(a)){var e=0==a.length%2;if(e)for(var n=0;n<a.length;n++)if("number"!=typeof a[n]||isNaN(a[n])){e=!1;break}if(e)for(t=new ot,e=0;e<a.length/2;e++)n=new St(a[2*e],a[2*e+1]).freeze(),t.add(n);else{for(e=!0,n=0;n<a.length;n++){var o=a[n];if(!F(o)||"number"!=typeof o.x||isNaN(o.x)||"number"!=typeof o.y||isNaN(o.y)){e=!1;break}}if(e)for(t=new ot,e=0;e<a.length;e++)n=a[e],t.add(new St(n.x,n.y).freeze())}}else if(a instanceof ot)for(t=a.copy(),a=t.iterator;a.next();)a.value.freeze();else T("Link.points value is not an instance of List or Array: "+a);t.freeze(),this.Ob=t,this.rc(),zc(this),null!==(a=this.diagram)&&(a.pi||a.undoManager.isUndoingRedoing||a.zs.add(this),a.animationManager.Ab&&lo(a.animationManager,this,t)),this.g("points",b,t)}}},pointsCount:{get:function(){return this.Ob.count}},fd:{get:function(){return 0!=(16&this.Qa)},set:function(a){0!=(16&this.Qa)!==a&&(this.Qa^=16)}},suspendsRouting:{get:function(){return 0!=(32&this.Qa)},set:function(a){0!=(32&this.Qa)!==a&&(this.Qa^=32)}},computingPoints:{get:function(){return 0!=(64&this.Qa)},set:function(a){0!=(64&this.Qa)!==a&&(this.Qa^=64)}},defaultFromPoint:{get:function(){return this.o},set:function(a){this.o=a.copy()}},defaultToPoint:{get:function(){return this.u},set:function(a){this.u=a.copy()}},isOrthogonal:{get:function(){return 2==(2&this.qj.value)}},isAvoiding:{get:function(){return 4==(4&this.qj.value)}},kk:{get:function(){return 0!=(128&this.Qa)},set:function(a){0!=(128&this.Qa)!==a&&(this.Qa^=128)}},geometry:{get:function(){if(!this.kk){if(this.vg(),2>this.pointsCount)return this.kk=!0,this.ua;this.ua=this.makeGeometry()}return this.ua}},firstPickIndex:{get:function(){return 2>=this.pointsCount?0:this.isOrthogonal||!Vc(this.computeSpot(!0))?1:0}},lastPickIndex:{get:function(){var a=this.pointsCount;return 0===a?0:2>=a?a-1:this.isOrthogonal||!Vc(this.computeSpot(!1))?a-2:a-1}},adjusting:{get:function(){return this.pk},set:function(a){var b=this.pk;b!==a&&(this.pk=a,this.g("adjusting",b,a))}},corner:{get:function(){return this.Nm},set:function(a){var b=this.Nm;b!==a&&(this.Nm=a,this.rc(),this.g("corner",b,a))}},curve:{get:function(){return this.Pm},set:function(a){var b=this.Pm;b!==a&&(this.Pm=a,this.bb(),this.rc(),Zc(this,b===lf||b===uf||a===lf||a===uf),this.g("curve",b,a))}},curviness:{get:function(){return this.Qm},set:function(a){var b=this.Qm;b!==a&&(this.Qm=a,this.bb(),this.rc(),this.g("curviness",b,a))}},routing:{get:function(){return this.qj},set:function(a){var b=this.qj;b!==a&&(this.qj=a,this.Wf=null,this.bb(),Zc(this,2==(2&b.value)||2==(2&a.value)),this.g("routing",b,a))}},smoothness:{get:function(){return this.oo},set:function(a){var b=this.oo;b!==a&&(this.oo=a,this.rc(),this.g("smoothness",b,a))}},key:{get:function(){var a=this.diagram;if(null!==a&&a.model.ri())return a.model.Ac(this.data)}}}),Oc.prototype.invalidateOtherJumpOvers=Oc.prototype.Wo,Oc.prototype.findClosestSegment=Oc.prototype.ez,Oc.prototype.updateRoute=Oc.prototype.vg,Oc.prototype.invalidateRoute=Oc.prototype.bb,Oc.prototype.rollbackRoute=Oc.prototype.rv,Oc.prototype.commitRoute=Oc.prototype.zf,Oc.prototype.startRoute=Oc.prototype.uh,Oc.prototype.clearPoints=Oc.prototype.Ej,Oc.prototype.removePoint=Oc.prototype.pv,Oc.prototype.addPointAt=Oc.prototype.yf,Oc.prototype.addPoint=Oc.prototype.ne,Oc.prototype.insertPointAt=Oc.prototype.m,Oc.prototype.insertPoint=Oc.prototype.Kz,Oc.prototype.setPointAt=Oc.prototype.L,Oc.prototype.setPoint=Oc.prototype.dd,Oc.prototype.getPoint=Oc.prototype.i,Oc.prototype.getOtherPort=Oc.prototype.Cz,Oc.prototype.getOtherNode=Oc.prototype.So;var tf=null,ef=null,nf=new W(Oc,"Normal",1),of=new W(Oc,"Orthogonal",2),rf=new W(Oc,"AvoidsNodes",6),sf=new W(Oc,"AvoidsNodesStraight",7),af=new W(Oc,"None",0),hf=new W(Oc,"Bezier",9),lf=new W(Oc,"JumpGap",10),uf=new W(Oc,"JumpOver",11),cf=new W(Oc,"End",17),ff=new W(Oc,"Scale",18),df=new W(Oc,"Stretch",19),pf=new W(Oc,"OrientAlong",21),gf=new W(Oc,"OrientPlus90",22),mf=new W(Oc,"OrientMinus90",23),yf=new W(Oc,"OrientOpposite",24),vf=new W(Oc,"OrientUpright",25),xf=new W(Oc,"OrientPlus90Upright",26),bf=new W(Oc,"OrientMinus90Upright",27),wf=new W(Oc,"OrientUpright45",28),kf=16,Mf=14,Sf=8;function Pf(a,b,t,e){ht(this),this.Fe=this.pq=!1,this.Cs=a,this.Ox=b,this.cv=t,this.Px=e,this.links=[]}function Nf(a){ht(this),this.Yx=this.group=null,this.us=!0,this.abort=!1,this.Od=this.Nd=1,this.En=this.Dn=-1,this.sc=a.width,this.tc=a.height,this.bc=null,this.ei=this.di=0,this.Ns=11,this.Ix=this.Hx=22}function Cf(a,b,t){return a.Nd<=b&&b<=a.Dn&&a.Od<=t&&t<=a.En}function Tf(a,b,t){return Cf(a,b,t)?(b-=a.Nd,b/=a.sc,t-=a.Od,t/=a.tc,a.bc[0|b][0|t]):Rf}function Lf(a){if(null!==a.bc)for(var b=0;b<=a.di;b++)for(var t=a.bc[b],e=0;e<=a.ei;e++)t[e]>=If&&(t[e]=Rf)}function Af(a,b,t,e,n,o,g,r,h){if(!(b<o||b>g||t<r||t>h)){var l=0|b,c=0|t,f=a.bc[l][c];if(f>=If&&f<zf)for(n?c+=e:l+=e,f+=1;o<=l&&l<=g&&r<=c&&c<=h&&!(f>=a.bc[l][c]);)a.bc[l][c]=f,f+=1,n?c+=e:l+=e;if(l=n?c:l,n)if(0<e)for(t+=e;t<l;t+=e)Af(a,b,t,1,!n,o,g,r,h),Af(a,b,t,-1,!n,o,g,r,h);else for(t+=e;t>l;t+=e)Af(a,b,t,1,!n,o,g,r,h),Af(a,b,t,-1,!n,o,g,r,h);else if(0<e)for(b+=e;b<l;b+=e)Af(a,b,t,1,!n,o,g,r,h),Af(a,b,t,-1,!n,o,g,r,h);else for(b+=e;b>l;b+=e)Af(a,b,t,1,!n,o,g,r,h),Af(a,b,t,-1,!n,o,g,r,h)}}function jf(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=Df,c=If;for(a.bc[b][t]=c;l===Df&&b>o&&b<g&&t>r&&t<h;)c+=1,a.bc[b][t]=c,n?t+=e:b+=e,l=a.bc[b][t]}function Ff(a,b,t,e,n,o,g,r,h){b|=0,t|=0;var l=Df,c=zf;for(a.bc[b][t]=c;l===Df&&b>o&&b<g&&t>r&&t<h;)a.bc[b][t]=c,n?t+=e:b+=e,l=a.bc[b][t]}function Of(a,b,t,e,n,o,g){if(null!==a.bc){a.abort=!1;var r=b.x,h=b.y;if(Cf(a,r,h)){r-=a.Nd,r/=a.sc,h-=a.Od,h/=a.tc;var l=e.x,c=e.y;if(Cf(a,l,c))if(l-=a.Nd,l/=a.sc,c-=a.Od,c/=a.tc,1>=Math.abs(r-l)&&1>=Math.abs(h-c))a.abort=!0;else{var f=o.x;e=o.y,b=o.x+o.width;var p=o.y+o.height;f-=a.Nd,f/=a.sc,e-=a.Od,e/=a.tc,b-=a.Nd,b/=a.sc,p-=a.Od,p/=a.tc,o=Math.max(0,Math.min(a.di,0|f)),b=Math.min(a.di,Math.max(0,0|b)),f=Math.max(0,Math.min(a.ei,0|e)),p=Math.min(a.ei,Math.max(0,0|p)),h|=0,l|=0,c|=0;var q=0===t||90===t?1:-1;if(t=90===t||270===t,(e=a.bc)[r|=0][h]===Df?(jf(a,r,h,q,t,o,b,f,p),jf(a,r,h,1,!t,o,b,f,p),jf(a,r,h,-1,!t,o,b,f,p)):jf(a,r,h,q,t,r,h,r,h),e[l][c]===Df?(Ff(a,l,c,0===n||90===n?1:-1,90===n||270===n,o,b,f,p),Ff(a,l,c,1,!(90===n||270===n),o,b,f,p),Ff(a,l,c,-1,!(90===n||270===n),o,b,f,p)):Ff(a,l,c,q,t,l,c,l,c),t=z(),g&&Bf(a,l,c,n,r,h,t))for(t[0]===l&&t[1]===c||(t.unshift(c),t.unshift(l)),t[t.length-2]===r&&t[t.length-1]===h||(t.push(r),t.push(h)),a=If,n=t[t.length-2],g=t[t.length-1],e[n][g]=a++,o=t.length-4;0<=o;o-=2)for(n=t[o+2],g=t[o+3],b=t[o],l=t[o+1];b>n?n++:b<n?n--:l>g?g++:l<g&&g--,e[n][g]=a++,n!==b||g!==l;);else Af(a,r,h,1,!1,o,b,f,p),Af(a,r,h,-1,!1,o,b,f,p),Af(a,r,h,1,!0,o,b,f,p),Af(a,r,h,-1,!0,o,b,f,p);R(t)}}}}function Bf(a,b,t,e,n,o,g){for(var r=a.bc,h=b,l=t;;){if(h===n&&l===o)return!0;var c=h,f=l;if(0===e){if(!(c<n))break;c++}else if(90===e){if(!(f<o))break;f++}else if(180===e){if(!(c>n))break;c--}else{if(!(f>o))break;f--}var p=r[c][f];if(0===p||p===Ef)break;h=c,l=f}for(;;){if(c=e,f=h,p=l,0===e?p<o?(c=90,p++):p>o&&(c=270,p--):90===e?f<n?(c=0,f++):f>n&&(c=180,f--):180===e?p<o?(c=90,p++):p>o&&(c=270,p--):f<n?(c=0,f++):f>n&&(c=180,f--),f=r[f][p],c!==e&&0!==f&&f!==Ef){if(g.push(h),g.push(l),Bf(a,h,l,c,n,o,g))return!0;g.pop(),g.pop()}if(r[h][l]=Ef,0===e){if(h===b)return!1;h--}else if(90===e){if(l===t)return!1;l--}else if(180===e){if(h===b)return!1;h++}else{if(l===t)return!1;l++}}}Oc.className="Link",Oc.Normal=nf,Oc.Orthogonal=of,Oc.AvoidsNodes=rf,Oc.AvoidsNodesStraight=sf,Oc.None=af,Oc.Bezier=hf,Oc.JumpGap=lf,Oc.JumpOver=uf,Oc.End=cf,Oc.Scale=ff,Oc.Stretch=df,Oc.OrientAlong=pf,Oc.OrientPlus90=gf,Oc.OrientMinus90=mf,Oc.OrientOpposite=yf,Oc.OrientUpright=vf,Oc.OrientPlus90Upright=xf,Oc.OrientMinus90Upright=bf,Oc.OrientUpright45=wf,Oc.EndSegmentStep=8,Oc.CurvinessStart=kf,Oc.SpacingMin=Mf,Oc.OrthoShortCut=Sf,Pf.prototype.Rl=function(){if(!this.pq){var a=this.links;0<a.length&&(null!==(a=a[0].diagram)&&(a.ow.add(this),this.Fe=a.undoManager.isUndoingRedoing))}this.pq=!0},Pf.prototype.Nv=function(){if(this.pq){this.pq=!1;var a=this.links;if(0<a.length){var b=a[0],t=b.diagram;t=null===t||t.pi&&!this.Fe,this.Fe=!1,b.arrangeBundledLinks(a,t),1===a.length&&(b.Sf=null,a.length=0)}0===a.length&&(a=this.Cs,null!==this&&null!==a.af&&a.af.remove(this),a=this.cv,null!==this&&null!==a.af&&a.af.remove(this))}},Pf.className="LinkBundle",Nf.prototype.initialize=function(a){if(!(0>=a.width||0>=a.height)){var b=a.y,t=a.x+a.width,e=a.y+a.height;if(this.Nd=Math.floor((a.x-this.sc)/this.sc)*this.sc,this.Od=Math.floor((b-this.tc)/this.tc)*this.tc,this.Dn=Math.ceil((t+2*this.sc)/this.sc)*this.sc,this.En=Math.ceil((e+2*this.tc)/this.tc)*this.tc,a=1+(0|Math.ceil((this.Dn-this.Nd)/this.sc)),b=1+(0|Math.ceil((this.En-this.Od)/this.tc)),null===this.bc||this.di<a-1||this.ei<b-1){for(t=[],e=0;e<=a;e++)t[e]=new Uint32Array(b);this.bc=t,this.di=a-1,this.ei=b-1}if(a=Rf,null!==this.bc)for(b=0;b<=this.di;b++)if((t=this.bc[b]).fill)t.fill(a);else for(e=0;e<=this.ei;e++)t[e]=a}},Nf.prototype.Xj=function(a,b,t,e){if(a>this.Dn||a+t<this.Nd||b>this.En||b+e<this.Od)return!0;a=(a-this.Nd)/this.sc|0,b=(b-this.Od)/this.tc|0,t=Math.max(0,t)/this.sc+1|0;var n=Math.max(0,e)/this.tc+1|0;if(0>a&&(t+=a,a=0),0>b&&(n+=b,b=0),0>t||0>n)return!0;for(e=0|Math.min(a+t-1,this.di),t=0|Math.min(b+n-1,this.ei);a<=e;a++){n=this.bc[a];for(var o=b;o<=t;o++)if(n[o]===Df)return!1}return!0},v.Object.defineProperties(Nf.prototype,{bounds:{get:function(){return new Ut(this.Nd,this.Od,this.Dn-this.Nd,this.En-this.Od)}},Go:{get:function(){return this.sc},set:function(a){0<a&&a!==this.sc&&(this.sc=a,this.initialize(this.bounds))}},Fo:{get:function(){return this.tc},set:function(a){0<a&&a!==this.tc&&(this.tc=a,this.initialize(this.bounds))}}});var Df=0,If=1,zf=999999,Rf=zf+1,Ef=zf+2;function Vf(){ht(this),this.port=this.node=null,this.pe=[],this.$o=!1}function Yf(a,b,t,e){switch(b=b.offsetY){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}switch(b){case 9:return 180<t?270:90;case 6:return 90<t&&270>=t?180:0}switch(a=180*Math.atan2(a.height,a.width)/Math.PI,b){case 3:return t>a&&t<=180+a?180:270;case 5:return t>180-a&&t<=360-a?270:0;case 12:return t>a&&t<=180+a?90:0;case 10:return t>180-a&&t<=360-a?180:90;case 7:return 90<t&&t<=180+a?180:t>180+a&&t<=360-a?270:0;case 13:return 180<t&&t<=360-a?270:t>a&&180>=t?90:0;case 14:return t>a&&t<=180-a?90:t>180-a&&270>=t?180:0;case 11:return t>180-a&&t<=180+a?180:t>180+a?270:90}return e&&15!==b&&(0>(t-=15)&&(t+=360)),t>a&&t<180-a?90:t>=180-a&&t<=180+a?180:t>180+a&&t<360-a?270:0}function Gf(a,b){var t=a.pe;if(0===t.length){t:if(!a.$o){t=a.$o,a.$o=!0;var e=null,n=a.node,o=n instanceof Cc?n:null;if(null===o||o.isSubGraphExpanded)var g=n.isTreeExpanded?n.findLinksConnected(a.port.portId):n.qx();else{if(!o.actualBounds.w()){a.$o=t;break t}g=(e=o).Lu()}o=a.pe.length=0;var r=a.port.ga(he,St.alloc()),h=a.port.ga(me,St.alloc());for((n=Ut.allocAt(r.x,r.y,0,0)).Ye(h),St.free(r),St.free(h),r=St.allocAt(n.x+n.width/2,n.y+n.height/2),h=a.port.li(),g=g.iterator;g.next();){var l=g.value;if(l.isVisible()&&l.fromPort!==l.toPort){var c=l.fromPort===a.port||null!==l.fromNode&&l.fromNode.Td(e),f=l.computeSpot(c,a.port);if(f.$c()&&null!==(c=c?l.toPort:l.fromPort)){var p=c.part;if(null!==p){var q=p.findVisibleNode();null!==q&&q!==p&&(c=(p=q).port),c=l.computeOtherPoint(p,c),p=r.ab(c),0>(p-=h)?p+=360:360<=p&&(p-=360),0===(f=Yf(n,f,p,l.isOrthogonal))?(f=4,180<p&&(p-=360)):90===f?(f=8,270<p&&(p-=360)):180===f?f=2:(f=1,90>p&&(p+=360)),void 0===(q=a.pe[o])?(q=new Xf(l,p,f),a.pe[o]=q):(q.link=l,q.angle=p,q.Nc=f),q.hv.set(c),o++}}}}for(St.free(r),a.pe.sort(Vf.prototype.j),h=a.pe.length,e=-1,o=r=0;o<h;o++)void 0!==(g=a.pe[o])&&(g.Nc!==e&&(e=g.Nc,r=0),g.To=r,r++);for(e=-1,r=0,o=h-1;0<=o;o--)void 0!==(h=a.pe[o])&&(h.Nc!==e&&(e=h.Nc,r=h.To+1),h.Fl=r);if(o=a.pe,f=a.port,e=a.node.portSpreading,r=St.alloc(),h=St.alloc(),g=St.alloc(),l=St.alloc(),f.ga(he,r),f.ga(ue,h),f.ga(me,g),f.ga(pe,l),q=p=c=f=0,e===Nc)for(var d=0;d<o.length;d++){var u=o[d];if(null!==u){var m=u.link.computeThickness();switch(u.Nc){case 8:p+=m;break;case 2:q+=m;break;case 1:f+=m;break;default:c+=m}}}var y=d=0,v=1,x=u=0;for(m=0;m<o.length;m++){var w=o[m];if(null!==w){if(d!==w.Nc){switch(d=w.Nc){case 8:var k=g;y=l;break;case 2:k=l,y=r;break;case 1:k=r,y=h;break;default:k=h,y=g}switch(u=y.x-k.x,x=y.y-k.y,d){case 8:p>Math.abs(u)?(v=Math.abs(u)/p,p=Math.abs(u)):v=1;break;case 2:q>Math.abs(x)?(v=Math.abs(x)/q,q=Math.abs(x)):v=1;break;case 1:f>Math.abs(u)?(v=Math.abs(u)/f,f=Math.abs(u)):v=1;break;default:c>Math.abs(x)?(v=Math.abs(x)/c,c=Math.abs(x)):v=1}y=0}var M=w.Yo;if(e===Nc){switch(w=w.link.computeThickness(),w*=v,M.set(k),d){case 8:M.x=k.x+u/2+p/2-y-w/2;break;case 2:M.y=k.y+x/2+q/2-y-w/2;break;case 1:M.x=k.x+u/2-f/2+y+w/2;break;default:M.y=k.y+x/2-c/2+y+w/2}y+=w}else{var S=.5;e===Pc&&(S=(w.To+1)/(w.Fl+1)),M.x=k.x+u*S,M.y=k.y+x*S}}}for(St.free(r),St.free(h),St.free(g),St.free(l),k=a.pe,o=0;o<k.length;o++)null!==(e=k[o])&&(e.Ju=a.computeEndSegmentLength(e));a.$o=t,Ut.free(n)}t=a.pe}for(a=0;a<t.length;a++)if(null!==(n=t[a])&&n.link===b)return n;return null}function Xf(a,b,t){this.link=a,this.angle=b,this.Nc=t,this.hv=new St,this.Fl=this.To=0,this.Yo=new St,this.Ju=0}function Uf(a){ht(this),this.o=this.H=null,this.Gh=this.rn=!0,this.xn=!1,this.zm=new St(0,0).freeze(),this.un=!0,this.Dm=this.tn=null,this.wn=!1,this.j=null,a&&Object.assign(this,a)}function qf(a,b,t,e,n,o,g,r){for(t=t.iterator;t.next();){var h=t.value;e&&!h.isTopLevel||null!==n&&!n(h)||!h.canLayout()||(o&&h instanceof uc?h.isLinkLabel||(h instanceof Cc&&null===h.layout?qf(a,b,h.memberParts,!1,n,o,g,r):(Kf(h),b.add(h))):g&&h instanceof Oc?b.add(h):!r||!h.Zc()||h instanceof uc||(Kf(h),b.add(h)))}}function Kf(a){var b=a.actualBounds;(0===b.width||0===b.height||isNaN(b.width)||isNaN(b.height))&&a.Va()}function Hf(a){ht(this),this.Sc=a,this.wf=new at,this.ye=new at,this.Ds=new Mt,this.ys=new Mt}function Wf(a,b){if(null===b)return!1;var t=a.wf.remove(b);return t&&(null!==(b=b.node)&&a.Ds.remove(b)),t}function Jf(a,b){if(null!==b){a.ye.add(b);var t=b.link;null!==t&&null===a.Ko(t)&&a.ys.add(t,b),b.network=a}}function Zf(a,b){null!==b&&a.ye.remove(b)&&(null!==(b=b.link)&&a.ys.remove(b))}function _f(a,b,t){if(null!==t&&t.network!==b){Wf(a,t),b.dh(t);for(var e=t.sourceEdges;e.next();){var n=e.value;n.network!==b&&(Zf(a,n),Jf(b,n),_f(a,b,n.fromVertex))}for(e=t.destinationEdges;e.next();)(t=e.value).network!==b&&(Zf(a,t),Jf(b,t),_f(a,b,t.toVertex))}}function $f(a){ht(this),this.ob=a,this.j=new Ut(0,0,10,10).freeze(),this.o=new St(5,5).freeze(),this.Sh=this.ub=null,this.tg=new ot,this.mg=new ot}function Qf(a,b){return a=a.Sh,b=b.Sh,a?b?(a=a.text)<(b=b.text)?-1:a>b?1:0:1:null!==b?-1:0}function ed(a){ht(this),this.nb=a,this.qd=this.kd=this.Zk=this.ub=null}function id(a){Uf.call(this),this.isViewportSized=!0,this.xo=this.yo=NaN,this.yg=new Vt(NaN,NaN).freeze(),this.tf=new Vt(10,10).freeze(),this.Kb=rd,this.Sb=sd,this.nd=ud,this.hd=nd,a&&Object.assign(this,a)}function nd(a,b){return(a=a.text)<(b=b.text)?-1:a>b?1:0}Nf.className="PositionArray",Vf.prototype.toString=function(){for(var a=this.pe,b=this.node.toString()+" "+a.length.toString()+":",t=0;t<a.length;t++){var e=a[t];null!==e&&(b+="\n  "+e.toString())}return b},Vf.prototype.Rl=function(){this.pe.length=0},Vf.prototype.j=function(a,b){return a===b?0:null===a?-1:null===b?1:a.Nc<b.Nc?-1:a.Nc>b.Nc?1:a.angle<b.angle?-1:a.angle>b.angle?1:0},Vf.prototype.computeEndSegmentLength=function(a){var b=a.link,t=b.computeEndSegmentLength(this.node,this.port,ae,b.fromPort===this.port),e=a.To;if(0>e)return t;var n=a.Fl;if(1>=n||!b.isOrthogonal)return t;b=a.hv;var o=a.Yo;return 2!==a.Nc&&8!==a.Nc||(e=n-1-e),((a=2===a.Nc||4===a.Nc)?b.y<o.y:b.x<o.x)?t+8*e:(a?b.y===o.y:b.x===o.x)?t:t+8*(n-1-e)},Vf.className="Knot",Xf.prototype.toString=function(){return this.link.toString()+" "+this.angle.toString()+" "+this.Nc.toString()+":"+this.To.toString()+"/"+this.Fl.toString()+" "+this.Yo.toString()+" "+this.Ju.toString()+" "+this.hv.toString()},Xf.className="LinkInfo",Uf.prototype.cloneProtected=function(a){a.rn=this.rn,a.Gh=this.Gh,a.xn=this.xn,a.zm.assign(this.zm),a.un=this.un,a.tn=this.tn,a.Dm=this.Dm,a.wn=!0},Uf.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},Uf.prototype.qb=function(){},Uf.prototype.toString=function(){var a=E(this.constructor);return a+="(",null!==this.group&&(a+=" in "+this.group),null!==this.diagram&&(a+=" for "+this.diagram),a+")"},Uf.prototype.C=function(){if(this.isValidLayout){var a=this.diagram;if(null!==a&&!a.undoManager.isUndoingRedoing){var b=a.animationManager;!b.isTicking&&(b.defaultAnimation.isAnimating&&b.Cc(),this.isOngoing&&a.pi||this.isInitial&&!a.pi)&&(this.isValidLayout=!1,a.ac())}}},Uf.prototype.createNetwork=function(){return new Hf(this)},Uf.prototype.makeNetwork=function(a){var b=this.createNetwork();return a instanceof zo?(b.lg(a.nodes,!0),b.lg(a.links,!0)):a instanceof Cc?b.lg(a.memberParts):b.lg(a.iterator),b},Uf.prototype.updateParts=function(){this.isValidLayout=!0;var a=this.diagram;if(null===a&&null!==this.network)for(var b=this.network.vertexes.iterator;b.next();){var t=b.value.node;if(null!==t&&null!==(a=t.diagram))break}try{null!==a&&a.Ea("Layout"),this.commitLayout()}finally{null!==a&&a.eb("Layout")}},Uf.prototype.commitLayout=function(){if(null!==this.network){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();if(this.isRouting)for(a=this.network.edges.iterator;a.next();)a.value.commit()}},Uf.prototype.doLayout=function(a){var b=new at;a instanceof zo?(qf(this,b,a.nodes,!0,this.rh,!0,!1,!0),qf(this,b,a.parts,!0,this.rh,!0,!1,!0)):a instanceof Cc?qf(this,b,a.memberParts,!1,this.rh,!0,!1,!0):b.addAll(a.iterator),0<b.count&&(null!==(a=this.diagram)&&a.Ea("Layout"),this.doMinimalNoNetworkLayout(b),null!==a&&a.eb("Layout")),this.isValidLayout=!0},Uf.prototype.doMinimalNoNetworkLayout=function(a){var b=Math.ceil(Math.sqrt(a.count));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var t=this.arrangementOrigin.x,e=t,n=this.arrangementOrigin.y,o=0,g=0;for(a=a.iterator;a.next();){var r=a.value;Kf(r);var h=r.measuredBounds,l=h.width;h=h.height,r.moveTo(e,n),r instanceof Cc&&(r.rh=!1),e+=Math.max(l,50)+20,g=Math.max(g,Math.max(h,50)),o>=b-1?(o=0,e=t,n+=g+20,g=0):o++}},Uf.prototype.doMinimalNetworkLayout=function(){var a=Math.ceil(Math.sqrt(this.network.vertexes.count));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);for(var b=this.arrangementOrigin.x,t=b,e=this.arrangementOrigin.y,n=0,o=0,g=this.network.vertexes.iterator;g.next();){var r=g.value.node;if(!(null===r||r instanceof Oc)&&(Kf(r),this.rh(r))){var h=r.measuredBounds,l=h.width;h=h.height,r.moveTo(t,e),r instanceof Cc&&(r.rh=!1),t+=Math.max(l,50)+20,o=Math.max(o,Math.max(h,50)),n>=a-1?(n=0,t=b,e+=o+20,o=0):n++}}},Uf.prototype.rh=function(a){return!(a.location.w()&&!(a instanceof Cc&&a.rh))},Uf.prototype.ni=function(a,b){var t=this.boundsComputation;return null!==t?(b||(b=new Ut),t(a,this,b)):b?(b.set(a.actualBounds),b):a.actualBounds},Uf.prototype.ex=function(a){var b=new at;return a instanceof zo?(qf(this,b,a.nodes,!0,null,!0,!0,!0),qf(this,b,a.links,!0,null,!0,!0,!0),qf(this,b,a.parts,!0,null,!0,!0,!0)):qf(this,b,a instanceof Cc?a.memberParts:a.iterator,!1,null,!0,!0,!0),b},Uf.prototype.initialOrigin=function(a){var b=this.group;if(null!==b){var t=b.position.copy();return(isNaN(t.x)||isNaN(t.y))&&t.set(a),null!==(b=b.placeholder)&&(t=b.ga(he),(isNaN(t.x)||isNaN(t.y))&&t.set(a),a=b.padding,t.x+=a.left,t.y+=a.top),t}return a},v.Object.defineProperties(Uf.prototype,{diagram:{get:function(){return this.H},set:function(a){this.H=a}},group:{get:function(){return this.o},set:function(a){this.o!==a&&(this.o=a,null!==a&&(this.H=a.diagram))}},isOngoing:{get:function(){return this.rn},set:function(a){this.rn!==a&&(this.rn=a)}},isInitial:{get:function(){return this.Gh},set:function(a){this.Gh=a,a||(this.wn=!0)}},isViewportSized:{get:function(){return this.xn},set:function(a){this.xn!==a&&(this.xn=a)&&this.C()}},isRouting:{get:function(){return this.un},set:function(a){this.un!==a&&(this.un=a)}},isRealtime:{get:function(){return this.tn},set:function(a){this.tn!==a&&(this.tn=a)}},isValidLayout:{get:function(){return this.wn},set:function(a){this.wn!==a&&(this.wn=a,a||null!==(a=this.diagram)&&(a.xh=!0))}},network:{get:function(){return this.j},set:function(a){this.j!==a&&(this.j=a,null!==a&&(a.layout=this))}},boundsComputation:{get:function(){return this.Dm},set:function(a){this.Dm!==a&&(this.Dm=a,this.C())}},arrangementOrigin:{get:function(){return this.zm},set:function(a){this.zm.D(a)||(this.zm.assign(a),this.C())}}}),Uf.prototype.collectParts=Uf.prototype.ex,Uf.prototype.getLayoutBounds=Uf.prototype.ni,Uf.prototype.invalidateLayout=Uf.prototype.C,Uf.className="Layout",Hf.prototype.clear=function(){if(this.wf)for(var a=this.wf.iterator;a.next();)a.value.clear();if(this.ye)for(a=this.ye.iterator;a.next();)a.value.clear();this.wf=new at,this.ye=new at,this.Ds=new Mt,this.ys=new Mt},Hf.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(0>=a)return b;if(b+=" vertexes: "+this.wf.count+" edges: "+this.ye.count,1<a){for(var t=this.wf.iterator;t.next();)b+="\n    "+t.value.toString(a-1);for(t=this.ye.iterator;t.next();)b+="\n    "+t.value.toString(a-1)}return b},Hf.prototype.createVertex=function(){return new $f(this)},Hf.prototype.createEdge=function(){return new ed(this)},Hf.prototype.lg=function(a,b,t){if(null!==a){for(void 0===b&&(b=!1),void 0===t&&(t=null),null===t&&(t=function(a){if(a instanceof uc)return!a.isLinkLabel;if(a instanceof Oc){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&(null!==(a=a.toNode)&&!a.isLinkLabel)}return!1}),a=a.iterator;a.next();){var e=a.value;if(e instanceof uc&&(!b||e.isTopLevel)&&e.canLayout()&&t(e))if(e instanceof Cc&&null===e.layout)this.lg(e.memberParts,!1);else if(null===this.ki(e)){var n=this.createVertex();n.node=e,this.dh(n)}}for(a.reset();a.next();)if((e=a.value)instanceof Oc&&(!b||e.isTopLevel)&&e.canLayout()&&t(e)&&null===this.Ko(e)){var o=e.fromNode;n=e.toNode,null!==o&&null!==n&&o!==n&&(o=this.findGroupVertex(o),n=this.findGroupVertex(n),null!==o&&null!==n&&this.Yj(o,n,e))}}},Hf.prototype.findGroupVertex=function(a){if(null===a)return null;var b=a.findVisibleNode();if(null===b)return null;if(null!==(a=this.ki(b)))return a;for(b=b.containingGroup;null!==b;){if(null!==(a=this.ki(b)))return a;b=b.containingGroup}return null},(e=Hf.prototype).dh=function(a){if(null!==a){this.wf.add(a);var b=a.node;null!==b&&this.Ds.add(b,a),a.network=this}},e.Al=function(a){if(null===a)return null;var b=this.ki(a);return null===b&&((b=this.createVertex()).node=a,this.dh(b)),b},e.Iu=function(a){if(null!==a&&Wf(this,a)){for(var b=a.tg,t=b.count-1;0<=t;t--){var e=b.M(t);this.Lj(e)}for(a=(b=a.mg).count-1;0<=a;a--)t=b.M(a),this.Lj(t)}},e.Zy=function(a){null!==a&&(null!==(a=this.ki(a))&&this.Iu(a))},e.ki=function(a){return null===a?null:this.Ds.I(a)},e.Ao=function(a){if(null!==a){Jf(this,a);var b=a.toVertex;null!==b&&b.Bl(a),null!==(b=a.fromVertex)&&b.yl(a)}},e.Dy=function(a){if(null===a)return null;var b=a.fromNode,t=a.toNode,e=this.Ko(a);return null===e?((e=this.createEdge()).link=a,null!==b&&(e.fromVertex=this.Al(b)),null!==t&&(e.toVertex=this.Al(t)),this.Ao(e)):(e.fromVertex=null!==b?this.Al(b):null,e.toVertex=null!==t?this.Al(t):null),e},e.Lj=function(a){if(null!==a){var b=a.toVertex;null!==b&&b.Jl(a),null!==(b=a.fromVertex)&&b.Il(a),Zf(this,a)}},e.Yy=function(a){null!==a&&(null!==(a=this.Ko(a))&&this.Lj(a))},e.Ko=function(a){return null===a?null:this.ys.I(a)},e.Yj=function(a,b,t){if(null===a||null===b)return null;if(a.network===this&&b.network===this){var e=this.createEdge();return e.link=t,e.fromVertex=a,e.toVertex=b,this.Ao(e),e}return null},e.fm=function(a){if(null!==a){var b=a.fromVertex,t=a.toVertex;null!==b&&null!==t&&(b.Il(a),t.Jl(a),a.fm(),b.Bl(a),t.yl(a))}},e.Jo=function(){for(var a=z(),b=this.ye.iterator;b.next();){var t=b.value;t.fromVertex===t.toVertex&&a.push(t)}for(b=a.length,t=0;t<b;t++)this.Lj(a[t]);R(a)},Hf.prototype.deleteArtificialVertexes=function(){for(var a=z(),b=this.wf.iterator;b.next();){var t=b.value;null===t.node&&null===t.data&&a.push(t)}for(t=a.length,b=0;b<t;b++)this.Iu(a[b]);for(b=z(),t=this.ye.iterator;t.next();){var e=t.value;null===e.link&&null===e.data&&b.push(e)}for(t=b.length,e=0;e<t;e++)this.Lj(b[e]);R(a),R(b)},Hf.prototype.Zx=function(a){void 0===a&&(a=!0),a&&(this.deleteArtificialVertexes(),function(a){for(var b=z(),t=a.ye.iterator;t.next();){var e=t.value;null!==e.fromVertex&&null!==e.toVertex||b.push(e)}for(t=b.length,e=0;e<t;e++)a.Lj(b[e]);R(b)}(this),this.Jo()),a=new ot;for(var b=!0;b;){b=!1;for(var t=this.wf.iterator;t.next();){var e=t.value;if(0<e.tg.count||0<e.mg.count){b=this.layout.createNetwork(),a.add(b),_f(this,b,e),b=!0;break}}}return a.sort((function(a,b){return null===a||null===b||a===b?0:b.vertexes.count-a.vertexes.count})),a},Hf.prototype.dz=function(){for(var a=new at,b=this.wf.iterator;b.next();)a.add(b.value.node);for(b=this.ye.iterator;b.next();)a.add(b.value.link);return a},v.Object.defineProperties(Hf.prototype,{layout:{get:function(){return this.Sc},set:function(a){null!==a&&(this.Sc=a)}},vertexes:{get:function(){return this.wf}},edges:{get:function(){return this.ye}}}),Hf.prototype.findAllParts=Hf.prototype.dz,Hf.prototype.splitIntoSubNetworks=Hf.prototype.Zx,Hf.prototype.deleteSelfEdges=Hf.prototype.Jo,Hf.prototype.reverseEdge=Hf.prototype.fm,Hf.prototype.linkVertexes=Hf.prototype.Yj,Hf.prototype.findEdge=Hf.prototype.Ko,Hf.prototype.deleteLink=Hf.prototype.Yy,Hf.prototype.deleteEdge=Hf.prototype.Lj,Hf.prototype.addLink=Hf.prototype.Dy,Hf.prototype.addEdge=Hf.prototype.Ao,Hf.prototype.findVertex=Hf.prototype.ki,Hf.prototype.deleteNode=Hf.prototype.Zy,Hf.prototype.deleteVertex=Hf.prototype.Iu,Hf.prototype.addNode=Hf.prototype.Al,Hf.prototype.addVertex=Hf.prototype.dh,Hf.prototype.addParts=Hf.prototype.lg,Hf.className="LayoutNetwork",$f.prototype.clear=function(){this.Sh=this.ub=null,this.tg=new ot,this.mg=new ot},$f.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutVertex#"+ut(this);if(0<a&&(b+=null!==this.node?"("+this.node.toString()+")":"",1<a)){a="";for(var t=!0,e=this.tg.iterator;e.next();){var n=e.value;t?t=!1:a+=",",a+=n.toString(0)}for(n="",t=!0,e=this.mg.iterator;e.next();){t?t=!1:n+=",",n+=e.value.toString(0)}b+=" sources: "+a+" destinations: "+n}return b},$f.prototype.commit=function(){var a=this.ub;if(null!==a){var b=this.bounds,t=a.bounds;F(t)?(t.x=b.x,t.y=b.y,t.width=b.width,t.height=b.height):a.bounds=b.copy()}else if(null!==(a=this.node)){if(b=this.bounds,!(a instanceof Cc)){t=Ut.alloc(),a.Va();var e=this.network.layout.ni(a,t),n=a.locationObject.ga(fe);if(e.w()&&n.w())return a.moveTo(b.x+this.focusX-(n.x-e.x),b.y+this.focusY-(n.y-e.y)),void Ut.free(t);Ut.free(t)}a.moveTo(b.x,b.y)}},$f.prototype.Bl=function(a){null!==a&&(this.tg.contains(a)||this.tg.add(a))},$f.prototype.Jl=function(a){null!==a&&this.tg.remove(a)},$f.prototype.yl=function(a){null!==a&&(this.mg.contains(a)||this.mg.add(a))},$f.prototype.Il=function(a){null!==a&&this.mg.remove(a)},v.Object.defineProperties($f.prototype,{sourceEdgesArrayAccess:{get:function(){return this.tg._dataArray}},destinationEdgesArrayAccess:{get:function(){return this.mg._dataArray}},data:{get:function(){return this.ub},set:function(a){if(this.ub=a,null!==a&&a.bounds){var b=a.bounds;a=b.x;var t=b.y,e=b.width;b=b.height,this.o.h(e/2,b/2),this.j.h(a,t,e,b)}}},node:{get:function(){return this.Sh},set:function(a){if(this.Sh!==a){this.Sh=a,a.Va();var b=this.network.layout,t=Ut.alloc(),e=b.ni(a,t);b=e.x;var n=e.y,o=e.width;if(e=e.height,isNaN(b)&&(b=0),isNaN(n)&&(n=0),this.j.h(b,n,o,e),Ut.free(t),!(a instanceof Cc)&&(a=a.locationObject.ga(fe)).w())return void this.o.h(a.x-b,a.y-n);this.o.h(o/2,e/2)}}},bounds:{get:function(){return this.j},set:function(a){this.j.D(a)||this.j.assign(a)}},focus:{get:function(){return this.o},set:function(a){this.o.D(a)||this.o.assign(a)}},centerX:{get:function(){return this.j.x+this.o.x},set:function(a){var b=this.j;b.x+this.o.x!==a&&(b.ka(),b.x=a-this.o.x,b.freeze())}},centerY:{get:function(){return this.j.y+this.o.y},set:function(a){var b=this.j;b.y+this.o.y!==a&&(b.ka(),b.y=a-this.o.y,b.freeze())}},focusX:{get:function(){return this.o.x},set:function(a){var b=this.o;b.x!==a&&(b.ka(),b.x=a,b.freeze())}},focusY:{get:function(){return this.o.y},set:function(a){var b=this.o;b.y!==a&&(b.ka(),b.y=a,b.freeze())}},x:{get:function(){return this.j.x},set:function(a){var b=this.j;b.x!==a&&(b.ka(),b.x=a,b.freeze())}},y:{get:function(){return this.j.y},set:function(a){var b=this.j;b.y!==a&&(b.ka(),b.y=a,b.freeze())}},width:{get:function(){return this.j.width},set:function(a){var b=this.j;b.width!==a&&(b.ka(),b.width=a,b.freeze())}},height:{get:function(){return this.j.height},set:function(a){var b=this.j;b.height!==a&&(b.ka(),b.height=a,b.freeze())}},network:{get:function(){return this.ob},set:function(a){this.ob=a}},sourceVertexes:{get:function(){for(var a=new at,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);return a.iterator}},destinationVertexes:{get:function(){for(var a=new at,b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},vertexes:{get:function(){for(var a=new at,b=this.sourceEdges;b.next();)a.add(b.value.fromVertex);for(b=this.destinationEdges;b.next();)a.add(b.value.toVertex);return a.iterator}},sourceEdges:{get:function(){return this.tg.iterator}},destinationEdges:{get:function(){return this.mg.iterator}},edges:{get:function(){for(var a=new ot,b=this.sourceEdges;b.next();)a.add(b.value);for(b=this.destinationEdges;b.next();)a.add(b.value);return a.iterator}},edgesCount:{get:function(){return this.tg.count+this.mg.count}}}),$f.prototype.deleteDestinationEdge=$f.prototype.Il,$f.prototype.addDestinationEdge=$f.prototype.yl,$f.prototype.deleteSourceEdge=$f.prototype.Jl,$f.prototype.addSourceEdge=$f.prototype.Bl,$f.className="LayoutVertex",$f.standardComparer=Qf,$f.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.Sh;var t=b.Sh;if(null!==a){if(null!==t){for(b=a.text.toLocaleLowerCase().split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),a=t.text.toLocaleLowerCase().split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),t=0;t<b.length;t++)if(""!==a[t]&&void 0!==a[t]){var e=parseFloat(b[t]),n=parseFloat(a[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==b[t].localeCompare(a[t]))return b[t].localeCompare(a[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==b[t])return 1;return""!==a[t]&&void 0!==a[t]?-1:0}return 1}return null!==t?-1:0}return 1}return null!==b?-1:0},ed.prototype.clear=function(){this.qd=this.kd=this.Zk=this.ub=null},ed.prototype.toString=function(a){void 0===a&&(a=0);var b="LayoutEdge#"+ut(this);return 0<a&&(b+=null!==this.Zk?"("+this.Zk.toString()+")":"",1<a&&(b+=" "+(this.kd?this.kd.toString():"null")+" --\x3e "+(this.qd?this.qd.toString():"null"))),b},ed.prototype.fm=function(){var a=this.kd;this.kd=this.qd,this.qd=a},ed.prototype.commit=function(){},ed.prototype.Ax=function(a){return this.qd===a?this.kd:this.kd===a?this.qd:null},v.Object.defineProperties(ed.prototype,{network:{get:function(){return this.nb},set:function(a){this.nb=a}},data:{get:function(){return this.ub},set:function(a){this.ub!==a&&(this.ub=a)}},link:{get:function(){return this.Zk},set:function(a){this.Zk!==a&&(this.Zk=a)}},fromVertex:{get:function(){return this.kd},set:function(a){this.kd!==a&&(this.kd=a)}},toVertex:{get:function(){return this.qd},set:function(a){this.qd!==a&&(this.qd=a)}}}),ed.prototype.getOtherVertex=ed.prototype.Ax,ed.className="LayoutEdge",y(id,Uf),id.prototype.cloneProtected=function(a){Uf.prototype.cloneProtected.call(this,a),a.yo=this.yo,a.xo=this.xo,a.yg.assign(this.yg),a.tf.assign(this.tf),a.Kb=this.Kb,a.Sb=this.Sb,a.nd=this.nd,a.hd=this.hd},id.prototype.qb=function(a){a.classType===id?a===ud||a===cd||a===hd||a===ld?this.sorting=a:a===sd||a===ad?this.arrangement=a:a===rd||a===od?this.alignment=a:T("Unknown enum value: "+a):Uf.prototype.qb.call(this,a)},id.prototype.doLayout=function(a){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);var b=this.ex(a);a=this.diagram;for(var t=b.copy().iterator;t.next();){var e=t.value;if(!e.ph()||null===e.fromNode&&null===e.toNode){if(e.Va(),e instanceof Cc)for(e=e.memberParts;e.next();)b.remove(e.value)}else b.remove(e)}var n=b.Fa();if(0!==n.length){switch(this.sorting){case ld:n.reverse();break;case ud:n.sort(this.comparer);break;case cd:n.sort(this.comparer),n.reverse()}var o=this.wrappingColumn;isNaN(o)&&(o=0);var g=this.wrappingWidth;switch(isNaN(g)&&null!==a?(b=a.padding,g=Math.max(a.viewportBounds.width-b.left-b.right,0)):g=Math.max(this.wrappingWidth,0),0>=o&&0>=g&&(o=1),b=this.spacing.width,isFinite(b)||(b=0),t=this.spacing.height,isFinite(t)||(t=0),null!==a&&a.Ea("Layout"),e=[],this.alignment){case od:var r=b,h=t,l=Ut.alloc(),c=Math.max(this.cellSize.width,1);if(!isFinite(c))for(var f=c=0;f<n.length;f++){var p=this.ni(n[f],l);c=Math.max(c,p.width)}if(c=Math.max(c+r,1),f=Math.max(this.cellSize.height,1),!isFinite(f))for(p=f=0;p<n.length;p++){var q=this.ni(n[p],l);f=Math.max(f,q.height)}f=Math.max(f+h,1),p=this.arrangement;for(var d=q=this.arrangementOrigin.x,u=this.arrangementOrigin.y,m=0,y=0,v=0;v<n.length;v++){var x=n[v],w=this.ni(x,l),k=Math.ceil((w.width+r)/c)*c,M=Math.ceil((w.height+h)/f)*f;if(p===ad)var S=Math.abs(d-w.width);else S=d+w.width;if((0<o&&m>o-1||0<g&&0<m&&S-q>g)&&(e.push(new Ut(0,u,g+r,y)),m=0,d=q,u+=y,y=0),y=Math.max(y,M),p===ad)w=-w.width;else w=0;if(x.moveTo(d+w,u),p===ad)d-=k;else d+=k;m++}e.push(new Ut(0,u,g+r,y)),Ut.free(l);break;case rd:for(h=g,c=o,f=b,p=t,g=Ut.alloc(),q=Math.max(this.cellSize.width,1),o=u=l=0,r=St.alloc(),d=0;d<n.length;d++)y=n[d],m=this.ni(y,g),y=Gu(y,y.locationObject,y.locationSpot,r),l=Math.max(l,y.x),u=Math.max(u,m.width-y.x),o=Math.max(o,y.y);if((d=this.arrangement)===ad)l+=f;else u+=f;q=isFinite(q)?Math.max(q+f,1):Math.max(l+u,1);var P=y=this.arrangementOrigin.x;for(v=this.arrangementOrigin.y,u=0,h>=l&&(h-=l),l=x=0,k=Math.max(this.cellSize.height,1),w=o=0,M=!0,m=St.alloc(),S=0;S<n.length;S++){var N=n[S],C=this.ni(N,g),T=Gu(N,N.locationObject,N.locationSpot,r);if(0<u)if(d===ad)P=(P-y-(C.width-T.x))/q,P=(P=$e.$(Math.round(P),P)?Math.round(P):Math.floor(P))*q+y;else P=(P-y+T.x)/q,P=(P=$e.$(Math.round(P),P)?Math.round(P):Math.ceil(P))*q+y;else if(d===ad)x=P+T.x+C.width;else x=P-T.x;if(d===ad)var L=-(P+T.x)+x;else L=P+C.width-T.x-x;if(0<c&&u>c-1||0<h&&0<u&&L>h){for(e.push(new Ut(0,M?v-o:v,h+f,w+o+p)),P=0;P<u&&S!==u;P++){var A=Gu(L=n[S-u+P],L.locationObject,L.locationSpot,m);L.moveTo(L.position.x,L.position.y+o-A.y)}w+=p,v=M?v+w:v+(w+o),u=w=o=0,P=y,M=!1}if(P===y&&(l=d===ad?Math.max(l,C.width-T.x):Math.min(l,-T.x)),o=Math.max(o,T.y),w=Math.max(w,C.height-T.y),isFinite(k)&&(w=Math.max(w,Math.max(C.height,k)-T.y)),M?N.moveTo(P-T.x,v-T.y):N.moveTo(P-T.x,v),d===ad)P-=T.x+f;else P+=C.width-T.x+f;u++}if(e.push(new Ut(0,v,h+f,(M?w:w+o)+p)),n.length!==u)for(h=0;h<u;h++)f=Gu(c=n[n.length-u+h],c.locationObject,c.locationSpot,r),c.moveTo(c.position.x,c.position.y+o-f.y);if(St.free(r),St.free(m),d===ad)for(n=0;n<e.length;n++)(o=e[n]).width+=l,o.x-=l;else for(n=0;n<e.length;n++)(o=e[n]).x>l&&(o.width+=o.x-l,o.x=l);Ut.free(g)}for(r=o=g=n=0;r<e.length;r++)h=e[r],n=Math.min(n,h.x),g=Math.min(g,h.y),o=Math.max(o,h.x+h.width);this.arrangement===ad?this.commitLayers(e,new St(n+b/2-(o+n),g-t/2)):this.commitLayers(e,new St(n-b/2,g-t/2)),null!==a&&a.eb("Layout"),this.isValidLayout=!0}},id.prototype.commitLayers=function(){},v.Object.defineProperties(id.prototype,{wrappingWidth:{get:function(){return this.yo},set:function(a){this.yo!==a&&(0<a||isNaN(a))&&(this.yo=a,this.isViewportSized=isNaN(a),this.C())}},wrappingColumn:{get:function(){return this.xo},set:function(a){this.xo!==a&&(0<a||isNaN(a))&&(this.xo=a,this.C())}},cellSize:{get:function(){return this.yg},set:function(a){this.yg.D(a)||(this.yg.assign(a),this.C())}},spacing:{get:function(){return this.tf},set:function(a){this.tf.D(a)||(this.tf.assign(a),this.C())}},alignment:{get:function(){return this.Kb},set:function(a){this.Kb===a||a!==rd&&a!==od||(this.Kb=a,this.C())}},arrangement:{get:function(){return this.Sb},set:function(a){this.Sb===a||a!==sd&&a!==ad||(this.Sb=a,this.C())}},sorting:{get:function(){return this.nd},set:function(a){this.nd===a||a!==hd&&a!==ld&&a!==ud&&a!==cd||(this.nd=a,this.C())}},comparer:{get:function(){return this.hd},set:function(a){this.hd!==a&&(this.hd=a,this.C())}}});var od=new W(id,"Position",0),rd=new W(id,"Location",1),sd=new W(id,"LeftToRight",2),ad=new W(id,"RightToLeft",3),hd=new W(id,"Forward",4),ld=new W(id,"Reverse",5),ud=new W(id,"Ascending",6),cd=new W(id,"Descending",7);function fd(){this.Nn=new at,this.Cn=new at,this.Pa=new at,this.cf=new Mt,this.bf=new Mt,this.aj=new Mt,this.H=null,this.sp=!1}function pd(a,b,t){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.cf.contains(b)){void 0===t&&(t=!0);t:{if(null!=b&&!a.H.undoManager.isUndoingRedoing&&!a.cf.contains(b)){var e=a.Qo(b),n=gd(a,b,e);if(null!==n&&(al(n),null!==(n=n.copy()))){var o=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,n.Tf=e,n.ub=b,a.sp&&(n.Jg="Tool"),a.diagram.add(n),n.ub=null,n.data=b,a.diagram.skipsModelSourceBindings=o,e=n;break t}}e=null}null!==e&&t&&a.resolveReferencesForData(b)}}function gd(a,b,t){var e=(a=a.H).model;return e.Wj()&&e.Yu(b)?null===(b=a.groupTemplateMap.I(t))&&(null===(b=a.groupTemplateMap.I(""))&&(kd||(kd=!0,j('No Group template found for category "'+t+'"'),j("  Using default group template")),b=a.ly)):null===(b=a.nodeTemplateMap.I(t))&&(null===(b=a.nodeTemplateMap.I(""))&&(wd||(wd=!0,j('No Node template found for category "'+t+'"'),j("  Using default node template")),b=a.ny)),b}function md(a,b,t){for(var e in t){var n=b[e],o=t[e];if(O(o)){if(!O(n)||n.length<o.length)return!1;for(var g=0;g<n.length;g++){var r=o[g];if(void 0!==r&&!yd(a,n[g],r))return!1}}else if(!yd(a,n,o))return!1}return!0}function yd(a,b,t){if("function"==typeof t){if(!t(b))return!1}else if(t instanceof RegExp){if(!b||!t.test(b.toString()))return!1}else if(F(b)&&F(t)){if(!md(a,b,t))return!1}else if(b!==t)return!1;return!0}function vd(a,b){var t=b.Hh;if(O(t)){var e=a.aj.I(t);if(null===e)(e=[]).push(b),a.aj.add(t,e);else{for(a=0;a<e.length;a++)if(e[a]===b)return;e.push(b)}}}function xd(a,b,t){Kh(b,(function(a){for(var b=(a=a.O.s).length,e=0;e<b;e++)Or(t,a[e])}));var e=b.Hh;if(O(e)){var n=a.aj.I(e);if(null!==n)for(var o=0;o<n.length;o++)if(n[o]===b){n.splice(o,1),0===n.length&&a.aj.remove(e);break}}}function bd(a,b,t,e,n){if(null===b||n&&!b.canCopy())return null;if(e.contains(b))return e.I(b);var o=a.copyPartData(b,t);if(!(o instanceof zu))return null;if(o.isSelected=!1,o.isHighlighted=!1,e.add(b,o),b instanceof uc){for(var g=b.linksConnected;g.next();){var r=g.value;if(r.fromNode===b){var h=e.I(r);null!==h&&(h.fromNode=o)}r.toNode===b&&(null!==(r=e.I(r))&&(r.toNode=o))}if(b instanceof Cc&&o instanceof Cc)for(b=b.memberParts;b.next();)(g=bd(a,b.value,t,e,n))instanceof Oc||null===g||(g.containingGroup=o)}else if(b instanceof Oc&&o instanceof Oc)for(null!==(g=b.fromNode)&&(null!==(g=e.I(g))&&(o.fromNode=g)),null!==(g=b.toNode)&&(null!==(g=e.I(g))&&(o.toNode=g)),b=b.labelNodes;b.next();)null!==(g=bd(a,b.value,t,e,n))&&g instanceof uc&&(g.labeledLink=o);return o}id.className="GridLayout",id.standardComparer=nd,id.smartComparer=function(a,b){if(null!==a){if(null!==b){a=a.text.toLocaleLowerCase().split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),b=b.text.toLocaleLowerCase().split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);for(var t=0;t<a.length;t++)if(""!==b[t]&&void 0!==b[t]){var e=parseFloat(a[t]),n=parseFloat(b[t]);if(isNaN(e)){if(!isNaN(n))return 1;if(0!==a[t].localeCompare(b[t]))return a[t].localeCompare(b[t])}else{if(isNaN(n))return-1;if(0!=e-n)return e-n}}else if(""!==a[t])return 1;return""!==b[t]&&void 0!==b[t]?-1:0}return 1}return null!==b?-1:0},id.Position=od,id.Location=rd,id.LeftToRight=sd,id.RightToLeft=ad,id.Forward=hd,id.Reverse=ld,id.Ascending=ud,id.Descending=cd,(e=fd.prototype).clear=function(){this.Nn.clear(),this.Cn.clear(),this.Pa.clear(),this.cf.clear(),this.bf.clear(),this.aj.clear()},e.Xe=function(a){this.H=a},e.oi=function(a){if(a instanceof uc){if(this.Nn.add(a),a instanceof Cc){var b=a.containingGroup;null===b?this.H.ai.add(a):b.fl.add(a),null!==(b=a.layout)&&(b.diagram=this.H)}}else a instanceof Oc?this.Cn.add(a):a instanceof hc||this.Pa.add(a);null===(b=a.data)||a instanceof hc||(a instanceof Oc?this.bf.add(b,a):this.cf.add(b,a))},e.qc=function(a){if(a.Dj(),a instanceof uc){if(this.Nn.remove(a),a instanceof Cc){var b=a.containingGroup;null===b?this.H.ai.remove(a):b.fl.remove(a),null!==(b=a.layout)&&(b.diagram=null)}}else a instanceof Oc?this.Cn.remove(a):a instanceof hc||this.Pa.remove(a);null===(b=a.data)||a instanceof hc||(a instanceof Oc?this.bf.remove(b):this.cf.remove(b))},e.Wd=function(){var a=this.H;if(null!==a){for(var b=a.nodeTemplateMap.iterator;b.next();){var t=b.value,e=b.key;(!t.Zc()||t instanceof Cc)&&T('Invalid node template in Diagram.nodeTemplateMap: template for "'+e+'" must be a Node or a simple Part, not a Group or Link: '+t)}for(b=a.groupTemplateMap.iterator;b.next();)t=b.value,e=b.key,t instanceof Cc||T('Invalid group template in Diagram.groupTemplateMap: template for "'+e+'" must be a Group, not a normal Node or Link: '+t);for(b=a.linkTemplateMap.iterator;b.next();)t=b.value,e=b.key,t instanceof Oc||T('Invalid link template in Diagram.linkTemplateMap: template for "'+e+'" must be a Link, not a normal Node or simple Part: '+t);for(b=z(),t=a.selection.iterator;t.next();)(e=t.value.data)&&b.push(e);for(t=z(),a=a.highlighteds.iterator;a.next();)(e=a.value.data)&&t.push(e);for(a=z(),e=this.nodes.iterator;e.next();){var n=e.value;null!==n.data&&(a.push(n.data),a.push(n.location))}for(e=this.links.iterator;e.next();)null!==(n=e.value).data&&(a.push(n.data),a.push(n.location));for(e=this.parts.iterator;e.next();)null!==(n=e.value).data&&(a.push(n.data),a.push(n.location));for(this.removeAllModeledParts(),this.addAllModeledParts(),e=0;e<b.length;e++)null!==(n=this.Lc(b[e]))&&(n.isSelected=!0);for(e=0;e<t.length;e++)null!==(n=this.Lc(t[e]))&&(n.isHighlighted=!0);for(e=0;e<a.length;e+=2)null!==(n=this.Lc(a[e]))&&(n.location=a[e+1]);R(b),R(t),R(a)}},fd.prototype.addAllModeledParts=function(){this.addModeledParts(this.diagram.model.nodeDataArray)},fd.prototype.addModeledParts=function(a,b){var t=this,e=this.diagram.model;a.forEach((function(a){e.lb(a)&&pd(t,a,!1)})),a.forEach((function(a){e.lb(a)&&t.resolveReferencesForData(a)})),!1!==b&&Ir(this.diagram,!1)},fd.prototype.insertLink=function(){return null},fd.prototype.resolveReferencesForData=function(){},fd.prototype.Qo=function(a){return this.H.model.Qo(a)},fd.prototype.getLinkCategoryForData=function(){return""},fd.prototype.setLinkCategoryForData=function(){},fd.prototype.setFromNodeForLink=function(){},fd.prototype.setToNodeForLink=function(){},fd.prototype.findLinkTemplateForCategory=function(a){var b=this.H,t=b.linkTemplateMap.I(a);return null===t&&(null===(t=b.linkTemplateMap.I(""))&&(Md||(Md=!0,j('No Link template found for category "'+a+'"'),j("  Using default link template")),t=b.my)),t},fd.prototype.removeAllModeledParts=function(){this.Fs(this.diagram.model.nodeDataArray)},fd.prototype.Fs=function(a){var b=this;a.forEach((function(a){b.hp(a)}))},fd.prototype.hp=function(a){null!==(a=this.Lc(a))&&(vr(this.diagram,a,!1),this.unresolveReferencesForPart(a))},fd.prototype.unresolveReferencesForPart=function(){},fd.prototype.removeDataForLink=function(){},fd.prototype.findPartForKey=function(a){return null==a?null:null!==(a=this.H.model.ic(a))?this.cf.I(a):null},fd.prototype.Wb=function(a){return null==a||null===(a=this.H.model.ic(a))?null:(a=this.cf.I(a))instanceof uc?a:null},fd.prototype.findLinkForKey=function(){return null},(e=fd.prototype).Lc=function(a){if(null===a)return null;var b=this.cf.I(a);return null!==b?b:b=this.bf.I(a)},e.ii=function(a){return null===a?null:(a=this.cf.I(a))instanceof uc?a:null},e.Kc=function(a){return null===a?null:this.bf.I(a)},e.ls=function(a){for(var b=0;b<arguments.length;++b);b=new at;for(var t=this.Nn.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(F(g)&&md(this,n,g)){b.add(e);break}}}return b.iterator},e.ks=function(a){for(var b=0;b<arguments.length;++b);b=new at;for(var t=this.Cn.iterator;t.next();){var e=t.value,n=e.data;if(null!==n)for(var o=0;o<arguments.length;o++){var g=arguments[o];if(F(g)&&md(this,n,g)){b.add(e);break}}}return b.iterator},fd.prototype.doModelChanged=function(a){if(this.H){var b=this.H;if(a.model===b.model){var t=a.change;if(b.doModelChanged(a),b.aa){b.aa=!1;try{var e=a.modelChange;if(""!==e)if(t===ki){if("nodeCategory"===e){var n=this.Lc(a.object),o=a.newValue;null!==n&&"string"==typeof o&&(n.category=o)}else"nodeDataArray"===e&&(this.Fs(a.oldValue),this.addModeledParts(a.newValue));b.isModified=!0}else if(t===Mi){var g=a.newValue;"nodeDataArray"===e&&F(g)&&pd(this,g),b.isModified=!0}else if(t===Si){var r=a.oldValue;"nodeDataArray"===e&&F(r)&&this.hp(r),b.isModified=!0}else t===wi&&("SourceChanged"===e?null!==a.object?this.updateDataBindings(a.object,a.propertyName):(this.qp(),this.updateAllTargetBindings()):"ModelDisplaced"===e&&this.Wd());else if(t===ki){var h=a.propertyName,l=a.object;l===b.model?"nodeKeyProperty"!==h&&"nodeCategoryProperty"!==h||b.undoManager.isUndoingRedoing||this.Wd():this.updateDataBindings(l,h),b.isModified=!0}else if(t===Mi||t===Si){var c=a.change===Mi,f=c?a.newParam:a.oldParam,p=c?a.newValue:a.oldValue,q=this.aj.I(a.object);if(Array.isArray(q))for(a=0;a<q.length;a++){var d=q[a];if(c)cl(d,p,f,!0);else if(!(0>f)){var u=f+hl(d);d.qc(u,!0),fl(d,u,f)}}b.isModified=!0}}finally{b.aa=!0}}}}},fd.prototype.updateAllTargetBindings=function(a){void 0===a&&(a="");for(var b=this.parts.iterator;b.next();)b.value.La(a);for(b=this.nodes.iterator;b.next();)b.value.La(a);for(b=this.links.iterator;b.next();)b.value.La(a)},fd.prototype.qp=function(){for(var a=this.H.model,b=new at,t=a.nodeDataArray,e=0;e<t.length;e++)b.add(t[e]);var n=[];for(this.nodes.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),this.parts.each((function(a){null===a.data||b.contains(a.data)||n.push(a.data)})),n.forEach((function(b){Xd(a,b,!1)})),e=0;e<t.length;e++){var o=t[e];null===this.Lc(o)&&Gd(a,o,!1)}for(this.refreshDataBoundLinks(),t=this.parts.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.nodes.iterator;t.next();)t.value.updateRelationshipsFromData();for(t=this.links.iterator;t.next();)t.value.updateRelationshipsFromData()},fd.prototype.refreshDataBoundLinks=function(){},fd.prototype.updateRelationshipsFromData=function(){},fd.prototype.updateDataBindings=function(a,b){if("string"==typeof b){var t=this.Lc(a);if(null!==t)t.La(b);else{t=null;for(var e=this.aj.iterator;e.next();){for(var n=e.value,o=0;o<n.length;o++){var g=n[o].sx(a);null!==g&&(null===t&&(t=z()),t.push(g))}if(null!==t)break}if(null!==t){for(e=0;e<t.length;e++)t[e].La(b);R(t)}}a===this.diagram.model.modelData&&this.updateAllTargetBindings(b)}},fd.prototype.Jj=function(a,b,t){void 0===t&&(t=!1);var e=new Mt;if(O(a))for(var n=0;n<a.length;n++)bd(this,a[n],b,e,t);else for(a=a.iterator;a.next();)bd(this,a.value,b,e,t);if(null!==b){t=b.model,a=null!==(a=b.toolManager.findTool("Dragging"))?a.dragOptions.dragsLink:b.Vm.dragsLink,n=new at;for(var o=new Mt,g=e.iterator;g.next();){var r=g.value;if(r instanceof Oc)a||null!==r.fromNode&&null!==r.toNode||n.add(r);else if(r instanceof uc&&null!==r.data&&t.Sl()){var h=r,l=(r=g.key).pg();null!==l&&(null!==(l=e.I(l))?(t.qe(h.data,t.wa(l.data)),h=b.Kc(h.data),null!==(r=r.kh())&&null!==h&&o.add(r,h)):t.qe(h.data,void 0))}}if(0<n.count&&b.Hs(n,!1),0<o.count)for(t=o.iterator;t.next();)e.add(t.key,t.value)}if(null!==b&&null!==this.H&&null!==(t=(b=b.model).afterCopyFunction)){var c=new Mt;e.each((function(a){null!==a.key.data&&c.add(a.key.data,a.value.data)})),t(c,b,this.H.model)}for(b=e.iterator;b.next();)b.value.La();return e},fd.prototype.copyPartData=function(a,b){var t=null,e=a.data;if(null!==e&&null!==b){var n=b.model;a instanceof Oc||F(e=n.copyNodeData(e))&&(n.xf(e),t=b.Lc(e))}else al(a),null!==(t=a.copy())&&(n=this.H,null!==b?b.add(t):null!==e&&null!==n&&null!==n.commandHandler&&n.commandHandler.copiesClipboardData&&(b=n.model,n=null,t instanceof Oc||(n=b.copyNodeData(e)),F(n)&&(t.data=n)));return t},v.Object.defineProperties(fd.prototype,{nodes:{get:function(){return this.Nn}},links:{get:function(){return this.Cn}},parts:{get:function(){return this.Pa}},diagram:{get:function(){return this.H}},addsToTemporaryLayer:{get:function(){return this.sp},set:function(a){this.sp=a}}}),fd.prototype.updateAllRelationshipsFromData=fd.prototype.qp,fd.prototype.findLinksByExample=fd.prototype.ks,fd.prototype.findNodesByExample=fd.prototype.ls,fd.prototype.findLinkForData=fd.prototype.Kc,fd.prototype.findNodeForData=fd.prototype.ii,fd.prototype.findPartForData=fd.prototype.Lc,fd.prototype.findNodeForKey=fd.prototype.Wb,fd.prototype.removeModeledPart=fd.prototype.hp,fd.prototype.removeModeledParts=fd.prototype.Fs,fd.prototype.rebuildParts=fd.prototype.Wd;var wd=!1,kd=!1,Md=!1;function Sd(a){fd.apply(this,arguments)}function Pd(a,b){b.forEach((function(b){Nd(a,b)})),Ir(a.diagram,!1)}function Nd(a,b){if(null!=b&&!a.diagram.undoManager.isUndoingRedoing&&!a.bf.contains(b)){var t=a.getLinkCategoryForData(b),e=a.findLinkTemplateForCategory(t);if(null!==e){al(e);var n=e.copy();if(null!==n){e=a.diagram.skipsModelSourceBindings,a.diagram.skipsModelSourceBindings=!0,n.Tf=t,n.ub=b;var o=lp(t=a.diagram.model,b,!0);""!==o&&(n.fromPortId=o),void 0!==(o=br(t,b,!0))&&((o=a.Wb(o))instanceof uc&&(n.fromNode=o)),""!==(o=lp(t,b,!1))&&(n.toPortId=o),void 0!==(o=br(t,b,!1))&&((o=a.Wb(o))instanceof uc&&(n.toNode=o)),t=t.Ef(b),Array.isArray(t)&&t.forEach((function(b){null!==(b=a.Wb(b))&&(b.labeledLink=n)})),a.sp&&(n.Jg="Tool"),a.diagram.add(n),n.ub=null,n.data=b,a.diagram.skipsModelSourceBindings=e}}}}function Cd(a,b){b.forEach((function(b){a.hp(b)}))}function Td(){fd.apply(this,arguments),this.Sg=null}function Ld(a,b,t){if(null!==b&&null!==t&&null===t.kh()){var e=a.diagram.toolManager.findTool("Linking"),n=b,o=t;if(a.diagram.isTreePathToChildren||(n=t,o=b),(null===e||!an(e,n,o,null,!0))&&(b=a.getLinkCategoryForData(t.data),null!==(e=a.findLinkTemplateForCategory(b))&&(al(e),null!==(e=e.copy())))){var g=a.diagram.skipsModelSourceBindings;a.diagram.skipsModelSourceBindings=!0,e.Tf=b,e.ub=t.data,e.fromNode=n,e.toNode=o,a.diagram.add(e),e.ub=null,e.data=t.data,a.diagram.skipsModelSourceBindings=g}}}function Ad(a,b){this.jl=new at,this.hl=new at,this.Wv=',\n  "insertedNodeKeys": ',this.jy=',\n  "modifiedNodeData": ',this.Yv=',\n  "removedNodeKeys": ',this.vh=null,ht(this),this.Rm=this.xa="",this.Gg=!1,this.j={},this.Tc=[],this.kb=new Mt,this.Th="key",this.Ak=this.al=null,this.Im=this.Jm=!1,this.Lm=!0,this.wm=null,this.lj="category",this.Vf=new Mt,this.Kt=new ot,this.Wg=!1,this.o=null,this.undoManager=new Ni,void 0!==a&&(O(a)?this.nodeDataArray=a:b=a),b&&(Object.assign(this,b),a=b.Changed)&&(delete this.Changed,this.Pe(a))}function jd(a,b,t,e,n,o){function g(a,t){r?(void 0===a.__gohashid&&o.push(a),e.set(a,t)):(a=yt++,e.set(a,t),n.set(a,b))}if(!F(b))return b;o||(o=[]);var r=Object.isExtensible(b);if(e||(e=new Mt),r){var h=e.get(b);if(h)return h}else for(n||(n=new Mt),h=n.iterator;h.next();){var l=h.key;if(h.value===b&&(l=e.get(l)))return l}if(Array.isArray(b)){g(b,h=[]);for(var c=0;c<b.length;c++)h.push(jd(a,b[c],!1,e,n,o))}else if(b instanceof St||b instanceof Vt||b instanceof Ut||b instanceof oe||b instanceof qe)h=b.copy(),g(b,h);else{if(b instanceof Ha||b instanceof Qe||b instanceof W)return b;if(b instanceof ot)h=(new ot).addAll(jd(a,b.Fa(),!1,e,n,o)),g(b,h);else if(b instanceof at)h=(new at).addAll(jd(a,b.Fa(),!1,e,n,o)),g(b,h);else if(b instanceof Mt)h=(new Mt).addAll(jd(a,b.Fa(),!1,e,n,o)),g(b,h);else if(b instanceof Date)h=new Date(b.getTime()),g(b,h);else if(b instanceof RegExp)h=new RegExp(b),g(b,h),h.lastIndex=b.lastIndex;else if("function"==typeof b.copy)h=b.copy(),g(b,h);else for(c in g(b,h={}),b)"__gohashid"!==c&&(h[c]=jd(a,b[c],!1,e,n,o))}return t&&o.forEach((function(a){delete a.__gohashid})),h}function Fd(a,b){F(b=b.modelData)&&(a.cm(b),a.modelData=b)}function Od(a,b){function t(a,b){if((b=b.part)&&a!==(b=b.data)){var t=e.get(a);null===t?((t=new at).add(b),e.add(a,t)):t.add(b)}}var e=a.vh;null===e&&(e=new Mt,b.changes.each((function(a){if(null!==a.diagram){var b=a.change;b===ki?(a=a.object.panel)&&(b=a.data)&&t(b,a):b!==Mi&&b!==Si||(b=(a=a.object).itemArray)&&t(b,a)}})),a.vh=e)}function Bd(a,b){for(var t=new at,e=0;e<a.nodeDataArray.length;e++){var n=a.nodeDataArray[e];Dd(a,b,n,n,t)}return t}function Dd(a,b,t,e,n){if(Array.isArray(t))for(var o=0;o<t.length;o++){var g=t[o];if(g===b)return n.add(e),!0;if(Dd(a,b,g,e,n))return!0}else if(F(t)&&Object.getPrototypeOf(t)===Object.prototype)for(o in t){if((g=t[o])===b)return n.add(e),!0;if(Dd(a,b,g,e,n))return!0}return!1}function tr(a,b,t){void 0===t&&(t=!1);var e=b.length;if(0>=e)return"[]";var n=new Z;n.add("["),t&&1<e&&n.add("\n");for(var o=0;o<e;o++){var g=b[o];void 0!==g&&(0<o&&(n.add(","),t&&n.add("\n")),n.add(a.rm(g)))}return t&&1<e&&n.add("\n"),n.add("]"),n.toString()}function Id(a,b){return void 0===b||"__gohashid"===a||"_"===a[0]||"function"==typeof b}function zd(a){return isNaN(a)?"NaN":1/0===a?"9e9999":-1/0===a?"-9e9999":a}function Rd(a,b){var t=b;if(t instanceof St)b={class:"go.Point",x:zd(t.x),y:zd(t.y)};else if(t instanceof Vt)b={class:"go.Size",width:zd(t.width),height:zd(t.height)};else if(t instanceof Ut)b={class:"go.Rect",x:zd(t.x),y:zd(t.y),width:zd(t.width),height:zd(t.height)};else if(t instanceof oe)b={class:"go.Margin",top:zd(t.top),right:zd(t.right),bottom:zd(t.bottom),left:zd(t.left)};else if(t instanceof qe)b=t.sb()?{class:"go.Spot",x:zd(t.x),y:zd(t.y),offsetX:zd(t.offsetX),offsetY:zd(t.offsetY)}:{class:"go.Spot",enum:t.toString()};else if(t instanceof Ha){if(b={class:"go.Brush",type:t.type.name},t.type===hh?b.color=t.color:t.type!==lh&&t.type!==uh||(b.start=t.start,b.end=t.end,t.type===uh&&(0!==t.startRadius&&(b.startRadius=zd(t.startRadius)),isNaN(t.endRadius)||(b.endRadius=zd(t.endRadius)))),null!==t.colorStops){var e={};for(t=t.colorStops.iterator;t.next();)e[t.key]=t.value;b.colorStops=e}}else t instanceof Qe?(b={class:"go.Geometry",type:t.type.name},0!==t.startX&&(b.startX=zd(t.startX)),0!==t.startY&&(b.startY=zd(t.startY)),0!==t.endX&&(b.endX=zd(t.endX)),0!==t.endY&&(b.endY=zd(t.endY)),t.spot1.D(he)||(b.spot1=t.spot1),t.spot2.D(me)||(b.spot2=t.spot2),t.type===Qe.o&&(b.path=Qe.ia(t))):t instanceof W&&(b={class:"go.EnumValue",classType:Wd(a,t.classType),name:t.name});for(var n in e="{",t=!0,b){var o=Zd(b,n);if(!Id(n,o))if(t?t=!1:e+=",",e+=a.quote(n)+":","points"===n&&o instanceof ot){var g="[";for(o=o.iterator;o.next();){var r=o.value;1<g.length&&(g+=","),g+=a.rm(r.x),g+=",",g+=a.rm(r.y)}e+=g+="]"}else e+=a.rm(o)}return e+"}"}function Ed(a){return"number"==typeof a?a:"NaN"===a?NaN:"9e9999"===a?1/0:"-9e9999"===a?-1/0:parseFloat(a)}function Vd(a,b,t,e,n,o,g,r,h){void 0===r&&(r=null),void 0===h&&(h=null);var l=new bi;l.model=a,l.change=t,l.modelChange=b,l.propertyName=e,l.object=n,l.oldValue=o,l.oldParam=r,l.newValue=g,l.newParam=h,a.cs(l)}function Yd(a){return"number"==typeof a||"string"==typeof a}function Gd(a,b,t){var e=a.wa(b);void 0!==e&&a.kb.I(e)===b||(a.$u(b),void 0===(e=a.wa(b))&&T("Model.makeNodeDataKeyUnique failed on "+b+".  Data not added to Model."),a.kb.add(e,b),e=null,t&&(e=a.Tc.length,D(a.Tc,e,b)),Vd(a,"nodeDataArray",Mi,"nodeDataArray",a,null,b,null,e),a.em(b),a.dm(b))}function Xd(a,b,t){var e=a.wa(b);if(void 0!==e&&a.kb.remove(e),e=null,t){t:if(t=a.Tc,Array.isArray(t))e=t.indexOf(b);else{e=t.length;for(var n=0;n<e;n++)if(t[n]===b){e=n;break t}e=-1}if(0>e)return;I(a.Tc,e)}Vd(a,"nodeDataArray",Si,"nodeDataArray",a,b,null,e,null),a.pp(b)}function Ud(a,b,t){if(void 0!==b){var e=a.Vf.I(b);null===e&&(e=new at,a.Vf.add(b,e)),e.add(t)}}function hr(a,b,t){if(void 0!==b){var e=a.Vf.I(b);e instanceof at&&(null==t?a.Vf.remove(b):(e.remove(t),0===e.count&&a.Vf.remove(b)))}}function qd(a,b){return void 0===b?null:(a=a.Vf.I(b))instanceof at?a:null}function Kd(a,b,t){if(a.copiesArrays&&Array.isArray(b)){var e=[];for(t=0;t<b.length;t++){var n=Kd(a,b[t],a.copiesArrayObjects);e.push(n)}return ht(e),e}if(t&&F(b)){for(e in t=(t=b.constructor)?new t:{},n=a.copiesKey||"string"!=typeof a.nodeKeyProperty?null:a.nodeKeyProperty,b)if("__gohashid"===e)t.__gohashid=void 0;else if(e===n)t[n]=void 0;else{var o=Zd(b,e),g=Wd(a,o);"GraphObject"===g||"Diagram"===g||"Layer"===g||"RowColumnDefinition"===g||"AnimationManager"===g||"Tool"===g||"CommandHandler"===g||"Layout"===g||"InputEvent"===g||"DiagramEvent"===g||o instanceof Ad||o instanceof Ni||o instanceof Pi||o instanceof bi||(o=Kd(a,o,!1)),_d(t,e,o)}return ht(t),t}return b instanceof St||b instanceof Vt||b instanceof Ut||b instanceof qe||b instanceof oe?b.copy():b}function Hd(){return new Ad}function Wd(a,b){if("function"==typeof b){if(b.className)return b.className;if(b.name)return b.name}else if("object"==typeof b&&null!==b&&b.constructor)return Wd(a,b.constructor);return typeof b}function Jd(a){return Qd[a]?Qd[a]:void 0!==M.go&&M.go[a]?M.go[a]:null}function Zd(a,b){if(!a||!b)return null;try{if("function"==typeof b)var t=b(a);else"function"==typeof a.getAttribute?null===(t=a.getAttribute(b))&&(t=void 0):t=a[b]}catch(t){}return t}function _d(a,b,t){if(a&&b)try{"function"==typeof b?b(a,t):"function"==typeof a.setAttribute?a.setAttribute(b,t):a[b]=t}catch(t){}}fd.className="PartManager",y(Sd,fd),Sd.prototype.addAllModeledParts=function(){var a=this.diagram.model;this.addModeledParts(a.nodeDataArray),Pd(this,a.linkDataArray)},Sd.prototype.addModeledParts=function(a){for(fd.prototype.addModeledParts.call(this,a,!1),a=this.links.iterator;a.next();)Bc(a.value);Ir(this.diagram,!1)},Sd.prototype.removeAllModeledParts=function(){var a=this.diagram.model;Cd(this,a.linkDataArray),this.Fs(a.nodeDataArray)},Sd.prototype.getLinkCategoryForData=function(a){return this.diagram.model.os(a)},Sd.prototype.setLinkCategoryForData=function(a,b){return this.diagram.model.kp(a,b)},Sd.prototype.setFromNodeForLink=function(a,b){var t=this.diagram.model;t.wv(a.data,t.wa(null!==b?b.data:null))},Sd.prototype.setToNodeForLink=function(a,b){var t=this.diagram.model;t.Bv(a.data,t.wa(null!==b?b.data:null))},Sd.prototype.removeDataForLink=function(a){this.diagram.model.am(a.data)},Sd.prototype.findPartForKey=function(a){var b=fd.prototype.findPartForKey.call(this,a);return null===b&&null!==(a=this.diagram.model.jh(a))?this.bf.I(a):b},Sd.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.jh(a))?this.bf.I(a):null},Sd.prototype.doModelChanged=function(a){var b=this;if(fd.prototype.doModelChanged.call(this,a),this.diagram){var t=this.diagram;if(a.model===t.model){var e=a.change;if(t.aa){t.aa=!1;try{var n=a.modelChange;if(""!==n){if(e===ki){if("linkFromKey"===n){var o=this.Kc(a.object);if(null!==o){var g=this.Wb(a.newValue);o.fromNode=g}}else if("linkToKey"===n){var r=this.Kc(a.object);if(null!==r){var h=this.Wb(a.newValue);r.toNode=h}}else if("linkFromPortId"===n){var l=this.Kc(a.object);if(null!==l){var c=a.newValue;"string"==typeof c&&(l.fromPortId=c)}}else if("linkToPortId"===n){var f=this.Kc(a.object);if(null!==f){var p=a.newValue;"string"==typeof p&&(f.toPortId=p)}}else if("nodeGroupKey"===n){var q=this.Lc(a.object);if(null!==q){var d=a.newValue;if(void 0!==d){var u=this.Wb(d);q.containingGroup=u instanceof Cc?u:null}else q.containingGroup=null}}else if("linkLabelKeys"===n){var m=this.Kc(a.object);if(null!==m){var y=a.oldValue,v=a.newValue;Array.isArray(y)&&y.forEach((function(a){0<=v.indexOf(a)||null!==(a=b.Wb(a))&&(a.labeledLink=null)})),Array.isArray(v)&&v.forEach((function(a){null!==(a=b.Wb(a))&&(a.labeledLink=m)}))}}else if("linkCategory"===n){var x=this.Kc(a.object),w=a.newValue;null!==x&&"string"==typeof w&&(x.category=w)}else"linkDataArray"===n&&(Cd(this,a.oldValue),Pd(this,a.newValue));t.isModified=!0}else if(e===Mi){var k=a.newValue;if("linkDataArray"===n&&"object"==typeof k&&null!==k)Nd(this,k);else if("linkLabelKeys"===n&&Yd(k)){var M=this.Kc(a.object),S=this.Wb(k);null!==M&&null!==S&&(S.labeledLink=M)}t.isModified=!0}else if(e===Si){var P=a.oldValue;if("linkDataArray"===n&&"object"==typeof P&&null!==P)this.hp(P);else if("linkLabelKeys"===n&&Yd(P)){var N=this.Wb(P);null!==N&&(N.labeledLink=null)}t.isModified=!0}}else if(e===ki){var C=a.propertyName;a.object!==t.model||"linkFromKeyProperty"!==C&&"linkToKeyProperty"!==C&&"linkFromPortIdProperty"!==C&&"linkToPortIdProperty"!==C&&"linkLabelKeysProperty"!==C&&"nodeIsGroupProperty"!==C&&"nodeGroupKeyProperty"!==C&&"linkCategoryProperty"!==C||t.undoManager.isUndoingRedoing||this.Wd(),t.isModified=!0}}finally{t.aa=!0}}}}},Sd.prototype.refreshDataBoundLinks=function(){var a=this,b=this.diagram.model,t=new at,e=b.linkDataArray;e.forEach((function(a){t.add(a)}));var n=[];this.links.each((function(a){null===a.data||t.contains(a.data)||n.push(a.data)})),n.forEach((function(a){fp(b,a,!1)})),e.forEach((function(t){null===a.Kc(t)&&cp(b,t,!1)}))},Sd.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;if(a instanceof Oc){var n=br(e,b,!0);if(n=t.Wb(n),a.fromNode=n,n=br(e,b,!1),n=t.Wb(n),a.toNode=n,0<(b=e.Ef(b)).length||0<a.labelNodes.count){if(1===b.length&&1===a.labelNodes.count){n=b[0];var o=a.labelNodes.first();if(e.wa(o.data)===n)return}n=(new at).addAll(b);var g=new at;a.labelNodes.each((function(a){null!==a.data&&(void 0!==(a=e.wa(a.data))&&g.add(a))})),(b=g.copy()).gp(n),(n=n.copy()).gp(g),(0<b.count||0<n.count)&&(b.each((function(b){null!==(b=t.Wb(b))&&b.labeledLink===a&&(b.labeledLink=null)})),n.each((function(b){null!==(b=t.Wb(b))&&b.labeledLink!==a&&(b.labeledLink=a)})))}}else!(a instanceof hc)&&(b=e.lh(b),null===(b=t.findPartForKey(b))||b instanceof Cc)&&(a.containingGroup=b)}}},Sd.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.wa(a);if(void 0!==t){var e=qd(b,t),n=this.Lc(a);if(null!==e&&null!==n){e=e.iterator;for(var o={};e.next();){var g=e.value;b.lb(g)?n instanceof Cc&&b.lh(g)===t&&(null!==(g=this.Lc(g))&&(g.containingGroup=n)):(o.link=this.Kc(g),null!==o.link&&n instanceof uc&&(br(b,g,!0)===t&&(o.link.fromNode=n),br(b,g,!1)===t&&(o.link.toNode=n),g=b.Ef(g),Array.isArray(g)&&g.some(function(a){return function(b){return b===t&&(n.labeledLink=a.link,!0)}}(o)))),o={link:o.link}}hr(b,t)}void 0!==(a=b.lh(a))&&((a=this.Wb(a))instanceof Cc&&(n.containingGroup=a))}},Sd.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof uc){var t=b.wa(a.data);if(void 0!==t){for(var e=a.linksConnected;e.next();)Ud(b,t,e.value.data);if(a.isLinkLabel&&(null!==(e=a.labeledLink)&&Ud(b,t,e.data)),a instanceof Cc)for(a=a.memberParts;a.next();)e=a.value.data,b.lb(e)&&Ud(b,t,e)}}},Sd.prototype.copyPartData=function(a,b){var t=fd.prototype.copyPartData.call(this,a,b);if(a instanceof Oc)if(null!==(a=a.data)&&null!==b){var e=b.model;"object"==typeof(a=e.Io(a))&&null!==a&&(e.fi(a),t=b.Kc(a))}else null!==t&&(b=this.diagram,null!==a&&null!==b&&null!==b.commandHandler&&b.commandHandler.copiesClipboardData&&("object"==typeof(b=b.model.Io(a))&&null!==b&&(t.data=b)));return t},Sd.prototype.insertLink=function(a,b,t,e){var n=this.diagram,o=n.model,g=n.toolManager.findTool("Linking"),r="";if(null!==a&&(null===b&&(b=a),null===(r=b.portId)&&(r="")),b="",null!==t&&(null===e&&(e=t),null===(b=e.portId)&&(b="")),(e=g.archetypeLinkData)instanceof Oc){if(al(e),null!==(o=e.copy()))return o.fromNode=a,o.fromPortId=r,o.toNode=t,o.toPortId=b,n.add(o),(a=g.archetypeLabelNodeData)instanceof uc&&(al(a),null!==(a=a.copy())&&(a.labeledLink=o,n.add(a))),o}else if(null!==e&&("object"==typeof(e=o.Io(e))&&null!==e))return null!==a&&hp(o,e,o.wa(a.data),!0),up(o,e,r,!0),null!==t&&hp(o,e,o.wa(t.data),!1),up(o,e,b,!1),o.fi(e),null===(a=g.archetypeLabelNodeData)||a instanceof uc||"object"==typeof(a=o.copyNodeData(a))&&null!==a&&(o.xf(a),void 0!==(a=o.wa(a))&&o.Au(e,a)),n.Kc(e);return null},Sd.prototype.findLinkForKey=Sd.prototype.findLinkForKey,Sd.prototype.findPartForKey=Sd.prototype.findPartForKey,Sd.prototype.removeAllModeledParts=Sd.prototype.removeAllModeledParts,Sd.prototype.addModeledParts=Sd.prototype.addModeledParts,Sd.prototype.addAllModeledParts=Sd.prototype.addAllModeledParts,Sd.className="GraphLinksPartManager",y(Td,fd),Td.prototype.getLinkCategoryForData=function(a){return this.diagram.model.rs(a)},Td.prototype.setLinkCategoryForData=function(a,b){this.diagram.model.Ls(a,b)},Td.prototype.setFromNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren)e.qe(a.data,e.wa(b));else{var n=this.Sg;this.Sg=a,null!==t&&e.qe(t.data,void 0),e.qe(b,e.wa(null!==a.toNode?a.toNode.data:null)),this.Sg=n}},Td.prototype.setToNodeForLink=function(a,b,t){var e=this.diagram.model;if(void 0===t&&(t=null),b=null!==b?b.data:null,this.diagram.isTreePathToChildren){var n=this.Sg;this.Sg=a,null!==t&&e.qe(t.data,void 0),e.qe(b,e.wa(null!==a.fromNode?a.fromNode.data:null)),this.Sg=n}else e.qe(a.data,e.wa(b))},Td.prototype.removeDataForLink=function(a){this.diagram.model.qe(a.data,void 0)},Td.prototype.findLinkForKey=function(a){return null==a?null:null!==(a=this.diagram.model.ic(a))?this.bf.I(a):null},Td.prototype.doModelChanged=function(a){if(fd.prototype.doModelChanged.call(this,a),this.diagram){var b=this.diagram;if(a.model===b.model){var t=a.change;if(b.aa){b.aa=!1;try{var e=a.modelChange;if(""!==e){if(t===ki){if("nodeParentKey"===e){var n=a.object,o=this.Wb(a.newValue),g=this.ii(n);if(null!==this.Sg)null!==o&&(this.Sg.data=n,this.Sg.category=this.getLinkCategoryForData(n));else if(null!==g){var r=g.kh();null!==r?null===o?b.remove(r):b.isTreePathToChildren?r.fromNode=o:r.toNode=o:Ld(this,o,g)}}else if("parentLinkCategory"===e){var h=this.ii(a.object),l=a.newValue;if(null!==h&&"string"==typeof l){var c=h.kh();null!==c&&(c.category=l)}}b.isModified=!0}}else if(t===ki){var f=a.propertyName;a.object===b.model&&"nodeParentKeyProperty"===f&&(b.undoManager.isUndoingRedoing||this.Wd()),b.isModified=!0}}finally{b.aa=!0}}}}},Td.prototype.updateRelationshipsFromData=function(a){var b=a.data;if(null!==b){var t=a.diagram;if(null!==t){var e=t.model;a instanceof uc&&(b=e.mh(b),(b=t.Wb(b))!==(e=a.pg())&&(e=a.kh(),null!==b?null!==e?t.isTreePathToChildren?e.fromNode=b:e.toNode=b:Ld(this,b,a):null!==e&&vr(t,e,!1)))}}},Td.prototype.updateDataBindings=function(a,b){fd.prototype.updateDataBindings.call(this,a,b),"string"==typeof b&&null!==this.Lc(a)&&(null!==(a=this.Kc(a))&&a.La(b))},Td.prototype.resolveReferencesForData=function(a){var b=this.diagram.model,t=b.wa(a);if(void 0!==t){var e=qd(b,t),n=this.Lc(a);if(null!==e&&null!==n){for(e=e.iterator;e.next();){var o=e.value;b.lb(o)&&n instanceof uc&&b.mh(o)===t&&Ld(this,n,this.ii(o))}hr(b,t)}void 0!==(a=b.mh(a))&&n instanceof uc&&Ld(this,a=this.Wb(a),n)}},Td.prototype.unresolveReferencesForPart=function(a){var b=this.diagram.model;if(a instanceof uc){var t=b.wa(a.data),e=this.Kc(a.data);if(null!==e){e.isSelected=!1,e.isHighlighted=!1;var n=e.layer;if(null!==n){var o=n.qc(-1,e,!1);0<=o&&this.diagram.cb(Si,"parts",n,e,null,o,null),null!==(o=e.layerChanged)&&o(e,n,null)}}for(e=this.diagram.isTreePathToChildren,a=a.linksConnected;a.next();)n=a.value,n=(e?n.toNode:n.fromNode).data,b.lb(n)&&Ud(b,t,n)}},Td.prototype.insertLink=function(a,b,t){b=this.diagram.model;var e=a,n=t;return this.diagram.isTreePathToChildren||(e=t,n=a),null!==e&&null!==n?(b.qe(n.data,b.wa(e.data)),n.kh()):null},Td.prototype.findLinkForKey=Td.prototype.findLinkForKey,Td.className="TreePartManager",Ad.prototype.cloneProtected=function(a){a.xa=this.xa,a.Rm=this.Rm,a.Gg=this.Gg,a.Th=this.Th,a.al=this.al,a.Ak=this.Ak,a.Jm=this.Jm,a.Im=this.Im,a.Lm=this.Lm,a.wm=this.wm,a.lj=this.lj},Ad.prototype.copy=function(){var a=new this.constructor;return this.cloneProtected(a),a},Ad.prototype.clear=function(){this.Tc=[],this.kb.clear(),this.Vf.clear(),this.undoManager.clear()},Ad.prototype.toString=function(a){if(void 0===a&&(a=0),1<a)return this.mp();var b=(""!==this.name?this.name:"")+" Model";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.wa(n)+":"+V(n)}}return b},Ad.prototype.xA=function(a){a.change!==wi&&T("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+a.toString());var b=a.object;return a.isTransactionFinished&&b instanceof Pi?(Od(this,b),a=this.Qv(b,"FinishedUndo"===a.propertyName),this.vh=null,a):null},Ad.prototype.Qv=function(a,b){var t=this,e=!1,n=new at,o=new at,g=new at,r=this.vh;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Mi?n.add(a.newValue):a.change===Si&&g.add(a.oldValue):t.lb(a.object)?o.add(a.object):a.change!==ki||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.lb(a)&&o.add(a)})):a.object instanceof Ad||t.ri()&&t.Jc(a.object)||Bd(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=this.hl;h.clear(),n.each((function(a){h.add(t.wa(a)),b||o.add(a)}));var l=this.jl;l.clear(),g.each((function(a){l.add(t.wa(a)),b&&o.add(a)})),a=t.cloneDeep(o.Fa());var c=null;return e&&(null===c&&(c={}),c.modelData=this.cloneDeep(this.modelData)),0<h.count&&(null===c&&(c={}),b?c.removedNodeKeys=h.Fa():c.insertedNodeKeys=h.Fa()),0<a.length&&(null===c&&(c={}),c.modifiedNodeData=a),0<l.count&&(null===c&&(c={}),b?c.insertedNodeKeys=l.Fa():c.removedNodeKeys=l.Fa()),l.clear(),h.clear(),c},Ad.prototype.cloneDeep=function(a){return jd(this,a,!0)},(e=Ad.prototype).quote=function(a){return JSON.stringify(a).replace(/[\u007F-\uFFFF]/g,(function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).substr(-4)}))},e.qm=function(){var a="";return""!==this.name&&(a+=',\n  "name": '+this.quote(this.name)),""!==this.dataFormat&&(a+=',\n  "dataFormat": '+this.quote(this.dataFormat)),this.isReadOnly&&(a+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(a+=',\n  "nodeKeyProperty": '+this.quote(this.nodeKeyProperty)),this.copiesArrays&&(a+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(a+=',\n  "copiesArrayObjects": true'),this.copiesKey||(a+=',\n  "copiesKey": false'),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(a+=',\n  "nodeCategoryProperty": '+this.quote(this.nodeCategoryProperty)),a},e.fp=function(a){a.name&&(this.name=a.name),a.dataFormat&&(this.dataFormat=a.dataFormat),a.isReadOnly&&(this.isReadOnly=!0),a.nodeKeyProperty&&(this.nodeKeyProperty=a.nodeKeyProperty),a.copiesArrays&&(this.copiesArrays=!0),a.copiesArrayObjects&&(this.copiesArrayObjects=!0),!1===a.copiesKey&&(this.copiesKey=!1),a.nodeCategoryProperty&&(this.nodeCategoryProperty=a.nodeCategoryProperty)},e.Rv=function(){var t,a=this.modelData,b=!1;for(t in a)if(!Id(t,a[t])){b=!0;break}return a="",b&&(a=',\n  "modelData": '+Rd(this,this.modelData)),a+',\n  "nodeDataArray": '+tr(this,this.nodeDataArray,!0)},e.kv=function(a){Fd(this,a),O(a=a.nodeDataArray)&&(this.cm(a),this.nodeDataArray=a)},e.Pv=function(a,b){var t=this,e=!1,n=new at,o=new at,g=new at,r=this.vh;a.changes.each((function(a){a.model===t&&("nodeDataArray"===a.modelChange?a.change===Mi?n.add(a.newValue):a.change===Si&&g.add(a.oldValue):t.lb(a.object)?o.add(a.object):a.change!==ki||t.modelData!==a.object&&"modelData"!==a.propertyName?null!==a.object&&(r&&r.contains(a.object)?r.get(a.object).each((function(a){t.lb(a)&&o.add(a)})):a.object instanceof Ad||t.ri()&&t.Jc(a.object)||Bd(t,a.object).each((function(a){o.add(a)}))):e=!0)}));var h=this.hl;h.clear(),n.each((function(a){h.add(t.wa(a)),b||o.add(a)}));var l=this.jl;return l.clear(),g.each((function(a){l.add(t.wa(a)),b&&o.add(a)})),a="",e&&(a+=',\n  "modelData": '+Rd(this,this.modelData)),0<h.count&&(a+=(b?this.Yv:this.Wv)+tr(this,h.Fa(),!0)),0<o.count&&(a+=this.jy+tr(this,o.Fa(),!0)),0<l.count&&(a+=(b?this.Wv:this.Yv)+tr(this,l.Fa(),!0)),l.clear(),h.clear(),a},e.ep=function(a){(void 0!==a.name&&a.name!==this.name||void 0!==a.dataFormat&&a.dataFormat!==this.dataFormat||void 0!==a.isReadOnly&&a.isReadOnly!==this.isReadOnly||void 0!==a.nodeKeyProperty&&a.nodeKeyProperty!==this.nodeKeyProperty||void 0!==a.copiesArrays&&a.copiesArrays!==this.copiesArrays||void 0!==a.copiesArrayObjects&&a.copiesArrayObjects!==this.copiesArrayObjects||void 0!==a.copiesKey&&a.copiesKey!==this.copiesKey||void 0!==a.nodeCategoryProperty&&a.nodeCategoryProperty!==this.nodeCategoryProperty)&&T("applyIncrementalJson cannot change Model properties"),Fd(this,a);var b=a.insertedNodeKeys,t=a.modifiedNodeData,e=new Mt;if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n],g=this.wa(o);null!=g&&e.set(g,o)}if(Array.isArray(b))for(n=b.length,o=0;o<n;o++){g=b[o];var r=this.ic(g);null===r&&(r=(r=e.get(g))?r:this.copyNodeData({}),this.jm(r,g),this.xf(r))}if(Array.isArray(t))for(b=t.length,e=0;e<b;e++)if(n=t[e],o=this.wa(n),null!==(o=this.ic(o))){for(var h in n)"__gohashid"===h||h===this.nodeKeyProperty||this.Vj()&&h===this.nodeIsGroupProperty||this.setDataProperty(o,h,n[h]);this.km(n,o)}if(a=a.removedNodeKeys,Array.isArray(a))for(t=a.length,h=0;h<t;h++)null!==(b=this.ic(a[h]))&&this.bm(b)},e.$x=function(a,b){a.change!==wi&&T("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+a.toString());var t=a.object;return a.isTransactionFinished&&t instanceof Pi?(void 0===b&&(b=Wd(this,this)),Od(this,t),a=this.Pv(t,"FinishedUndo"===a.propertyName),this.vh=null,"2"===b?'{ "incremental": 2'+a+"}":'{ "class": '+this.quote(b)+', "incremental": 1'+this.qm()+a+"}"):'{ "incremental": 0 }'},e.yA=function(a,b){return this.$x(a,b)},e.mp=function(a){return void 0===a&&(a=Wd(this,this)),'{ "class": '+this.quote(a)+this.qm()+this.Rv()+"}"},e.toJSON=function(a){return this.mp(a)},e.Zw=function(a){var b=null;if("string"==typeof a)try{b=M.JSON.parse(a)}catch(t){}else"object"==typeof a?b=a:T("Unable to modify a Model from: "+a);var t=b.incremental;"number"!=typeof t&&T("Unable to apply non-incremental changes to Model: "+a),0!==t&&(this.Ea("applyIncrementalJson"),this.ep(b),this.eb("applyIncrementalJson"))},e.Ky=function(a){return this.Zw(a)},Ad.constructGraphLinksModel=function(){return new Ad},(e=Ad.prototype).cm=function(a){if(O(a))for(var b=a.length,t=0;t<b;t++){var e=a[t];if(F(e)){var n=t;e=this.cm(e),Array.isArray(a)?a[n]=e:T("Cannot replace an object in an HTMLCollection or NodeList at "+n)}}else if(F(a)){for(b in a)if(F(t=a[b])&&(t=this.cm(t),a[b]=t,"points"===b&&Array.isArray(t))){for(n=0==t.length%2,e=0;e<t.length;e++)if("number"!=typeof t[e]){n=!1;break}if(n){for(n=new ot,e=0;e<t.length/2;e++)n.add(new St(t[2*e],t[2*e+1]));n.freeze(),a[b]=n}}return function(a){if("object"!=typeof a)return a;var b=a.class||"";if("NaN"===b)return NaN;if("Date"===b)return new Date(a.value);if(0!==b.indexOf("go."))return a;b=b.substr(3);var t=a;if("Point"===b)t=new St(Ed(a.x),Ed(a.y));else if("Size"===b)t=new Vt(Ed(a.width),Ed(a.height));else if("Rect"===b)t=new Ut(Ed(a.x),Ed(a.y),Ed(a.width),Ed(a.height));else if("Margin"===b)t=new oe(Ed(a.top),Ed(a.right),Ed(a.bottom),Ed(a.left));else if("Spot"===b)t="string"==typeof a.enum?He(a.enum):new qe(Ed(a.x),Ed(a.y),Ed(a.offsetX),Ed(a.offsetY));else if("Brush"===b){if((t=new Ha).type=J(Ha,a.type),"string"==typeof a.color&&(t.color=a.color),a.start instanceof qe&&(t.start=a.start),a.end instanceof qe&&(t.end=a.end),"number"==typeof a.startRadius&&(t.startRadius=Ed(a.startRadius)),"number"==typeof a.endRadius&&(t.endRadius=Ed(a.endRadius)),F(a=a.colorStops))for(var e in a)t.addColorStop(parseFloat(e),a[e])}else"Geometry"===b?(t=null,t="string"==typeof a.path?Qe.parse(a.path):new Qe,t.type=J(Qe,a.type),"number"==typeof a.startX&&(t.startX=Ed(a.startX)),"number"==typeof a.startY&&(t.startY=Ed(a.startY)),"number"==typeof a.endX&&(t.endX=Ed(a.endX)),"number"==typeof a.endY&&(t.endY=Ed(a.endY)),a.spot1 instanceof qe&&(t.spot1=a.spot1),a.spot2 instanceof qe&&(t.spot2=a.spot2)):"EnumValue"===b&&(e=a.classType,0===e.indexOf("go.")&&(e=e.substr(3)),e=Jd(e),"function"==typeof e&&(t=J(e,a.name)));return t}(a)}return a},e.rm=function(a){return void 0===a?"undefined":null===a?"null":!0===a?"true":!1===a?"false":"string"==typeof a?this.quote(a):"number"==typeof a?1/0===a?"9e9999":-1/0===a?"-9e9999":isNaN(a)?'{"class":"NaN"}':a.toString():a instanceof Date?'{"class":"Date", "value":"'+a.toJSON()+'"}':a instanceof Number?this.rm(a.valueOf()):O(a)?tr(this,a):F(a)?Rd(this,a):"function"==typeof a?"null":a.toString()},e.Pe=function(a){return this.Kt.add(a),this},e.hk=function(a){this.Kt.remove(a)},e.cs=function(a){this.skipsUndoManager||this.undoManager.Tu(a);for(var b=this.Kt,t=b.length,e=0;e<t;e++)b.M(e)(a)},e.cb=function(a,b,t,e,n,o,g){Vd(this,"",a,b,t,e,n,o,g)},e.g=function(a,b,t,e,n){Vd(this,"",ki,a,this,b,t,e,n)},e.Es=function(a,b,t,e,n,o){Vd(this,"",ki,b,a,t,e,n,o)},Ad.prototype.changeState=function(a,b){if(null!==a&&a.model===this)if(a.change===ki){var t=a.object,e=a.propertyName,n=a.I(b);e===this.nodeKeyProperty&&this.lb(t)&&(void 0!==(b=a.I(!b))&&this.kb.remove(b),void 0!==n&&this.kb.add(n,t)),_d(t,e,n)}else a.change===Mi?(t=a.newParam,"nodeDataArray"===a.modelChange?F(a=a.newValue)&&"number"==typeof t&&(e=this.wa(a),b?(this.Tc[t]===a&&I(this.Tc,t),void 0!==e&&this.kb.remove(e)):(this.Tc[t]!==a&&D(this.Tc,t,a),void 0!==e&&this.kb.add(e,a))):""===a.modelChange?((e=a.object)&&!O(e)&&a.propertyName&&(e=Zd(a.object,a.propertyName)),O(e)&&"number"==typeof t&&(a=a.newValue,b?I(e,t):D(e,t,a))):T("unknown ChangedEvent.Insert modelChange: "+a.toString())):a.change===Si?(t=a.oldParam,"nodeDataArray"===a.modelChange?F(a=a.oldValue)&&"number"==typeof t&&(e=this.wa(a),b?(this.Tc[t]!==a&&D(this.Tc,t,a),void 0!==e&&this.kb.add(e,a)):(this.Tc[t]===a&&I(this.Tc,t),void 0!==e&&this.kb.remove(e))):""===a.modelChange?((e=a.object)&&!O(e)&&a.propertyName&&(e=Zd(a.object,a.propertyName)),O(e)&&"number"==typeof t&&(a=a.oldValue,b?D(e,t,a):I(e,t))):T("unknown ChangedEvent.Remove modelChange: "+a.toString())):a.change!==wi&&T("unknown ChangedEvent: "+a.toString())},Ad.prototype.Ea=function(a){return this.undoManager.Ea(a)},Ad.prototype.eb=function(a){return this.undoManager.eb(a)},Ad.prototype.Kf=function(){return this.undoManager.Kf()},Ad.prototype.commit=function(a,b){void 0===b&&(b="");var t=this.skipsUndoManager;null===b&&(this.skipsUndoManager=!0,b=""),this.undoManager.Ea(b);var e=!1;try{a(this),e=!0}finally{e?this.undoManager.eb(b):this.undoManager.Kf(),this.skipsUndoManager=t}},(e=Ad.prototype).La=function(a,b){void 0===b&&(b=""),Vd(this,"SourceChanged",wi,b,a,null,null)},e.wa=function(a){if(null!==a){var b=this.Th;if(""!==b&&void 0!==(b=Zd(a,b))){if(Yd(b))return b;T("Key value for node data "+a+" is not a number or a string: "+b)}}},e.jm=function(a,b){if(null!==a){var t=this.Th;if(""!==t)if(this.lb(a)){var e=Zd(a,t);e!==b&&null===this.ic(b)&&(_d(a,t,b),void 0!==e&&this.kb.remove(e),this.kb.add(b,a),Vd(this,"nodeKey",ki,t,a,e,b),"string"==typeof t&&this.La(a,t),this.ip(e,b))}else _d(a,t,b)}},e.lb=function(a){var b=this.wa(a);return void 0!==b&&this.kb.I(b)===a},e.ic=function(a){return null===a&&T("Model.findNodeDataForKey:key must not be null"),void 0!==a&&Yd(a)?this.kb.I(a):null},e.$u=function(a){if(null!==a){var b=this.Th;if(""!==b){var t=this.wa(a);if(void 0===t||this.kb.contains(t)){var e=this.al;if(null!==e&&(null!=(t=e(this,a))&&!this.kb.contains(t)))return void _d(a,b,t);if("string"==typeof t){for(e=2;this.kb.contains(t+e);)e++;_d(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.kb.count-1;this.kb.contains(t);)t--;_d(a,b,t)}}}}},e.xf=function(a){null!==a&&(lt(a),this.lb(a)||Gd(this,a,!0))},e.Fy=function(a){if(O(a))for(var b=a.length,t=0;t<b;t++)this.xf(a[t]);else for(a=a.iterator;a.next();)this.xf(a.value)},e.bm=function(a){null!==a&&Xd(this,a,!0)},e.nA=function(a){if(O(a))for(var b=a.length,t=0;t<b;t++)this.bm(a[t]);else for(a=a.iterator;a.next();)this.bm(a.value)},e.$z=function(a){if(a!==this.nodeDataArray&&O(a)){var b=this.jl;b.clear(),b.addAll(this.kb.iteratorKeys);var t=this.hl;t.clear();for(var e=a.length,n=0;n<e;n++){var o=a[n],g=this.wa(o);if(void 0!==g){t.add(g);var r=this.ic(g);r!==o&&(null!==r?(this.Co(r,o),this.km(o,r)):(o=this.cloneDeep(o),this.jm(o,g),this.xf(o)))}else g=this.cloneDeep(o),this.xf(g),t.add(this.wa(g))}for(a=b.iterator;a.next();)e=a.value,t.contains(e)||(e=this.ic(e))&&this.bm(e);b.clear(),t.clear()}},e.ip=function(a,b){void 0!==b&&((a=qd(this,a))instanceof at&&this.Vf.add(b,a))},e.Lv=function(){},e.em=function(){},e.dm=function(){},e.pp=function(){},e.Qy=function(a){void 0===a?this.Vf.clear():this.Vf.remove(a)},Ad.prototype.copyNodeData=function(a){if(null===a)return null;var b=this.Ak;return F(a=null!==b?b(a,this):Kd(this,a,!0))&&ht(a),a},Ad.prototype.setDataProperty=function(a,b,t){if(this.lb(a)){if(b===this.nodeKeyProperty)return void this.jm(a,t);if(b===this.nodeCategoryProperty)return void this.im(a,t)}else!$d&&a instanceof qs&&($d=!0,j('Model.setDataProperty is modifying a GraphObject, "'+a.toString()+'"'),j("  Is that really your intent?"));var e=Zd(a,b);e!==t&&(_d(a,b,t),this.Es(a,b,e,t))},(e=Ad.prototype).set=function(a,b,t){this.setDataProperty(a,b,t)},e.Co=function(a,b){if(b){var t,e=this.lb(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||this.setDataProperty(a,t,b[t])}},e.Ay=function(a,b){this.ss(a,-1,b)},e.ss=function(a,b,t){0>b&&(b=a.length),D(a,b,t),Vd(this,"",Mi,"",a,null,t,null,b)},e.ov=function(a,b){void 0===b&&(b=-1),a===this.Tc&&T("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===b&&(b=a.length-1);var t=a[b];I(a,b),Vd(this,"",Si,"",a,t,null,b,null)},e.Qo=function(a){if(null===a)return"";var b=this.lj;return""===b||void 0===(b=Zd(a,b))?"":"string"==typeof b?b:void T("getCategoryForNodeData found a non-string category for "+a+": "+b)},e.im=function(a,b){if(null!==a){var t=this.lj;if(""!==t)if(this.lb(a)){var e=Zd(a,t);void 0===e&&(e=""),e!==b&&(_d(a,t,b),Vd(this,"nodeCategory",ki,t,a,e,b))}else _d(a,t,b)}},e.km=function(a,b){this.im(b,this.Qo(a))},e.Sl=function(){return!1},e.Vj=function(){return!1},e.ri=function(){return!1},e.ws=function(){return!1},e.Wj=function(){return!1},v.Object.defineProperties(Ad.prototype,{name:{get:function(){return this.xa},set:function(a){var b=this.xa;b!==a&&(this.xa=a,this.g("name",b,a))}},dataFormat:{get:function(){return this.Rm},set:function(a){var b=this.Rm;b!==a&&(this.Rm=a,this.g("dataFormat",b,a))}},isReadOnly:{get:function(){return this.Gg},set:function(a){var b=this.Gg;b!==a&&(this.Gg=a,this.g("isReadOnly",b,a))}},modelData:{get:function(){return this.j},set:function(a){var b=this.j;b!==a&&(this.j=a,this.g("modelData",b,a),this.La(a))}},undoManager:{get:function(){return this.o},set:function(a){var b=this.o;b!==a&&(null!==b&&b.Rx(this),this.o=a,null!==a&&a.Xw(this))}},skipsUndoManager:{get:function(){return this.Wg},set:function(a){this.Wg=a}},nodeKeyProperty:{get:function(){return this.Th},set:function(a){var b=this.Th;b!==a&&(""===a&&T("Model.nodeKeyProperty may not be the empty string"),0<this.kb.count&&T("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Th=a,this.g("nodeKeyProperty",b,a))}},makeUniqueKeyFunction:{get:function(){return this.al},set:function(a){var b=this.al;b!==a&&(this.al=a,this.g("makeUniqueKeyFunction",b,a))}},nodeDataArray:{get:function(){return this.Tc},set:function(a){var b=this.Tc;if(b!==a){this.kb.clear(),this.Lv();for(var t=a.length,e=0;e<t;e++){var n=a[e];F(n)||T("Model.nodeDataArray must only contain Objects, not: "+n),lt(n)}for(this.Tc=a,e=new ot,n=0;n<t;n++){var o=a[n],g=this.wa(o);void 0===g||null!==this.kb.I(g)?e.add(o):this.kb.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.$u(n),void 0!==(o=this.wa(n))&&this.kb.add(o,n);for(Vd(this,"nodeDataArray",ki,"nodeDataArray",this,b,a),b=0;b<t;b++)e=a[b],this.em(e),this.dm(e);Array.isArray(a)||(this.isReadOnly=!0)}}},copyNodeDataFunction:{get:function(){return this.Ak},set:function(a){var b=this.Ak;b!==a&&(this.Ak=a,this.g("copyNodeDataFunction",b,a))}},copiesArrays:{get:function(){return this.Jm},set:function(a){var b=this.Jm;b!==a&&(this.Jm=a,this.g("copiesArrays",b,a))}},copiesArrayObjects:{get:function(){return this.Im},set:function(a){var b=this.Im;b!==a&&(this.Im=a,this.g("copiesArrayObjects",b,a))}},copiesKey:{get:function(){return this.Lm},set:function(a){var b=this.Lm;b!==a&&(this.Lm=a,this.g("copiesKey",b,a))}},afterCopyFunction:{get:function(){return this.wm},set:function(a){var b=this.wm;b!==a&&(this.wm=a,this.g("afterCopyFunction",b,a))}},nodeCategoryProperty:{get:function(){return this.lj},set:function(a){var b=this.lj;b!==a&&(this.lj=a,this.g("nodeCategoryProperty",b,a))}},type:{get:function(){return"Model"}}}),Ad.prototype.setCategoryForNodeData=Ad.prototype.im,Ad.prototype.getCategoryForNodeData=Ad.prototype.Qo,Ad.prototype.removeArrayItem=Ad.prototype.ov,Ad.prototype.insertArrayItem=Ad.prototype.ss,Ad.prototype.addArrayItem=Ad.prototype.Ay,Ad.prototype.assignAllDataProperties=Ad.prototype.Co,Ad.prototype.set=Ad.prototype.set,Ad.prototype.clearUnresolvedReferences=Ad.prototype.Qy,Ad.prototype.mergeNodeDataArray=Ad.prototype.$z,Ad.prototype.removeNodeDataCollection=Ad.prototype.nA,Ad.prototype.removeNodeData=Ad.prototype.bm,Ad.prototype.addNodeDataCollection=Ad.prototype.Fy,Ad.prototype.addNodeData=Ad.prototype.xf,Ad.prototype.makeNodeDataKeyUnique=Ad.prototype.$u,Ad.prototype.findNodeDataForKey=Ad.prototype.ic,Ad.prototype.containsNodeData=Ad.prototype.lb,Ad.prototype.setKeyForNodeData=Ad.prototype.jm,Ad.prototype.getKeyForNodeData=Ad.prototype.wa,Ad.prototype.updateTargetBindings=Ad.prototype.La,Ad.prototype.commit=Ad.prototype.commit,Ad.prototype.rollbackTransaction=Ad.prototype.Kf,Ad.prototype.commitTransaction=Ad.prototype.eb,Ad.prototype.startTransaction=Ad.prototype.Ea,Ad.prototype.raiseDataChanged=Ad.prototype.Es,Ad.prototype.raiseChanged=Ad.prototype.g,Ad.prototype.raiseChangedEvent=Ad.prototype.cb,Ad.prototype.removeChangedListener=Ad.prototype.hk,Ad.prototype.addChangedListener=Ad.prototype.Pe,Ad.prototype.writeJsonValue=Ad.prototype.rm,Ad.prototype.replaceJsonObjects=Ad.prototype.cm,Ad.prototype.applyIncrementalJSON=Ad.prototype.Ky,Ad.prototype.applyIncrementalJson=Ad.prototype.Zw,Ad.prototype.toJSON=Ad.prototype.toJSON,Ad.prototype.toJson=Ad.prototype.mp,Ad.prototype.toIncrementalJSON=Ad.prototype.yA,Ad.prototype.toIncrementalJson=Ad.prototype.$x,Ad.prototype.toIncrementalData=Ad.prototype.xA,Ad.prototype.clear=Ad.prototype.clear;var $d=!1,Qd={};function tp(a,b,t,e){ht(this),this._isFrozen=!1,void 0===a&&(a=""),void 0===b&&(b=a),void 0===t&&(t=null),this.j=-1,this.xd=null,this.wl=a,this.vl=this.so=0,this.Br=null,this.vn=!1,this.rl=b,this.Hm=t,void 0===e?(this.dl=np,this.vk=null):(this.dl=op,this.vk=e),this.rt=new at}function ep(a,b,t){return null===(a=a.sourceName)||""===a?b:"/"===a?t.part:"."===a?t:".."===a?t.panel:b.fb(a)}Ad.className="Model",Ad.fromJSON=Ad.fromJson=function(a,b){void 0===b&&(b=null);var t=null;if("string"==typeof a)try{t=M.JSON.parse(a)}catch(t){}else"object"==typeof a?t=a:T("Unable to construct a Model from: "+a);if(null===b){a=null;var e=t.class;if("string"==typeof e)try{var n=null;0===e.indexOf("go.")?n=Jd(e=e.substr(3)):null===(n=Jd(e))&&(n=M[e]),"function"==typeof n&&(a=new n)}catch(t){}null===a||a instanceof Ad?b=a:T("Unable to construct a Model of declared class: "+t.class)}return null===b&&(b=Ad.constructGraphLinksModel()),b.fp(t),b.kv(t),b},Ad.safePropertyValue=Zd,Ad.safePropertySet=_d,Qd.Brush=Ha,Qd.ChangedEvent=bi,Qd.Geometry=Qe,Qd.Margin=oe,Qd.Panel=Eh,Qd.Point=St,Qd.Rect=Ut,Qd.Size=Vt,Qd.Spot=qe,Qd.Transaction=Pi,Qd.UndoManager=Ni,tp.prototype.copy=function(){var a=new tp;return a.wl=this.wl,a.so=this.so,a.vl=this.vl,a.Br=this.Br,a.vn=this.vn,a.rl=this.rl,a.Hm=this.Hm,a.dl=this.dl,a.vk=this.vk,a},(e=tp.prototype).qb=function(a){a.classType===tp&&(this.mode=a)},e.toString=function(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.Ai?" "+this.Ai:"")+" "+this.mode.name+")"},e.freeze=function(){return this._isFrozen=!0,this},e.ka=function(){return this._isFrozen=!1,this},e.Kx=function(a){return void 0===a&&(a=null),this.mode=op,this.backConverter=a,this},e.bp=function(a){return void 0===a&&(a=""),this.sourceName=a,this.isToModel=!1,this},e.dA=function(){return this.sourceName=null,this.isToModel=!0,this},e.Mv=function(a,b,t){var e=this.rl;if(void 0===t||""===e||e===t){t=this.wl;var n=this.Hm;if(null===n&&""===t)j("Binding error: target property is the empty string: "+this.toString());else{var o=b;if(""!==e&&(o=Zd(b,e)),void 0!==o)if(null===n)""!==t&&_d(a,t,o);else try{if(""!==t)_d(a,t,n(o,a));else n(o,a)}catch(t){}}}},e.rp=function(a,b,t,e){if(this.dl===op){var n=this.wl;if(void 0===t||n===t){t=this.rl;var o=this.vk,g=a;if(""!==n&&(g=Zd(a,n)),void 0!==g&&!this.rt.contains(a))try{this.rt.add(a);var r=null!==e?e.diagram:null,h=null!==r?r.model:null;if(null===o){if(""!==t)null!==h?h.setDataProperty(b,t,g):_d(b,t,g);else if(null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var l=e.itemIndex,c=e.panel.itemArray;h.ov(c,l),h.ss(c,l,g)}}else try{if(""!==t){var f=o(g,b,h);null!==h?h.setDataProperty(b,t,f):_d(b,t,f)}else{var p=o(g,b,h);if(void 0!==p&&null!==h&&null!==e&&0<=e.itemIndex&&null!==e.panel&&Array.isArray(e.panel.itemArray)){var q=e.itemIndex,d=e.panel.itemArray;h.ov(d,q),h.ss(d,q,p)}}}catch(t){}}finally{this.rt.remove(a)}}}},v.Object.defineProperties(tp.prototype,{Ai:{get:function(){return this.j},set:function(a){this._isFrozen&&L(this),this.j=a}},targetProperty:{get:function(){return this.wl},set:function(a){this._isFrozen&&L(this),this.wl=a}},sourceName:{get:function(){return this.Br},set:function(a){this._isFrozen&&L(this),this.Br=a,null!==a&&(this.vn=!1)}},isToModel:{get:function(){return this.vn},set:function(a){this._isFrozen&&L(this),this.vn=a}},sourceProperty:{get:function(){return this.rl},set:function(a){this._isFrozen&&L(this),this.rl=a}},converter:{get:function(){return this.Hm},set:function(a){this._isFrozen&&L(this),this.Hm=a}},backConverter:{get:function(){return this.vk},set:function(a){this._isFrozen&&L(this),this.vk=a}},mode:{get:function(){return this.dl},set:function(a){this._isFrozen&&L(this),this.dl=a}}}),tp.prototype.updateSource=tp.prototype.rp,tp.prototype.updateTarget=tp.prototype.Mv,tp.prototype.ofModel=tp.prototype.dA,tp.prototype.ofObject=tp.prototype.bp,tp.prototype.makeTwoWay=tp.prototype.Kx;var ip="Binding",np=new W(tp,"OneWay",1),op=new W(tp,"TwoWay",2);function sp(a,b,t){Ad.call(this),this.Vv=',\n  "insertedLinkKeys": ',this.iy=',\n  "modifiedLinkData": ',this.Xv=',\n  "removedLinkKeys": ',this.md=[],this.$f=new at,this.xb=new Mt,this.Jh="",this.Ri=this.zk=this.bl=null,this.lf="from",this.mf="to",this.fj=this.ej="",this.dj="category",this.je="",this.il="isGroup",this.Je="group",this.Km=!1,void 0!==b&&(this.linkDataArray=b),void 0!==a&&(O(a)?this.nodeDataArray=a:t=a),t&&(Object.assign(this,t),a=t.Changed)&&(delete this.Changed,this.Pe(a))}function ap(a,b){for(var t=new at,e=0;e<a.linkDataArray.length;e++){var n=a.linkDataArray[e];Dd(a,b,n,n,t)}return t}function br(a,b,t){if(null!==b&&(""!==(a=t?a.lf:a.mf)&&void 0!==(a=Zd(b,a)))){if(Yd(a))return a;T((t?"FromKey":"ToKey")+" value for link data "+b+" is not a number or a string: "+a)}}function hp(a,b,t,e){if(null===t&&(t=void 0),null!==b){var n=e?a.lf:a.mf;if(""!==n)if(t=a.Ul(t),a.Jc(b)){var o=Zd(b,n);o!==t&&(hr(a,o,b),_d(b,n,t),null===a.ic(t)&&Ud(a,t,b),Vd(a,e?"linkFromKey":"linkToKey",ki,n,b,o,t),"string"==typeof n&&a.La(b,n))}else _d(b,n,t)}}function lp(a,b,t){return null===b||""===(a=t?a.ej:a.fj)||void 0===(b=Zd(b,a))?"":b}function up(a,b,t,e){if(null!==b){var n=e?a.ej:a.fj;if(""!==n)if(a.Jc(b)){var o=Zd(b,n);void 0===o&&(o=""),o!==t&&(_d(b,n,t),Vd(a,e?"linkFromPortId":"linkToPortId",ki,n,b,o,t),"string"==typeof n&&a.La(b,n))}else _d(b,n,t)}}function cp(a,b,t){if(""!==a.linkKeyProperty){var e=a.Ac(b);if(void 0!==e&&a.xb.I(e)===b)return;a.As(b),void 0===(e=a.Ac(b))&&T("GraphLinksModel.makeLinkDataKeyUnique failed on "+b+". Data not added to model."),a.xb.add(e,b)}a.$f.add(b),e=null,t&&(e=a.md.length,a.md.splice(e,0,b)),Vd(a,"linkDataArray",Mi,"linkDataArray",a,null,b,null,e),dp(a,b)}function fp(a,b,t){a.$f.remove(b);var e=a.Ac(b);if(void 0!==e&&a.xb.remove(e),e=null,t){if(0>(e=a.md.indexOf(b)))return;a.md.splice(e,1)}if(Vd(a,"linkDataArray",Si,"linkDataArray",a,b,null,e,null),hr(a,t=br(a,b,!0),b),hr(a,t=br(a,b,!1),b),e=a.Ef(b),Array.isArray(e))for(var n=e.length,o=0;o<n;o++)hr(a,t=e[o],b)}function dp(a,b){var t=br(a,b,!0);t=a.Ul(t),null===a.ic(t)&&Ud(a,t,b),t=br(a,b,!1),t=a.Ul(t),null===a.ic(t)&&Ud(a,t,b);var e=a.Ef(b);if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)t=e[o],null===a.ic(t)&&Ud(a,t,b)}function pp(a,b,t){a.kp(t,a.os(b)),a.wv(t,a.yx(b)),a.Bv(t,a.Bx(b)),a.Ks(t,a.Ef(b)),a.xv(t,a.zx(b)),a.Cv(t,a.Cx(b))}tp.className="Binding",tp.parseEnum=function(a,b){return function(t){return null===(t=J(a,t))?b:t}},tp.toString=V,tp.OneWay=np,tp.TwoWay=op,y(sp,Ad),sp.constructGraphLinksModel=Ad.constructGraphLinksModel,sp.prototype.cloneProtected=function(a){Ad.prototype.cloneProtected.call(this,a),a.Jh=this.Jh,a.bl=this.bl,a.zk=this.zk,a.lf=this.lf,a.mf=this.mf,a.ej=this.ej,a.fj=this.fj,a.dj=this.dj,a.je=this.je,a.il=this.il,a.Je=this.Je,a.Km=this.Km},(e=sp.prototype).clear=function(){Ad.prototype.clear.call(this),this.md=[],this.xb.clear(),this.$f.clear()},e.toString=function(a){if(void 0===a&&(a=0),2<=a)return this.mp();var b=(""!==this.name?this.name:"")+" GraphLinksModel";if(0<a){b+="\n node data:";var t,e=(a=this.nodeDataArray).length;for(t=0;t<e;t++){var n=a[t];b+=" "+this.wa(n)+":"+V(n)}for(b+="\n link data:",e=(a=this.linkDataArray).length,t=0;t<e;t++)b+=" "+br(this,n=a[t],!0)+"--\x3e"+br(this,n,!1)}return b},e.Qv=function(a,b){""===this.linkKeyProperty&&T("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalData() to succeed.");var t=Ad.prototype.Qv.call(this,a,b),e=this,n=new at,o=new at,g=new at,r=this.vh;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Mi?n.add(a.newValue):a.change===Si&&g.add(a.oldValue):e.Jc(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.Jc(a)&&o.add(a)})):a.object instanceof Ad||e.lb(a.object)||ap(e,a.object).each((function(a){o.add(a)}))))}));var h=this.hl;h.clear(),n.each((function(a){h.add(e.Ac(a)),b||o.add(a)}));var l=this.jl;return l.clear(),g.each((function(a){l.add(e.Ac(a)),b&&o.add(a)})),a=e.cloneDeep(o.Fa()),0<h.count&&(null===t&&(t={}),b?t.removedLinkKeys=h.Fa():t.insertedLinkKeys=h.Fa()),0<a.length&&(null===t&&(t={}),t.modifiedLinkData=a),0<l.count&&(null===t&&(t={}),b?t.insertedLinkKeys=l.Fa():t.removedLinkKeys=l.Fa()),l.clear(),h.clear(),t},e.qm=function(){var a=Ad.prototype.qm.call(this),b="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(b+=',\n  "linkCategoryProperty": '+this.quote(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(b+=',\n  "linkKeyProperty": '+this.quote(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(b+=',\n  "linkFromKeyProperty": '+this.quote(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(b+=',\n  "linkToKeyProperty": '+this.quote(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(b+=',\n  "linkFromPortIdProperty": '+this.quote(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(b+=',\n  "linkToPortIdProperty": '+this.quote(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(b+=',\n  "linkLabelKeysProperty": '+this.quote(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(b+=',\n  "nodeIsGroupProperty": '+this.quote(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(b+=',\n  "nodeGroupKeyProperty": '+this.quote(this.nodeGroupKeyProperty)),a+b},e.fp=function(a){Ad.prototype.fp.call(this,a),a.linkKeyProperty&&(this.linkKeyProperty=a.linkKeyProperty),a.linkFromKeyProperty&&(this.linkFromKeyProperty=a.linkFromKeyProperty),a.linkToKeyProperty&&(this.linkToKeyProperty=a.linkToKeyProperty),a.linkFromPortIdProperty&&(this.linkFromPortIdProperty=a.linkFromPortIdProperty),a.linkToPortIdProperty&&(this.linkToPortIdProperty=a.linkToPortIdProperty),a.linkCategoryProperty&&(this.linkCategoryProperty=a.linkCategoryProperty),a.linkLabelKeysProperty&&(this.linkLabelKeysProperty=a.linkLabelKeysProperty),a.nodeIsGroupProperty&&(this.nodeIsGroupProperty=a.nodeIsGroupProperty),a.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=a.nodeGroupKeyProperty)},e.Rv=function(){return Ad.prototype.Rv.call(this)+(',\n  "linkDataArray": '+tr(this,this.linkDataArray,!0))},e.kv=function(a){Ad.prototype.kv.call(this,a),a=a.linkDataArray,Array.isArray(a)&&(this.cm(a),this.linkDataArray=a)},e.Pv=function(a,b){""===this.linkKeyProperty&&T("GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed.");var t=Ad.prototype.Pv.call(this,a,b),e=this,n=new at,o=new at,g=new at,r=this.vh;a.changes.each((function(a){a.model===e&&("linkDataArray"===a.modelChange?a.change===Mi?n.add(a.newValue):a.change===Si&&g.add(a.oldValue):e.Jc(a.object)?o.add(a.object):null!==a.object&&(null!==a.object&&r&&r.contains(a.object)?r.get(a.object).each((function(a){e.Jc(a)&&o.add(a)})):a.object instanceof Ad||e.lb(a.object)||ap(e,a.object).each((function(a){o.add(a)}))))}));var h=this.hl;h.clear(),n.each((function(a){h.add(e.Ac(a)),b||o.add(a)}));var l=this.jl;return l.clear(),g.each((function(a){l.add(e.Ac(a)),b&&o.add(a)})),a=t,0<h.count&&(a+=(b?this.Xv:this.Vv)+tr(this,h.Fa(),!0)),0<o.count&&(a+=this.iy+tr(this,o.Fa(),!0)),0<l.count&&(a+=(b?this.Vv:this.Xv)+tr(this,l.Fa(),!0)),l.clear(),h.clear(),a},e.ep=function(a){(void 0!==a.linkCategoryProperty&&a.linkCategoryProperty!==this.linkCategoryProperty||void 0!==a.linkKeyProperty&&a.linkKeyProperty!==this.linkKeyProperty||void 0!==a.linkFromKeyProperty&&a.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==a.linkToKeyProperty&&a.linkToKeyProperty!==this.linkToKeyProperty||void 0!==a.linkFromPortIdProperty&&a.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==a.linkToPortIdProperty&&a.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==a.linkLabelKeysProperty&&a.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==a.nodeIsGroupProperty&&a.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==a.nodeGroupKeyProperty&&a.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&T("applyIncrementalJson cannot change Model properties"),Ad.prototype.ep.call(this,a);var b=a.insertedLinkKeys;if(Array.isArray(b))for(var t=b.length,e=0;e<t;e++){var n=b[e],o=this.jh(n);null===o&&(o=this.Io({}),this.Js(o,n),this.fi(o))}if(b=a.modifiedLinkData,Array.isArray(b))for(t=b.length,e=0;e<t;e++)if(n=b[e],o=this.Ac(n),null!==(o=this.jh(o))){for(var g in n)"__gohashid"!==g&&g!==this.linkKeyProperty&&this.setDataProperty(o,g,n[g]);pp(this,n,o)}if(a=a.removedLinkKeys,Array.isArray(a))for(g=a.length,b=0;b<g;b++)null!==(t=this.jh(a[b]))&&this.am(t)},sp.prototype.changeState=function(a,b){if(null!==a&&a.model===this){if(a.change===ki){var t=a.object,e=a.propertyName;if(e===this.linkKeyProperty&&this.Jc(t)){var n=a.I(b);return void 0!==(b=a.I(!b))&&this.xb.remove(b),void 0!==n&&this.xb.add(n,t),void _d(t,e,n)}}else if(a.change===Mi){if(t=a.newParam,"linkDataArray"===a.modelChange)return void(F(a=a.newValue)&&"number"==typeof t&&(e=this.Ac(a),b?(this.$f.remove(a),this.md[t]===a&&this.md.splice(t,1),void 0!==e&&this.xb.remove(e)):(this.$f.add(a),this.md[t]!==a&&this.md.splice(t,0,a),void 0!==e&&this.xb.add(e,a))));if("linkLabelKeys"===a.modelChange)return e=this.Ef(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1)):0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue)))}else if(a.change===Si){if(t=a.oldParam,"linkDataArray"===a.modelChange)return void(F(a=a.oldValue)&&"number"==typeof t&&(e=this.Ac(a),b?(this.$f.add(a),this.md[t]!==a&&this.md.splice(t,0,a),void 0!==e&&this.xb.add(e,a)):(this.$f.remove(a),this.md[t]===a&&this.md.splice(t,1),void 0!==e&&this.xb.remove(e))));if("linkLabelKeys"===a.modelChange)return e=this.Ef(a.object),void(Array.isArray(e)&&"number"==typeof t&&(b?0>e.indexOf(a.newValue)&&e.splice(t,0,a.newValue):(t=e.indexOf(a.newValue),0<=t&&e.splice(t,1))))}Ad.prototype.changeState.call(this,a,b)}},(e=sp.prototype).Ul=function(a){if(void 0!==a){var b=this.Ri;if(null!==b){var t=this.ic(a);null===t&&(_d(t=this.copyNodeData(b),this.nodeKeyProperty,a),this.xf(t))}return a}},e.yx=function(a){return br(this,a,!0)},e.wv=function(a,b){hp(this,a,b,!0)},e.Bx=function(a){return br(this,a,!1)},e.Bv=function(a,b){hp(this,a,b,!1)},e.zx=function(a){return lp(this,a,!0)},e.xv=function(a,b){up(this,a,b,!0)},e.Cx=function(a){return lp(this,a,!1)},e.Cv=function(a,b){up(this,a,b,!1)},e.Ef=function(a){if(null===a)return gp;var b=this.je;return""===b||void 0===(a=Zd(a,b))?gp:a},e.Ks=function(a,b){if(null!==a){var t=this.je;if(""!==t)if(this.Jc(a)){var e=Zd(a,t);if(void 0===e&&(e=gp),e!==b){if(Array.isArray(e))for(var n=e.length,o=0;o<n;o++)hr(this,e[o],a);for(_d(a,t,b),n=b.length,o=0;o<n;o++){var g=b[o];null===this.ic(g)&&Ud(this,g,a)}Vd(this,"linkLabelKeys",ki,t,a,e,b),"string"==typeof t&&this.La(a,t)}}else _d(a,t,b)}},e.Au=function(a,b){if(null!=b&&null!==a){var t=this.je;if(""!==t){var e=Zd(a,t);if(void 0===e)(t=[]).push(b),this.Ks(a,t);else if(Array.isArray(e)){var n=e.indexOf(b);0<=n||(n=e.length,e.push(b),this.Jc(a)&&(null===this.ic(b)&&Ud(this,b,a),Vd(this,"linkLabelKeys",Mi,t,a,null,b,null,n)))}else T(t+" property is not an Array; cannot addLabelKeyForLinkData: "+a)}}},e.Qx=function(a,b){if(null!=b&&null!==a){var t=this.je;if(""!==t){var e=Zd(a,t);if(Array.isArray(e)){var n=e.indexOf(b);0>n||(e.splice(n,1),this.Jc(a)&&(hr(this,b,a),Vd(this,"linkLabelKeys",Si,t,a,b,null,n,null)))}else void 0!==e&&T(t+" property is not an Array; cannot removeLabelKeyforLinkData: "+a)}}},e.Ac=function(a){if(null!==a){var b=this.Jh;if(""!==b&&void 0!==(b=Zd(a,b))){if(Yd(b))return b;T("Key value for link data "+a+" is not a number or a string: "+b)}}},e.Js=function(a,b){if(null!==a){var t=this.Jh;if(""!==t)if(this.Jc(a)){var e=Zd(a,t);e!==b&&null===this.jh(b)&&(_d(a,t,b),void 0!==e&&this.xb.remove(e),this.xb.add(b,a),Vd(this,"linkKey",ki,t,a,e,b),"string"==typeof t&&this.La(a,t))}else _d(a,t,b)}},e.jh=function(a){return null===a&&T("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==a&&Yd(a)?this.xb.I(a):null},e.As=function(a){if(null!==a){var b=this.Jh;if(""!==b){var t=this.Ac(a);if(void 0===t||this.xb.contains(t)){var e=this.bl;if(null!==e&&(null!=(t=e(this,a))&&!this.xb.contains(t)))return void _d(a,b,t);if("string"==typeof t){for(e=2;this.xb.contains(t+e);)e++;_d(a,b,t+e)}else if(void 0===t||"number"==typeof t){for(t=-this.xb.count-1;this.xb.contains(t);)t--;_d(a,b,t)}}}}},e.Jc=function(a){return null!==a&&this.$f.contains(a)},e.fi=function(a){null!==a&&(lt(a),this.Jc(a)||cp(this,a,!0))},e.Ey=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.fi(a[t]);else for(a=a.iterator;a.next();)this.fi(a.value)},e.am=function(a){null!==a&&fp(this,a,!0)},e.lA=function(a){if(Array.isArray(a))for(var b=a.length,t=0;t<b;t++)this.am(a[t]);else for(a=a.iterator;a.next();)this.am(a.value)},e.Zz=function(a){if(""===this.linkKeyProperty&&T("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),a!==this.linkDataArray&&O(a)){var b=this.jl;b.clear(),b.addAll(this.xb.iteratorKeys);var t=this.hl;t.clear();for(var e=a.length,n=0;n<e;n++){var o=a[n],g=this.Ac(o);if(void 0!==g){t.add(g);var r=this.jh(g);r!==o&&(null!==r?(this.Co(r,o),pp(this,o,r)):(o=this.cloneDeep(o),this.Js(o,g),this.fi(o)))}else g=this.cloneDeep(o),this.fi(g),t.add(this.Ac(g))}for(a=b.iterator;a.next();)e=a.value,t.contains(e)||(e=this.jh(e))&&this.am(e);b.clear(),t.clear()}},e.Io=function(a){if(null===a)return null;var b=this.zk;return F(a=null!==b?b(a,this):Kd(this,a,!0))&&(ht(a),""!==this.lf&&_d(a,this.lf,void 0),""!==this.mf&&_d(a,this.mf,void 0),""!==this.je&&_d(a,this.je,[])),a},e.Yu=function(a){if(null===a)return!1;var b=this.il;return""!==b&&!!Zd(a,b)},e.lh=function(a){if(null!==a){var b=this.Je;if(""!==b&&void 0!==(b=Zd(a,b))){if(Yd(b))return b;T("GroupKey value for node data "+a+" is not a number or a string: "+b)}}},e.lp=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.Je;if(""!==t)if(this.lb(a)){var e=Zd(a,t);e!==b&&(hr(this,e,a),_d(a,t,b),null===this.ic(b)&&Ud(this,b,a),Vd(this,"nodeGroupKey",ki,t,a,e,b),"string"==typeof t&&this.La(a,t))}else _d(a,t,b)}},sp.prototype.copyNodeData=function(a){return null===a?null:(a=Ad.prototype.copyNodeData.call(this,a),this.Hj||""===this.Je||void 0===Zd(a,this.Je)||_d(a,this.Je,void 0),a)},sp.prototype.setDataProperty=function(a,b,t){if(this.lb(a)){if(b===this.nodeKeyProperty)return void this.jm(a,t);if(b===this.nodeCategoryProperty)return void this.im(a,t);if(b===this.nodeGroupKeyProperty)return void this.lp(a,t)}else if(this.Jc(a)){if(b===this.linkFromKeyProperty)return void hp(this,a,t,!0);if(b===this.linkToKeyProperty)return void hp(this,a,t,!1);if(b===this.linkFromPortIdProperty)return void up(this,a,t,!0);if(b===this.linkToPortIdProperty)return void up(this,a,t,!1);if(b===this.linkKeyProperty)return void this.Js(a,t);if(b===this.linkCategoryProperty)return void this.kp(a,t);if(b===this.linkLabelKeysProperty)return void this.Ks(a,t)}var e=Zd(a,b);e!==t&&(_d(a,b,t),this.Es(a,b,e,t))},(e=sp.prototype).Co=function(a,b){if(b){var t,e=this.lb(a),n=this.Jc(a);for(t in b)"__gohashid"===t||e&&t===this.nodeKeyProperty||e&&t===this.nodeIsGroupProperty&&Zd(a,t)===b[t]||n&&t===this.linkKeyProperty||this.setDataProperty(a,t,b[t])}},e.ip=function(a,b){Ad.prototype.ip.call(this,a,b);for(var t=this.kb.iterator;t.next();)this.qv(t.value,a,b);for(t=this.$f.iterator;t.next();){var e=t.value,n=a,o=b;if(br(this,e,!0)===n){var g=this.lf;_d(e,g,o),Vd(this,"linkFromKey",ki,g,e,n,o),"string"==typeof g&&this.La(e,g)}if(br(this,e,!1)===n&&(_d(e,g=this.mf,o),Vd(this,"linkToKey",ki,g,e,n,o),"string"==typeof g&&this.La(e,g)),g=this.Ef(e),Array.isArray(g))for(var r=g.length,h=this.je,l=0;l<r;l++)g[l]===n&&(g[l]=o,Vd(this,"linkLabelKeys",Mi,h,e,n,o,l,l))}},e.qv=function(a,b,t){if(this.lh(a)===b){var e=this.Je;_d(a,e,t),Vd(this,"nodeGroupKey",ki,e,a,b,t),"string"==typeof e&&this.La(a,e)}},e.Lv=function(){Ad.prototype.Lv.call(this);for(var a=this.linkDataArray,b=a.length,t=0;t<b;t++)dp(this,a[t])},e.em=function(a){Ad.prototype.em.call(this,a);var b=qd(this,a=this.wa(a));if(null!==b){var t=z();for(b=b.iterator;b.next();){var e=b.value;if(this.lb(e)){if(this.lh(e)===a){var n=this.Je;Vd(this,"nodeGroupKey",ki,n,e,a,a),"string"==typeof n&&this.La(e,n),t.push(e)}}else if(br(this,e,!0)===a&&(n=this.lf,Vd(this,"linkFromKey",ki,n,e,a,a),"string"==typeof n&&this.La(e,n),t.push(e)),br(this,e,!1)===a&&(n=this.mf,Vd(this,"linkToKey",ki,n,e,a,a),"string"==typeof n&&this.La(e,n),t.push(e)),n=this.Ef(e),Array.isArray(n))for(var o=n.length,g=this.je,r=0;r<o;r++)n[r]===a&&(Vd(this,"linkLabelKeys",Mi,g,e,a,a,r,r),t.push(e))}for(b=0;b<t.length;b++)hr(this,a,t[b]);R(t)}},e.dm=function(a){Ad.prototype.dm.call(this,a);var b=this.lh(a);null===this.ic(b)&&Ud(this,b,a)},e.pp=function(a){Ad.prototype.pp.call(this,a),hr(this,this.lh(a),a)},e.os=function(a){if(null===a)return"";var b=this.dj;return""===b||void 0===(b=Zd(a,b))?"":"string"==typeof b?b:void T("getCategoryForLinkData found a non-string category for "+a+": "+b)},sp.prototype.getLinkCategoryForData=function(a){return this.os(a)},sp.prototype.kp=function(a,b){if(null!==a){var t=this.dj;if(""!==t)if(this.Jc(a)){var e=Zd(a,t);void 0===e&&(e=""),e!==b&&(_d(a,t,b),Vd(this,"linkCategory",ki,t,a,e,b),"string"==typeof t&&this.La(a,t))}else _d(a,t,b)}},sp.prototype.setLinkCategoryForData=function(a,b){this.kp(a,b)},(e=sp.prototype).km=function(a,b){Ad.prototype.km.call(this,a,b),this.lp(b,this.lh(a))},e.Vj=function(){return!0},e.ri=function(){return!0},e.ws=function(){return!0},e.Wj=function(){return!0},v.Object.defineProperties(sp.prototype,{archetypeNodeData:{get:function(){return this.Ri},set:function(a){var b=this.Ri;b!==a&&(this.Ri=a,this.g("archetypeNodeData",b,a))}},linkFromKeyProperty:{get:function(){return this.lf},set:function(a){var b=this.lf;b!==a&&(this.lf=a,this.g("linkFromKeyProperty",b,a))}},linkToKeyProperty:{get:function(){return this.mf},set:function(a){var b=this.mf;b!==a&&(this.mf=a,this.g("linkToKeyProperty",b,a))}},linkFromPortIdProperty:{get:function(){return this.ej},set:function(a){var b=this.ej;b!==a&&(this.ej=a,this.g("linkFromPortIdProperty",b,a))}},linkToPortIdProperty:{get:function(){return this.fj},set:function(a){var b=this.fj;b!==a&&(this.fj=a,this.g("linkToPortIdProperty",b,a))}},linkLabelKeysProperty:{get:function(){return this.je},set:function(a){var b=this.je;b!==a&&(this.je=a,this.g("linkLabelKeysProperty",b,a))}},linkDataArray:{get:function(){return this.md},set:function(a){var b=this.md;if(b!==a){this.xb.clear();for(var t=a.length,e=0;e<t;e++){var n=a[e];F(n)||T("GraphLinksModel.linkDataArray must only contain Objects, not: "+n),lt(n)}if(this.md=a,""!==this.linkKeyProperty){for(e=new ot,n=0;n<t;n++){var o=a[n],g=this.Ac(o);void 0===g||null!==this.xb.I(g)?e.add(o):this.xb.add(g,o)}for(e=e.iterator;e.next();)n=e.value,this.As(n),void 0!==(o=this.Ac(n))&&this.xb.add(o,n)}for(e=new at,n=0;n<t;n++)e.add(a[n]);for(this.$f=e,Vd(this,"linkDataArray",ki,"linkDataArray",this,b,a),b=0;b<t;b++)dp(this,a[b])}}},linkKeyProperty:{get:function(){return this.Jh},set:function(a){var b=this.Jh;if(b!==a){this.Jh=a,this.xb.clear();for(var t=this.linkDataArray.length,e=0;e<t;e++){var n=this.linkDataArray[e],o=this.Ac(n);void 0===o&&(this.As(n),o=this.Ac(n)),void 0!==o&&this.xb.add(o,n)}this.g("linkKeyProperty",b,a)}}},makeUniqueLinkKeyFunction:{get:function(){return this.bl},set:function(a){var b=this.bl;b!==a&&(this.bl=a,this.g("makeUniqueLinkKeyFunction",b,a))}},copyLinkDataFunction:{get:function(){return this.zk},set:function(a){var b=this.zk;b!==a&&(this.zk=a,this.g("copyLinkDataFunction",b,a))}},nodeIsGroupProperty:{get:function(){return this.il},set:function(a){var b=this.il;b!==a&&(this.il=a,this.g("nodeIsGroupProperty",b,a))}},nodeGroupKeyProperty:{get:function(){return this.Je},set:function(a){var b=this.Je;b!==a&&(this.Je=a,this.g("nodeGroupKeyProperty",b,a))}},Hj:{get:function(){return this.Km},set:function(a){this.Km!==a&&(this.Km=a)}},linkCategoryProperty:{get:function(){return this.dj},set:function(a){var b=this.dj;b!==a&&(this.dj=a,this.g("linkCategoryProperty",b,a))}},type:{get:function(){return"GraphLinksModel"}}}),sp.prototype.setCategoryForLinkData=sp.prototype.kp,sp.prototype.getCategoryForLinkData=sp.prototype.os,sp.prototype.assignAllDataProperties=sp.prototype.Co,sp.prototype.setGroupKeyForNodeData=sp.prototype.lp,sp.prototype.getGroupKeyForNodeData=sp.prototype.lh,sp.prototype.isGroupForNodeData=sp.prototype.Yu,sp.prototype.copyLinkData=sp.prototype.Io,sp.prototype.mergeLinkDataArray=sp.prototype.Zz,sp.prototype.removeLinkDataCollection=sp.prototype.lA,sp.prototype.removeLinkData=sp.prototype.am,sp.prototype.addLinkDataCollection=sp.prototype.Ey,sp.prototype.addLinkData=sp.prototype.fi,sp.prototype.containsLinkData=sp.prototype.Jc,sp.prototype.makeLinkDataKeyUnique=sp.prototype.As,sp.prototype.findLinkDataForKey=sp.prototype.jh,sp.prototype.setKeyForLinkData=sp.prototype.Js,sp.prototype.getKeyForLinkData=sp.prototype.Ac,sp.prototype.removeLabelKeyForLinkData=sp.prototype.Qx,sp.prototype.addLabelKeyForLinkData=sp.prototype.Au,sp.prototype.setLabelKeysForLinkData=sp.prototype.Ks,sp.prototype.getLabelKeysForLinkData=sp.prototype.Ef,sp.prototype.setToPortIdForLinkData=sp.prototype.Cv,sp.prototype.getToPortIdForLinkData=sp.prototype.Cx,sp.prototype.setFromPortIdForLinkData=sp.prototype.xv,sp.prototype.getFromPortIdForLinkData=sp.prototype.zx,sp.prototype.setToKeyForLinkData=sp.prototype.Bv,sp.prototype.getToKeyForLinkData=sp.prototype.Bx,sp.prototype.setFromKeyForLinkData=sp.prototype.wv,sp.prototype.getFromKeyForLinkData=sp.prototype.yx,sp.prototype.clear=sp.prototype.clear;var gp=Object.freeze([]);function mp(a,b){Ad.call(this),this.Ke="parent",this.Mm=!1,this.nj="parentLinkCategory",void 0!==a&&(O(a)?this.nodeDataArray=a:b=a),b&&(Object.assign(this,b),a=b.Changed)&&(delete this.Changed,this.Pe(a))}function yp(a){Uf.call(this),this.lw=this.Ym=this.mc=0,this.Vp=360,this.kw=Lp,this.Ti=0,this.Zv=new St,this.Ip=this.me=0,this.Wr=new Up,this.ft=this.mj=0,this.ty=600,this.co=NaN,this.Bm=1,this.qo=0,this.tl=360,this.Sb=Lp,this.K=Op,this.nd=Yp,this.hd=Qf,this.tf=6,this.Mn=Gp,a&&Object.assign(this,a)}function vp(a,b,t,e,n){var o=a.Vp,g=a.mc;a=a.me,e=e*Math.PI/180,t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=e+(n===Op?h*t/(360<=o?r:r-1):-h*t/r),c=b.M(h),f=g*Math.tan(l)/a;f=Math.sqrt((g*g+a*a*f*f)/(1+f*f)),c.centerX=f*Math.cos(l),c.centerY=f*Math.sin(l),c.actualAngle=180*l/Math.PI}}function xp(a,b,t,e){var n=a.mc,o=a.me,g=a.Ti;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.M(h),c=b.M(h===r-1?0:h+1),f=o*Math.sin(t);l.centerX=n*Math.cos(t),l.centerY=f,l.actualAngle=180*t/Math.PI,isNaN(l.diameter)&&Hp(l,0),isNaN(c.diameter)&&Hp(c,0),l=Tp(a,n,o,e===Op?t:-t,(l.diameter+c.diameter)/2+g),t+=e===Op?l:-l}}function bp(a,b,t,e){var n=a.mc,o=a.me,g=a.Ip;t=t*Math.PI/180;for(var r=b.length,h=0;h<r;h++){var l=b.M(h);l.centerX=n*Math.cos(t),l.centerY=o*Math.sin(t),l.actualAngle=180*t/Math.PI,l=Tp(a,n,o,e===Op?t:-t,g),t+=e===Op?l:-l}}function wp(a,b,t,e,n){var o=a.Vp;if(a.mj=0,a.Wr=new Up,360>t){for(o=e+(n===Op?o:-o);0>o;)o+=360;180<(o%=360)&&(o-=360),o*=Math.PI/180,a.ft=o,Mp(a,b,t,e,n)}else kp(a,b,t,e,n);a.Wr.commit(b)}function kp(a,b,t,e,n){var o=a.mc,g=a.Ti,r=a.Ym,h=o*Math.cos(e*Math.PI/180),l=a.me*Math.sin(e*Math.PI/180),c=b.Fa();if(3===c.length)c[0].centerX=o,c[0].centerY=0,c[1].centerX=c[0].centerX-c[0].width/2-c[1].width/2-g,c[1].y=c[0].y,c[2].centerX=(c[0].centerX+c[1].centerX)/2,c[2].y=c[0].y-c[2].height-g;else if(4===c.length)c[0].centerX=o,c[0].centerY=0,c[2].centerX=-c[0].centerX,c[2].centerY=c[0].centerY,c[1].centerX=0,c[1].y=Math.min(c[0].y,c[2].y)-c[1].height-g,c[3].centerX=0,c[3].y=Math.max(c[0].y+c[0].height+g,c[2].y+c[2].height+g);else{o=St.alloc();for(var f=0;f<c.length&&(c[f].centerX=h,c[f].centerY=l,!(f>=c.length-1));f++)Sp(a,h,l,c,f,n,o)||Pp(a,h,l,c,f,n,o),h=o.x,l=o.y;if(St.free(o),a.mj++,!(23<a.mj)){h=c[0].centerX,l=c[0].centerY,o=c[c.length-1].centerX,f=c[c.length-1].centerY;var p=Math.abs(h-o)-((c[0].width+c[c.length-1].width)/2+g),q=Math.abs(l-f)-((c[0].height+c[c.length-1].height)/2+g);g=0,1>Math.abs(q)?Math.abs(h-o)<(c[0].width+c[c.length-1].width)/2&&(g=0):g=0<q?q:1>Math.abs(p)?0:p,h=Math.abs(o)>Math.abs(f)?0<o!=l>f:0<f!=h<o,(h=n===Op?h:!h)&&(g=-Math.abs(g),g=Math.min(g,-c[c.length-1].width),g=Math.min(g,-c[c.length-1].height)),a.Wr.compare(g,c),1<Math.abs(g)&&(a.mc=8>a.mj?a.mc-g/(2*Math.PI):5>c.length&&10<g?a.mc/2:a.mc-(0<g?1.7:-2.3),a.me=a.mc*r,kp(a,b,t,e,n))}}}function Mp(a,b,t,e,n){for(var o=a.mc,g=a.me,r=a.Ym,h=o*Math.cos(e*Math.PI/180),l=g*Math.sin(e*Math.PI/180),c=St.alloc(),f=b.Fa(),p=0;p<f.length&&(f[p].centerX=h,f[p].centerY=l,!(p>=f.length-1));p++)Sp(a,h,l,f,p,n,c)||Pp(a,h,l,f,p,n,c),h=c.x,l=c.y;if(St.free(c),a.mj++,!(23<a.mj)){if(h=Math.atan2(l,h),h=n===Op?a.ft-h:h-a.ft,o=(h=Math.abs(h)<Math.abs(h-2*Math.PI)?h:h-2*Math.PI)*(o+g)/2,g=a.Wr,Math.abs(o)<Math.abs(g.Ol))for(g.Ol=o,g.lk=[],g.sm=[],h=0;h<f.length;h++)g.lk[h]=f[h].bounds.x,g.sm[h]=f[h].bounds.y;1<Math.abs(o)&&(a.mc=8>a.mj?a.mc-o/(2*Math.PI):a.mc-(0<o?1.7:-2.3),a.me=a.mc*r,Mp(a,b,t,e,n))}}function Sp(a,b,t,e,n,o,g){var r=a.mc,h=a.me,l=0;a=(e[n].width+e[n+1].width)/2+a.Ti;var c=!1;if(0<=t!=(o===Op)){if((o=b+a)>r){if((o=b-a)<-r)return g.x=o,g.y=l,!1;c=!0}}else if((o=b-a)<-r){if((o=b+a)>r)return g.x=o,g.y=l,!1;c=!0}return l=Math.sqrt(1-Math.min(1,o*o/(r*r)))*h,0>t!==c&&(l=-l),Math.abs(t-l)>(e[n].height+e[n+1].height)/2?(g.x=o,g.y=l,!1):(g.x=o,g.y=l,!0)}function Pp(a,b,t,e,n,o,g){var r=a.mc,h=a.me,l=0;if(a=(e[n].height+e[n+1].height)/2+a.Ti,e=!1,0<=b!=(o===Op)){if((o=t-a)<-h){if((o=t+a)>h)return g.x=l,void(g.y=o);e=!0}}else if((o=t+a)>h){if((o=t-a)<-h)return g.x=l,void(g.y=o);e=!0}l=Math.sqrt(1-Math.min(1,o*o/(h*h)))*r,0>b!==e&&(l=-l),g.x=l,g.y=o}function Np(a,b,t,e,n){var o=a.ty;if(.001>Math.abs(a.Ym-1))return void 0!==e&&void 0!==n?n*b:2*Math.PI*b;a=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t;for(var g=0,r=void 0!==e&&void 0!==n?n/(o+1):Math.PI/(2*(o+1)),h=0,l=0;l<=o;l++){h=void 0!==e&&void 0!==n?e+l*n/o:l*Math.PI/(2*o);var c=Math.sin(h);g+=Math.sqrt(1-a*a*c*c)*r}return void 0!==e&&void 0!==n?(b>t?b:t)*g:4*(b>t?b:t)*g}function Cp(a,b,t,e,n){return b/(void 0!==e&&void 0!==n?Np(a,1,t,e,n):Np(a,1,t))}function Tp(a,b,t,e,n){if(.001>Math.abs(a.Ym-1))return n/b;var o=b>t?Math.sqrt(b*b-t*t)/b:Math.sqrt(t*t-b*b)/t,g=0;a=2*Math.PI/(700*a.network.vertexes.count),b>t&&(e+=Math.PI/2);for(var r=0;;r++){var h=Math.sin(e+r*a);if((g+=(b>t?b:t)*Math.sqrt(1-o*o*h*h)*a)>=n)return r*a}}sp.className="GraphLinksModel",Qd.GraphLinksModel=sp,Ad.constructGraphLinksModel=Ad.constructGraphLinksModel=function(){return new sp},Ad.initDiagramModel=Hd=function(){return new sp},y(mp,Ad),mp.constructGraphLinksModel=Ad.constructGraphLinksModel,mp.prototype.cloneProtected=function(a){Ad.prototype.cloneProtected.call(this,a),a.Ke=this.Ke,a.Mm=this.Mm,a.nj=this.nj},(e=mp.prototype).toString=function(a){if(void 0===a&&(a=0),2<=a)return this.mp();var b=(""!==this.name?this.name:"")+" TreeModel";if(0<a){b+="\n node data:";for(var t=(a=this.nodeDataArray).length,e=0;e<t;e++){var n=a[e];b+=" "+this.wa(n)+":"+V(n)}}return b},e.qm=function(){var a=Ad.prototype.qm.call(this),b="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(b+=',\n  "nodeParentKeyProperty": '+this.quote(this.nodeParentKeyProperty)),a+b},e.fp=function(a){Ad.prototype.fp.call(this,a),a.nodeParentKeyProperty&&(this.nodeParentKeyProperty=a.nodeParentKeyProperty)},e.ep=function(a){void 0!==a.nodeParentKeyProperty&&a.nodeParentKeyProperty!==this.nodeParentKeyProperty&&T("applyIncrementalJson cannot change Model properties"),Ad.prototype.ep.call(this,a)},e.Ul=function(a){return a},e.mh=function(a){if(null!==a){var b=this.Ke;if(""!==b&&void 0!==(b=Zd(a,b))){if(Yd(b))return b;T("ParentKey value for node data "+a+" is not a number or a string: "+b)}}},e.qe=function(a,b){if(null===b&&(b=void 0),null!==a){var t=this.Ke;if(""!==t)if(b=this.Ul(b),this.lb(a)){var e=Zd(a,t);e!==b&&(hr(this,e,a),_d(a,t,b),null===this.ic(b)&&Ud(this,b,a),Vd(this,"nodeParentKey",ki,t,a,e,b),"string"==typeof t&&this.La(a,t))}else _d(a,t,b)}},e.rs=function(a){if(null===a)return"";var b=this.nj;return""===b||void 0===(b=Zd(a,b))?"":"string"==typeof b?b:(T("getParentLinkCategoryForNodeData found a non-string category for "+a+": "+b),"")},mp.prototype.getLinkCategoryForData=function(a){return this.rs(a)},mp.prototype.Ls=function(a,b){if(null!==a){var t=this.nj;if(""!==t)if(this.lb(a)){var e=Zd(a,t);void 0===e&&(e=""),e!==b&&(_d(a,t,b),Vd(this,"parentLinkCategory",ki,t,a,e,b),"string"==typeof t&&this.La(a,t))}else _d(a,t,b)}},mp.prototype.setLinkCategoryForData=function(a,b){this.Ls(a,b)},mp.prototype.copyNodeData=function(a){return null===a?null:(a=Ad.prototype.copyNodeData.call(this,a),this.Ij||""===this.Ke||void 0===Zd(a,this.Ke)||_d(a,this.Ke,void 0),a)},mp.prototype.setDataProperty=function(a,b,t){if(this.lb(a)){if(b===this.nodeKeyProperty)return void this.jm(a,t);if(b===this.nodeCategoryProperty)return void this.im(a,t);if(b===this.nodeParentKeyProperty)return void this.qe(a,t)}var e=Zd(a,b);e!==t&&(_d(a,b,t),this.Es(a,b,e,t))},(e=mp.prototype).ip=function(a,b){Ad.prototype.ip.call(this,a,b);for(var t=this.kb.iterator;t.next();)this.qv(t.value,a,b)},e.qv=function(a,b,t){if(this.mh(a)===b){var e=this.Ke;_d(a,e,t),Vd(this,"nodeParentKey",ki,e,a,b,t),"string"==typeof e&&this.La(a,e)}},e.em=function(a){Ad.prototype.em.call(this,a);var b=qd(this,a=this.wa(a));if(null!==b){var t=z();for(b=b.iterator;b.next();){var e=b.value;if(this.lb(e)&&this.mh(e)===a){var n=this.Ke;Vd(this,"nodeParentKey",ki,n,e,a,a),"string"==typeof n&&this.La(e,n),t.push(e)}}for(b=0;b<t.length;b++)hr(this,a,t[b]);R(t)}},e.dm=function(a){Ad.prototype.dm.call(this,a);var b=this.mh(a);b=this.Ul(b),null===this.ic(b)&&Ud(this,b,a)},e.pp=function(a){Ad.prototype.pp.call(this,a),hr(this,this.mh(a),a)},e.km=function(a,b){Ad.prototype.km.call(this,a,b),this.Ls(b,this.rs(a)),this.qe(b,this.mh(a))},e.Sl=function(){return!0},e.ws=function(){return!0},v.Object.defineProperties(mp.prototype,{nodeParentKeyProperty:{get:function(){return this.Ke},set:function(a){var b=this.Ke;b!==a&&(this.Ke=a,this.g("nodeParentKeyProperty",b,a))}},Ij:{get:function(){return this.Mm},set:function(a){this.Mm!==a&&(this.Mm=a)}},parentLinkCategoryProperty:{get:function(){return this.nj},set:function(a){var b=this.nj;b!==a&&(this.nj=a,this.g("parentLinkCategoryProperty",b,a))}},linkCategoryProperty:{get:function(){return this.parentLinkCategoryProperty},set:function(a){this.parentLinkCategoryProperty=a}},type:{get:function(){return"TreeModel"}}}),mp.prototype.setParentLinkCategoryForNodeData=mp.prototype.Ls,mp.prototype.getParentLinkCategoryForNodeData=mp.prototype.rs,mp.prototype.setParentKeyForNodeData=mp.prototype.qe,mp.prototype.getParentKeyForNodeData=mp.prototype.mh,mp.className="TreeModel",Qd.TreeModel=mp,y(yp,Uf),yp.prototype.cloneProtected=function(a){Uf.prototype.cloneProtected.call(this,a),a.co=this.co,a.Bm=this.Bm,a.qo=this.qo,a.tl=this.tl,a.Sb=this.Sb,a.K=this.K,a.nd=this.nd,a.hd=this.hd,a.tf=this.tf,a.Mn=this.Mn},yp.prototype.qb=function(a){a.classType===yp?a===Ep||a===Vp||a===zp||a===Rp||a===Yp?this.sorting=a:a===Dp||a===Ip||a===Op||a===Bp?this.direction=a:a===jp||a===Ap||a===Lp||a===Fp?this.arrangement=a:a!==Xp&&a!==Gp||(this.nodeDiameterFormula=a):Uf.prototype.qb.call(this,a)},yp.prototype.createNetwork=function(){return new qp(this)},yp.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),1>=(a=this.network.vertexes).count)1===a.count&&((a=a.first()).centerX=0,a.centerY=0);else{var b=new ot;b.addAll(a.iterator),a=new ot;var t,e,n=new ot,o=this.sort(b),g=this.Ip,r=this.arrangement,h=this.nodeDiameterFormula,l=this.radius;(!isFinite(l)||0>=l)&&(l=NaN);var c=this.aspectRatio;(!isFinite(c)||0>=c)&&(c=1);var f=this.startAngle;isFinite(f)||(f=0);var p=this.sweepAngle;if((!isFinite(p)||360<p||1>p)&&(p=360),b=this.spacing,isFinite(b)||(b=NaN),r===Fp&&h===Xp?r=Lp:r===Fp&&h!==Xp&&(r=this.arrangement),(this.direction===Dp||this.direction===Ip)&&this.sorting!==Yp){for(h=0;!(h>=o.length)&&(a.add(o.M(h)),!(h+1>=o.length));h+=2)n.add(o.M(h+1));this.direction===Dp?(this.arrangement===Fp&&a.reverse(),(o=new ot).addAll(a),o.addAll(n)):(this.arrangement===Fp&&n.reverse(),(o=new ot).addAll(n),o.addAll(a))}h=o.length;for(var q=e=t=0;q<o.length;q++){var d=f+p*e*(this.direction===Op?1:-1)/h,u=o.M(q).diameter;isNaN(u)&&(u=Hp(o.M(q),d)),360>p&&(0===q||q===o.length-1)&&(u/=2),t+=u,e++}if(isNaN(l)||r===Fp){if(isNaN(b)&&(b=6),r!==Lp&&r!==Fp){for(e=-1/0,g=0;g<h;g++)q=o.M(g),t=o.M(g===h-1?0:g+1),isNaN(q.diameter)&&Hp(q,0),isNaN(t.diameter)&&Hp(t,0),e=Math.max(e,(q.diameter+t.diameter)/2);g=e+b,l=r===jp?(e+b)/(2*Math.PI/h):Cp(this,g*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180)}else l=Cp(this,t+(360<=p?h:h-1)*(r!==Fp?b:1.6*b),c,f*Math.PI/180,p*Math.PI/180);e=l*c}else if(q=Np(this,l,e=l*c,f*Math.PI/180,p*Math.PI/180),isNaN(b))r!==Lp&&r!==Fp||(b=(q-t)/(360<=p?h:h-1));else if(r===Lp||r===Fp)(q=(q-t)/(360<=p?h:h-1))<b?e=(l=Cp(this,t+b*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))*c:b=q;else{for(g=-1/0,t=0;t<h;t++)d=o.M(t),u=o.M(t===h-1?0:t+1),isNaN(d.diameter)&&Hp(d,0),isNaN(u.diameter)&&Hp(u,0),g=Math.max(g,(d.diameter+u.diameter)/2);(t=Cp(this,(g+=b)*(360<=p?h:h-1),c,f*Math.PI/180,p*Math.PI/180))>l?e=(l=t)*c:g=q/(360<=p?h:h-1)}if(this.kw=r,this.mc=l,this.Ym=c,this.lw=f,this.Vp=p,this.Ti=b,this.me=e,this.Ip=g,b=o,o=this.kw,r=this.mc,l=this.lw,c=this.Vp,f=this.Ti,p=this.me,h=this.Ip,this.direction!==Dp&&this.direction!==Ip||o!==Fp)if(this.direction===Dp||this.direction===Ip){switch(g=0,o){case Ap:g=180*Tp(this,r,p,l,h)/Math.PI;break;case Lp:h=b=0,null!==(g=a.first())&&(b=Hp(g,Math.PI/2)),null!==(g=n.first())&&(h=Hp(g,Math.PI/2)),g=180*Tp(this,r,p,l,f+(b+h)/2)/Math.PI;break;case jp:g=c/b.length}if(this.direction===Dp){switch(o){case Ap:bp(this,a,l,Bp);break;case Lp:xp(this,a,l,Bp);break;case jp:vp(this,a,c/2,l,Bp)}switch(o){case Ap:bp(this,n,l+g,Op);break;case Lp:xp(this,n,l+g,Op);break;case jp:vp(this,n,c/2,l+g,Op)}}else{switch(o){case Ap:bp(this,n,l,Bp);break;case Lp:xp(this,n,l,Bp);break;case jp:vp(this,n,c/2,l,Bp)}switch(o){case Ap:bp(this,a,l+g,Op);break;case Lp:xp(this,a,l+g,Op);break;case jp:vp(this,a,c/2,l+g,Op)}}}else switch(o){case Ap:bp(this,b,l,this.direction);break;case Lp:xp(this,b,l,this.direction);break;case jp:vp(this,b,c,l,this.direction);break;case Fp:wp(this,b,c,l,this.direction)}else wp(this,b,c,l-c/2,Op)}this.updateParts(),this.network=null,this.isValidLayout=!0},yp.prototype.commitLayout=function(){this.commitNodes(),this.isRouting&&this.commitLinks()},yp.prototype.commitNodes=function(){var a=null!==this.group&&null!==this.group.placeholder&&this.group.isSubGraphExpanded,b=a?this.group.location.copy():null,t=this.actualCenter;a?t=new St(0,0):(t.x=this.arrangementOrigin.x+this.mc,t.y=this.arrangementOrigin.y+this.me);for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;n.x+=t.x,n.y+=t.y,n.commit()}a&&(this.group.Va(),a=this.group.position.copy(),t=this.group.location.copy(),b=b.re(t.re(a)),this.group.move(b),this.Zv=b.re(a))},yp.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},yp.prototype.sort=function(a){switch(this.sorting){case zp:break;case Rp:a.reverse();break;case Ep:a.sort(this.comparer);break;case Vp:a.sort(this.comparer),a.reverse();break;case Yp:return this.$j(function(a){for(var b=[],t=0;t<a.length;t++)b.push(0);t=new ot;for(var e=0;e<a.length;e++){var n=-1,o=-1;if(0===e)for(var g=0;g<a.length;g++){var r=a.M(g).edgesCount;r>n&&(n=r,o=g)}else for(g=0;g<a.length;g++)(r=b[g])>n&&(n=r,o=g);for(t.add(a.M(o)),b[o]=-1,g=(o=a.M(o)).sourceEdges;g.next();)0>(n=a.indexOf(g.value.fromVertex))||0<=b[n]&&b[n]++;for(o=o.destinationEdges;o.next();)0>(n=a.indexOf(o.value.toVertex))||0<=b[n]&&b[n]++}return t}(a));default:T("Invalid sorting type.")}return a},yp.prototype.$j=function(a){for(var b=[],t=0;t<a.length;t++){var e=a.M(t);b[t]=[];for(var n,o=e.destinationEdges;o.next();)(n=a.indexOf(o.value.toVertex))!==t&&0>b[t].indexOf(n)&&b[t].push(n);for(e=e.sourceEdges;e.next();)(n=a.indexOf(e.value.fromVertex))!==t&&0>b[t].indexOf(n)&&b[t].push(n)}for(o=[],t=0;t<b.length;t++)o[t]=0;t=[];var g=[],r=[];e=[],n=new ot;for(var h=0,l=0;l<b.length;l++){var c=b[l].length;if(1===c)e.push(l);else if(0===c)n.add(a.M(l));else{if(0===h)t.push(l);else{for(var f=c=1/0,p=-1,q=[],d=0;d<t.length;d++)0>b[t[d]].indexOf(t[d===t.length-1?0:d+1])&&q.push(d===t.length-1?0:d+1);if(0===q.length)for(d=0;d<t.length;d++)q.push(d);for(d=0;d<q.length;d++){for(var u=q[d],m=b[l],y=0,v=0;v<g.length;v++){var x=o[g[v]],w=o[r[v]];if(x<w){var k=x;x=w}else k=w;if(k<u&&u<=x)for(w=0;w<m.length;w++){var M=m[w];0>t.indexOf(M)||k<o[M]&&o[M]<x||k===o[M]||x===o[M]||y++}else for(w=0;w<m.length;w++)M=m[w],0>t.indexOf(M)||k<o[M]&&o[M]<x&&k!==o[M]&&x!==o[M]&&y++}for(m=y,v=y=0;v<b[l].length;v++)0<=(k=t.indexOf(b[l][v]))&&(y+=(k=Math.abs(u-(k>=u?k+1:k)))<t.length+1-k?k:t.length+1-k);for(v=0;v<g.length;v++)(k=o[g[v]])>=u&&k++,(x=o[r[v]])>=u&&x++,k>x&&(w=x,x=k,k=w),x-k<(t.length+2)/2==(k<u&&u<=x)&&y++;(m<c||m===c&&y<f)&&(c=m,f=y,p=u)}for(t.splice(p,0,l),c=0;c<t.length;c++)o[t[c]]=c;for(c=0;c<b[l].length;c++)f=b[l][c],0<=t.indexOf(f)&&(g.push(l),r.push(f))}h++}}for(g=t.length;;){for(o=!0,r=0;r<e.length;r++)if(l=b[h=e[r]][0],0<=(c=t.indexOf(l))){for(p=f=0;p<b[l].length;p++)0>(q=t.indexOf(b[l][p]))||q===c||(f+=q<c!=(d=q>c?q-c:c-q)>g-d?1:-1);t.splice(0>f?c:c+1,0,h),e.splice(r,1),r--}else o=!1;if(o)break;t.push(e[0]),e.splice(0,1)}for(b=0;b<t.length;b++)n.add(a.M(t[b]));return n},v.Object.defineProperties(yp.prototype,{radius:{get:function(){return this.co},set:function(a){this.co!==a&&(0<a||isNaN(a))&&(this.co=a,this.C())}},aspectRatio:{get:function(){return this.Bm},set:function(a){this.Bm!==a&&0<a&&(this.Bm=a,this.C())}},startAngle:{get:function(){return this.qo},set:function(a){this.qo!==a&&(this.qo=a,this.C())}},sweepAngle:{get:function(){return this.tl},set:function(a){this.tl!==a&&(this.tl=0<a&&360>=a?a:360,this.C())}},arrangement:{get:function(){return this.Sb},set:function(a){this.Sb===a||a!==Fp&&a!==Lp&&a!==Ap&&a!==jp||(this.Sb=a,this.C())}},direction:{get:function(){return this.K},set:function(a){this.K===a||a!==Op&&a!==Bp&&a!==Dp&&a!==Ip||(this.K=a,this.C())}},sorting:{get:function(){return this.nd},set:function(a){this.nd===a||a!==zp&&a!==Rp&&a!==Ep&&!Vp&&a!==Yp||(this.nd=a,this.C())}},comparer:{get:function(){return this.hd},set:function(a){this.hd!==a&&(this.hd=a,this.C())}},spacing:{get:function(){return this.tf},set:function(a){this.tf!==a&&(this.tf=a,this.C())}},nodeDiameterFormula:{get:function(){return this.Mn},set:function(a){this.Mn===a||a!==Gp&&a!==Xp||(this.Mn=a,this.C())}},actualXRadius:{get:function(){return this.mc}},actualYRadius:{get:function(){return this.me}},actualSpacing:{get:function(){return this.Ti}},actualCenter:{get:function(){return this.Zv}}});var Lp=new W(yp,"ConstantSpacing",0),Ap=new W(yp,"ConstantDistance",1),jp=new W(yp,"ConstantAngle",2),Fp=new W(yp,"Packed",3),Op=new W(yp,"Clockwise",4),Bp=new W(yp,"Counterclockwise",5),Dp=new W(yp,"BidirectionalLeft",6),Ip=new W(yp,"BidirectionalRight",7),zp=new W(yp,"Forwards",8),Rp=new W(yp,"Reverse",9),Ep=new W(yp,"Ascending",10),Vp=new W(yp,"Descending",11),Yp=new W(yp,"Optimized",12),Gp=new W(yp,"Pythagorean",13),Xp=new W(yp,"Circular",14);function Up(){this.Ol=-1/0,this.sm=this.lk=null}function qp(a){Hf.call(this,a)}function Kp(a){$f.call(this,a),this.u=this.Si=NaN}function Hp(a,b){var t=a.network;if(null===t)return NaN;if(null===(t=t.layout))return NaN;if(t.arrangement===Fp)if(t.nodeDiameterFormula===Xp)a.Si=Math.max(a.width,a.height);else{if(t=Math.abs(Math.sin(b)),b=Math.abs(Math.cos(b)),0===t)return a.width;if(0===b)return a.height;a.Si=Math.min(a.height/t,a.width/b)}else a.Si=t.nodeDiameterFormula===Xp?Math.max(a.width,a.height):Math.sqrt(a.width*a.width+a.height*a.height);return a.Si}function Wp(a){ed.call(this,a)}function Jp(a){Uf.call(this),this.ah=null,this.zn=0,this.$d=new Vt(100,100).freeze(),this.Am=!1,this.sf=!0,this.td=!1,this.cl=100,this.Zm=1,this.Zf=1e3,this.Hn=10,this.eo=Math,this.Gk=.05,this.Fk=50,this.Dk=150,this.Ek=0,this.Um=10,this.Tm=5,a&&Object.assign(this,a)}function Zp(a,b,t){if(function(a,b){if(10<b||3>a.network.vertexes.count)return!1;for(a.ah=a.network.vertexes.Fa(),(a=a.ah).sort((function(a,b){return null===a||null===b||a===b?0:b.Vd-a.Vd})),b=a.length-1;0<=b&&1>=a[b].Vd;)b--;return 1<a.length-b}(a,b)){var e=a.Zf;a.Zf*=1+1/(b+1);var n=function(a,b){for(var t=a.network,e=new ng(a),n=0;n<a.ah.length;n++){var o=a.ah[n];if(!(1<o.Vd))break;e.dh(o);var g=new ig;g.Qs=o.Vd,g.Rs=o.width,g.Ps=o.height,g.Sv=o.focus.x,g.Tv=o.focus.y,null===o.We&&(o.We=new ot),o.We.add(g),o.sv=o.We.count-1}for(o=t.edges.iterator;o.next();){var r=o.value;n=r.fromVertex,g=r.toVertex,n.network===e&&g.network===e?e.Ao(r):n.network===e?(null===(r=n.Gj)&&(r=new ot,n.Gj=r),r.add(g),n.Vd--,n.sh+=g.sh):g.network===e&&(null===(r=g.Gj)&&(r=new ot,g.Gj=r),r.add(n),g.Vd--,g.sh+=n.sh)}for(n=e.edges.iterator;n.next();)(o=n.value).length*=Math.max(1,$e.sqrt((o.fromVertex.sh+o.toVertex.sh)/(4*b+1)));for(b=e.vertexes.iterator;b.next();){var h=(n=b.value).Gj;if(null!==h&&0<h.count&&!(0>=(g=n.We.M(n.We.count-1).Qs-n.Vd))){for(var l=r=0,c=h.count-g;c<h.count;c++){var f=h.M(c),p=null;for(o=f.edges.iterator;o.next();){var q=o.value;if(q.Ax(f)===n){p=q;break}}null!==p&&(l+=p.length,r+=f.width*f.height)}o=n.centerX,h=n.centerY,c=n.width,f=n.height,p=n.focus,1>(q=c*f)&&(q=1),g=((r=$e.sqrt((r+q+l*l*4/(g*g))/q))-1)*c/2,r=(r-1)*f/2,n.bounds=new Ut(o-p.x-g,h-p.y-r,c+2*g,f+2*r),n.focus=new St(p.x+g,p.y+r)}}return a.network=e,t}(a,b),o=Math.max(0,Math.max(Math.min(a.network.vertexes.count,t*(b+1)/11),10));for(a.maxIterations+=o,Zp(a,b+1,t),tg(a,o),function(a,b){for(var t=a.network.vertexes.iterator;t.next();){var e=t.value;if(e.network=b,null!==e.We){var n=e.We.M(e.sv);e.Vd=n.Qs;var o=n.Sv,g=n.Tv;e.bounds=new Ut(e.centerX-o,e.centerY-g,n.Rs,n.Ps),e.focus=new St(o,g),e.sv--}}for(t=a.network.edges.iterator;t.next();)t.value.network=b;a.network=b}(a,n),(b=n.vertexes.Fa()).sort((function(a,b){return null===a||null===b||a===b?0:b.Vd-a.Vd})),t=0;t<b.length;t++)_p(a,b[t]);a.Zf=e}}function _p(a,b){var t=b.Gj;if(null!==t&&0!==t.count){var e=b.centerX,n=b.centerY,o=b.width,g=b.height;null!==b.We&&0<b.We.count&&(o=(g=b.We.M(0)).Rs,g=g.Ps),o=$e.sqrt(o*o+g*g)/2;for(var r=!1,h=g=0,l=0,c=b.vertexes.iterator;c.next();){var f=c.value;1>=f.Vd?h++:(r=!0,l++,g+=Math.atan2(b.centerY-f.centerY,b.centerX-f.centerX))}if(0!==h)for(0<l&&(g/=l),l=b=0,b=r?2*Math.PI/(h+1):2*Math.PI/h,0==h%2&&(l=b/2),1<t.count&&t.sort((function(a,b){return null===a||null===b||a===b?0:b.width*b.height-a.width*a.height})),r=0==h%2?0:1,t=t.iterator;t.next();)if(!(1<(h=t.value).Vd||a.isFixed(h))){for(c=null,f=h.edges.iterator;f.next();){c=f.value;break}f=h.width;var p=h.height;f=$e.sqrt(f*f+p*p)/2,c=o+c.length+f,f=g+(b*(r/2>>1)+l)*(0==r%2?1:-1),h.centerX=e+c*Math.cos(f),h.centerY=n+c*Math.sin(f),r++}}}function $p(a,b,t,e,n,o,g){var r=9e19,h=-1,l=0;t:for(;l<b;l++){var c=a[l],f=c.x-t,p=c.y-e;if((f=f*f+p*p)<r){for(p=l-1;0<=p;p--)if(a[p].y>c.y&&a[p].x-c.x<n+g.width)continue t;for(p=l+1;p<b;p++)if(a[p].x>c.x&&a[p].y-c.y<o+g.height)continue t;h=l,r=f}}return h}function Qp(a,b){var t=a.bounds,e=t.x;a=t.y;var n=t.width;t=t.height;var o=b.bounds,g=o.x;b=o.y;var r=o.width;return o=o.height,e+n<g?a>b+o?(t=e+n-g,a=a-b-o,$e.sqrt(t*t+a*a)):a+t<b?(e=e+n-g,a=a+t-b,$e.sqrt(e*e+a*a)):g-(e+n):e>g+r?a>b+o?(t=e-g-r,a=a-b-o,$e.sqrt(t*t+a*a)):a+t<b?(e=e-g-r,a=a+t-b,$e.sqrt(e*e+a*a)):e-(g+r):a>b+o?a-(b+o):a+t<b?b-(a+t):.1}function tg(a,b){for(a.ah=null,b=a.zn+b;a.zn<b&&(a.zn++,eg(a)););a.ah=null}function eg(a){null===a.ah&&(a.ah=a.network.vertexes.Fa());var b=a.ah;if(0>=b.length)return!1;var t=b[0];t.forceX=0,t.forceY=0;for(var e=t.centerX,n=e,o=t=t.centerY,g=1;g<b.length;g++){var r=b[g];r.forceX=0,r.forceY=0;var h=r.centerX;r=r.centerY,e=Math.min(e,h),n=Math.max(n,h),t=Math.min(t,r),o=Math.max(o,r)}(n=n-e>o-t)?b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerX-b.centerX})):b.sort((function(a,b){return null===a||null===b||a===b?0:a.centerY-b.centerY})),t=a.Zf;var l=e=r=0;for(o=0;o<b.length;o++){e=(g=b[o]).bounds,r=g.focus,h=e.x+r.x;var c=e.y+r.y;e=g.charge*a.electricalFieldX(h,c),l=g.charge*a.electricalFieldY(h,c),e+=g.mass*a.gravitationalFieldX(h,c),l+=g.mass*a.gravitationalFieldY(h,c),g.forceX+=e,g.forceY+=l;for(var f=o+1;f<b.length;f++){var p=b[f];if(p!==g){e=p.bounds,r=p.focus,l=e.x+r.x;var q=e.y+r.y;if(h-l>t||l-h>t){if(n)break}else if(c-q>t||q-c>t){if(!n)break}else{var d=Qp(g,p);1>d?(null===(e=a.randomNumberGenerator)&&(a.randomNumberGenerator=e=new sg),d=e.random(),r=e.random(),h>l?e=(1+(e=Math.abs(p.bounds.right-g.bounds.x)))*d:h<l?e=-(1+(e=Math.abs(p.bounds.x-g.bounds.right)))*d:e=(1+(e=Math.max(p.width,g.width)))*d-e/2,c>q?l=(1+(l=Math.abs(p.bounds.bottom-g.bounds.y)))*r:h<l?l=-(1+(l=Math.abs(p.bounds.y-g.bounds.bottom)))*r:l=(1+(l=Math.max(p.height,g.height)))*r-l/2):(e=(l-h)/d*(r=-g.charge*p.charge/(d*d)),l=(q-c)/d*r),g.forceX+=e,g.forceY+=l,p.forceX-=e,p.forceY-=l}}}}for(n=a.network.edges.iterator;n.next();)t=(r=n.value).fromVertex,o=r.toVertex,g=t.bounds,h=t.focus,e=g.x+h.x,g=g.y+h.y,c=o.bounds,f=o.focus,h=c.x+f.x,c=c.y+f.y,1>(f=Qp(t,o))?(null===(f=a.randomNumberGenerator)&&(a.randomNumberGenerator=f=new sg),r=f.random(),f=f.random(),e=(e>h?1:-1)*(1+(o.width>t.width?o.width:t.width))*r,l=(g>c?1:-1)*(1+(o.height>t.height?o.height:t.height))*f):(e=(h-e)/f*(r=r.stiffness*(f-r.length)),l=(c-g)/f*r),t.forceX+=e,t.forceY+=l,o.forceX-=e,o.forceY-=l;for(n=e=0;n<b.length;n++)t=b[n],a.isFixed(t)?a.moveFixedVertex(t):e=Math.max(e,a.moveVertex(t)||0);return e>a.epsilonDistance*a.epsilonDistance}function ig(){this.Tv=this.Sv=this.Ps=this.Rs=this.Qs=0}function ng(a){Hf.call(this,a)}function og(a){$f.call(this,a),this.ia=!1,this.Ha=this.u=NaN,this.sh=this.Vd=this.V=this.F=0,this.We=this.Gj=null,this.sv=0}function rg(a){ed.call(this,a),this.j=this.o=NaN}function sg(){var a=0;void 0===a&&(a=42),this.seed=a,this.ay=48271,this.ey=2147483647,this.Q=44488.07041494893,this.gy=3399,this.by=1/2147483647,this.random()}function ag(a){Uf.call(this),this.lc=this.ie=25,this.K=0,this.Ck=Xg,this.Yk=Kg,this.Pk=Jg,this.bj=4,this.qk=Qg,this.bg=15,this.sf=!0,this.Bn=4,this.Ra=this.Hq=this.Ia=-1,this.Md=this.Gn=0,this.Ta=this.Kd=this.Ld=this.he=this.vb=null,this.Jn=0,this.In=this.kj=null,this.le=0,this.el=null,this.Rf=new St,this.He=[],this.He.length=100,this.xw=this.ve=0,a&&Object.assign(this,a)}function hg(a){var b=a.fromVertex.node||a.fromVertex.data;return a=a.toVertex.node||a.toVertex.data,null===b&&null===a?8:null===b||null===a?4:1}function lg(a){null===a.kj&&(a.kj=[]);for(var b=0,t=a.network.vertexes.iterator;t.next();){var e=t.value;a.kj[b]=e.layer,b++,a.kj[b]=e.column,b++,a.kj[b]=e.index,b++}return a.kj}function ug(a,b){var t=0;for(a=a.network.vertexes.iterator;a.next();){var e=a.value;e.layer=b[t],t++,e.column=b[t],t++,e.index=b[t],t++}}function cg(a,b,t){var e=Yg(a,b),n=a.vb[b];(null===a.In||a.In.length<n*n)&&(a.In=[]);for(var o=a.In,g=0;g<n;g++){var r,h=0,l=e[g],c=l.near;if(null!==c&&c!==l&&c.layer===l.layer&&(h+=Math.max(0,Math.abs(c.index-l.index)-1)),0<=t){var f=e[g].sourceEdgesArrayAccess;for(l=0;l<f.length;l++){var p=f[l];if(p.valid&&p.fromVertex.layer!==b){c=p.fromVertex.index;var q=p.portToPos;for(p=p.portFromPos,r=l+1;r<f.length;r++){var d=f[r];if(d.valid&&d.fromVertex.layer!==b){var u=d.fromVertex.index,m=d.portToPos;d=d.portFromPos,q<m&&(c>u||c===u&&p>d)&&h++,m<q&&(u>c||u===c&&d>p)&&h++}}}}}if(0>=t)for(f=e[g].destinationEdgesArrayAccess,l=0;l<f.length;l++)if((p=f[l]).valid&&p.toVertex.layer!==b)for(c=p.toVertex.index,q=p.portToPos,p=p.portFromPos,r=l+1;r<f.length;r++)(d=f[r]).valid&&d.toVertex.layer!==b&&(u=d.toVertex.index,m=d.portToPos,p<(d=d.portFromPos)&&(c>u||c===u&&q>m)&&h++,d<p&&(u>c||u===c&&m>q)&&h++);for(o[g*n+g]=h,h=g+1;h<n;h++){var y=0,v=0;if(0<=t){f=e[g].sourceEdgesArrayAccess;var x=e[h].sourceEdgesArrayAccess;for(l=0;l<f.length;l++)if((p=f[l]).valid&&p.fromVertex.layer!==b)for(c=p.fromVertex.index,p=p.portFromPos,r=0;r<x.length;r++)(d=x[r]).valid&&d.fromVertex.layer!==b&&(u=d.fromVertex.index,d=d.portFromPos,(c<u||c===u&&p<d)&&v++,(u<c||u===c&&d<p)&&y++)}if(0>=t)for(f=e[g].destinationEdgesArrayAccess,x=e[h].destinationEdgesArrayAccess,l=0;l<f.length;l++)if((p=f[l]).valid&&p.toVertex.layer!==b)for(c=p.toVertex.index,q=p.portToPos,r=0;r<x.length;r++)(d=x[r]).valid&&d.toVertex.layer!==b&&(u=d.toVertex.index,m=d.portToPos,(c<u||c===u&&q<m)&&v++,(u<c||u===c&&m<q)&&y++);o[g*n+h]=y,o[h*n+g]=v}}return Gg(a,b,e),o}function fg(a){for(var b=0,t=0;t<=a.Ia;t++){for(var e=a,n=t,o=Yg(e,n),g=e.vb[n],r=0,h=0;h<g;h++){var l=o[h].destinationEdgesArrayAccess;if(null!==l)for(var c=0;c<l.length;c++){var f=l[c];if(f.valid&&f.toVertex.layer!==n){var p=f.fromVertex.column+f.portFromColOffset,q=f.toVertex.column+f.portToColOffset;r+=(Math.abs(p-q)+1)*hg(f)}}}Gg(e,n,o),b+=r}return b}function dg(a,b,t){for(var e=Yg(a,b),n=a.vb[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=0,p=r.near;if(null!==p&&p.layer===r.layer&&(c+=p.column-1,f++),null!==h)for(p=0;p<h.length;p++){var q=(r=h[p]).fromVertex;r.valid&&!r.rev&&q.layer!==b&&(c+=q.column,f++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(c+=p.column,f++);o[g]=0===f?-1:c/f}return Gg(a,b,e),o}function pg(a,b,t){for(var e=Yg(a,b),n=a.vb[b],o=[],g=0;g<n;g++){var r=e[g],h=null;0>=t&&(h=r.sourceEdgesArrayAccess);var l=null;0<=t&&(l=r.destinationEdgesArrayAccess);var c=0,f=[],p=r.near;if(null!==p&&p.layer===r.layer&&(f[c]=p.column-1,c++),r=void 0,null!==h)for(p=0;p<h.length;p++){var q=(r=h[p]).fromVertex;r.valid&&!r.rev&&q.layer!==b&&(f[c]=q.column+r.portFromColOffset,c++)}if(null!==l)for(h=0;h<l.length;h++)p=(r=l[h]).toVertex,r.valid&&!r.rev&&p.layer!==b&&(f[c]=p.column+r.portToColOffset,c++);0===c?o[g]=-1:(f.sort((function(a,b){return a-b})),l=c>>1,o[g]=0!=(1&c)?f[l]:f[l-1]+f[l]>>1)}return Gg(a,b,e),o}function gg(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();){var r=g.value,h=r.toVertex,l=b.layer-h.layer;l===(r=a.linkMinLength(r))&&gg(a,h,t,e,n,o)}if(o)for(g=b.sourceEdges;g.next();)(l=(h=(r=g.value).fromVertex).layer-b.layer)===(r=a.linkMinLength(r))&&gg(a,h,t,e,n,o)}}function mg(a,b,t,e,n,o){if(b.component===e){if(b.component=t,n)for(var g=b.destinationEdges;g.next();)mg(a,g.value.toVertex,t,e,n,o);if(o)for(b=b.sourceEdges;b.next();)mg(a,b.value.fromVertex,t,e,n,o)}}function yg(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid)return b}return null}function dt(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.destinationEdges;e.next();)if(e.value.toVertex.valid){t=!1;break}if(t)return b}}return null}function vg(a){for(a=a.vertexes.iterator;a.next();){var b=a.value;if(b.valid){for(var t=!0,e=b.sourceEdges;e.next();)if(e.value.fromVertex.valid){t=!1;break}if(t)return b}}return null}function xg(a,b){b.Kl=a.Jn,a.Jn++;for(var t=b.destinationEdges;t.next();){var e=t.value,n=e.toVertex;-1===n.Kl&&(e.forest=!0,xg(a,n))}b.finish=a.Jn,a.Jn++}function bg(a){for(var b=a.network.vertexes.iterator;b.next();){var t=wg(a,b.value);a.Ia=Math.max(t,a.Ia)}}function wg(a,b){var t=0;if(-1===b.layer){for(var e=b.destinationEdges;e.next();){var n=e.value,o=n.toVertex;n=a.linkMinLength(n),t=Math.max(t,wg(a,o)+n)}b.layer=t}else t=b.layer;return t}function kg(a,b){var t=0;if(-1===b.layer){for(var e=b.sourceEdges;e.next();){var n=e.value,o=n.fromVertex;n=a.linkMinLength(n),t=Math.max(t,kg(a,o)+n)}b.layer=t}else t=b.layer;return t}function Mg(a,b){if(!b.valid){b.valid=!0;for(var t=b.destinationEdges;t.next();)Mg(a,t.value.toVertex);for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(var e=b.sourceEdgesArrayAccess,n=e.length,o=0;o<n;o++){var g=e[o],r=g.fromVertex,h=g.toVertex;g=a.linkMinLength(g),r.layer-h.layer>g&&gg(a,r,0,-1,!0,!1)}for(gg(a,b,1,-1,!0,!0);0!==b.component;){for(o=0,e=1/0,r=0,h=null,g=a.network.vertexes.iterator;g.next();){var l=g.value;if(1===l.component){var c=0,f=!1,p=l.sourceEdgesArrayAccess;n=p.length;for(var q=0;q<n;q++){var d=p[q],u=d.fromVertex;c+=1,1!==u.component&&(o+=1,u=u.layer-l.layer,d=a.linkMinLength(d),e=Math.min(e,u-d))}for(n=(p=l.destinationEdgesArrayAccess).length,q=0;q<n;q++)--c,1!==(d=p[q].toVertex).component?--o:f=!0;(null===h||c<r)&&!f&&(h=l,r=c)}}if(0<o){for(t.reset();t.next();)1===(n=t.value).component&&(n.layer+=e);b.component=0}else h.component=0}for(t=a.network.vertexes.iterator;t.next();)t.value.component=-1;for(gg(a,b,1,-1,!0,!1);0!==b.component;){for(e=0,n=1/0,o=0,r=null,h=a.network.vertexes.iterator;h.next();)if(1===(g=h.value).component){for(l=0,c=!1,f=(p=g.sourceEdgesArrayAccess).length,q=0;q<f;q++)l+=1,1!==(d=p[q].fromVertex).component?e+=1:c=!0;for(f=(p=g.destinationEdgesArrayAccess).length,q=0;q<f;q++)--l,1!==(u=(d=p[q]).toVertex).component&&(--e,u=g.layer-u.layer,d=a.linkMinLength(d),n=Math.min(n,u-d));(null===r||l>o)&&!c&&(r=g,o=l)}if(0>e){for(t.reset();t.next();)1===(e=t.value).component&&(e.layer-=n);b.component=0}else r.component=0}}}function Sg(a,b,t){return 90===a.K?t&&!b.rev||!t&&b.rev?270:90:180===a.K?t&&!b.rev||!t&&b.rev?0:180:270===a.K?t&&!b.rev||!t&&b.rev?90:270:t&&!b.rev||!t&&b.rev?180:0}function Pg(a,b,t){for(var e=t[t.length-1].sourceEdges.iterator;e.next();){var n=e.value;if(!n.rev&&n.valid){if(n=n.fromVertex,t.push(n),n===b||Pg(a,b,t))return!0;t.pop()}}return!1}function Ng(a,b,t){if(!t||!b.near){var e=b.layer;if(b.index=a.vb[e],a.vb[e]++,t){var n=t.get(b);Array.isArray(n)&&n.forEach((function(b){b.index=a.vb[e],a.vb[e]++}))}for(b=b.destinationEdgesArrayAccess,n=!0;n;){n=!1;for(var o=0;o<b.length-1;o++){var g=b[o],r=b[o+1];g.portFromColOffset>r.portFromColOffset&&(n=!0,b[o]=r,b[o+1]=g)}}for(n=0;n<b.length;n++)(o=b[n]).valid&&(-1===(o=o.toVertex).index&&Ng(a,o,t))}}function Cg(a,b,t){if(!t||!b.near){var e=b.layer;if(b.index=a.vb[e],a.vb[e]++,t){var n=t.get(b);Array.isArray(n)&&n.forEach((function(b){b.index=a.vb[e],a.vb[e]++}))}b=b.sourceEdgesArrayAccess;var o=!0;for(n=0;o;)for(o=!1,n=0;n<b.length-1;n++){var g=b[n],r=b[n+1];g.portToColOffset>r.portToColOffset&&(o=!0,b[n]=r,b[n+1]=g)}for(n=0;n<b.length;n++)(o=b[n]).valid&&(-1===(o=o.fromVertex).index&&Cg(a,o,t))}}function rt(a,b,t){var e=Yg(a,b),n=a.vb[b],o=pg(a,b,t),g=dg(a,b,t);for(t=0;t<n;t++)-1===g[t]&&(g[t]=e[t].column),-1===o[t]&&(o[t]=e[t].column);for(var r,h=!0;h;)for(h=!1,t=0;t<n-1;t++)(o[t+1]<o[t]||o[t+1]===o[t]&&g[t+1]<g[t])&&(h=!0,r=o[t],o[t]=o[t+1],o[t+1]=r,r=g[t],g[t]=g[t+1],g[t+1]=r,r=e[t],e[t]=e[t+1],e[t+1]=r);for(t=o=0;t<n;t++)(r=e[t]).index=t,o+=a.nodeMinColumnSpace(r,!0),r.column=o,o+=1,o+=a.nodeMinColumnSpace(r,!1);Gg(a,b,e)}function Tg(a,b,t){var e,n=Yg(a,b),o=a.vb[b];t=cg(a,b,t);var g=[];for(e=0;e<o;e++)g[e]=-1;var r=[];for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o-1;e++){var c=t[n[e].index*o+n[e+1].index],f=t[n[e+1].index*o+n[e].index],p=0,q=0,d=n[e].column,u=n[e+1].column,m=a.nodeMinColumnSpace(n[e],!0),y=a.nodeMinColumnSpace(n[e],!1),v=a.nodeMinColumnSpace(n[e+1],!0),x=a.nodeMinColumnSpace(n[e+1],!1);m=d-m+v,y=u-y+x;var w=n[e].sourceEdges.iterator;for(w.reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e-v),q+=2*(e+1-v)),v===e+1&&(p+=1),v>e+1&&(p+=4*(v-e),q+=4*(v-(e+1)))}for((w=n[e].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e+1&&(q+=1)}for((w=n[e+1].sourceEdges.iterator).reset();w.next();)if(x=(v=w.value).fromVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v<e&&(p+=2*(e+1-v),q+=2*(e-v)),v===e&&(q+=1),v>e+1&&(p+=4*(v-(e+1)),q+=4*(v-e))}for((w=n[e+1].destinationEdges.iterator).reset();w.next();)if(x=(v=w.value).toVertex,v.valid&&x.layer===b){for(v=0;n[v]!==x;)v++;v===e&&(p+=1)}v=x=0,w=g[n[e].index];var k=r[n[e].index],M=g[n[e+1].index],S=r[n[e+1].index];-1!==w&&(x+=Math.abs(w-d),v+=Math.abs(w-y)),-1!==k&&(x+=Math.abs(k-d),v+=Math.abs(k-y)),-1!==M&&(x+=Math.abs(M-u),v+=Math.abs(M-m)),-1!==S&&(x+=Math.abs(S-u),v+=Math.abs(S-m)),(q<p-.5||q===p&&f<c-.5||q===p&&f===c&&v<x-.5)&&(l=h=!0,n[e].column=y,n[e+1].column=m,c=n[e],n[e]=n[e+1],n[e+1]=c)}for(e=0;e<o;e++)n[e].index=e;return Gg(a,b,n),h}function Lg(a,b,t){for(var e=!1;Ag(a,b,t);)e=!0;return e}function Ag(a,b,t){var e,n=Yg(a,b),o=a.vb[b],g=dg(a,b,-1);if(0<t)for(e=0;e<o;e++)g[e]=-1;var r=dg(a,b,1);if(0>t)for(e=0;e<o;e++)r[e]=-1;for(var h=!1,l=!0;l;)for(l=!1,e=0;e<o;e++){var c=n[e].column,f=a.nodeMinColumnSpace(n[e],!0),p=a.nodeMinColumnSpace(n[e],!1),q=0;q=0>e-1||c-n[e-1].column-1>f+a.nodeMinColumnSpace(n[e-1],!1)?c-1:c,f=e+1>=o||n[e+1].column-c-1>p+a.nodeMinColumnSpace(n[e+1],!0)?c+1:c;var d=p=0,u=0;if(0>=t)for(var m=n[e].sourceEdges.iterator;m.next();){var y=m.value,v=y.fromVertex;if(y.valid&&v.layer!==b){var x=hg(y),w=y.portFromColOffset;y=y.portToColOffset,v=v.column,p+=(Math.abs(c+y-(v+w))+1)*x,d+=(Math.abs(q+y-(v+w))+1)*x,u+=(Math.abs(f+y-(v+w))+1)*x}}if(0<=t)for(m=n[e].destinationEdges.iterator;m.next();)v=(y=m.value).toVertex,y.valid&&v.layer!==b&&(x=hg(y),w=y.portFromColOffset,y=y.portToColOffset,v=v.column,p+=(Math.abs(c+w-(v+y))+1)*x,d+=(Math.abs(q+w-(v+y))+1)*x,u+=(Math.abs(f+w-(v+y))+1)*x);y=w=x=0,m=g[n[e].index],v=r[n[e].index],-1!==m&&(x+=Math.abs(m-c),w+=Math.abs(m-q),y+=Math.abs(m-f)),-1!==v&&(x+=Math.abs(v-c),w+=Math.abs(v-q),y+=Math.abs(v-f)),d<p||d===p&&w<x?(l=h=!0,n[e].column=q):(u<p||u===p&&y<x)&&(l=h=!0,n[e].column=f)}return Gg(a,b,n),a.normalize(),h}function jg(a,b,t){var e=Yg(a,b),n=a.vb[b],o=pg(a,b,t),g=[];for(t=0;t<n;t++)g[t]=o[t];for(o=!0;o;)for(o=!1,t=0;t<n;t++){var r=e[t].column,h=a.nodeMinColumnSpace(e[t],!0),l=a.nodeMinColumnSpace(e[t],!1),c=0;if(-1===g[t])if(0===t&&t===n-1)c=r;else if(0===t){var f=e[t+1].column;c=f-r===l+a.nodeMinColumnSpace(e[t+1],!0)?r-1:r}else t===n-1?c=r-(f=e[t-1].column)===h+a.nodeMinColumnSpace(e[t-1],!1)?r+1:r:c=((h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1)+(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1))/2|0;else 0===t&&t===n-1?c=g[t]:0===t?(l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,c=Math.min(g[t],l)):t===n-1?(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,c=Math.max(g[t],h)):(h=(f=e[t-1].column)+a.nodeMinColumnSpace(e[t-1],!1)+h+1,l=(f=e[t+1].column)-a.nodeMinColumnSpace(e[t+1],!0)-l-1,h<g[t]&&g[t]<l?c=g[t]:h>=g[t]?c=h:l<=g[t]&&(c=l));c!==r&&(o=!0,e[t].column=c)}Gg(a,b,e),a.normalize()}function Fg(a,b){for(var t=!0,e=a.network.vertexes.iterator;e.next();){var n=e.value,o=a.nodeMinColumnSpace(n,!0),g=a.nodeMinColumnSpace(n,!1);if(n.column-o<=b&&n.column+g>=b){t=!1;break}}if(a=!1,t)for(e.reset();e.next();)(t=e.value).column>b&&(--t.column,a=!0);return a}function Og(a,b){var t,e=b+1,n=[],o=[];for(t=0;t<=a.Ia;t++)n[t]=!1,o[t]=!1;for(var g=a.network.vertexes.iterator;g.next();){var r=(t=g.value).column-a.nodeMinColumnSpace(t,!0),h=t.column+a.nodeMinColumnSpace(t,!1);r<=b&&h>=b&&(n[t.layer]=!0),r<=e&&h>=e&&(o[t.layer]=!0)}for(r=!0,e=!1,t=0;t<=a.Ia;t++)r=r&&!(n[t]&&o[t]);if(r)for(g.reset();g.next();)(a=g.value).column>b&&(--a.column,e=!0);return e}function Bg(a,b){for(var t=0;t<=a.Ra;t++)for(;Fg(a,t););for(a.normalize(),t=0;t<a.Ra;t++)for(;Og(a,t););var e;if(a.normalize(),0<b)for(t=0;t<=a.Ra;t++){var n=lg(a),o=fg(a);for(e=o+1;o<e;){e=o,Dg(a,t,1);var g=fg(a);g>o?ug(a,n):g<o&&(o=g,n=lg(a))}}if(0>b)for(t=a.Ra;0<=t;t--)for(n=lg(a),e=(o=fg(a))+1;o<e;)e=o,Dg(a,t,-1),(g=fg(a))>o?ug(a,n):g<o&&(o=g,n=lg(a));a.normalize()}function Dg(a,b,t){a.le=0;for(var e=a.network.vertexes.iterator;e.next();)e.value.component=-1;if(0<t)for(e.reset();e.next();){var n=e.value;n.column-a.nodeMinColumnSpace(n,!0)<=b&&(n.component=a.le)}if(0>t)for(e.reset();e.next();)(n=e.value).column+a.nodeMinColumnSpace(n,!1)>=b&&(n.component=a.le);for(a.le++,e.reset();e.next();)-1===(b=e.value).component&&(mg(a,b,a.le,-1,!0,!0),a.le++);var o;for(b=[],o=0;o<a.le*a.le;o++)b[o]=!1;for(n=[],o=0;o<(a.Ia+1)*(a.Ra+1);o++)n[o]=-1;for(e.reset();e.next();)for(var g=(o=e.value).layer,r=Math.max(0,o.column-a.nodeMinColumnSpace(o,!0)),h=Math.min(a.Ra,o.column+a.nodeMinColumnSpace(o,!1));r<=h;r++)n[g*(a.Ra+1)+r]=o.component;for(o=0;o<=a.Ia;o++){if(0<t)for(g=0;g<a.Ra;g++)-1!==n[o*(a.Ra+1)+g]&&-1!==n[o*(a.Ra+1)+g+1]&&n[o*(a.Ra+1)+g]!==n[o*(a.Ra+1)+g+1]&&(b[n[o*(a.Ra+1)+g]*a.le+n[o*(a.Ra+1)+g+1]]=!0);if(0>t)for(g=a.Ra;0<g;g--)-1!==n[o*(a.Ra+1)+g]&&-1!==n[o*(a.Ra+1)+g-1]&&n[o*(a.Ra+1)+g]!==n[o*(a.Ra+1)+g-1]&&(b[n[o*(a.Ra+1)+g]*a.le+n[o*(a.Ra+1)+g-1]]=!0)}for(n=[],o=0;o<a.le;o++)n[o]=!0;for((g=[]).push(0);0!==g.length;)if(h=g[g.length-1],g.pop(),n[h])for(n[h]=!1,o=0;o<a.le;o++)b[h*a.le+o]&&g.splice(0,0,o);if(0<t)for(e.reset();e.next();)n[(a=e.value).component]&&--a.column;if(0>t)for(e.reset();e.next();)n[(t=e.value).component]&&(t.column+=1)}function Ig(a,b,t,e){for(var n=90===a.K||270===a.K,o=r(b),g=o.next();!g.done;g=o.next()){var h=r(g.value);for(g=h.next();!g.done;g=h.next())(g=g.value).sd=g,g.shift=1/0,g.zc=NaN,g.qg=0}for(g=90===a.K||270===a.K,h=(o=r(b)).next();!h.done;h=o.next())for(var l=(h=r(h.value)).next();!l.done;l=h.next())if((l=l.value).root===l){for(var c=0,f=l;f.align!==l;){var d=f.align,p=g?f.width:f.height,q=g?d.width:d.height;if(t){var m=am(f,d),u=m.portFromPos,y=m.portToPos;null!==m.link&&(f.node&&f.node!==m.link.fromNode&&(u=g?f.focusX:f.focusY),d.node&&d.node!==m.link.toNode&&(y=g?d.focusX:d.focusY))}else u=(m=am(d,f)).portToPos,y=m.portFromPos,null!==m.link&&(f.node&&f.node!==m.link.toNode&&(u=g?f.focusX:f.focusY),d.node&&d.node!==m.link.fromNode&&(y=g?d.focusX:d.focusY));p=e?f.qg+(p-u)-(q-y):f.qg+u-y,d.qg=p,c=Math.min(c,p),f=f.align}f=l;do{f.qg=f.qg-c,f=f.align}while(f!==l)}for(g=(t=r(b)).next();!g.done;g=t.next())for(g=(o=r(g.value)).next();!g.done;g=o.next())(g=g.value).root===g&&zg(a,g,b);for(t=0;t<b.length;t++)if(!(0>=b[t].length)&&(g=b[t][0]).sd===g){1/0===g.sd.shift&&(g.sd.shift=0),g=t,h=0;do{for(o=b[g][h];o.align!==o.root;)g++,0<(o=o.align).vi&&((h=Rg(o,b)).sd.shift=Math.min(h.sd.shift,o.sd.shift+o.zc+o.qg-(h.zc+h.qg+(n?h.width:h.height)+a.columnSpacing)));h=o.vi+1}while(g<b.length&&h<b[g].length&&o.sd===b[g][h].sd)}for(a=new Mt,g=(b=r(b)).next();!g.done;g=b.next())for(g=(t=r(g.value)).next();!g.done;g=t.next())(g=g.value).zc=g.zc+g.sd.shift+g.qg,o=n?g.width:g.height,a.add(g,e?-g.zc-o:g.zc);return a}function zg(a,b,t){if(isNaN(b.zc)){b.zc=0;var e=b;do{if(0<e.vi){var n=Rg(e,t),o=n.root;zg(a,o,t),b.sd===b&&(b.sd=o.sd);var g=90===a.K||270===a.K?n.width:n.height;b.sd===o.sd&&(b.zc=Math.max(b.zc,o.zc+n.qg+g-e.qg+a.columnSpacing))}e=e.align}while(e!==b);for(;e.align!==b;)(e=e.align).zc=b.zc,e.sd=b.sd}}function Rg(a,b){var t=a.Tz;return 1>(a=a.vi)&&T("Could not determine previous vertex in layer"),b[t][a-1]}function Eg(a,b,t,e,n){if(!b||0===b.count)return t[n]=0,e[n]=0,1/0;var o=1/0,g=-1/0;return b.each((function(b){var t=b.key;b=b.value,t=90===a.K||270===a.K?t.width:t.height,b<o&&(o=b),b+t>g&&(g=b+t)})),t[n]=o,e[n]=g,g-o}function Vg(a,b){return 270===a.K?b?ze:Ve:90===a.K?b?Ve:ze:180===a.K?b?Re:Ee:b?Ee:Re}function Yg(a,b){var t=a.vb[b];if(t>=a.He.length){for(var e=[],n=0;n<a.He.length;n++)e[n]=a.He[n];a.He=e}for(void 0===a.He[t]||null===a.He[t]?e=[]:(e=a.He[t],a.He[t]=null),a=a.el[b],b=0;b<a.length;b++)e[(t=a[b]).index]=t;return e}function Gg(a,b,t){a.He[a.vb[b]]=t}yp.className="CircularLayout",yp.ConstantSpacing=Lp,yp.ConstantDistance=Ap,yp.ConstantAngle=jp,yp.Packed=Fp,yp.Clockwise=Op,yp.Counterclockwise=Bp,yp.BidirectionalLeft=Dp,yp.BidirectionalRight=Ip,yp.Forwards=zp,yp.Reverse=Rp,yp.Ascending=Ep,yp.Descending=Vp,yp.Optimized=Yp,yp.Pythagorean=Gp,yp.Circular=Xp,Up.prototype.compare=function(a,b){if(0<a&&0>this.Ol||Math.abs(a)<Math.abs(this.Ol)&&!(0>a&&0<this.Ol))for(this.Ol=a,this.lk=[],this.sm=[],a=0;a<b.length;a++)this.lk[a]=b[a].bounds.x,this.sm[a]=b[a].bounds.y},Up.prototype.commit=function(a){if(null!==this.lk&&null!==this.sm)for(var b=0;b<this.lk.length;b++){var t=a.M(b);t.x=this.lk[b],t.y=this.sm[b]}},Up.className="VertexArrangement",y(qp,Hf),qp.prototype.createVertex=function(){return new Kp(this)},qp.prototype.createEdge=function(){return new Wp(this)},qp.className="CircularNetwork",y(Kp,$f),v.Object.defineProperties(Kp.prototype,{diameter:{get:function(){return this.Si},set:function(a){this.Si!==a&&(this.Si=a)}},actualAngle:{get:function(){return this.u},set:function(a){this.u!==a&&(this.u=a)}}}),Kp.className="CircularVertex",y(Wp,ed),Wp.className="CircularEdge",y(Jp,Uf),Jp.prototype.cloneProtected=function(a){Uf.prototype.cloneProtected.call(this,a),a.$d.assign(this.$d),a.Am=this.Am,a.sf=this.sf,a.td=this.td,a.cl=this.cl,a.Zm=this.Zm,a.Zf=this.Zf,a.Hn=this.Hn,a.eo=this.eo,a.Gk=this.Gk,a.Fk=this.Fk,a.Dk=this.Dk,a.Ek=this.Ek,a.Um=this.Um,a.Tm=this.Tm},Jp.prototype.createNetwork=function(){return new ng(this)},Jp.prototype.doLayout=function(a){if(null===this.network&&(this.network=this.makeNetwork(a)),a=this.maxIterations,0<this.network.vertexes.count){this.network.Jo();for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}for(b=this.network.edges.iterator;b.next();)(t=b.value).stiffness=this.springStiffness(t),t.length=this.springLength(t);if(this.Bu(),this.zn=0,this.needsClusterLayout()){for(var e=(t=(b=this.network).Zx()).iterator;e.next();){this.network=e.value;for(var n=this.network.vertexes.iterator;n.next();){var o=n.value;o.Vd=o.vertexes.count,o.sh=1,o.Gj=null,o.We=null}Zp(this,0,a)}this.network=b;var g=e=t.iterator;e=this.arrangementSpacing;var r=g.count,h=!0;o=n=0;for(var l=z(),c=0;c<r+b.vertexes.count+2;c++)l[c]=null;r=0,g.reset();for(var f=Ut.alloc();g.next();)if(c=g.value,this.computeBounds(c,f),h)h=!1,n=f.x+f.width/2,o=f.y+f.height/2,l[0]=new St(f.x+f.width+e.width,f.y),l[1]=new St(f.x,f.y+f.height+e.height),r=2;else{var p=$p(l,r,n,o,f.width,f.height,e),q=l[p],d=new St(q.x+f.width+e.width,q.y),u=new St(q.x,q.y+f.height+e.height);for(p+1<r&&l.splice(p+1,0,null),l[p]=d,l[p+1]=u,r++,p=q.x-f.x,q=q.y-f.y,c=c.vertexes.iterator;c.next();)(d=c.value).centerX+=p,d.centerY+=q}for(Ut.free(f),c=b.vertexes.iterator;c.next();)p=(g=c.value).bounds,2>r?(n=p.x+p.width/2,o=p.y+p.height/2,l[0]=new St(p.x+p.width+e.width,p.y),l[1]=new St(p.x,p.y+p.height+e.height),r=2):(q=new St((f=l[h=$p(l,r,n,o,p.width,p.height,e)]).x+p.width+e.width,f.y),p=new St(f.x,f.y+p.height+e.height),h+1<r&&l.splice(h+1,0,null),l[h]=q,l[h+1]=p,r++,g.centerX=f.x+g.width/2,g.centerY=f.y+g.height/2);for(R(l),e=t.iterator;e.next();){for(n=(t=e.value).vertexes.iterator;n.next();)b.dh(n.value);for(t=t.edges.iterator;t.next();)b.Ao(t.value)}}tg(this,a),this.updateParts()}this.cl=a,this.network=null,this.isValidLayout=!0},Jp.prototype.needsClusterLayout=function(){if(3>this.network.vertexes.count)return!1;for(var a=0,b=0,t=this.network.vertexes.first().bounds,e=this.network.vertexes.iterator;e.next();){if(e.value.bounds.Yc(t)&&2<++a)return!0;if(10<b)break;b++}return!1},Jp.prototype.computeBounds=function(a,b){var t=!0;for(a=a.vertexes.iterator;a.next();){var e=a.value;t?(t=!1,b.set(e.bounds)):b.ed(e.bounds)}return b},Jp.prototype.Bu=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},Jp.prototype.addComments=function(a){var b=a.node;if(null!==b)for(b=b.Mu();b.next();){var t=b.value;if("Comment"===t.category&&t.isVisible()){var e=this.network.ki(t);null===e&&(e=this.network.Al(t)),e.charge=this.defaultCommentElectricalCharge,t=null;for(var n=e.destinationEdges;n.next();){var o=n.value;if(o.toVertex===a){t=o;break}}if(null===t)for(n=e.sourceEdges;n.next();)if((o=n.value).fromVertex===a){t=o;break}null===t&&(t=this.network.Yj(a,e,null)),t.length=this.defaultCommentSpringLength}}},Jp.prototype.moveVertex=function(a){var b=a.forceX,t=a.forceY,e=this.moveLimit;return b<-e?b=-e:b>e&&(b=e),t<-e?t=-e:t>e&&(t=e),a.centerX+=b,a.centerY+=t,b*b+t*t},Jp.prototype.moveFixedVertex=function(){},Jp.prototype.commitLayout=function(){this.yv(),this.commitNodes(),this.isRouting&&this.commitLinks()},Jp.prototype.yv=function(){if(this.setsPortSpots)for(var a=this.network.edges.iterator;a.next();){var b=a.value.link;null!==b&&(b.fromSpot=Fe,b.toSpot=Fe)}},Jp.prototype.commitNodes=function(){var a=0,b=0;if(this.arrangesToOrigin){var t=Ut.alloc();this.computeBounds(this.network,t),a=(b=this.arrangementOrigin).x-t.x,b=b.y-t.y,Ut.free(t)}t=Ut.alloc();for(var e=this.network.vertexes.iterator;e.next();){var n=e.value;0===a&&0===b||(t.assign(n.bounds),t.x+=a,t.y+=b,n.bounds=t),n.commit()}Ut.free(t)},Jp.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},Jp.prototype.springStiffness=function(a){return a=a.stiffness,isNaN(a)?this.Gk:a},Jp.prototype.springLength=function(a){return a=a.length,isNaN(a)?this.Fk:a},Jp.prototype.electricalCharge=function(a){return a=a.charge,isNaN(a)?this.Dk:a},Jp.prototype.electricalFieldX=function(){return 0},Jp.prototype.electricalFieldY=function(){return 0},Jp.prototype.gravitationalMass=function(a){return a=a.mass,isNaN(a)?this.Ek:a},Jp.prototype.gravitationalFieldX=function(){return 0},Jp.prototype.gravitationalFieldY=function(){return 0},Jp.prototype.isFixed=function(a){return a.isFixed},v.Object.defineProperties(Jp.prototype,{currentIteration:{get:function(){return this.zn}},arrangementSpacing:{get:function(){return this.$d},set:function(a){this.$d.D(a)||(this.$d.assign(a),this.C())}},arrangesToOrigin:{get:function(){return this.Am},set:function(a){this.Am!==a&&(this.Am=a,this.C())}},setsPortSpots:{get:function(){return this.sf},set:function(a){this.sf!==a&&(this.sf=a,this.C())}},comments:{get:function(){return this.td},set:function(a){this.td!==a&&(this.td=a,this.C())}},maxIterations:{get:function(){return this.cl},set:function(a){this.cl!==a&&0<=a&&(this.cl=a,this.C())}},epsilonDistance:{get:function(){return this.Zm},set:function(a){this.Zm!==a&&0<a&&(this.Zm=a,this.C())}},infinityDistance:{get:function(){return this.Zf},set:function(a){this.Zf!==a&&1<a&&(this.Zf=a,this.C())}},moveLimit:{get:function(){return this.Hn},set:function(a){this.Hn!==a&&1<a&&(this.Hn=a,this.C())}},randomNumberGenerator:{get:function(){return this.eo},set:function(a){this.eo!==a&&(null!==a&&"function"!=typeof a.random&&T('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+a),this.eo=a)}},defaultSpringStiffness:{get:function(){return this.Gk},set:function(a){this.Gk!==a&&(this.Gk=a,this.C())}},defaultSpringLength:{get:function(){return this.Fk},set:function(a){this.Fk!==a&&(this.Fk=a,this.C())}},defaultElectricalCharge:{get:function(){return this.Dk},set:function(a){this.Dk!==a&&(this.Dk=a,this.C())}},defaultGravitationalMass:{get:function(){return this.Ek},set:function(a){this.Ek!==a&&(this.Ek=a,this.C())}},defaultCommentSpringLength:{get:function(){return this.Um},set:function(a){this.Um!==a&&(this.Um=a,this.C())}},defaultCommentElectricalCharge:{get:function(){return this.Tm},set:function(a){this.Tm!==a&&(this.Tm=a,this.C())}}}),Jp.className="ForceDirectedLayout",ig.className="ForceDirectedSubnet",y(ng,Hf),ng.prototype.createVertex=function(){return new og(this)},ng.prototype.createEdge=function(){return new rg(this)},ng.className="ForceDirectedNetwork",y(og,$f),v.Object.defineProperties(og.prototype,{isFixed:{get:function(){return this.ia},set:function(a){this.ia!==a&&(this.ia=a)}},charge:{get:function(){return this.u},set:function(a){this.u!==a&&(this.u=a)}},mass:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}},forceX:{get:function(){return this.F},set:function(a){this.F!==a&&(this.F=a)}},forceY:{get:function(){return this.V},set:function(a){this.V!==a&&(this.V=a)}}}),og.className="ForceDirectedVertex",y(rg,ed),v.Object.defineProperties(rg.prototype,{stiffness:{get:function(){return this.o},set:function(a){this.o!==a&&(this.o=a)}},length:{get:function(){return this.j},set:function(a){this.j!==a&&(this.j=a)}}}),rg.className="ForceDirectedEdge",sg.prototype.random=function(){var a=this.seed%this.Q*this.ay-this.seed/this.Q*this.gy;return this.seed=0<a?a:a+this.ey,this.seed*this.by},sg.className="RandomNumberGenerator",y(ag,Uf),ag.prototype.cloneProtected=function(a){Uf.prototype.cloneProtected.call(this,a),a.ie=this.ie,a.lc=this.lc,a.K=this.K,a.Ck=this.Ck,a.Yk=this.Yk,a.Pk=this.Pk,a.bj=this.bj,a.qk=this.qk,a.bg=this.bg,a.sf=this.sf,a.Bn=this.Bn,a.ve=this.ve},ag.prototype.qb=function(a){a.classType===ag?0===a.name.indexOf("Aggressive")?this.aggressiveOption=a:0===a.name.indexOf("Cycle")?this.cycleRemoveOption=a:0===a.name.indexOf("Init")?this.initializeOption=a:0===a.name.indexOf("Layer")?this.layeringOption=a:T("Unknown enum value: "+a):Uf.prototype.qb.call(this,a)},ag.prototype.createNetwork=function(){return new om(this)},ag.prototype.doLayout=function(a){for(null===this.network&&(this.network=this.makeNetwork(a)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.Hq=-1,this.Md=this.Gn=0,this.el=this.In=this.kj=null,a=0;a<this.He.length;a++)this.He[a]=null;if(0<this.network.vertexes.count){for(this.network.Jo(),this.cycleRemoveOption!==qg&&this.removeCycles(),a=this.network.vertexes.iterator;a.next();)a.value.layer=-1;for(this.Ia=-1,this.assignLayers(),a.reset();a.next();)this.Ia=Math.max(this.Ia,a.value.layer);this.cycleRemoveOption===qg&&this.removeCycles();for(var b=[],t=(a=this.network).edges.iterator;t.next();){var e=t.value;e.valid=!1,b.push(e)}for(t=0;t<b.length;t++){var n=(e=b[t]).fromVertex,o=e.toVertex;if(!(e.valid||(null===n.node&&null===n.data||null===o.node&&null===o.data)&&n.layer===o.layer)){var g=0,r=0,h=0,l=0;if(null!==e.link){if(null===(r=e.link))continue;var c=n.node;if(g=o.node,null===c||null===g)continue;var f=r.fromNode;h=r.toNode;for(var p=r.fromPort;null!==p&&!p.Ed();)p=p.panel;for(r=r.toPort;null!==r&&!r.Ed();)r=r.panel;if(e.rev){l=f;var q=p;f=h,p=r,h=l,r=q}var d=n.focus;l=o.focus;var u=e.rev?o.bounds:n.bounds;q=St.alloc(),c!==f?u.w()&&f.isVisible()?f.actualBounds.w()?(Gu(f,p,fe,q),q.x+=f.actualBounds.x-u.x,q.y+=f.actualBounds.y-u.y):(Gu(f,p,fe,q),q.w()||q.assign(d)):q.assign(d):u.w()?(Gu(f,p,fe,q),q.w()||q.assign(d)):q.assign(d),f=e.rev?n.bounds:o.bounds,c=St.alloc(),g!==h?f.w()&&h.isVisible()?h.actualBounds.w()?(Gu(h,r,fe,c),c.x+=h.actualBounds.x-f.x,c.y+=h.actualBounds.y-f.y):(Gu(h,r,fe,c),c.w()||c.assign(l)):c.assign(l):f.w()?(Gu(h,r,fe,c),c.w()||c.assign(l)):c.assign(l),90===this.K||270===this.K?(g=Math.round((q.x-d.x)/this.lc),h=q.x,r=Math.round((c.x-l.x)/this.lc),l=c.x):(g=Math.round((q.y-d.y)/this.lc),h=q.y,r=Math.round((c.y-l.y)/this.lc),l=c.y),St.free(q),St.free(c),e.portFromColOffset=g,e.portFromPos=h,e.portToColOffset=r,e.portToPos=l}else e.portFromColOffset=0,e.portFromPos=0,e.portToColOffset=0,e.portToPos=0;if(q=n.layer,c=o.layer,f=0,null!==(u=e.link)){var m=u.fromPort,y=u.toPort;if(null!==m&&null!==y){var v=u.fromNode;if(p=u.toNode,null!==v&&null!==p){var x=Vg(this,!0),w=Vg(this,!1),k=this.setsPortSpots?x:u.computeSpot(!0,m);d=this.setsPortSpots?w:u.computeSpot(!1,y);var M=u.isOrthogonal;k.$c()&&k.Hf(w)&&d.$c()&&d.Hf(x)?f=0:(x=u.getLinkPoint(v,m,k,!0,M,p,y,St.alloc()),w=u.getLinkDirection(v,m,x,k,!0,M,p,y),St.free(x),k.xs()||w!==Sg(this,e,!0)?this.setsPortSpots&&null!==v&&1===v.ports.count&&e.rev&&(f+=1):f+=1,k=u.getLinkPoint(p,y,d,!1,M,v,m,St.alloc()),u=u.getLinkDirection(p,y,k,d,!1,M,v,m),St.free(k),d.xs()||u!==Sg(this,e,!1)?this.setsPortSpots&&null!==p&&1===p.ports.count&&e.rev&&(f+=2):f+=2)}}}if(f=1===(p=f)||3===p,u=null,m=void 0,(p=2===p||3===p)&&(this._experimental&&(d=n,(u=[]).push(o),u=Pg(this,d,u)?u.reverse():[],m=1),(d=a.createVertex()).node=null,d.Cu=1,d.layer=q,d.near=n,a.dh(d),(n=a.Yj(n,d,e.link)).valid=!1,n.rev=e.rev,n.portFromColOffset=g,n.portToColOffset=0,n.portFromPos=h,n.portToPos=0,n=d),y=1,f&&y--,q-c>y&&0<q){for(e.valid=!1,(d=a.createVertex()).node=null,d.Cu=2,d.layer=q-1,u&&m<u.length&&d.layer===u[m].layer&&(d.near=u[m++]),a.dh(d),(n=a.Yj(n,d,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=p?0:g,n.portToColOffset=0,n.portFromPos=p?0:h,n.portToPos=0,n=d,q--;q-c>y&&0<q;)(d=a.createVertex()).node=null,d.Cu=3,d.layer=q-1,u&&m<u.length&&d.layer===u[m].layer&&(d.near=u[m++]),a.dh(d),(n=a.Yj(n,d,e.link)).valid=!0,n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=0,n.portFromPos=0,n.portToPos=0,n=d,q--;(n=a.Yj(d,o,e.link)).valid=!f,f&&(d.near=o),n.rev=e.rev,n.portFromColOffset=0,n.portToColOffset=r,n.portFromPos=0,n.portToPos=l}else e.valid=!0}}for(a=this.vb=[],b=0;b<=this.Ia;b++)a[b]=0;for(b=this.network.vertexes.iterator;b.next();)b.value.index=-1;for(this.initializeIndices(),this.Hq=-1,t=this.Md=this.Gn=0;t<=this.Ia;t++)a[t]>a[this.Md]&&(this.Hq=a[t]-1,this.Md=t),a[t]<a[this.Gn]&&(this.Gn=t);for(this.el=[],t=0;t<a.length;t++)this.el[t]=[];for(b.reset();b.next();)a=b.value,this.el[a.layer][a.index]=a;for(this.Ra=-1,a=0;a<=this.Ia;a++){for(b=Yg(this,a),t=0,e=this.vb[a],o=0;o<e;o++)n=b[o],t+=this.nodeMinColumnSpace(n,!0),n.column=t,t+=1,t+=this.nodeMinColumnSpace(n,!1);this.Ra=Math.max(this.Ra,t-1),Gg(this,a,b)}this.reduceCrossings(),this.straightenAndPack(),this.updateParts()}this.network=null,this.isValidLayout=!0},ag.prototype.linkMinLength=function(){return 1},ag.prototype.nodeMinLayerSpace=function(a,b){return null===a.node&&null===a.data?0:90===this.K||270===this.K?b?a.focus.y+10:a.bounds.height-a.focus.y+10:b?a.focus.x+10:a.bounds.width-a.focus.x+10},ag.prototype.nodeMinColumnSpace=function(a,b){if(null===a.node&&null===a.data)return 0;var t=b?a.ev:a.dv;return null!==t?t:90===(t=this.K)||270===t?b?a.ev=a.focus.x/this.lc+1|0:a.dv=(a.bounds.width-a.focus.x)/this.lc+1|0:b?a.ev=a.focus.y/this.lc+1|0:a.dv=(a.bounds.height-a.focus.y)/this.lc+1|0},ag.prototype.countCrossings=function(){for(var a=0,b=0;b<=this.Ia;b++)for(var t=cg(this,b,1),e=this.vb[b],n=0;n<e;n++)for(var o=n;o<e;o++)a+=t[n*e+o];return a},ag.prototype.normalize=function(){var a=1/0;this.Ra=-1;for(var b=this.network.vertexes.iterator;b.next();){var t=b.value;a=Math.min(a,t.column-this.nodeMinColumnSpace(t,!0)),this.Ra=Math.max(this.Ra,t.column+this.nodeMinColumnSpace(t,!1))}for(b.reset();b.next();)b.value.column-=a;this.Ra-=a},ag.prototype.removeCycles=function(){for(var a=this.network.edges.iterator;a.next();)a.value.rev=!1;switch(this.Ck){default:case Ug:var b=0,t=(a=this.network).vertexes.count-1,e=[];e.length=t+1;for(var n=a.vertexes.iterator;n.next();)n.value.valid=!0;for(;null!==yg(a);){for(n=dt(a);null!==n;)e[t]=n,t--,n.valid=!1,n=dt(a);for(n=vg(a);null!==n;)e[b]=n,b++,n.valid=!1,n=vg(a);n=null;for(var o=0,g=this.network.vertexes.iterator;g.next();){var r=g.value;if(r.valid){for(var h=0,l=r.destinationEdges;l.next();)l.value.toVertex.valid&&h++;l=0;for(var c=r.sourceEdges;c.next();)c.value.fromVertex.valid&&l++;(null===n||o<h-l)&&(n=r,o=h-l)}}null!==n&&(e[b]=n,b++,n.valid=!1)}for(b=0;b<a.vertexes.count;b++)e[b].index=b;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.index>b.toVertex.index&&(a.fm(b),b.rev=!0);break;case Xg:for(e=this.network.vertexes.iterator;e.next();)(a=e.value).Kl=-1,a.finish=-1;for(a=this.network.edges.iterator;a.next();)a.value.forest=!1;for(this.Jn=0,e.reset();e.next();)0===(b=e.value).sourceEdges.count&&xg(this,b);for(e.reset();e.next();)-1===(b=e.value).Kl&&xg(this,b);for(a.reset();a.next();)(e=a.value).forest||(t=(b=e.fromVertex).finish,o=(n=e.toVertex).finish,n.Kl<b.Kl&&t<o&&(this.network.fm(e),e.rev=!0));break;case qg:for(b=(a=this.network).vertexes.iterator,e=1/0;b.next();)e=Math.min(e,b.value.layer);if(1/0>e){if(0>e)for(b.reset();b.next();)b.value.layer-=e;for(e=[],b.reset();b.next();)void 0===(n=e[(t=b.value).layer])?e[t.layer]=[t]:n.push(t);for(t=b=0;t<e.length;t++)if((n=e[t])&&0!==n.length){if(0<t)for(o=0;o<n.length;o++)n[o].layer-=b}else b++;for(e=a.edges.iterator;e.next();)(b=e.value).fromVertex.layer<b.toVertex.layer&&(a.fm(b),b.rev=!0)}}},ag.prototype.assignLayers=function(){switch(this.Yk){case Hg:bg(this);break;case Wg:for(var a,b=this.network.vertexes.iterator;b.next();)a=kg(this,b.value),this.Ia=Math.max(a,this.Ia);for(b.reset();b.next();)(a=b.value).layer=this.Ia-a.layer;break;default:for(bg(this),b=this.network.vertexes.iterator;b.next();)b.value.valid=!1;for(b.reset();b.next();)0===(a=b.value).sourceEdges.count&&Mg(this,a);for(a=1/0,b.reset();b.next();)a=Math.min(a,b.value.layer);for(this.Ia=-1,b.reset();b.next();){var t=b.value;t.layer-=a,this.Ia=Math.max(this.Ia,t.layer)}}},ag.prototype.initializeIndices=function(){switch(this.Pk){default:case _g:!function(a){var b=null,t=a.network.vertexes.iterator;if(a._experimental){for(;t.next();){var e=t.value;if(e.near&&(null===b&&(b=new Mt),e.layer===e.near.layer)){var n=b.get(e.near)||[];n.push(e),b.set(e.near,n)}}t.reset()}for(e={};t.next();)n=t.value,b&&n.near||(e.layer=n.layer,n.index=a.vb[e.layer],a.vb[e.layer]++,b&&(n=b.get(n),Array.isArray(n)&&n.forEach(function(b){return function(t){t.index=a.vb[b.layer],a.vb[b.layer]++}}(e)))),e={layer:e.layer}}(this);break;case Jg:var a=null,b=this.network.vertexes.iterator;if(this._experimental)for(;b.next();){var t=b.value;if(t.near&&(null===a&&(a=new Mt),t.layer===t.near.layer)){var e=a.get(t.near)||[];e.push(t),a.set(t.near,e)}}for(t=this.Ia;0<=t;t--)for(b.reset();b.next();)(e=b.value).layer===t&&-1===e.index&&Ng(this,e,a);break;case Zg:if(a=null,b=this.network.vertexes.iterator,this._experimental)for(;b.next();)(t=b.value).near&&(null===a&&(a=new Mt),t.layer===t.near.layer&&((e=a.get(t.near)||[]).push(t),a.set(t.near,e)));for(t=0;t<=this.Ia;t++)for(b.reset();b.next();)(e=b.value).layer===t&&-1===e.index&&Cg(this,e,a)}},ag.prototype.reduceCrossings=function(){var t,e,n,g,o,a=this.countCrossings(),b=lg(this);for(t=0;t<this.bj;t++){for(e=0;e<=this.Ia;e++)rt(this,e,1),Tg(this,e,1);var r=this.countCrossings();for(r<a&&(a=r,b=lg(this)),e=this.Ia;0<=e;e--)rt(this,e,-1),Tg(this,e,-1);(r=this.countCrossings())<a&&(a=r,b=lg(this))}for(ug(this,b),t=0;t<this.bj;t++){for(e=0;e<=this.Ia;e++)rt(this,e,0),Tg(this,e,0);for((r=this.countCrossings())<a&&(a=r,b=lg(this)),e=this.Ia;0<=e;e--)rt(this,e,0),Tg(this,e,0);(r=this.countCrossings())<a&&(a=r,b=lg(this))}switch(ug(this,b),this.qk){case $g:break;case tm:for(o=a+1;(e=this.countCrossings())<o;)for(o=e,t=this.Ia;0<=t;t--)for(g=0;g<=t;g++){for(n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,-1)||n;for((r=this.countCrossings())>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,1)||n;for((r=this.countCrossings())>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,1)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,-1)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,0)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,0)||n;r>=a?ug(this,b):(a=r,b=lg(this))}break;default:for(t=this.Ia,g=0,o=a+1;(e=this.countCrossings())<o;){for(o=e,n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,-1)||n;for((r=this.countCrossings())>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,1)||n;for((r=this.countCrossings())>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,1)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,-1)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=t;e>=g;e--)n=Tg(this,e,0)||n;for(r>=a?ug(this,b):(a=r,b=lg(this)),n=!0;n;)for(n=!1,e=g;e<=t;e++)n=Tg(this,e,0)||n;r>=a?ug(this,b):(a=r,b=lg(this))}}ug(this,b)},ag.prototype.straightenAndPack=function(){if(0===this.ve){var a=0!=(1&this.bg),b=0!=(this.bg&im);if(1e3<this.network.edges.count&&b&&(a=!1),a){var t=[];for(b=0;b<=this.Ia;b++)t[b]=0;for(var e,n=this.network.vertexes.iterator;n.next();){var o=n.value;b=o.layer,e=o.column,o=this.nodeMinColumnSpace(o,!1),t[b]=Math.max(t[b],e+o)}for(n.reset();n.next();)b=(o=n.value).layer,e=o.column,o.column=(8*(this.Ra-t[b])>>1)+8*e;this.Ra*=8}if(0!=(2&this.bg))for(t=!0;t;){for(t=!1,b=this.Md+1;b<=this.Ia;b++)t=Lg(this,b,1)||t;for(b=this.Md-1;0<=b;b--)t=Lg(this,b,-1)||t;t=Lg(this,this.Md,0)||t}if(0!=(4&this.bg)){for(b=this.Md+1;b<=this.Ia;b++)jg(this,b,1);for(b=this.Md-1;0<=b;b--)jg(this,b,-1);jg(this,this.Md,0)}if(a&&(Bg(this,-1),Bg(this,1)),0!=(2&this.bg))for(t=!0;t;){for(t=!1,t=Lg(this,this.Md,0)||t,b=this.Md+1;b<=this.Ia;b++)t=Lg(this,b,0)||t;for(b=this.Md-1;0<=b;b--)t=Lg(this,b,0)||t}}else!function(a){for(var b=z(),t=a.el.length,e=0;e<=t;e++)b[e]=[];for(e=a.network.vertexes.iterator;e.next();){var n=e.value;b[t-n.layer][n.index]=n}t=new at,function(a,b){for(var t=a.length,e=1;e<t-1;e++)for(var n=0,o=0,g=a[e],h=a[e+1],l=0;o<h.length;l++){var c=h[l];t:{if(null===c.node){var f=hm(c);if(0<f.length){f=null===f[0].node;break t}}f=!1}var d=f;if(l===h.length-1||d){for(f=g.length-1,d&&(f=hm(c)[0].index);o<=l;){if(!(c=h[o]).ao){d=[];for(var p=r(c.sourceEdgesArrayAccess),q=p.next();!q.done;q=p.next())(q=q.value).valid&&d.push(q);c.ao=d}for(d=(c=r(c.ao)).next();!d.done;d=c.next())((p=(d=d.value).fromVertex.index)<n||p>f)&&b.add(d);o++}n=f}}}(b,t);var o=null,g=null,h=null,l=null,c=0!=(1&a.ve),f=0!=(2&a.ve),d=0!=(4&a.ve),p=0!=(8&a.ve);for(c&&(a.verticalAlignment(b,t,!0),o=Ig(a,b,!0,!1)),b.reverse(),d&&(a.verticalAlignment(b,t,!1),h=Ig(a,b,!1,!1)),e=r(b),n=e.next();!n.done;n=e.next())n.value.reverse();p&&(a.verticalAlignment(b,t,!1),l=Ig(a,b,!1,!0)),b.reverse(),f&&(a.verticalAlignment(b,t,!0),g=Ig(a,b,!0,!0)),R(b),a.u(o,g,h,l),a.network.vertexes.each((function(a){var b=z();c&&b.push(o.get(a)),f&&b.push(g.get(a)),d&&b.push(h.get(a)),p&&b.push(l.get(a)),b.sort((function(a,b){return a-b}));var t=b.length;t=(b[Math.floor((t-1)/2)]+b[Math.ceil((t-1)/2)])/2,R(b),a.zc=t}))}(this)},ag.prototype.verticalAlignment=function(a,b,t){!function(a){for(var b=0;b<a.length;b++)for(var t=a[b],e=0;e<t.length;e++){var n=t[e];n.root=n,n.align=n,n.Tz=b,n.vi=e}}(a);for(var e=(a=r(a)).next();!e.done;e=a.next())for(var n=-1,o=(e=r(e.value)).next();!o.done;o=e.next()){o=o.value;var g=t?hm(o):lm(o),h=g.length;if(0<h){g.sort((function(a,b){return a.vi-b.vi}));var l=(h-1)/2;for(h=Math.floor(l),l=Math.ceil(l);h<=l;h++)if(o.align===o){var c,f=g[h];c=t?am(f,o):am(o,f),!b.contains(c)&&n<f.vi&&(f.align=o,o.root=f.root,o.align=f.root,n=f.vi)}}}},ag.prototype.u=function(a){for(var b=[],t=0;t<arguments.length;++t)b[t]=arguments[t];t=-1;for(var e=z(),n=z(),o=1/0,g=0;4>g;g++)if(b[g]){var r=Eg(this,b[g],e,n,g);r<o&&(t=g,o=r)}for(o={},g=0;4>g;o={delta:o.delta},g++)b[g]&&(o.delta=0===g||2===g?e[t]-e[g]:n[t]-n[g],0!==o.delta&&b[g].each(function(a){return function(b){b.value+=a.delta}}(o)));R(e),R(n)},ag.prototype.commitLayout=function(){if(this.setsPortSpots)for(var a=Vg(this,!0),b=Vg(this,!1),t=this.network.edges.iterator;t.next();){var e=t.value.link;null!==e&&(e.fromSpot=a,e.toSpot=b)}this.commitNodes(),this.Gu(),this.isRouting&&this.commitLinks()},ag.prototype.commitNodes=function(){this.he=[],this.Ld=[],this.Kd=[],this.Ta=[];for(var a=0;a<=this.Ia;a++)this.he[a]=0,this.Ld[a]=0,this.Kd[a]=0,this.Ta[a]=0;for(a=this.network.vertexes.iterator;a.next();){var b=a.value,t=b.layer;this.he[t]=Math.max(this.he[t],this.nodeMinLayerSpace(b,!0)),this.Ld[t]=Math.max(this.Ld[t],this.nodeMinLayerSpace(b,!1))}b=0,t=this.ie;for(var e=0;e<=this.Ia;e++){var n=t;0>=this.he[e]+this.Ld[e]&&(n=0),0<e&&(b+=n/2),90===this.K||0===this.K?(b+=this.Ld[e],this.Kd[e]=b,b+=this.he[e]):(b+=this.he[e],this.Kd[e]=b,b+=this.Ld[e]),e<this.Ia&&(b+=n/2),this.Ta[e]=b}for(t=b,b=this.arrangementOrigin,e=0;e<=this.Ia;e++)270===this.K?this.Kd[e]=b.y+this.Kd[e]:90===this.K?(this.Kd[e]=b.y+t-this.Kd[e],this.Ta[e]=t-this.Ta[e]):180===this.K?this.Kd[e]=b.x+this.Kd[e]:(this.Kd[e]=b.x+t-this.Kd[e],this.Ta[e]=t-this.Ta[e]);t=0!==this.ve,a.reset(),e=270===this.K||90===this.K;for(var o=1/0,g=n=1/0,r=-1/0;a.next();){var h=a.value,l=h.layer,c=0|h.column;e?(g=b.x+this.lc*c,l=this.Kd[l]):(g=this.Kd[l],l=b.y+this.lc*c),h.centerX=g,h.centerY=l,t&&isFinite(h.zc)&&(e?h.node?h.x=b.x+h.zc:h.centerX=b.x+h.zc:h.node?h.y=b.y+h.zc:h.centerY=b.y+h.zc),o=Math.min(h.x,o),n=Math.min(h.y,n),e?(g=o,r=Math.max(r,h.bounds.right)):(g=n,r=Math.max(r,h.bounds.bottom))}for(this.xw=r-g,o=b.x-o,b=b.y-n,this.Rf=new St(t&&e?0:o,t&&!e?0:b),a.reset();a.next();)(t=a.value).x+=o,t.y+=b,t.commit()},ag.prototype.Gu=function(){for(var a=0,b=this.ie,t=0;t<=this.Ia;t++)a+=this.he[t],a+=this.Ld[t];a+=this.Ia*b,b=[],t=0!==this.ve?this.xw:this.lc*this.Ra;for(var e=this.maxLayer;0<=e;e--)270===this.K?0===e?b.push(new Ut(0,0,t,Math.abs(this.Ta[0]))):b.push(new Ut(0,this.Ta[e-1],t,Math.abs(this.Ta[e-1]-this.Ta[e]))):90===this.K?0===e?b.push(new Ut(0,this.Ta[0],t,Math.abs(this.Ta[0]-a))):b.push(new Ut(0,this.Ta[e],t,Math.abs(this.Ta[e-1]-this.Ta[e]))):180===this.K?0===e?b.push(new Ut(0,0,Math.abs(this.Ta[0]),t)):b.push(new Ut(this.Ta[e-1],0,Math.abs(this.Ta[e-1]-this.Ta[e]),t)):0===e?b.push(new Ut(this.Ta[0],0,Math.abs(this.Ta[0]-a),t)):b.push(new Ut(this.Ta[e],0,Math.abs(this.Ta[e-1]-this.Ta[e]),t));this.commitLayers(b,this.Rf)},ag.prototype.commitLayers=function(){},ag.prototype.commitLinks=function(){for(var b,a=this.network.edges.iterator;a.next();)null!==(b=a.value.link)&&(b.uh(),b.Ej(),b.zf());for(a.reset();a.next();)null!==(b=a.value.link)&&b.vg();for(a.reset();a.next();){var t=a.value;if(null!==(b=t.link)){b.uh();var e=b,n=e.fromNode,o=e.toNode,g=e.fromPort,r=e.toPort;if(null!==n){var h=n.findVisibleNode();null!==h&&h!==n&&(n=h,g=h.port)}null!==o&&(null!==(h=o.findVisibleNode())&&h!==o&&(o=h,r=h.port));var l=b.computeSpot(!0,g);h=b.computeSpot(!1,r);var c=t.fromVertex,f=t.toVertex;if(t.valid)b.curve===hf&&4===b.pointsCount&&(c.column===f.column&&0===this.alignOption?(t=b.getLinkPoint(n,g,l,!0,!1,o,r),r=b.getLinkPoint(o,r,h,!1,!1,n,g),t.w()||t.set(n.actualBounds.center),r.w()||r.set(o.actualBounds.center),b.Ej(),b.yf(t.x,t.y),b.yf((2*t.x+r.x)/3,(2*t.y+r.y)/3),b.yf((t.x+2*r.x)/3,(t.y+2*r.y)/3),b.yf(r.x,r.y)):(t=e=!1,null!==g&&l===ae&&(e=!0),null!==r&&h===ae&&(t=!0),(e||t)&&(h=null,e&&((h=b.getLinkPointFromPoint(n,g,g.ga(fe),b.i(3),!0)).w()||h.set(n.actualBounds.center),b.L(0,h.x,h.y)),n=null,t&&((n=b.getLinkPointFromPoint(o,r,r.ga(fe),b.i(0),!1)).w()||n.set(o.actualBounds.center),b.L(3,n.x,n.y)),h&&(o=b.i(2),b.L(1,(2*h.x+o.x)/3,(2*h.y+o.y)/3)),n&&(o=b.i(1),b.L(2,(2*n.x+o.x)/3,(2*n.y+o.y)/3))))),b.zf();else if(c.layer===f.layer)b.zf();else{var p=!1,q=!1,d=this.ie,u=b.firstPickIndex+1;if(b.isOrthogonal){q=!0;var m=b.pointsCount;4<m&&b.points.removeRange(2,m-3)}else if(b.curve===hf)p=!0,4<(m=b.pointsCount)&&b.points.removeRange(2,m-3),4===m&&(u=2);else{m=b.pointsCount;var y=l===ae,v=h===ae;2<m&&y&&v?b.points.removeRange(1,m-2):3<m&&y&&!v?b.points.removeRange(1,m-3):3<m&&!y&&v?b.points.removeRange(2,m-2):4<m&&!y&&!v&&b.points.removeRange(2,m-3)}if(t.rev){for(;null!==f&&c!==f;){var x=m=null;for(y=f.sourceEdges.iterator;y.next()&&((v=y.value).link!==t.link||(m=v.fromVertex,x=v.toVertex,null!==m.node)););if(null===m)break;if(m!==c){y=b.i(u-1).x,v=b.i(u-1).y;var w=m.centerX,k=m.centerY;if(q)180===this.K||0===this.K?u===b.firstPickIndex+1?(b.m(u++,y,v),b.m(u++,y,k)):(null!==x?x.centerY:v)!==k&&(x=this.Ta[m.layer-1]+this.Rf.x,b.m(u++,x,v),b.m(u++,x,k)):u===b.firstPickIndex+1?(b.m(u++,y,v),b.m(u++,w,v)):(null!==x?x.centerX:y)!==w&&(x=this.Ta[m.layer-1]+this.Rf.y,b.m(u++,y,x),b.m(u++,w,x));else if(u===b.firstPickIndex+1){x=Math.max(10,this.he[f.layer]);var M=Math.max(10,this.Ld[f.layer]);if(p)180===this.K?w<=f.bounds.x?(f=f.bounds.x,b.m(u++,f-x,k),b.m(u++,f,k),b.m(u++,f+M,k)):(b.m(u++,w-x,k),b.m(u++,w,k),b.m(u++,w+M,k)):90===this.K?k>=f.bounds.bottom?(f=f.bounds.y+f.bounds.height,b.m(u++,w,f+M),b.m(u++,w,f),b.m(u++,w,f-x)):(b.m(u++,w,k+M),b.m(u++,w,k),b.m(u++,w,k-x)):270===this.K?k<=f.bounds.y?(f=f.bounds.y,b.m(u++,w,f-x),b.m(u++,w,f),b.m(u++,w,f+M)):(b.m(u++,w,k-x),b.m(u++,w,k),b.m(u++,w,k+M)):0===this.K&&(w>=f.bounds.right?(f=f.bounds.x+f.bounds.width,b.m(u++,f+M,k),b.m(u++,f,k),b.m(u++,f-x,k)):(b.m(u++,w+M,k),b.m(u++,w,k),b.m(u++,w-x,k)));else{b.m(u++,y,v);var S=0;180===this.K||0===this.K?((180===this.K?w>=f.bounds.right:w<=f.bounds.x)&&(S=(0===this.K?-x:M)/2),b.m(u++,y+S,k)):((270===this.K?k>=f.bounds.bottom:k<=f.bounds.y)&&(S=(90===this.K?-x:M)/2),b.m(u++,w,v+S)),b.m(u++,w,k)}}else x=Math.max(10,this.he[m.layer]),M=Math.max(10,this.Ld[m.layer]),p?180===this.K?(b.m(u++,w-x-d,k),b.m(u++,Math.min(w-x+d/2,w),k),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,Math.max(w+M-d/2,w),k),b.m(u++,w+M+d,k)):90===this.K?(b.m(u++,w,k+M+d),b.m(u++,w,Math.max(k+M-d/2,k)),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,w,Math.min(k-x+d/2,k)),b.m(u++,w,k-x-d)):270===this.K?(b.m(u++,w,k-x-d),b.m(u++,w,Math.min(k-x+d/2,k)),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,w,Math.max(k+M-d/2,k)),b.m(u++,w,k+M+d)):(b.m(u++,w+M+d,k),b.m(u++,Math.max(w+M-d/2,w),k),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,Math.min(w-x+d/2,w),k),b.m(u++,w-x-d,k)):b.m(u++,w,k)}f=m}(null===r||l!==ae||q)&&(y=b.i(u-1).x,v=b.i(u-1).y,w=b.i(u).x,k=b.i(u).y,q?(d=this.Ld[c.layer],180===this.K||0===this.K?((q=v)>=c.bounds.y&&q<=c.bounds.bottom&&(180===this.K?w>=c.bounds.x:w<=c.bounds.right)&&(f=c.centerX+(180===this.K?-d:d),q=q<c.bounds.y+c.bounds.height/2?c.bounds.y-this.lc/2:c.bounds.bottom+this.lc/2,b.m(u++,f,v),b.m(u++,f,q)),b.m(u++,w,q)):((q=y)>=c.bounds.x&&q<=c.bounds.right&&(270===this.K?k>=c.bounds.y:k<=c.bounds.bottom)&&(f=c.centerY+(270===this.K?-d:d),q=q<c.bounds.x+c.bounds.width/2?c.bounds.x-this.lc/2:c.bounds.right+this.lc/2,b.m(u++,y,f),b.m(u++,q,f)),b.m(u++,q,k)),b.m(u++,w,k)):p?(x=Math.max(10,this.he[c.layer]),M=Math.max(10,this.Ld[c.layer]),180===this.K&&w>=c.bounds.x?(f=c.bounds.x+c.bounds.width,b.L(u-2,f,v),b.L(u-1,f+M,v)):90===this.K&&k<=c.bounds.bottom?(f=c.bounds.y,b.L(u-2,y,f),b.L(u-1,y,f-x)):270===this.K&&k>=c.bounds.y?(f=c.bounds.y+c.bounds.height,b.L(u-2,y,f),b.L(u-1,y,f+M)):0===this.K&&w<=c.bounds.right&&(f=c.bounds.x,b.L(u-2,f,v),b.L(u-1,f-x,v))):(x=Math.max(10,this.he[c.layer]),M=Math.max(10,this.Ld[c.layer]),q=0,180===this.K||0===this.K?((180===this.K?w<=c.bounds.x:w>=c.bounds.right)&&(q=(0===this.K?M:-x)/2),b.m(u++,w+q,v)):((270===this.K?k<=c.bounds.y:k>=c.bounds.bottom)&&(q=(90===this.K?M:-x)/2),b.m(u++,y,k+q)),b.m(u++,w,k)))}else{for(;null!==c&&c!==f;){for(x=m=null,c=c.destinationEdges.iterator;c.next()&&((y=c.value).link!==t.link||(m=y.toVertex,null!==(x=y.fromVertex).node&&(x=null),null!==m.node)););if(null===m)break;m!==f&&(y=b.i(u-1).x,v=b.i(u-1).y,w=m.centerX,k=m.centerY,q?180===this.K||0===this.K?(null!==x?x.centerY:v)!==k&&(x=this.Ta[m.layer]+this.Rf.x,u===b.firstPickIndex+1&&(x=0===this.K?Math.max(x,y):Math.min(x,y)),b.m(u++,x,v),b.m(u++,x,k)):(null!==x?x.centerX:y)!==w&&(x=this.Ta[m.layer]+this.Rf.y,u===b.firstPickIndex+1&&(x=90===this.K?Math.max(x,v):Math.min(x,v)),b.m(u++,y,x),b.m(u++,w,x)):(x=Math.max(10,this.he[m.layer]),M=Math.max(10,this.Ld[m.layer]),p?180===this.K?(b.m(u++,w+M+d,k),b.m(u++,Math.max(w+M-d/2,w),k),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,Math.min(w-x+d/2,w),k),b.m(u++,w-x-d,k)):90===this.K?(b.m(u++,w,k-x-d),b.m(u++,w,Math.min(k-x+d/2,k)),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,w,Math.max(k+M-d/2,k)),b.m(u++,w,k+M+d)):270===this.K?(b.m(u++,w,k+M+d),b.m(u++,w,Math.max(k+M-d/2,k)),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,w,Math.min(k-x+d/2,k)),b.m(u++,w,k-x-d)):(b.m(u++,w-x-d,k),b.m(u++,Math.min(w-x+d/2,w),k),b.m(u++,w,k),b.m(u++,w,k),b.m(u++,Math.max(w+M-d/2,w),k),b.m(u++,w+M+d,k)):180===this.K?(b.m(u++,w+M,k),b.m(u++,w-x,k)):90===this.K?(b.m(u++,w,k-x),b.m(u++,w,k+M)):270===this.K?(b.m(u++,w,k+M),b.m(u++,w,k-x)):(b.m(u++,w-x,k),b.m(u++,w+M,k)))),c=m}q&&(y=b.i(u-1).x,v=b.i(u-1).y,w=b.i(u).x,k=b.i(u).y,180===this.K||0===this.K?v!==k&&(x=0===this.K?Math.min(Math.max((w+y)/2,this.Ta[f.layer]+this.Rf.x),w):Math.max(Math.min((w+y)/2,this.Ta[f.layer]+this.Rf.x),w),b.m(u++,x,v),b.m(u++,x,k)):y!==w&&(x=90===this.K?Math.min(Math.max((k+v)/2,this.Ta[f.layer]+this.Rf.y),k):Math.max(Math.min((k+v)/2,this.Ta[f.layer]+this.Rf.y),k),b.m(u++,y,x),b.m(u++,w,x)))}null!==e&&p&&4<=b.pointsCount&&(null!==g&&(g=l===ae?b.getLinkPointFromPoint(n,g,g.ga(fe),b.i(3),!0):b.i(0),l===ae&&(l=b.i(2),e=b.i(3),90===this.direction||270===this.direction?(b.L(1,(g.x+l.x)/2,l.y),b.L(2,e.x,(l.y+e.y)/2)):(b.L(1,l.x,(g.y+l.y)/2),b.L(2,(l.x+e.x)/2,e.y))),g.w()||g.set(n.actualBounds.center),b.L(0,g.x,g.y)),null!==r&&(n=h===ae?b.getLinkPointFromPoint(o,r,r.ga(fe),b.i(b.pointsCount-4),!1):b.i(b.pointsCount-1),h===ae&&(r=b.i(b.pointsCount-3),h=b.i(b.pointsCount-4),90===this.direction||270===this.direction?(b.L(b.pointsCount-2,(n.x+r.x)/2,r.y),b.L(b.pointsCount-2,h.x,(r.y+h.y)/2)):(b.L(b.pointsCount-2,r.x,(n.y+r.y)/2),b.L(b.pointsCount-3,(r.x+h.x)/2,h.y))),n.w()||n.set(o.actualBounds.center),b.L(b.pointsCount-1,n.x,n.y))),b.zf(),t.commit()}}}this.avoidOrthogonalOverlaps()},ag.prototype.avoidOrthogonalOverlaps=function(){if(!(0>=this.linkSpacing)){for(var a=new ot,b=this.network.edges.iterator;b.next();){var t=b.value.link;null!==t&&t.isOrthogonal&&!a.contains(t)&&a.add(t)}if(0<a.count)if(90===this.K||270===this.K){for(b=0,t=[],a=a.iterator;a.next();){var e=a.value;if(null!==e&&e.isOrthogonal)for(var n=2;n<e.pointsCount-3;n++){var o=e.i(n),g=e.i(n+1);if(this.B(o.y,g.y)&&!this.B(o.x,g.x)){var r=new nm;r.layer=Math.floor(o.y/2);var h=e.i(0),l=e.i(e.pointsCount-1);if(r.first=h.x*h.x+h.y,r.kc=l.x*l.x+l.y,r.rd=Math.min(o.x,g.x),r.Ic=Math.max(o.x,g.x),r.index=n,r.link=e,n+2<e.pointsCount){h=e.i(n-1),l=e.i(n+2);var c=0;h.y<o.y?c=l.y<o.y?3:o.x<g.x?2:1:h.y>o.y&&(c=l.y>o.y?0:g.x<o.x?2:1),r.j=c}t.push(r)}}}if(1<t.length)for(t.sort(this.Vx),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].Ic,n=a+1;n<e&&t[n].rd<g;)g=Math.max(g,t[n].Ic),n++;if(1<(g=n-o)){for(this.zi(t,this.Is,o,o+g),c=1,r=t[o].kc,h=o;h<n;h++)(l=t[h]).kc!==r&&(c++,r=l.kc);this.zi(t,this.Ux,o,o+g);var f=1;for(r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].kc,this.zi(t,this.Is,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++){var p=t[f];(h?p.first:p.kc)!==r&&(c++,r=h?p.first:p.kc);var q=p.link;o=q.i(p.index),g=q.i(p.index+1);var d=this.linkSpacing*(c-(l-1)/2);b++,q.uh(),q.L(p.index,o.x,o.y+d),q.L(p.index+1,g.x,g.y+d),q.zf()}}o=n}a=e}}else{for(b=0,t=[],a=a.iterator;a.next();)if(null!==(e=a.value)&&e.isOrthogonal)for(n=2;n<e.pointsCount-3;n++)o=e.i(n),g=e.i(n+1),this.B(o.x,g.x)&&!this.B(o.y,g.y)&&((r=new nm).layer=Math.floor(o.x/2),h=e.i(0),l=e.i(e.pointsCount-1),r.first=h.x+h.y*h.y,r.kc=l.x+l.y*l.y,r.rd=Math.min(o.y,g.y),r.Ic=Math.max(o.y,g.y),r.index=n,r.link=e,n+2<e.pointsCount&&(h=e.i(n-1),l=e.i(n+2),c=0,h.x<o.x?c=l.x<o.x?3:o.y<g.y?2:1:h.x>o.x&&(c=l.x>o.x?0:g.y<o.y?2:1),r.j=c),t.push(r));if(1<t.length)for(t.sort(this.Vx),a=0;a<t.length;){for(o=t[a].layer,e=a+1;e<t.length&&t[e].layer===o;)e++;if(1<e-a)for(o=a;o<e;){for(g=t[o].Ic,n=a+1;n<e&&t[n].rd<g;)g=Math.max(g,t[n].Ic),n++;if(1<(g=n-o)){for(this.zi(t,this.Is,o,o+g),c=1,r=t[o].kc,h=o;h<n;h++)(l=t[h]).kc!==r&&(c++,r=l.kc);for(this.zi(t,this.Ux,o,o+g),f=1,r=t[o].first,h=o;h<n;h++)(l=t[h]).first!==r&&(f++,r=l.first);for(h=!0,l=f,c<f?(h=!1,l=c,r=t[o].kc,this.zi(t,this.Is,o,o+g)):r=t[o].first,c=0,f=o;f<n;f++)p=t[f],(h?p.first:p.kc)!==r&&(c++,r=h?p.first:p.kc),o=(q=p.link).i(p.index),g=q.i(p.index+1),d=this.linkSpacing*(c-(l-1)/2),b++,q.uh(),q.L(p.index,o.x+d,o.y),q.L(p.index+1,g.x+d,g.y),q.zf()}o=n}a=e}}}},(e=ag.prototype).Vx=function(a,b){return a instanceof nm&&b instanceof nm&&a!==b?a.layer<b.layer?-1:a.layer>b.layer?1:a.rd<b.rd?-1:a.rd>b.rd?1:a.Ic<b.Ic?-1:a.Ic>b.Ic?1:0:0},e.Ux=function(a,b){return a instanceof nm&&b instanceof nm&&a!==b?a.first<b.first?-1:a.first>b.first||a.j<b.j?1:a.j>b.j||a.rd<b.rd?-1:a.rd>b.rd?1:a.Ic<b.Ic?-1:a.Ic>b.Ic?1:0:0},e.Is=function(a,b){return a instanceof nm&&b instanceof nm&&a!==b?a.kc<b.kc?-1:a.kc>b.kc||a.j<b.j?1:a.j>b.j||a.rd<b.rd?-1:a.rd>b.rd?1:a.Ic<b.Ic?-1:a.Ic>b.Ic?1:0:0},e.B=function(a,b){return-1<(a-=b)&&1>a},e.zi=function(a,b,t,e){var n=a.length,o=e-t;if(!(1>=o))if((0>t||t>=n-1)&&T("not in range 0 <= from < length: "+t),2===o)0<b(e=a[t],n=a[t+1])&&(a[t]=n,a[t+1]=e);else if(0===t)if(e>=n)a.sort(b);else for((t=a.slice(0,e)).sort(b),b=0;b<e;b++)a[b]=t[b];else if(e>=n)for((e=a.slice(t)).sort(b),b=t;b<n;b++)a[b]=e[b-t];else for((n=a.slice(t,e)).sort(b),b=t;b<e;b++)a[b]=n[b-t]},v.Object.defineProperties(ag.prototype,{layerSpacing:{get:function(){return this.ie},set:function(a){this.ie!==a&&0<=a&&(this.ie=a,this.C())}},columnSpacing:{get:function(){return this.lc},set:function(a){this.lc!==a&&0<a&&(this.lc=a,this.C())}},direction:{get:function(){return this.K},set:function(a){this.K!==a&&(0===a||90===a||180===a||270===a?(this.K=a,this.C()):T("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}},cycleRemoveOption:{get:function(){return this.Ck},set:function(a){this.Ck===a||a!==Ug&&a!==Xg&&a!==qg||(this.Ck=a,this.C())}},layeringOption:{get:function(){return this.Yk},set:function(a){this.Yk===a||a!==Kg&&a!==Hg&&a!==Wg||(this.Yk=a,this.C())}},initializeOption:{get:function(){return this.Pk},set:function(a){this.Pk===a||a!==Jg&&a!==Zg&&a!==_g||(this.Pk=a,this.C())}},iterations:{get:function(){return this.bj},set:function(a){this.bj!==a&&0<=a&&(this.bj=a,this.C())}},aggressiveOption:{get:function(){return this.qk},set:function(a){this.qk===a||a!==$g&&a!==Qg&&a!==tm||(this.qk=a,this.C())}},packOption:{get:function(){return this.bg},set:function(a){this.bg!==a&&0<=a&&8>a&&(this.bg=a,this.C())}},alignOption:{get:function(){return this.ve},set:function(a){this.ve!==a&&0<=a&&16>a&&(this.ve=a,this.C())}},setsPortSpots:{get:function(){return this.sf},set:function(a){this.sf!==a&&(this.sf=a,this.C())}},linkSpacing:{get:function(){return this.Bn},set:function(a){this.Bn!==a&&0<=a&&(this.Bn=a,this.C())}},maxLayer:{get:function(){return this.Ia}},maxIndex:{get:function(){return this.Hq}},maxColumn:{get:function(){return this.Ra}},minIndexLayer:{get:function(){return this.Gn}},maxIndexLayer:{get:function(){return this.Md}}});var Xg=new W(ag,"CycleDepthFirst",0),Ug=new W(ag,"CycleGreedy",1),qg=new W(ag,"CycleFromLayers",2),Kg=new W(ag,"LayerOptimalLinkLength",0),Hg=new W(ag,"LayerLongestPathSink",1),Wg=new W(ag,"LayerLongestPathSource",2),Jg=new W(ag,"InitDepthFirstOut",0),Zg=new W(ag,"InitDepthFirstIn",1),_g=new W(ag,"InitNaive",2),$g=new W(ag,"AggressiveNone",0),Qg=new W(ag,"AggressiveLess",1),tm=new W(ag,"AggressiveMore",2),im=8;function nm(){this.index=this.Ic=this.rd=this.kc=this.first=this.layer=0,this.link=null,this.j=0}function om(a){Hf.call(this,a)}function rm(a){$f.call(this,a),this.Zn=this.ao=this.$n=this.bo=null,this.Za=this.Ag=this.Ig=-1,this.u=NaN,this.F=null,this.valid=!1,this.finish=this.Kl=NaN,this.Cu=0,this.dv=this.ev=null}function sm(a,b){return a.index-b.index}function am(a,b){if(!a.Zn){for(var t=[],e=r(a.destinationEdgesArrayAccess),n=e.next();!n.done;n=e.next())(n=n.value).valid&&t.push(n);a.Zn=t}for(t=(a=r(a.Zn)).next();!t.done;t=a.next())if((t=t.value).toVertex===b)return t;T("Unable to find destination edge to given vertex")}function hm(a){if(!a.bo){for(var b=[],t=r(a.sourceEdgesArrayAccess),e=t.next();!e.done;e=t.next())(e=e.value).valid&&b.push(e.fromVertex);b.sort(sm),a.bo=b}return a.bo}function lm(a){if(!a.$n){for(var b=[],t=r(a.destinationEdgesArrayAccess),e=t.next();!e.done;e=t.next())(e=e.value).valid&&b.push(e.toVertex);b.sort(sm),a.$n=b}return a.$n}function um(a){ed.call(this,a),this.j=this.ia=this.Ha=!1,this.V=this.u=NaN,this.F=this.o=0}function cm(a){Uf.call(this),this.Vb=new at,this.Vn=Em,this.ud=Vm,this.uo=iy,this.Aq=ly,this.$v=[],this.td=!0,this.Sb=sy,this.$d=new Vt(10,10).freeze();var b=new fy(this);this.W=new dy(b),this.Y=new dy(b),this.qu=[],a&&Object.assign(this,a)}function fm(a){var b=new at;for(a=a.iterator;a.next();){var t=a.value;t.initialized||b.add(t)}return b}function dm(a,b){var t=999999,e=null;for(b=b.iterator;b.next();){var n=b.value;switch(a.ud){case Vm:n.sourceEdges.count<t&&(t=n.sourceEdges.count,e=n);break;case Ym:n.destinationEdges.count<t&&(t=n.destinationEdges.count,e=n);break;default:T("Unhandled path value "+a.ud.toString())}}return e}function pm(a,b){if(null!==b){switch(a.ud){case Vm:if(0<b.destinationEdges.count){for(var t=new ot,e=b.destinationVertexes;e.next();){var n=e.value;gm(a,b,n)&&t.add(n)}0<t.count&&(b.children=t.Fa())}break;case Ym:if(0<b.sourceEdges.count){for(t=new ot,e=b.sourceVertexes;e.next();)gm(a,b,n=e.value)&&t.add(n);0<t.count&&(b.children=t.Fa())}break;default:T("Unhandled path value"+a.ud.toString())}for(e=(t=b.children).length,n=0;n<e;n++){var o=t[n];o.initialized=!0,o.level=b.level+1,o.parent=b,a.Vb.remove(o)}for(b=0;b<e;b++)pm(a,t[b])}}function gm(a,b,t){if(t.initialized){if(null===b)var e=!1;else{for(e=b.parent;null!==e&&e!==t;)e=e.parent;e=e===t}if(e||t.level>b.level)return!1;a.removeChild(t.parent,t)}return!0}function mm(a,b){if(null!==b){a.initializeTreeVertexValues(b),b.alignment===_m&&a.sortTreeVertexChildren(b);for(var t=0,e=b.childrenCount,n=0,o=b.children,g=o.length,r=0;r<g;r++){var h=o[r];mm(a,h),t+=h.descendantCount+1,e=Math.max(e,h.maxChildrenCount),n=Math.max(n,h.maxGenerationCount)}b.descendantCount=t,b.maxChildrenCount=e,b.maxGenerationCount=0<e?n+1:0}}function ym(a,b){if(null!==b){a.assignTreeVertexValues(b);for(var t=(b=b.children).length,e=0;e<t;e++)ym(a,b[e])}}function vm(a,b){if(null!==b){b.alignment!==_m&&a.sortTreeVertexChildren(b);for(var t=(b=b.children).length,e=0;e<t;e++)vm(a,b[e])}}function xm(a){return a===Zm||a===_m||a===$m||a===Qm}function bm(a){return a===Zm||a===_m}function wm(a){var b=a.parent;if(null!==b){var t=b.alignment;if(xm(t)){if(bm(t)){for(b=b.children,t=0;t<b.length&&a!==b[t];)t++;return 0==t%2}if(t===$m)return!0}}return!1}function km(a,b){if(0===b.childrenCount){var t=!1,e=0;null!==b.parent&&(e=b.parent.angle,t=xm(t=b.parent.alignment));var n=wm(b);b.S.h(0,0),b.Da.h(b.width,b.height),null===b.parent||null===b.comments||(180!==e&&270!==e||t)&&!n?b.la.h(0,0):180===e&&!t||(90===e||270===e)&&n?b.la.h(b.width-2*b.focus.x,0):b.la.h(0,b.height-2*b.focus.y)}else{t=90===(e=Rm(b))||270===e;for(var o=0,g=(n=b.children).length,r=0;r<g;r++){var h=n[r];o=Math.max(o,t?h.Da.width:h.Da.height)}var l=b.alignment,c=l===Wm,f=l===Jm;r=xm(l);var p=Math.max(0,b.breadthLimit);h=a.computeLayerSpacing(b);var q=b.nodeSpacing,d=a.computeNodeIndent(b),u=c||f?0:d/2,m=b.rowSpacing,y=0;(c||f||b.gm||b.hm&&1===b.maxGenerationCount)&&(y=Math.max(0,b.rowIndent)),c=b.width;var v=b.height,x=0,w=0,k=0,M=0,S=0,P=0,N=0,C=0,T=0,L=0;if(r&&!bm(l)&&135<e&&n.reverse(),bm(l))if(1<g)for(var A=0;A<g;A++){var j=n[A],F=j.Da;0==A%2&&A!==g-1?T=Math.max(T,(t?F.width:F.height)+a.computeBusNodeSpacing(j)-q):0!=A%2&&(L=Math.max(L,(t?F.width:F.height)+a.computeBusNodeSpacing(j)-q))}else 1===g&&(T=t?n[0].Da.width:n[0].Da.height);if(r)switch(l){case Zm:case _m:T=(w=135>e?Mm(a,b,n,T,x,w):Sm(a,b,n,T,x,w)).x,x=w.width,w=w.height;break;case $m:for(p=0;p<g;p++)k=(u=n[p]).Da,L=0===N?0:m,t?(u.S.h(o-k.width,S+L),x=Math.max(x,k.width),w=Math.max(w,S+L+k.height),S+=L+k.height):(u.S.h(M+L,o-k.height),x=Math.max(x,M+L+k.width),w=Math.max(w,k.height),M+=L+k.width),N++;break;case Qm:for(o=0;o<g;o++)u=(p=n[o]).Da,k=0===N?0:m,t?(p.S.h(q/2+b.focus.x,S+k),x=Math.max(x,u.width),w=Math.max(w,S+k+u.height),S+=k+u.height):(p.S.h(M+k,q/2+b.focus.y),x=Math.max(x,M+k+u.width),w=Math.max(w,u.height),M+=k+u.width),N++}else for(L=0;L<g;L++)j=(A=n[L]).Da,t?(0<p&&0<N&&M+q+j.width>p&&(M<o&&Lm(b,l,o-M,0,C,L-1),P++,N=0,C=L,k=w,M=0,S=135<e?-w-m:w+m),F=0===N?u:q,jm(a,A,0,S),A.S.h(M+F,S),x=Math.max(x,M+F+j.width),w=Math.max(w,k+(0===P?0:m)+j.height),M+=F+j.width):(0<p&&0<N&&S+q+j.height>p&&(S<o&&Lm(b,l,0,o-S,C,L-1),P++,N=0,C=L,k=x,S=0,M=135<e?-x-m:x+m),F=0===N?u:q,jm(a,A,M,0),A.S.h(M,S+F),w=Math.max(w,S+F+j.height),x=Math.max(x,k+(0===P?0:m)+j.width),S+=F+j.height),N++;switch(0<P&&(t?(w+=Math.max(0,h),M<x&&Lm(b,l,x-M,0,C,g-1),0<y&&(f||Am(b,y,0,0,g-1),x+=y)):(x+=Math.max(0,h),S<w&&Lm(b,l,0,w-S,C,g-1),0<y&&(f||Am(b,0,y,0,g-1),w+=y))),y=f=0,l){case Km:t?f+=x/2-b.focus.x-d/2:y+=w/2-b.focus.y-d/2;break;case Hm:0<P?t?f+=x/2-b.focus.x-d/2:y+=w/2-b.focus.y-d/2:t?f+=(a=n[0].S.x+n[0].la.x)+(n[g-1].S.x+n[g-1].la.x+2*n[g-1].focus.x-a)/2-b.focus.x-d/2:y+=(a=n[0].S.y+n[0].la.y)+(n[g-1].S.y+n[g-1].la.y+2*n[g-1].focus.y-a)/2-b.focus.y-d/2;break;case Wm:t?(f-=d,x+=d):(y-=d,w+=d);break;case Jm:t?(f+=x-b.width+d,x+=d):(y+=w-b.height+d,w+=d);break;case Zm:case _m:t?f+=1<g?T+q/2-b.focus.x:n[0].focus.x-b.focus.x+n[0].la.x:y+=1<g?T+q/2-b.focus.y:n[0].focus.y-b.focus.y+n[0].la.y;break;case $m:t?f+=x+q/2-b.focus.x:y+=w+q/2-b.focus.y;break;case Qm:break;default:f=(a=a.customAlignment(b,f,y,x,w))[0],y=a[1],x=a[2],w=a[3]}for(a=0;a<g;a++)d=n[a],t?d.S.h(d.S.x+d.la.x-f,d.S.y+(135<e?(r?-w:-d.Da.height)+d.la.y-h:v+h+d.la.y)):d.S.h(d.S.x+(135<e?(r?-x:-d.Da.width)+d.la.x-h:c+h+d.la.x),d.S.y+d.la.y-y);t?(x=Nm(b,x,f),0>f&&(f=0),135<e&&(y+=w+h),w=Math.max(Math.max(w,v),w+v+h)):(135<e&&(f+=x+h),x=Math.max(Math.max(x,c),x+c+h),w=Cm(b,w,y),0>y&&(y=0)),b.la.h(f,y),b.Da.h(x,w)}}function Mm(a,b,t,e,n,o){var g=t.length;if(0===g)return new Ut(e,0,n,o);if(1===g)return new Ut(e,0,n=(b=t[0]).Da.width,o=b.Da.height);for(var r=b.nodeSpacing,h=b.rowSpacing,l=90===Rm(b),c=0,f=0,p=0,q=0;q<g;q++)if(!(0!=q%2||1<g&&q===g-1)){var d=t[q],u=d.Da,m=0===c?0:h;if(l){var y=a.computeBusNodeSpacing(d)-r;d.S.h(e-(u.width+y),p+m),n=Math.max(n,u.width+y),o=Math.max(o,p+m+u.height),p+=m+u.height}else y=a.computeBusNodeSpacing(d)-r,d.S.h(f+m,e-(u.height+y)),o=Math.max(o,u.height+y),n=Math.max(n,f+m+u.width),f+=m+u.width;c++}for(c=0,d=f,q=p,l?(f=e+r,p=0):(f=0,p=e+r),u=0;u<g;u++)if(0!=u%2){y=(m=t[u]).Da;var v=0===c?0:h;if(l){var x=a.computeBusNodeSpacing(m)-r;m.S.h(f+x,p+v),n=Math.max(n,f+y.width+x),o=Math.max(o,p+v+y.height),p+=v+y.height}else x=a.computeBusNodeSpacing(m)-r,m.S.h(f+v,p+x),n=Math.max(n,f+v+y.width),o=Math.max(o,p+y.height+x),f+=v+y.width;c++}return 1<g&&1==g%2&&(g=(t=t[g-1]).Da,a=a.computeBusLastRowSpacing(t,l?Math.max(Math.abs(q),Math.abs(p)):Math.max(Math.abs(d),Math.abs(f))),l?(t.S.h(e+r/2-t.focus.x-t.la.x,o+a),l=e+r/2-t.focus.x-t.la.x,n=Math.max(n,l+g.width),0>l&&(n-=l),o=Math.max(o,Math.max(q,p)+a+g.height),0>t.S.x&&(e=Pm(b,t.S.x,!1,e,r))):(t.S.h(n+a,e+r/2-t.focus.y-t.la.y),n=Math.max(n,Math.max(d,f)+a+g.width),p=e+r/2-t.focus.y-t.la.y,o=Math.max(o,p+g.height),0>p&&(o-=p),0>t.S.y&&(e=Pm(b,t.S.y,!0,e,r)))),new Ut(e,0,n,o)}function Sm(a,b,t,e,n,o){var g=t.length;if(0===g)return new Ut(e,0,n,o);if(1===g)return new Ut(e,0,n=(t=t[0]).Da.width,o=t.Da.height);for(var r=b.nodeSpacing,h=b.rowSpacing,l=270===Rm(b),c=0,f=0,p=0,q=0;q<g;q++)if(!(0!=q%2||1<g&&q===g-1)){var d=t[q],u=d.Da,m=0===c?0:h;if(l){var y=a.computeBusNodeSpacing(d)-r;p-=m+u.height,d.S.h(e-(u.width+y),p),n=Math.max(n,u.width+y),o=Math.max(o,Math.abs(p))}else y=a.computeBusNodeSpacing(d)-r,f-=m+u.width,d.S.h(f,e-(u.height+y)),o=Math.max(o,u.height+y),n=Math.max(n,Math.abs(f));c++}for(c=0,d=f,q=p,l?(f=e+r,p=0):(f=0,p=e+r),u=0;u<g;u++)if(0!=u%2){y=(m=t[u]).Da;var v=0===c?0:h;if(l){var x=a.computeBusNodeSpacing(m)-r;p-=v+y.height,m.S.h(f+x,p),n=Math.max(n,f+y.width+x),o=Math.max(o,Math.abs(p))}else x=a.computeBusNodeSpacing(m)-r,f-=v+y.width,m.S.h(f,p+x),o=Math.max(o,p+y.height+x),n=Math.max(n,Math.abs(f));c++}for(1<g&&1==g%2&&(c=(h=t[g-1]).Da,a=a.computeBusLastRowSpacing(h,l?Math.max(Math.abs(q),Math.abs(p)):Math.max(Math.abs(d),Math.abs(f))),l?(h.S.h(e+r/2-h.focus.x-h.la.x,-o-c.height-a),f=e+r/2-h.focus.x-h.la.x,n=Math.max(n,f+c.width),0>f&&(n-=f),o=Math.max(o,Math.abs(Math.min(q,p))+a+c.height),0>h.S.x&&(e=Pm(b,h.S.x,!1,e,r))):(h.S.h(-n-c.width-a,e+r/2-h.focus.y-h.la.y),n=Math.max(n,Math.abs(Math.min(d,f))+a+c.width),p=e+r/2-h.focus.y-h.la.y,o=Math.max(o,p+c.height),0>p&&(o-=p),0>h.S.y&&(e=Pm(b,h.S.y,!0,e,r)))),b=0;b<g;b++)r=t[b],l?r.S.h(r.S.x,r.S.y+o):r.S.h(r.S.x+n,r.S.y);return new Ut(e,0,n,o)}function Pm(a,b,t,e,n){for(var o=(a=a.children).length,g=0;g<o;g++)t?a[g].S.h(a[g].S.x,a[g].S.y-b):a[g].S.h(a[g].S.x-b,a[g].S.y);return b=a[o-1],Math.max(e,t?b.la.y+b.focus.y-n/2:b.la.x+b.focus.x-n/2)}function Nm(a,b,t){switch(a.alignment){case Hm:case Km:return t+a.width>b&&(b=t+a.width),0>t&&(b-=t),b;case Wm:return a.width>b?a.width:b;case Jm:return 2*a.focus.x>b?a.width:b+a.width-2*a.focus.x;case Zm:case _m:return Math.max(a.width,Math.max(b,t+a.width)-Math.min(0,t));case $m:return a.width-a.focus.x+a.nodeSpacing/2+b;case Qm:return Math.max(a.width,a.focus.x+a.nodeSpacing/2+b);default:return b}}function Cm(a,b,t){switch(a.alignment){case Hm:case Km:return t+a.height>b&&(b=t+a.height),0>t&&(b-=t),b;case Wm:return a.height>b?a.height:b;case Jm:return 2*a.focus.y>b?a.height:b+a.height-2*a.focus.y;case Zm:case _m:return Math.max(a.height,Math.max(b,t+a.height)-Math.min(0,t));case $m:return a.height-a.focus.y+a.nodeSpacing/2+b;case Qm:return Math.max(a.height,a.focus.y+a.nodeSpacing/2+b);default:return b}}function Tm(a,b,t){switch(a){case Km:case Hm:b/=2,t/=2;break;case Wm:t=b=0;break;case Jm:break;default:T("Unhandled alignment value "+a.toString())}return new St(b,t)}function Lm(a,b,t,e,n,o){Am(a,(b=Tm(b,t,e)).x,b.y,n,o)}function Am(a,b,t,e,n){if(0!==b||0!==t)for(a=a.children;e<=n;e++){var o=a[e].S;o.x+=b,o.y+=t}}function jm(a,b,t,e){var n=b.parent;switch(a.ud){case Vm:for(a=b.sourceEdges;a.next();)(b=a.value).fromVertex===n&&b.relativePoint.h(t,e);break;case Ym:for(a=b.destinationEdges;a.next();)(b=a.value).toVertex===n&&b.relativePoint.h(t,e);break;default:T("Unhandled path value "+a.ud.toString())}}function Fm(a,b,t){for(var e=0;e<a.length;e++){var n=a[e];n.x+=b,n.y+=t}}function Om(a,b,t,e,n,o,g,r){var h=Rm(b),l=90===h||270===h,c=b.nodeSpacing;b=e;var f=n;e=o;var p=g,q=t.Xo,d=t.jp;g=t.Da;var u=l?Math.max(p,g.height):Math.max(e,g.width);if(null!==q&&h===Rm(t)||(q=Bm(a,2),d=Bm(a,2),l?(q[0].h(0,0),q[1].h(0,g.height),d[0].h(g.width,0),d[1].h(d[0].x,q[1].y)):(q[0].h(0,0),q[1].h(g.width,0),d[0].h(0,g.height),d[1].h(q[1].x,d[0].y))),l){if(p=9999999,!(null===f||2>f.length||null===q||2>q.length))for(n=t=0;t<f.length&&n<q.length;){o=f[t];var m=q[n];h=m.x,l=m.y,h+=e;var y=o;t+1<f.length&&(y=f[t+1]);var v=m;m=v.x,v=v.y,n+1<q.length&&(m=(v=q[n+1]).x,v=v.y,m+=e);var x=p;o.y===l?x=h-o.x:o.y>l&&o.y<v?x=h+(o.y-l)/(v-l)*(m-h)-o.x:l>o.y&&l<y.y&&(x=h-(o.x+(l-o.y)/(y.y-o.y)*(y.x-o.x))),x<p&&(p=x),y.y<=o.y?t++:v<=l?n++:(y.y<=v&&t++,v<=y.y&&n++)}if(p=e-p,t=q,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=Bm(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].y<b[0].y;)l=t[o++],c[e++].h(l.x+n,l.y);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].y;o<t.length&&t[o].y<=h;)o++;for(;o<t.length&&t[o].y>h;)l=t[o++],c[e++].h(l.x+n,l.y);for(t=Bm(a,e),h=0;h<e;h++)t[h].assign(c[h]);Dm(a,c),e=t}if(o=d,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=Bm(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].y<o[0].y;)y=f[t++],c[n++].h(y.x,y.y);for(;l<o.length;)y=o[l++],c[n++].h(y.x+h,y.y);for(o=o[o.length-1].y;t<f.length&&f[t].y<=o;)t++;for(;t<f.length&&f[t].y>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=Bm(a,n),t=0;t<n;t++)o[t].assign(c[t]);Dm(a,c),n=o}return o=Math.max(0,p)+g.width,g=u,Dm(a,b),Dm(a,q),Dm(a,f),Dm(a,d),r[0]=e,r[1]=n,new Ut(p,0,o,g)}if(e=9999999,!(null===f||2>f.length||null===q||2>q.length))for(n=t=0;t<f.length&&n<q.length;)o=f[t],h=(m=q[n]).x,l=m.y,l+=p,y=o,t+1<f.length&&(y=f[t+1]),m=(v=m).x,v=v.y,n+1<q.length&&(m=(v=q[n+1]).x,v=v.y,v+=p),x=e,o.x===h?x=l-o.y:o.x>h&&o.x<m?x=l+(o.x-h)/(m-h)*(v-l)-o.y:h>o.x&&h<y.x&&(x=l-(o.y+(h-o.x)/(y.x-o.x)*(y.y-o.y))),x<e&&(e=x),y.x<=o.x?t++:m<=h?n++:(y.x<=m&&t++,m<=y.x&&n++);if(p-=e,t=q,n=p+=c,null===b||2>b.length||null===t||2>t.length)e=null;else{for(c=Bm(a,b.length+t.length),e=o=h=0;o<t.length&&t[o].x<b[0].x;)l=t[o++],c[e++].h(l.x,l.y+n);for(;h<b.length;)l=b[h++],c[e++].h(l.x,l.y);for(h=b[b.length-1].x;o<t.length&&t[o].x<=h;)o++;for(;o<t.length&&t[o].x>h;)l=t[o++],c[e++].h(l.x,l.y+n);for(t=Bm(a,e),h=0;h<e;h++)t[h].assign(c[h]);Dm(a,c),e=t}if(o=d,h=p,null===f||2>f.length||null===o||2>o.length)n=null;else{for(c=Bm(a,f.length+o.length),n=l=t=0;t<f.length&&f[t].x<o[0].x;)y=f[t++],c[n++].h(y.x,y.y);for(;l<o.length;)y=o[l++],c[n++].h(y.x,y.y+h);for(o=o[o.length-1].x;t<f.length&&f[t].x<=o;)t++;for(;t<f.length&&f[t].x>o;)h=f[t++],c[n++].h(h.x,h.y);for(o=Bm(a,n),t=0;t<n;t++)o[t].assign(c[t]);Dm(a,c),n=o}return o=u,g=Math.max(0,p)+g.height,Dm(a,b),Dm(a,q),Dm(a,f),Dm(a,d),r[0]=e,r[1]=n,new Ut(p,0,o,g)}function Bm(a,b){if(void 0!==(a=a.qu[b])&&void 0!==(a=a.pop()))return a;a=[];for(var t=0;t<b;t++)a[t]=new St;return a}function Dm(a,b){var t=b.length,e=a.qu[t];void 0===e&&(e=[],a.qu[t]=e),e.push(b)}function Im(a,b,t,e){if(null!==b){b.x=t,b.y=e;for(var n=(b=b.children).length,o=0;o<n;o++){var g=b[o];Im(a,g,t+g.S.x,e+g.S.y)}}}function zm(a,b){if(null!==b){a.setPortSpots(b);for(var t=(b=b.children).length,e=0;e<t;e++)zm(a,b[e])}}function Rm(a){return 45>=(a=a.angle)?0:135>=a?90:225>=a?180:315>=a?270:0}ag.className="LayeredDigraphLayout",ag.CycleDepthFirst=Xg,ag.CycleGreedy=Ug,ag.CycleFromLayers=qg,ag.LayerOptimalLinkLength=Kg,ag.LayerLongestPathSink=Hg,ag.LayerLongestPathSource=Wg,ag.InitDepthFirstOut=Jg,ag.InitDepthFirstIn=Zg,ag.InitNaive=_g,ag.AggressiveNone=$g,ag.AggressiveLess=Qg,ag.AggressiveMore=tm,ag.PackNone=0,ag.PackExpand=1,ag.PackStraighten=2,ag.PackMedian=4,ag.PackAll=15,ag.AlignNone=0,ag.AlignUpperLeft=1,ag.AlignUpperRight=2,ag.AlignLowerLeft=4,ag.AlignLowerRight=8,ag.AlignAll=15,nm.className="SegInfo",y(om,Hf),om.prototype.createVertex=function(){return new rm(this)},om.prototype.createEdge=function(){return new um(this)},om.className="LayeredDigraphNetwork",y(rm,$f),rm.prototype.Bl=function(a){$f.prototype.Bl.call(this,a),this.ao=this.bo=null},rm.prototype.Jl=function(a){$f.prototype.Jl.call(this,a),this.ao=this.bo=null},rm.prototype.yl=function(a){$f.prototype.yl.call(this,a),this.Zn=this.$n=null},rm.prototype.Il=function(a){$f.prototype.Il.call(this,a),this.Zn=this.$n=null},v.Object.defineProperties(rm.prototype,{layer:{get:function(){return this.Ig},set:function(a){this.Ig!==a&&(this.Ig=a)}},column:{get:function(){return this.Ag},set:function(a){this.Ag!==a&&(this.Ag=a)}},index:{get:function(){return this.Za},set:function(a){this.Za!==a&&(this.Za=a)}},component:{get:function(){return this.u},set:function(a){this.u!==a&&(this.u=a)}},near:{get:function(){return this.F},set:function(a){this.F!==a&&(this.F=a)}}}),rm.prototype.deleteDestinationEdge=rm.prototype.Il,rm.prototype.addDestinationEdge=rm.prototype.yl,rm.prototype.deleteSourceEdge=rm.prototype.Jl,rm.prototype.addSourceEdge=rm.prototype.Bl,rm.className="LayeredDigraphVertex",y(um,ed),v.Object.defineProperties(um.prototype,{fromVertex:{get:function(){return this.kd},set:function(a){this.kd!==a&&(this.kd=a)}},toVertex:{get:function(){return this.qd},set:function(a){this.qd!==a&&(this.qd=a)}},valid:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}},rev:{get:function(){return this.ia},set:function(a){this.ia!==a&&(this.ia=a)}},forest:{get:function(){return this.j},set:function(a){this.j!==a&&(this.j=a)}},portFromPos:{get:function(){return this.u},set:function(a){this.u!==a&&(this.u=a)}},portToPos:{get:function(){return this.V},set:function(a){this.V!==a&&(this.V=a)}},portFromColOffset:{get:function(){return this.o},set:function(a){this.o!==a&&(this.o=a)}},portToColOffset:{get:function(){return this.F},set:function(a){this.F!==a&&(this.F=a)}}}),um.className="LayeredDigraphEdge",y(cm,Uf),cm.prototype.cloneProtected=function(a){Uf.prototype.cloneProtected.call(this,a),a.Vn=this.Vn,a.uo=this.uo,a.Aq=this.Aq,a.td=this.td,a.Sb=this.Sb,a.$d.assign(this.$d),a.W.copyInheritedPropertiesFrom(this.W),a.Y.copyInheritedPropertiesFrom(this.Y)},cm.prototype.qb=function(a){a.classType===cm?0===a.name.indexOf("Alignment")?this.alignment=a:0===a.name.indexOf("Arrangement")?this.arrangement=a:0===a.name.indexOf("Compaction")?this.compaction=a:0===a.name.indexOf("Path")?this.path=a:0===a.name.indexOf("Sorting")?this.sorting=a:0===a.name.indexOf("Style")?this.treeStyle=a:T("Unknown enum value: "+a):Uf.prototype.qb.call(this,a)},cm.prototype.createNetwork=function(){return new fy(this)},cm.prototype.makeNetwork=function(a){function b(a){if(a instanceof uc)return!a.isLinkLabel&&"Comment"!==a.category;if(a instanceof Oc){var b=a.fromNode;return null!==b&&!b.isLinkLabel&&"Comment"!==b.category&&(null!==(a=a.toNode)&&!a.isLinkLabel&&"Comment"!==a.category)}return!1}var t=this.createNetwork();return a instanceof zo?(t.lg(a.nodes,!0,b),t.lg(a.links,!0,b)):a instanceof Cc?t.lg(a.memberParts,!1,b):t.lg(a.iterator,!1,b),t},cm.prototype.doLayout=function(a){null===this.network&&(this.network=this.makeNetwork(a)),this.arrangement!==hy&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));var b=this.diagram;if(null===b&&a instanceof zo&&(b=a),this.path===Em&&null!==b?this.ud=b.isTreePathToChildren?Vm:Ym:this.ud=this.path===Em?Vm:this.path,0<this.network.vertexes.count){for(this.network.Jo(),a=this.network.vertexes.iterator;a.next();)(b=a.value).initialized=!1,b.level=0,b.parent=null,b.children=[];if(0<this.Vb.count){for(a=new at,b=this.Vb.iterator;b.next();){var t=b.value;t instanceof uc?null!==(t=this.network.ki(t))&&a.add(t):t instanceof dy&&a.add(t)}this.Vb=a}for(0===this.Vb.count&&this.findRoots(),a=this.Vb.copy().iterator;a.next();)(b=a.value).initialized||(b.initialized=!0,pm(this,b));for(b=this.network.vertexes,a=null;0<(a=fm(b)).count;)null!==(b=dm(this,a))&&this.Vb.add(b),b.initialized=!0,pm(this,b),b=a;for(a=this.Vb.iterator;a.next();)(b=a.value)instanceof dy&&mm(this,b);for(a=this.Vb.iterator;a.next();)(b=a.value)instanceof dy&&ym(this,b);for(a=this.Vb.iterator;a.next();)(b=a.value)instanceof dy&&vm(this,b);if(this.Bu(),this.layerStyle===cy){for(a=[],b=this.network.vertexes.iterator;b.next();){var e=(t=b.value).parent;null===e&&(e=t),e=0===e.angle||180===e.angle;var n=a[t.level];void 0===n&&(n=0),a[t.level]=Math.max(n,e?t.width:t.height)}for(b=0;b<a.length;b++)void 0===a[b]&&(a[b]=0);for(this.$v=a,b=this.network.vertexes.iterator;b.next();)null===(e=(t=b.value).parent)&&(e=t),0===e.angle||180===e.angle?(180===e.angle&&(t.focusX+=a[t.level]-t.width),t.width=a[t.level]):(270===e.angle&&(t.focusY+=a[t.level]-t.height),t.height=a[t.level])}else if(this.layerStyle===uy)for(a=this.network.vertexes.iterator;a.next();){for(t=0===(b=a.value).angle||180===b.angle,e=-1,n=0;n<b.children.length;n++){var o=b.children[n];e=Math.max(e,t?o.width:o.height)}if(0<=e)for(n=0;n<b.children.length;n++)o=b.children[n],t?(180===b.angle&&(o.focusX+=e-o.width),o.width=e):(270===b.angle&&(o.focusY+=e-o.height),o.height=e)}for(a=this.Vb.iterator;a.next();)(b=a.value)instanceof dy&&this.layoutTree(b);this.arrangeTrees(),this.updateParts()}this.network=null,this.Vb=new at,this.isValidLayout=!0},cm.prototype.findRoots=function(){for(var a=this.network.vertexes,b=a.iterator;b.next();){var t=b.value;switch(this.ud){case Vm:0===t.sourceEdges.count&&this.Vb.add(t);break;case Ym:0===t.destinationEdges.count&&this.Vb.add(t);break;default:T("Unhandled path value "+this.ud.toString())}}0===this.Vb.count&&(null!==(a=dm(this,a))&&this.Vb.add(a))},cm.prototype.removeChild=function(a,b){if(null!==a&&null!==b){for(var t=a.children,e=0,n=0;n<t.length;n++)t[n]===b&&e++;if(0<e){e=Array(t.length-e);for(var o=n=0;o<t.length;o++)t[o]!==b&&(e[n++]=t[o]);a.children=e}}},cm.prototype.initializeTreeVertexValues=function(a){if(a.copyInheritedPropertiesFrom(function(a,b){switch(a.uo){default:case iy:return null!==b.parent?b.parent:a.W;case ry:return null===b.parent?a.W:null===b.parent.parent?a.Y:b.parent;case oy:return null!==b.parent?null!==b.parent.parent?b.parent.parent:a.Y:a.W;case ny:var t=!0;if(0===b.childrenCount)t=!1;else for(var e=b.children,n=e.length,o=0;o<n;o++)if(0<e[o].childrenCount){t=!1;break}return t&&null!==b.parent?a.Y:null!==b.parent?b.parent:a.W}}(this,a)),null!==a.parent&&a.parent.alignment===_m){for(var b=a.angle,t=a.parent.children,e=0;e<t.length&&a!==t[e];)e++;0==e%2?e!==t.length-1&&(b=90===b?180:180===b?270:270===b?180:270):b=90===b?0:180===b?90:270===b?0:90,a.angle=b}a.initialized=!0},cm.prototype.assignTreeVertexValues=function(){},cm.prototype.sortTreeVertexChildren=function(a){switch(a.sorting){case Gm:break;case Xm:a.children.reverse();break;case Um:a.children.sort(a.comparer);break;case qm:a.children.sort(a.comparer),a.children.reverse();break;default:T("Unhandled sorting value "+a.sorting.toString())}},cm.prototype.Bu=function(){if(this.comments)for(var a=this.network.vertexes.iterator;a.next();)this.addComments(a.value)},cm.prototype.addComments=function(a){var b=a.angle,t=a.parent,e=0,n=!1;null!==t&&(e=t.angle,n=xm(n=t.alignment)),b=90===b||270===b,e=90===e||270===e,t=0===a.childrenCount;var o=0,g=0,r=0,h=a.commentSpacing;if(null!==a.node)for(var l=a.node.Mu();l.next();){var c=l.value;"Comment"===c.category&&c.canLayout()&&(null===a.comments&&(a.comments=[]),a.comments.push(c),c.Va(),c=c.measuredBounds,b&&!t||!n&&!e&&t||n&&e&&t?(o=Math.max(o,c.width),g+=c.height+Math.abs(r)):(o+=c.width+Math.abs(r),g=Math.max(g,c.height)),r=h)}null!==a.comments&&(b&&!t||!n&&!e&&t||n&&e&&t?(o+=Math.abs(a.commentMargin),g=Math.max(0,g-a.height)):(g+=Math.abs(a.commentMargin),o=Math.max(0,o-a.width)),n=Ut.allocAt(0,0,a.bounds.width+o,a.bounds.height+g),a.bounds=n,Ut.free(n))},cm.prototype.layoutComments=function(a){if(null!==a.comments){var b=a.node.measuredBounds,t=a.parent,e=a.angle,n=0,o=!1;null!==t&&(n=t.angle,o=xm(o=t.alignment)),e=90===e||270===e,t=90===n||270===n;for(var g=0===a.childrenCount,r=wm(a),h=0,l=a.comments,c=l.length,f=St.alloc(),p=0;p<c;p++){var q=l[p],d=q.measuredBounds;if(e&&!g||!o&&!t&&g||o&&t&&g){if(135<n&&!o||t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x-a.commentMargin-d.width,a.bounds.y+h),q.move(f),q=q.Sd();q.next();){var u=q.value;u.fromSpot=Re,u.toSpot=Ee}else for(f.h(a.bounds.x+2*a.focus.x-a.commentMargin,a.bounds.y+h),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=Ee,u.toSpot=Re;else if(0<=a.commentMargin)for(f.h(a.bounds.x+2*a.focus.x+a.commentMargin,a.bounds.y+h),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=Ee,u.toSpot=Re;else for(f.h(a.bounds.x+a.commentMargin-d.width,a.bounds.y+h),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=Re,u.toSpot=Ee;h=0<=a.commentSpacing?h+(d.height+a.commentSpacing):h+(a.commentSpacing-d.height)}else{if(135<n&&!o||!t&&r)if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y-a.commentMargin-d.height),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=ze,u.toSpot=Ve;else for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y-a.commentMargin),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=Ve,u.toSpot=ze;else if(0<=a.commentMargin)for(f.h(a.bounds.x+h,a.bounds.y+2*a.focus.y+a.commentMargin),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=Ve,u.toSpot=ze;else for(f.h(a.bounds.x+h,a.bounds.y+a.commentMargin-d.height),q.move(f),q=q.Sd();q.next();)(u=q.value).fromSpot=ze,u.toSpot=Ve;h=0<=a.commentSpacing?h+(d.width+a.commentSpacing):h+(a.commentSpacing-d.width)}}if(St.free(f),b=h-a.commentSpacing-(e?b.height:b.width),this.ud===Vm)for(a=a.destinationEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.fromEndSegmentLength=0<b?b:NaN);else for(a=a.sourceEdges;a.next();)null===(n=a.value.link)||n.isAvoiding||(n.toEndSegmentLength=0<b?b:NaN)}},cm.prototype.layoutTree=function(a){if(null!==a){for(var b=a.children,t=b.length,e=0;e<t;e++)this.layoutTree(b[e]);switch(a.compaction){case ty:km(this,a);break;case ey:if(a.alignment===_m)km(this,a);else if(0===a.childrenCount)t=!1,b=0,null!==(e=a.parent)&&(b=e.angle,t=xm(t=e.alignment)),e=wm(a),a.S.h(0,0),a.Da.h(a.width,a.height),null===a.parent||null===a.comments||(180!==b&&270!==b||t)&&!e?a.la.h(0,0):180===b&&!t||(90===b||270===b)&&e?a.la.h(a.width-2*a.focus.x,0):a.la.h(0,a.height-2*a.focus.y),a.Xo=null,a.jp=null;else{var n=Rm(a);b=90===n||270===n;var o=0,g=a.children,r=g.length;for(t=0;t<r;t++)e=g[t],o=Math.max(o,b?e.Da.width:e.Da.height);var h=a.alignment;e=h===Wm;var l=h===Jm,c=xm(h),f=Math.max(0,a.breadthLimit);t=this.computeLayerSpacing(a);var p=a.nodeSpacing,q=this.computeNodeIndent(a),d=a.rowSpacing,u=0;(e||l||a.gm||a.hm&&1===a.maxGenerationCount)&&(u=Math.max(0,a.rowIndent)),e=a.width;var m=a.height,y=0,v=0,x=0,w=null,k=null,M=0,S=0,P=0,N=0,C=0,L=0,A=0,j=0;if(c&&!bm(h)&&135<n&&g.reverse(),bm(h))if(1<r)for(var F=0;F<r;F++)0==F%2&&F!==r-1&&(j=Math.max(j,b?g[F].Da.width:g[F].Da.height));else 1===r&&(j=b?g[0].Da.width:g[0].Da.height);if(c){switch(h){case Zm:j=(v=135>n?Mm(this,a,g,j,y,v):Sm(this,a,g,j,y,v)).x,y=v.width,v=v.height;break;case $m:for(w=0;w<r;w++)f=(k=g[w]).Da,x=0===L?0:d,b?(k.S.h(o-f.width,N+x),y=Math.max(y,f.width),v=Math.max(v,N+x+f.height),N+=x+f.height):(k.S.h(P+x,o-f.height),y=Math.max(y,P+x+f.width),v=Math.max(v,f.height),P+=x+f.width),L++;break;case Qm:for(w=0;w<r;w++)o=(k=g[w]).Da,f=0===L?0:d,b?(k.S.h(p/2+a.focus.x,N+f),y=Math.max(y,o.width),v=Math.max(v,N+f+o.height),N+=f+o.height):(k.S.h(P+f,p/2+a.focus.y),y=Math.max(y,P+f+o.width),v=Math.max(v,o.height),P+=f+o.width),L++}w=Bm(this,2),k=Bm(this,2),b?(w[0].h(0,0),w[1].h(0,v),k[0].h(y,0)):(w[0].h(0,0),w[1].h(y,0),k[0].h(0,v)),k[1].h(y,v)}else for(F=0;F<r;F++){var O=g[F],B=O.Da;if(b){0<f&&0<L&&P+p+B.width>f&&(P<o&&Lm(a,h,o-P,0,A,F-1),C++,L=0,A=F,x=v,P=0,N=135<n?-v-d:v+d),jm(this,O,0,N);var D=0;if(0===L)w=O.Xo,k=O.jp,M=B.width,S=B.height,(null===w||null===k||n!==Rm(O))&&(w=Bm(this,2),k=Bm(this,2),w[0].h(0,0),w[1].h(0,S),k[0].h(M,0),k[1].h(M,S));else{var I=z();D=(S=Om(this,a,O,w,k,M,S,I)).x,w=I[0],k=I[1],M=S.width,S=S.height,R(I),P<B.width&&0>D&&(Am(a,-D,0,A,F-1),Fm(w,-D,0),Fm(k,-D,0),D=0)}O.S.h(D,N),y=Math.max(y,M),v=Math.max(v,x+(0===C?0:d)+B.height),P=M}else 0<f&&0<L&&N+p+B.height>f&&(N<o&&Lm(a,h,0,o-N,A,F-1),C++,L=0,A=F,x=y,N=0,P=135<n?-y-d:y+d),jm(this,O,P,0),D=0,0===L?(w=O.Xo,k=O.jp,M=B.width,S=B.height,(null===w||null===k||n!==Rm(O))&&(w=Bm(this,2),k=Bm(this,2),w[0].h(0,0),w[1].h(M,0),k[0].h(0,S),k[1].h(M,S))):(D=(S=Om(this,a,O,w,k,M,S,I=z())).x,w=I[0],k=I[1],M=S.width,S=S.height,R(I),N<B.height&&0>D&&(Am(a,0,-D,A,F-1),Fm(w,0,-D),Fm(k,0,-D),D=0)),O.S.h(P,D),v=Math.max(v,S),y=Math.max(y,x+(0===C?0:d)+B.width),N=S;L++}switch(0<C&&(b?(v+=Math.max(0,t),P<y&&Lm(a,h,y-P,0,A,r-1),0<u&&(l||Am(a,u,0,0,r-1),y+=u)):(y+=Math.max(0,t),N<v&&Lm(a,h,0,v-N,A,r-1),0<u&&(l||Am(a,0,u,0,r-1),v+=u))),u=l=0,h){case Km:b?l+=y/2-a.focus.x-q/2:u+=v/2-a.focus.y-q/2;break;case Hm:0<C?b?l+=y/2-a.focus.x-q/2:u+=v/2-a.focus.y-q/2:b?l+=(j=g[0].S.x+g[0].la.x)+(g[r-1].S.x+g[r-1].la.x+2*g[r-1].focus.x-j)/2-a.focus.x-q/2:u+=(j=g[0].S.y+g[0].la.y)+(g[r-1].S.y+g[r-1].la.y+2*g[r-1].focus.y-j)/2-a.focus.y-q/2;break;case Wm:b?(l-=q,y+=q):(u-=q,v+=q);break;case Jm:b?(l+=y-a.width+q,y+=q):(u+=v-a.height+q,v+=q);break;case Zm:b?l+=1<r?j+p/2-a.focus.x:g[0].focus.x-a.focus.x+g[0].la.x:u+=1<r?j+p/2-a.focus.y:g[0].focus.y-a.focus.y+g[0].la.y;break;case $m:b?l+=y+p/2-a.focus.x:u+=v+p/2-a.focus.y;break;case Qm:break;default:l=(v=this.customAlignment(a,l,u,y,v))[0],u=v[1],y=v[2],v=v[3]}for(q=0;q<r;q++)j=g[q],b?j.S.h(j.S.x+j.la.x-l,j.S.y+(135<n?(c?-v:-j.Da.height)+j.la.y-t:m+t+j.la.y)):j.S.h(j.S.x+(135<n?(c?-y:-j.Da.width)+j.la.x-t:e+t+j.la.x),j.S.y+j.la.y-u);if(r=g=0,c?b?(y=Nm(a,y,l),0>l&&(l=0),135<n&&(u+=v+t),v+=m+t,h===Qm&&(g+=p/2+a.focus.x),r+=m+t):(135<n&&(l+=y+t),y+=e+t,v=Cm(a,v,u),0>u&&(u=0),h===Qm&&(r+=p/2+a.focus.y),g+=e+t):b?(null===a.comments?e>y&&(g=(y=Tm(h,e-y,0)).x,r=y.y,y=e,l=0):y=Nm(a,y,l),0>l&&(g-=l,l=0),135<n&&(u+=v+t),v=Math.max(Math.max(v,m),v+m+t),r+=m+t):(135<n&&(l+=y+t),y=Math.max(Math.max(y,e),y+e+t),null===a.comments?m>v&&(g=(v=Tm(h,0,m-v)).x,r=v.y,v=m,u=0):v=Cm(a,v,u),0>u&&(r-=u,u=0),g+=e+t),0<C)n=Bm(this,4),C=Bm(this,4),b?(n[2].h(0,m+t),n[3].h(n[2].x,v),C[2].h(y,n[2].y),C[3].h(C[2].x,n[3].y)):(n[2].h(e+t,0),n[3].h(y,n[2].y),C[2].h(n[2].x,v),C[3].h(n[3].x,C[2].y));else{for(n=Bm(this,w.length+2),C=Bm(this,k.length+2),h=0;h<w.length;h++)c=w[h],n[h+2].h(c.x+g,c.y+r);for(h=0;h<k.length;h++)c=k[h],C[h+2].h(c.x+g,c.y+r)}b?(n[0].h(l,0),n[1].h(n[0].x,m),n[2].y<n[1].y&&(n[2].x>n[0].x?n[2].assign(n[1]):n[1].assign(n[2])),n[3].y<n[2].y&&(n[3].x>n[0].x?n[3].assign(n[2]):n[2].assign(n[3])),C[0].h(l+e,0),C[1].h(C[0].x,m),C[2].y<C[1].y&&(C[2].x<C[0].x?C[2].assign(C[1]):C[1].assign(C[2])),C[3].y<C[2].y&&(C[3].x<C[0].x?C[3].assign(C[2]):C[2].assign(C[3])),n[2].y-=t/2,C[2].y-=t/2):(n[0].h(0,u),n[1].h(e,n[0].y),n[2].x<n[1].x&&(n[2].y>n[0].y?n[2].assign(n[1]):n[1].assign(n[2])),n[3].x<n[2].x&&(n[3].y>n[0].y?n[3].assign(n[2]):n[2].assign(n[3])),C[0].h(0,u+m),C[1].h(e,C[0].y),C[2].x<C[1].x&&(C[2].y<C[0].y?C[2].assign(C[1]):C[1].assign(C[2])),C[3].x<C[2].x&&(C[3].y<C[0].y?C[3].assign(C[2]):C[2].assign(C[3])),n[2].x-=t/2,C[2].x-=t/2),Dm(this,w),Dm(this,k),a.Xo=n,a.jp=C,a.la.h(l,u),a.Da.h(y,v)}break;default:T("Unhandled compaction value "+a.compaction.toString())}}},cm.prototype.customAlignment=function(a,b,t,e,n){return[b,t,e,n]},cm.prototype.computeBusNodeSpacing=function(a){return null===a.parent?0:a.parent.nodeSpacing},cm.prototype.computeBusLastRowSpacing=function(a){return null===a.parent?0:a.parent.rowSpacing},cm.prototype.arrangeTrees=function(){if(this.Sb===hy)for(var a=this.Vb.iterator;a.next();){var b=a.value;if(b instanceof dy){var t=b.node;if(null!==t){var e=t.position;t=e.x,e=e.y,isFinite(t)||(t=0),isFinite(e)||(e=0),Im(this,b,t,e)}}}else{for(a=[],b=this.Vb.iterator;b.next();)(t=b.value)instanceof dy&&a.push(t);switch(this.sorting){case Gm:break;case Xm:a.reverse();break;case Um:a.sort(this.comparer);break;case qm:a.sort(this.comparer),a.reverse();break;default:T("Unhandled sorting value "+this.sorting.toString())}for(b=(t=this.arrangementOrigin).x,t=t.y,e=0;e<a.length;e++){var n=a[e];switch(Im(this,n,b+n.la.x,t+n.la.y),this.Sb){case sy:t+=n.Da.height+this.$d.height;break;case ay:b+=n.Da.width+this.$d.width;break;default:T("Unhandled arrangement value "+this.Sb.toString())}}}},cm.prototype.commitLayout=function(){this.yv(),this.commitNodes(),this.Gu(),this.isRouting&&this.commitLinks()},cm.prototype.commitNodes=function(){for(var a=this.network.vertexes.iterator;a.next();)a.value.commit();for(a.reset();a.next();)this.layoutComments(a.value)},cm.prototype.Gu=function(){if(this.layerStyle===cy){for(var a=this.$v,b=[],t=null,e=this.network.vertexes.iterator;e.next();){var n=e.value;null===t?t=n.bounds.copy():t.ed(n.bounds);var o=b[n.level];o=void 0===o?this.computeLayerSpacing(n):Math.max(o,this.computeLayerSpacing(n)),b[n.level]=o}for(e=0;e<b.length;e++)void 0===b[e]&&(b[e]=0);if(90===this.angle||270===this.angle?(t.Bc(this.nodeSpacing/2,this.layerSpacing),e=new St(-this.nodeSpacing/2,-this.layerSpacing/2)):(t.Bc(this.layerSpacing,this.nodeSpacing/2),e=new St(-this.layerSpacing/2,-this.nodeSpacing/2)),n=[],t=90===this.angle||270===this.angle?t.width:t.height,o=0,180===this.angle||270===this.angle)for(var g=0;g<a.length;g++)o+=a[g]+b[g];for(g=0;g<a.length;g++){var r=a[g]+b[g];270===this.angle?(o-=r,n.push(new Ut(0,o,t,r))):90===this.angle?(n.push(new Ut(0,o,t,r)),o+=r):180===this.angle?(o-=r,n.push(new Ut(o,0,r,t))):(n.push(new Ut(o,0,r,t)),o+=r)}this.commitLayers(n,e)}},cm.prototype.commitLayers=function(){},cm.prototype.commitLinks=function(){for(var a=this.network.edges.iterator;a.next();)a.value.commit()},cm.prototype.yv=function(){for(var a=this.Vb.iterator;a.next();){var b=a.value;b instanceof dy&&zm(this,b)}},cm.prototype.setPortSpots=function(a){var b=a.alignment;if(xm(b)){var t=this.ud===Vm,e=Rm(a);switch(e){case 0:var n=Ee;break;case 90:n=Ve;break;case 180:n=Re;break;default:n=ze}var o=a.children,g=o.length;switch(b){case Zm:case _m:for(b=0;b<g;b++){var r=o[b];if(null!==(r=(t?r.sourceEdges:r.destinationEdges).first())&&null!==(r=r.link)){var h=90===e||270===e?Re:ze;if(1===g||b===g-1&&1==g%2)switch(e){case 0:h=Re;break;case 90:h=ze;break;case 180:h=Ee;break;default:h=Ve}else 0==b%2&&(h=90===e||270===e?Ee:Ve);t?(a.setsPortSpot&&(r.fromSpot=n),a.setsChildPortSpot&&(r.toSpot=h)):(a.setsPortSpot&&(r.fromSpot=h),a.setsChildPortSpot&&(r.toSpot=n))}}break;case $m:for(e=90===e||270===e?Ee:Ve,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)));break;case Qm:for(e=90===e||270===e?Re:ze,o=t?a.destinationEdges:a.sourceEdges;o.next();)null!==(g=o.value.link)&&(t?(a.setsPortSpot&&(g.fromSpot=n),a.setsChildPortSpot&&(g.toSpot=e)):(a.setsPortSpot&&(g.fromSpot=e),a.setsChildPortSpot&&(g.toSpot=n)))}}else if(t=Rm(a),this.ud===Vm){for(n=a.destinationEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Yb())switch(t){case 0:e.fromSpot=Ee;break;case 90:e.fromSpot=Ve;break;case 180:e.fromSpot=Re;break;default:e.fromSpot=ze}else e.fromSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Yb())switch(t){case 0:e.toSpot=Re;break;case 90:e.toSpot=ze;break;case 180:e.toSpot=Ee;break;default:e.toSpot=Ve}else e.toSpot=a.childPortSpot}}else for(n=a.sourceEdges;n.next();)if(null!==(e=n.value.link)){if(a.setsPortSpot)if(a.portSpot.Yb())switch(t){case 0:e.toSpot=Ee;break;case 90:e.toSpot=Ve;break;case 180:e.toSpot=Re;break;default:e.toSpot=ze}else e.toSpot=a.portSpot;if(a.setsChildPortSpot)if(a.childPortSpot.Yb())switch(t){case 0:e.fromSpot=Re;break;case 90:e.fromSpot=ze;break;case 180:e.fromSpot=Ee;break;default:e.fromSpot=Ve}else e.fromSpot=a.childPortSpot}},cm.prototype.computeLayerSpacing=function(a){var b=Rm(a);b=90===b||270===b;var t=a.layerSpacing;if(0<a.layerSpacingParentOverlap){var e=Math.min(1,a.layerSpacingParentOverlap);t-=b?a.height*e:a.width*e}return t<(b?-a.height:-a.width)&&(t=b?-a.height:-a.width),t},cm.prototype.computeNodeIndent=function(a){var b=Rm(a),t=a.nodeIndent;if(0<a.nodeIndentPastParent){var e=Math.min(1,a.nodeIndentPastParent);t+=90===b||270===b?a.width*e:a.height*e}return Math.max(0,t)},v.Object.defineProperties(cm.prototype,{roots:{get:function(){return this.Vb},set:function(a){this.Vb!==a&&(this.Vb=a,this.C())}},path:{get:function(){return this.Vn},set:function(a){this.Vn!==a&&(this.Vn=a,this.C())}},treeStyle:{get:function(){return this.uo},set:function(a){this.Sb===a||a!==iy&&a!==oy&&a!==ny&&a!==ry||(this.uo=a,this.C())}},layerStyle:{get:function(){return this.Aq},set:function(a){this.Sb===a||a!==ly&&a!==uy&&a!==cy||(this.Aq=a,this.C())}},comments:{get:function(){return this.td},set:function(a){this.td!==a&&(this.td=a,this.C())}},arrangement:{get:function(){return this.Sb},set:function(a){this.Sb===a||a!==sy&&a!==ay&&a!==hy||(this.Sb=a,this.C())}},arrangementSpacing:{get:function(){return this.$d},set:function(a){this.$d.D(a)||(this.$d.assign(a),this.C())}},rootDefaults:{get:function(){return this.W},set:function(a){this.W!==a&&(this.W=a,this.C())}},alternateDefaults:{get:function(){return this.Y},set:function(a){this.Y!==a&&(this.Y=a,this.C())}},sorting:{get:function(){return this.W.sorting},set:function(a){this.W.sorting===a||a!==Gm&&a!==Xm&&a!==Um&&!qm||(this.W.sorting=a,this.C())}},comparer:{get:function(){return this.W.comparer},set:function(a){this.W.comparer!==a&&(this.W.comparer=a,this.C())}},angle:{get:function(){return this.W.angle},set:function(a){this.W.angle!==a&&(0===a||90===a||180===a||270===a?(this.W.angle=a,this.C()):T("TreeLayout.angle must be 0, 90, 180, or 270"))}},alignment:{get:function(){return this.W.alignment},set:function(a){this.W.alignment!==a&&(this.W.alignment=a,this.C())}},nodeIndent:{get:function(){return this.W.nodeIndent},set:function(a){this.W.nodeIndent!==a&&0<=a&&(this.W.nodeIndent=a,this.C())}},nodeIndentPastParent:{get:function(){return this.W.nodeIndentPastParent},set:function(a){this.W.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.W.nodeIndentPastParent=a,this.C())}},nodeSpacing:{get:function(){return this.W.nodeSpacing},set:function(a){this.W.nodeSpacing!==a&&(this.W.nodeSpacing=a,this.C())}},layerSpacing:{get:function(){return this.W.layerSpacing},set:function(a){this.W.layerSpacing!==a&&(this.W.layerSpacing=a,this.C())}},layerSpacingParentOverlap:{get:function(){return this.W.layerSpacingParentOverlap},set:function(a){this.W.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.W.layerSpacingParentOverlap=a,this.C())}},compaction:{get:function(){return this.W.compaction},set:function(a){this.W.compaction===a||a!==ty&&a!==ey||(this.W.compaction=a,this.C())}},breadthLimit:{get:function(){return this.W.breadthLimit},set:function(a){this.W.breadthLimit!==a&&0<=a&&(this.W.breadthLimit=a,this.C())}},rowSpacing:{get:function(){return this.W.rowSpacing},set:function(a){this.W.rowSpacing!==a&&(this.W.rowSpacing=a,this.C())}},rowIndent:{get:function(){return this.W.rowIndent},set:function(a){this.W.rowIndent!==a&&0<=a&&(this.W.rowIndent=a,this.C())}},commentSpacing:{get:function(){return this.W.commentSpacing},set:function(a){this.W.commentSpacing!==a&&(this.W.commentSpacing=a,this.C())}},commentMargin:{get:function(){return this.W.commentMargin},set:function(a){this.W.commentMargin!==a&&(this.W.commentMargin=a,this.C())}},setsPortSpot:{get:function(){return this.W.setsPortSpot},set:function(a){this.W.setsPortSpot!==a&&(this.W.setsPortSpot=a,this.C())}},portSpot:{get:function(){return this.W.portSpot},set:function(a){this.W.portSpot.D(a)||(this.W.portSpot=a,this.C())}},setsChildPortSpot:{get:function(){return this.W.setsChildPortSpot},set:function(a){this.W.setsChildPortSpot!==a&&(this.W.setsChildPortSpot=a,this.C())}},childPortSpot:{get:function(){return this.W.childPortSpot},set:function(a){this.W.childPortSpot.D(a)||(this.W.childPortSpot=a,this.C())}},alternateSorting:{get:function(){return this.Y.sorting},set:function(a){this.Y.sorting===a||a!==Gm&&a!==Xm&&a!==Um&&!qm||(this.Y.sorting=a,this.C())}},alternateComparer:{get:function(){return this.Y.comparer},set:function(a){this.Y.comparer!==a&&(this.Y.comparer=a,this.C())}},alternateAngle:{get:function(){return this.Y.angle},set:function(a){this.Y.angle===a||0!==a&&90!==a&&180!==a&&270!==a||(this.Y.angle=a,this.C())}},alternateAlignment:{get:function(){return this.Y.alignment},set:function(a){this.Y.alignment!==a&&(this.Y.alignment=a,this.C())}},alternateNodeIndent:{get:function(){return this.Y.nodeIndent},set:function(a){this.Y.nodeIndent!==a&&0<=a&&(this.Y.nodeIndent=a,this.C())}},alternateNodeIndentPastParent:{get:function(){return this.Y.nodeIndentPastParent},set:function(a){this.Y.nodeIndentPastParent!==a&&0<=a&&1>=a&&(this.Y.nodeIndentPastParent=a,this.C())}},alternateNodeSpacing:{get:function(){return this.Y.nodeSpacing},set:function(a){this.Y.nodeSpacing!==a&&(this.Y.nodeSpacing=a,this.C())}},alternateLayerSpacing:{get:function(){return this.Y.layerSpacing},set:function(a){this.Y.layerSpacing!==a&&(this.Y.layerSpacing=a,this.C())}},alternateLayerSpacingParentOverlap:{get:function(){return this.Y.layerSpacingParentOverlap},set:function(a){this.Y.layerSpacingParentOverlap!==a&&0<=a&&1>=a&&(this.Y.layerSpacingParentOverlap=a,this.C())}},alternateCompaction:{get:function(){return this.Y.compaction},set:function(a){this.Y.compaction===a||a!==ty&&a!==ey||(this.Y.compaction=a,this.C())}},alternateBreadthLimit:{get:function(){return this.Y.breadthLimit},set:function(a){this.Y.breadthLimit!==a&&0<=a&&(this.Y.breadthLimit=a,this.C())}},alternateRowSpacing:{get:function(){return this.Y.rowSpacing},set:function(a){this.Y.rowSpacing!==a&&(this.Y.rowSpacing=a,this.C())}},alternateRowIndent:{get:function(){return this.Y.rowIndent},set:function(a){this.Y.rowIndent!==a&&0<=a&&(this.Y.rowIndent=a,this.C())}},alternateCommentSpacing:{get:function(){return this.Y.commentSpacing},set:function(a){this.Y.commentSpacing!==a&&(this.Y.commentSpacing=a,this.C())}},alternateCommentMargin:{get:function(){return this.Y.commentMargin},set:function(a){this.Y.commentMargin!==a&&(this.Y.commentMargin=a,this.C())}},alternateSetsPortSpot:{get:function(){return this.Y.setsPortSpot},set:function(a){this.Y.setsPortSpot!==a&&(this.Y.setsPortSpot=a,this.C())}},alternatePortSpot:{get:function(){return this.Y.portSpot},set:function(a){this.Y.portSpot.D(a)||(this.Y.portSpot=a,this.C())}},alternateSetsChildPortSpot:{get:function(){return this.Y.setsChildPortSpot},set:function(a){this.Y.setsChildPortSpot!==a&&(this.Y.setsChildPortSpot=a,this.C())}},alternateChildPortSpot:{get:function(){return this.Y.childPortSpot},set:function(a){this.Y.childPortSpot.D(a)||(this.Y.childPortSpot=a,this.C())}}});var Em=new W(cm,"PathDefault",-1),Vm=new W(cm,"PathDestination",0),Ym=new W(cm,"PathSource",1),Gm=new W(cm,"SortingForwards",10),Xm=new W(cm,"SortingReverse",11),Um=new W(cm,"SortingAscending",12),qm=new W(cm,"SortingDescending",13),Km=new W(cm,"AlignmentCenterSubtrees",20),Hm=new W(cm,"AlignmentCenterChildren",21),Wm=new W(cm,"AlignmentStart",22),Jm=new W(cm,"AlignmentEnd",23),Zm=new W(cm,"AlignmentBus",24),_m=new W(cm,"AlignmentBusBranching",25),$m=new W(cm,"AlignmentTopLeftBus",26),Qm=new W(cm,"AlignmentBottomRightBus",27),ty=new W(cm,"CompactionNone",30),ey=new W(cm,"CompactionBlock",31),iy=new W(cm,"StyleLayered",40),ny=new W(cm,"StyleLastParents",41),oy=new W(cm,"StyleAlternating",42),ry=new W(cm,"StyleRootOnly",43),sy=new W(cm,"ArrangementVertical",50),ay=new W(cm,"ArrangementHorizontal",51),hy=new W(cm,"ArrangementFixedRoots",52),ly=new W(cm,"LayerIndividual",60),uy=new W(cm,"LayerSiblings",61),cy=new W(cm,"LayerUniform",62);function fy(a){Hf.call(this,a)}function dy(a){$f.call(this,a),this.V=!1,this.hb=null,this.u=[],this.nb=this.Ha=this.F=this.ia=0,this.td=null,this.S=new St(0,0),this.Da=new Vt(0,0),this.la=new St(0,0),this.hm=this.gm=this.qA=!1,this.jp=this.Xo=null,this.nd=Gm,this.hd=Qf,this.Lb=0,this.Kb=Hm,this.Uq=this.Tq=0,this.Vq=20,this.ie=50,this.zq=0,this.Gp=ey,this.zp=0,this.mr=25,this.Fp=this.lr=10,this.Ep=20,this.wr=!0,this.cr=Fe,this.vr=!0,this.Cp=Fe}function py(a){ed.call(this,a),this.Zt=new St(0,0)}cm.className="TreeLayout",cm.PathDefault=Em,cm.PathDestination=Vm,cm.PathSource=Ym,cm.SortingForwards=Gm,cm.SortingReverse=Xm,cm.SortingAscending=Um,cm.SortingDescending=qm,cm.AlignmentCenterSubtrees=Km,cm.AlignmentCenterChildren=Hm,cm.AlignmentStart=Wm,cm.AlignmentEnd=Jm,cm.AlignmentBus=Zm,cm.AlignmentBusBranching=_m,cm.AlignmentTopLeftBus=$m,cm.AlignmentBottomRightBus=Qm,cm.CompactionNone=ty,cm.CompactionBlock=ey,cm.StyleLayered=iy,cm.StyleLastParents=ny,cm.StyleAlternating=oy,cm.StyleRootOnly=ry,cm.ArrangementVertical=sy,cm.ArrangementHorizontal=ay,cm.ArrangementFixedRoots=hy,cm.LayerIndividual=ly,cm.LayerSiblings=uy,cm.LayerUniform=cy,y(fy,Hf),fy.prototype.createVertex=function(){return new dy(this)},fy.prototype.createEdge=function(){return new py(this)},fy.className="TreeNetwork",y(dy,$f),dy.prototype.copyInheritedPropertiesFrom=function(a){null!==a&&(this.nd=a.sorting,this.hd=a.comparer,this.Lb=a.angle,this.Kb=a.alignment,this.Tq=a.nodeIndent,this.Uq=a.nodeIndentPastParent,this.Vq=a.nodeSpacing,this.ie=a.layerSpacing,this.zq=a.layerSpacingParentOverlap,this.Gp=a.compaction,this.zp=a.breadthLimit,this.mr=a.rowSpacing,this.lr=a.rowIndent,this.Fp=a.commentSpacing,this.Ep=a.commentMargin,this.wr=a.setsPortSpot,this.cr=a.portSpot,this.vr=a.setsChildPortSpot,this.Cp=a.childPortSpot)},v.Object.defineProperties(dy.prototype,{initialized:{get:function(){return this.V},set:function(a){this.V!==a&&(this.V=a)}},parent:{get:function(){return this.hb},set:function(a){this.hb!==a&&(this.hb=a)}},children:{get:function(){return this.u},set:function(a){if(this.u!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.u=a}}},level:{get:function(){return this.ia},set:function(a){this.ia!==a&&(this.ia=a)}},descendantCount:{get:function(){return this.F},set:function(a){this.F!==a&&(this.F=a)}},maxChildrenCount:{get:function(){return this.Ha},set:function(a){this.Ha!==a&&(this.Ha=a)}},maxGenerationCount:{get:function(){return this.nb},set:function(a){this.nb!==a&&(this.nb=a)}},comments:{get:function(){return this.td},set:function(a){if(this.td!==a){if(null!==a)for(var b=a.length,t=0;t<b;t++);this.td=a}}},sorting:{get:function(){return this.nd},set:function(a){this.nd!==a&&(this.nd=a)}},comparer:{get:function(){return this.hd},set:function(a){this.hd!==a&&(this.hd=a)}},angle:{get:function(){return this.Lb},set:function(a){this.Lb!==a&&(this.Lb=a)}},alignment:{get:function(){return this.Kb},set:function(a){this.Kb!==a&&(this.Kb=a)}},nodeIndent:{get:function(){return this.Tq},set:function(a){this.Tq!==a&&(this.Tq=a)}},nodeIndentPastParent:{get:function(){return this.Uq},set:function(a){this.Uq!==a&&(this.Uq=a)}},nodeSpacing:{get:function(){return this.Vq},set:function(a){this.Vq!==a&&(this.Vq=a)}},layerSpacing:{get:function(){return this.ie},set:function(a){this.ie!==a&&(this.ie=a)}},layerSpacingParentOverlap:{get:function(){return this.zq},set:function(a){this.zq!==a&&(this.zq=a)}},compaction:{get:function(){return this.Gp},set:function(a){this.Gp!==a&&(this.Gp=a)}},breadthLimit:{get:function(){return this.zp},set:function(a){this.zp!==a&&(this.zp=a)}},rowSpacing:{get:function(){return this.mr},set:function(a){this.mr!==a&&(this.mr=a)}},rowIndent:{get:function(){return this.lr},set:function(a){this.lr!==a&&(this.lr=a)}},commentSpacing:{get:function(){return this.Fp},set:function(a){this.Fp!==a&&(this.Fp=a)}},commentMargin:{get:function(){return this.Ep},set:function(a){this.Ep!==a&&(this.Ep=a)}},setsPortSpot:{get:function(){return this.wr},set:function(a){this.wr!==a&&(this.wr=a)}},portSpot:{get:function(){return this.cr},set:function(a){this.cr.D(a)||(this.cr=a)}},setsChildPortSpot:{get:function(){return this.vr},set:function(a){this.vr!==a&&(this.vr=a)}},childPortSpot:{get:function(){return this.Cp},set:function(a){this.Cp.D(a)||(this.Cp=a)}},childrenCount:{get:function(){return this.children.length}},relativePosition:{get:function(){return this.S},set:function(a){this.S.set(a)}},subtreeSize:{get:function(){return this.Da},set:function(a){this.Da.set(a)}},subtreeOffset:{get:function(){return this.la},set:function(a){this.la.set(a)}}}),dy.className="TreeVertex",y(py,ed),py.prototype.commit=function(){var a=this.link;if(null!==a&&!a.isAvoiding){var b=this.network.layout,t=null,e=null;switch(b.ud){case Vm:t=this.fromVertex,e=this.toVertex;break;case Ym:t=this.toVertex,e=this.fromVertex;break;default:T("Unhandled path value "+b.ud.toString())}if(null!==t&&null!==e){var n=this.Zt;if(0!==n.x||0!==n.y||t.qA){e=t.bounds;var o=Rm(t),g=b.computeLayerSpacing(t),r=t.rowSpacing;a.vg();var h,l=a.curve===hf,c=a.isOrthogonal;if(a.uh(),c||l){for(h=2;4<a.pointsCount;)a.pv(2);var f=a.i(1),p=a.i(2)}else{for(h=1;3<a.pointsCount;)a.pv(1);f=a.i(0),p=a.i(a.pointsCount-1)}var q=a.i(a.pointsCount-1);0===o?(t.alignment===Jm?(o=e.bottom+n.y,0===n.y&&f.y>q.y+t.rowIndent&&(o=Math.min(o,Math.max(f.y,o-b.computeNodeIndent(t))))):t.alignment===Wm?(o=e.top+n.y,0===n.y&&f.y<q.y-t.rowIndent&&(o=Math.max(o,Math.min(f.y,o+b.computeNodeIndent(t))))):o=t.gm||t.hm&&1===t.maxGenerationCount?e.top-t.la.y+n.y:e.y+e.height/2+n.y,l?(a.m(h,f.x,o),h++,a.m(h,e.right+g,o),h++,a.m(h,e.right+g+(n.x-r)/3,o),h++,a.m(h,e.right+g+2*(n.x-r)/3,o),h++,a.m(h,e.right+g+(n.x-r),o),h++,a.m(h,p.x,o)):(c&&(a.m(h,e.right+g/2,f.y),h++),a.m(h,e.right+g/2,o),h++,a.m(h,e.right+g+n.x-(c?r/2:r),o),h++,c&&a.m(h,a.i(h-1).x,p.y))):90===o?(t.alignment===Jm?(o=e.right+n.x,0===n.x&&f.x>q.x+t.rowIndent&&(o=Math.min(o,Math.max(f.x,o-b.computeNodeIndent(t))))):t.alignment===Wm?(o=e.left+n.x,0===n.x&&f.x<q.x-t.rowIndent&&(o=Math.max(o,Math.min(f.x,o+b.computeNodeIndent(t))))):o=t.gm||t.hm&&1===t.maxGenerationCount?e.left-t.la.x+n.x:e.x+e.width/2+n.x,l?(a.m(h,o,f.y),h++,a.m(h,o,e.bottom+g),h++,a.m(h,o,e.bottom+g+(n.y-r)/3),h++,a.m(h,o,e.bottom+g+2*(n.y-r)/3),h++,a.m(h,o,e.bottom+g+(n.y-r)),h++,a.m(h,o,p.y)):(c&&(a.m(h,f.x,e.bottom+g/2),h++),a.m(h,o,e.bottom+g/2),h++,a.m(h,o,e.bottom+g+n.y-(c?r/2:r)),h++,c&&a.m(h,p.x,a.i(h-1).y))):180===o?(t.alignment===Jm?(o=e.bottom+n.y,0===n.y&&f.y>q.y+t.rowIndent&&(o=Math.min(o,Math.max(f.y,o-b.computeNodeIndent(t))))):t.alignment===Wm?(o=e.top+n.y,0===n.y&&f.y<q.y-t.rowIndent&&(o=Math.max(o,Math.min(f.y,o+b.computeNodeIndent(t))))):o=t.gm||t.hm&&1===t.maxGenerationCount?e.top-t.la.y+n.y:e.y+e.height/2+n.y,l?(a.m(h,f.x,o),h++,a.m(h,e.left-g,o),h++,a.m(h,e.left-g+(n.x+r)/3,o),h++,a.m(h,e.left-g+2*(n.x+r)/3,o),h++,a.m(h,e.left-g+(n.x+r),o),h++,a.m(h,p.x,o)):(c&&(a.m(h,e.left-g/2,f.y),h++),a.m(h,e.left-g/2,o),h++,a.m(h,e.left-g+n.x+(c?r/2:r),o),h++,c&&a.m(h,a.i(h-1).x,p.y))):270===o?(t.alignment===Jm?(o=e.right+n.x,0===n.x&&f.x>q.x+t.rowIndent&&(o=Math.min(o,Math.max(f.x,o-b.computeNodeIndent(t))))):t.alignment===Wm?(o=e.left+n.x,0===n.x&&f.x<q.x-t.rowIndent&&(o=Math.max(o,Math.min(f.x,o+b.computeNodeIndent(t))))):o=t.gm||t.hm&&1===t.maxGenerationCount?e.left-t.la.x+n.x:e.x+e.width/2+n.x,l?(a.m(h,o,f.y),h++,a.m(h,o,e.top-g),h++,a.m(h,o,e.top-g+(n.y+r)/3),h++,a.m(h,o,e.top-g+2*(n.y+r)/3),h++,a.m(h,o,e.top-g+(n.y+r)),h++,a.m(h,o,p.y)):(c&&(a.m(h,f.x,e.top-g/2),h++),a.m(h,o,e.top-g/2),h++,a.m(h,o,e.top-g+n.y+(c?r/2:r)),h++,c&&a.m(h,p.x,a.i(h-1).y))):T("Invalid angle "+o),a.zf()}else n=e,a=this.link,e=this.network.layout,(b=Rm(t))!==Rm(n)&&(g=e.computeLayerSpacing(t),r=t.bounds,t=n.bounds,0===b&&t.left-r.right<g+1||90===b&&t.top-r.bottom<g+1||180===b&&r.left-t.right<g+1||270===b&&r.top-t.bottom<g+1||(a.vg(),t=a.curve===hf,n=a.isOrthogonal,e=xm(this.fromVertex.alignment),a.uh(),0===b?(b=r.right+g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.L(1,b-20,a.i(1).y),a.m(2,b-20,t),a.m(3,b,t),a.m(4,b+20,t),a.L(5,a.i(5).x,t)):n?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,b,a.i(2).y),a.L(3,b,a.i(3).y)):4===a.pointsCount?a.m(2,b,a.i(2).y):3===a.pointsCount?a.L(1,b,a.i(2).y):2===a.pointsCount&&a.m(1,b,a.i(1).y)):90===b?(b=r.bottom+g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.L(1,a.i(1).x,b-20),a.m(2,t,b-20),a.m(3,t,b),a.m(4,t,b+20),a.L(5,t,a.i(5).y)):n?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,a.i(2).x,b),a.L(3,a.i(3).x,b)):4===a.pointsCount?a.m(2,a.i(2).x,b):3===a.pointsCount?a.L(1,a.i(2).x,b):2===a.pointsCount&&a.m(1,a.i(1).x,b)):180===b?(b=r.left-g/2,t?4===a.pointsCount&&(t=a.i(3).y,a.L(1,b+20,a.i(1).y),a.m(2,b+20,t),a.m(3,b,t),a.m(4,b-20,t),a.L(5,a.i(5).x,t)):n?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,b,a.i(2).y),a.L(3,b,a.i(3).y)):4===a.pointsCount?a.m(2,b,a.i(2).y):3===a.pointsCount?a.L(1,b,a.i(2).y):2===a.pointsCount&&a.m(1,b,a.i(1).y)):270===b&&(b=r.top-g/2,t?4===a.pointsCount&&(t=a.i(3).x,a.L(1,a.i(1).x,b+20),a.m(2,t,b+20),a.m(3,t,b),a.m(4,t,b-20),a.L(5,t,a.i(5).y)):n?e?a.L(3,a.i(2).x,a.i(4).y):6===a.pointsCount&&(a.L(2,a.i(2).x,b),a.L(3,a.i(3).x,b)):4===a.pointsCount?a.m(2,a.i(2).x,b):3===a.pointsCount?a.L(1,a.i(2).x,b):2===a.pointsCount&&a.m(1,a.i(1).x,b)),a.zf()))}}},v.Object.defineProperties(py.prototype,{fromVertex:{get:function(){return this.kd},set:function(a){this.kd!==a&&(this.kd=a)}},toVertex:{get:function(){return this.qd},set:function(a){this.qd!==a&&(this.qd=a)}},relativePoint:{get:function(){return this.Zt},set:function(a){this.Zt.set(a)}}}),py.className="TreeEdge",Li.prototype.initializeStandardTools=function(){this.gb("Action",new Pn,this.mouseDownTools),this.gb("Relinking",new pn,this.mouseDownTools),this.gb("LinkReshaping",new mn,this.mouseDownTools),this.gb("Rotating",new Mn,this.mouseDownTools),this.gb("Resizing",new kn,this.mouseDownTools),this.gb("Linking",new un,this.mouseMoveTools),this.gb("Dragging",new Ri,this.mouseMoveTools),this.gb("DragSelecting",new Cn,this.mouseMoveTools),this.gb("Panning",new Tn,this.mouseMoveTools),this.gb("ContextMenu",new jn,this.mouseUpTools),this.gb("TextEditing",new En,this.mouseUpTools),this.gb("ClickCreating",new Nn,this.mouseUpTools),this.gb("ClickSelecting",new Sn,this.mouseUpTools)},yl("Horizontal",new Ph),yl("Spot",new Ch),yl("Table",new Ah),yl("Viewbox",new Oh),yl("TableRow",new jh),yl("TableColumn",new Fh),yl("Graduated",new Rh),yl("Grid",new Bh),Zr.add("GraphLinksModel",Sd),Zr.add("TreeModel",Td);var gy=M.go,my={get licenseKey(){return zo.licenseKey},set licenseKey(a){zo.licenseKey=a},get version(){return zo.version},Group:Cc,EnumValue:W,List:ot,Set:at,Map:Mt,Point:St,Size:Vt,Rect:Ut,Margin:oe,Spot:qe,Geometry:Qe,PathFigure:ai,PathSegment:hi,InputEvent:vi,DiagramEvent:xi,ChangedEvent:bi,Model:Ad,GraphLinksModel:sp,TreeModel:mp,Binding:tp,Transaction:Pi,UndoManager:Ni,CommandHandler:Gs,Tool:Ti,DraggingTool:Ri,DraggingInfo:ks,DraggingOptions:Ds,LinkingBaseTool:rn,LinkingTool:un,RelinkingTool:pn,LinkReshapingTool:mn,ResizingTool:kn,RotatingTool:Mn,ClickSelectingTool:Sn,ActionTool:Pn,ClickCreatingTool:Nn,HTMLInfo:Ln,ContextMenuTool:jn,DragSelectingTool:Cn,PanningTool:Tn,TextEditingTool:En,ToolManager:Li,Animation:xo,AnimationManager:eo,AnimationTrigger:Co,Layer:Oo,Diagram:zo,Palette:Is,Overview:Rs,Brush:Ha,GraphObject:qs,Panel:Eh,RowColumnDefinition:Ml,Shape:Ll,TextBlock:Yl,Picture:xu,Part:zu,Adornment:hc,Node:uc,Link:Oc,Placeholder:Fc,Layout:Uf,LayoutNetwork:Hf,LayoutVertex:$f,LayoutEdge:ed,GridLayout:id,PanelLayout:Mh,CircularLayout:yp,CircularNetwork:qp,CircularVertex:Kp,CircularEdge:Wp,ForceDirectedLayout:Jp,ForceDirectedNetwork:ng,ForceDirectedVertex:og,ForceDirectedEdge:rg,LayeredDigraphLayout:ag,LayeredDigraphNetwork:om,LayeredDigraphVertex:rm,LayeredDigraphEdge:um,TreeLayout:cm,TreeNetwork:fy,TreeVertex:dy,TreeEdge:py};"object"==typeof gy&&gy.version&&j("WARNING: a `go` object on the root object is already defined.  "+("Debug"in gy?"debug ":"")+"version: "+gy.version+", replaced with version: "+my.version),zo.prototype.go=my,M.go=my,"object"==typeof o.exports&&(o.exports=void 0!==t?t.go:self.go)}();void 0!==t?t.go:self.go;const r=void 0!==t?t.go:self.go,h=(r.Group,r.EnumValue,r.List,r.Set,r.Map,r.Point),l=r.Size,c=(r.Rect,r.Margin),f=r.Spot,d=(r.Geometry,r.PathFigure,r.PathSegment,r.InputEvent,r.DiagramEvent,r.ChangedEvent,r.Model),m=(r.GraphLinksModel,r.TreeModel,r.Binding),y=(r.Transaction,r.UndoManager,r.CommandHandler,r.Tool,r.DraggingTool,r.DraggingInfo,r.LinkingBaseTool,r.LinkingTool,r.RelinkingTool,r.LinkReshapingTool,r.ResizingTool,r.RotatingTool,r.ClickSelectingTool,r.ActionTool,r.ClickCreatingTool),v=(r.HTMLInfo,r.ContextMenuTool,r.DragSelectingTool,r.PanningTool,r.TextEditingTool,r.ToolManager,r.Animation,r.AnimationManager,r.AnimationTrigger,r.Layer,r.Diagram),x=(r.Palette,r.Overview,r.Brush),w=r.GraphObject,k=r.Panel,M=r.RowColumnDefinition,S=r.Shape,P=r.TextBlock,N=(r.TextBlockMetrics,r.Picture),C=(r.Part,r.Adornment,r.Node),T=r.Link,L=(r.Placeholder,r.Layout,r.LayoutNetwork,r.LayoutVertex,r.LayoutEdge,r.GridLayout,r.PanelLayout,r.CircularLayout,r.CircularNetwork,r.CircularVertex,r.CircularEdge,r.ForceDirectedLayout,r.ForceDirectedNetwork,r.ForceDirectedVertex,r.ForceDirectedEdge,r.LayeredDigraphLayout,r.LayeredDigraphNetwork,r.LayeredDigraphVertex,r.LayeredDigraphEdge,r.TreeLayout);r.TreeNetwork,r.TreeVertex,r.TreeEdge,r.version}).call(this,n(76),n(441)(t))}}]);